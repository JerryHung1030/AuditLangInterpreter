# Security Configuration Assessment
# CIS Checks for Windows 2012 R2
# Copyright (C) 2015, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# Center for Internet Security Benchmark for Microsoft Windows Server 2012 R2 v2.3.0 - 03-30-2018

policy:
  id: "cis_win2012r2"
  file: "cis_win2012r2.yml"
  name: "CIS Microsoft Windows Server 2012 R2 Benchmark v2.3.0"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for Microsoft Windows Server 2012 R2."
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check that the Windows platform is Windows Server 2012 R2"
  description: "Requirements for running the CIS benchmark under Windows Server 2012 R2"
  condition: all
  rules:
    - 'r:HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion -> ProductName -> r:^Windows Server 2012 R2'

checks:
  # Section 1.1 - Password Policies
  - id: 15000
    title: "確保“密碼最長期限”設定為“60 天或更少，但不是 0”"
    description: "此原則設定定義使用者在密碼過期之前可以使用其密碼的時間。此策略設定的值範圍為 0 到 999 天。如果將該值設為 0，則密碼永遠不會過期。由於攻擊者可以破解密碼，因此更改密碼的頻率越高，攻擊者使用破解密碼的機會就越少。但是，該值設定得越低，由於使用者必須更改密碼或忘記當前密碼，因此向幫助台支援呼叫增加的可能性就越大。此設定的建議狀態是 60 天或更少，但不是 0。"
    rationale: "密碼存在的時間越長，受到暴力攻擊、攻擊者獲得有關用戶的一般知識或用戶共享密碼的破壞的可能性就越大。將密碼最長期限設定配置為 0，以便使用者永遠不需要更改其密碼，這是一個主要的安全風險，因為只要有效使用者被授權存取，惡意使用者就可以使用受損的密碼。"
    remediation: "要透過群組原則 (GP) 設定建議的配置，請將以下介面路徑設置為 60 天或更少，但不少於 0 天：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Maximum password age."
    compliance:
      - cis: ["1.1.2"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37167-4"
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge -> 0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge -> n:^(\d+) compare <= 60'

  # Section 2.3 - Security Options
  - id: 15001
    title: "確保“帳戶：封鎖 Microsoft 帳戶”設定為“使用者無法新增或使用 Microsoft 帳戶登入”"
    description: "此策略設定阻止使用者在此電腦上新增新的 Microsoft 帳戶。此設定的建議狀態為：使用者無法新增或使用 Microsoft 帳戶登入。"
    rationale: "想要有效實施身分識別管理策略並嚴格控制用於登入其電腦的帳戶的組織可能會希望阻止 Microsoft 帳戶。組織可能還需要封鎖 Microsoft 帳戶，以滿足適用於其資訊系統的合規性標準的要求。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為使用者無法新增或使用Microsoft帳戶登入: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Block Microsoft accounts."
    compliance:
      - cis: ["2.3.1.2"]
      - cis_csc: ["16"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36147-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> NoConnectedUser -> 3'

  - id: 15002
    title: "確保“帳戶：限製本機帳戶僅使用空白密碼進行控制台登入”設定為“已啟用”"
    description: "此政策設定決定是否可以使用不受密碼保護的本機帳戶從實體電腦控制台以外的位置登入。如果啟用此政策設置，密碼為空的本機帳戶將無法從遠端用戶端電腦登入網路。此類帳戶只能透過電腦鍵盤登入。此設定的建議狀態為：已啟用。"
    rationale: "空白密碼對電腦安全構成嚴重威脅，應透過組織政策和適當的技術措施來禁止。事實上，Active Directory 網域的預設設定需要至少七個字元的複雜密碼。但是，如果能夠建立新帳戶的使用者繞過基於網域的密碼策略，他們可能會建立具有空白密碼的帳戶。例如，使用者可以建立一台獨立計算機，建立一個或多個密碼為空的帳戶，然後將該計算機加入網域。密碼為空的本機帳戶仍然可以使用。任何知道這些不受保護的帳戶之一的名稱的人都可以使用它進行登入。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Limit local account use of blank passwords to console logon only."
    compliance:
      - cis: ["2.3.1.4"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37615-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LimitBlankPasswordUse -> 1'

  - id: 15003
    title: "確保“審核：強制審核原則子類別設定（Windows Vista 或更高版本）覆蓋審核原則類別設定”設定為“啟用”"
    description: "此政策設定允許管理員啟用 Windows Vista 中提供的更精確的審核功能。 Windows Server 2003 Active Directory 中可用的稽核原則設定尚不包含用於管理新稽核子類別的設定。為了正確應用此基準中規定的審核策略，審核：強制審核原則子類別設定（Windows Vista 或更高版本）覆蓋審核原則類別設定設定需要設定為啟用。此設定的建議狀態為：已啟用。 *重要*：對於可能產生大量流量的審核設定要非常謹慎。例如，如果您對所有權限使用子類別啟用成功或失敗審核，則產生的大量審核事件可能會導致很難在安全性日誌中找到其他類型的項目。這種配置也可能對系統效能產生重大影響。"
    rationale: "在 Windows Vista 中引入審核子類別之前，很難在每個系統或每個使用者層級追蹤事件。較大的事件類別產生了太多的事件，需要審計的關鍵資訊很難找到。"
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings."
    compliance:
      - cis: ["2.3.2.1"]
      - cis_csc: ["6.2"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37850-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> SCENoApplyLegacyAuditPolicy -> 1'

  - id: 15004
    title: "確保“審核：如果無法記錄安全審核，則立即關閉系統”設定為“停用”"
    description: "此策略設定確定系統在無法記錄安全事件時是否關閉。可信任電腦系統評估標準 (TCSEC)-C2 和通用標準認證要求在審核系統無法記錄可審核事件的情況下防止可審核事件發生。 Microsoft 選擇透過在審核系統發生故障時停止系統並顯示停止訊息來滿足此要求。啟用此政策設定後，如果因任何原因無法記錄安全審核，系統將關閉。如果啟用審核：如果無法記錄安全審核，則立即關閉系統設置，則可能會發生意外的系統故障。管理負擔可能會很大，特別是如果您還將安全日誌的保留方法配置為「不覆蓋事件」（手動清除日誌）。此配置會導致否認威脅（備份操作員可能否認他們備份或恢復資料）成為拒絕服務 (DoS) 漏洞，因為如果伺服器因登入事件和其他安全問題而不堪重負，則可能會被迫關閉寫入安全性日誌的事件。此外，由於關閉不正常，可能會對作業系統、應用程式或資料造成不可挽回的損壞。儘管 NTFS 檔案系統在電腦非正常關機時保證其完整性，但它不能保證每個應用程式的每個資料檔案在電腦重新啟動時仍處於可用形式。此設定的建議狀態是：停用。"
    rationale: "如果電腦無法將事件記錄到安全性日誌中，則在發生安全事件後可能無法查看關鍵證據或重要的故障排除資訊。此外，攻擊者可能會產生大量安全性日誌事件來故意強制電腦關閉。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設定為停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Audit: Shut down system immediately if unable to log security audits."
    compliance:
      - cis: ["2.3.2.2"]
      - cis_csc: ["6"]
      - pci_dss: ["2.2.4", "10.7"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-35907-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> CrashOnAuditFail -> 0'

  - id: 15005
    title: "確保“設備：允許格式化和彈出可移動媒體”設定為“管理員”"
    description: "此策略設定決定允許誰格式化和彈出可移動 NTFS 媒體。您可以使用此策略設定來防止未經授權的使用者刪除一台電腦上的資料，以便在他們擁有本機管理員權限的另一台電腦上存取該資料。此設定的建議狀態為：管理員。"
    rationale: "使用者可以將可移動磁碟上的資料移到他們具有管理權限的另一台電腦上。然後，使用者可以取得任何檔案的所有權，授予自己完全控制權，並檢視或修改任何檔案。大多數可移動儲存裝置將透過按機械按鈕彈出媒體，這一事實削弱了此策略設定的優勢。"
    remediation: "為了透過 GP 建立建議的配置，將以下 UI 路徑設定為 Administrators 和 Interactive Users: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Devices: Allowed to format and eject removable media."
    default_value: "Disabled."
    compliance:
      - cis: ["2.3.4.1"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37701-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> AllocateDASD -> 0'

  - id: 15006
    title: "確保“裝置：阻止使用者安裝印表機驅動程式”設定為“已啟用”"
    description: "若要讓電腦列印到共用印表機，必須在本機電腦上安裝此共用印表機的驅動程式。此安全性設定決定誰可以在連接到共用印表機時安裝印表機驅動程式。此設定的建議狀態為：已啟用。注意：此設定不會影響新增本機印表機的功能。此設定不會影響管理員。"
    rationale: "在某些組織中，允許使用者在自己的工作站上安裝印表機驅動程式可能是合適的。但是，您應該只允許管理員而不是使用者在伺服器上執行此操作，因為在伺服器上安裝印表機驅動程式可能會無意中導致電腦變得不太穩定。惡意使用者可能會故意安裝不適當的印表機驅動程式來損壞計算機，或者使用者可能會意外安裝偽裝成印表機驅動程式的惡意軟體。攻擊者可以將特洛伊木馬程式偽裝成印表機驅動程式。該程式可能對使用者來說似乎必須使用它來列印，但這樣的程式可能會在您的電腦網路上釋放惡意程式碼。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設定為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Devices: Prevent users from installing printer drivers."
    compliance:
      - cis: ["2.3.4.2"]
      - cis_csc: ["5.1"]
      - pci_dss: ["2.2.4", "2,2,5"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC6.3", "CC5.2"]
    references:
      - "CCE-37942-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers -> AddPrinterDrivers -> 1'

  - id: 15007
    title: "確保「網域控制站：允許伺服器操作員排程任務」設定為「停用」（僅限 DC）"
    description: "此策略設定決定是否允許伺服器操作員群組的成員透過 AT 計畫工具提交作業。對於大多數組織來說，此策略設定配置的影響應該很小。使用者（包括伺服器操作員群組中的使用者）仍然能夠透過任務規劃程式精靈建立作業，但這些作業將在使用者設定作業時進行驗證的帳戶上下文中執行。注意：可以修改 AT 服務帳戶以選擇其他帳戶而非本機系統帳戶。若要變更帳戶，請開啟“系統工具”，按一下“排程任務”，然後按一下“附件資料夾”。然後點選「進階」功能表上的「AT 服務帳戶」。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，伺服器操作員透過 AT 服務建立的作業將在執行該服務的帳戶的上下文中執行。預設情況下，這是本機系統帳戶。如果啟用此策略設置，伺服器操作員可以執行 SYSTEM 能夠執行但他們通常無法執行的任務，例如將其帳戶新增至本機管理員群組。"
    remediation: "若要透過GP建立推薦的設定，將以下UI路徑設為Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: Allow server operators to schedule tasks."
    compliance:
      - cis: ["2.3.5.1"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37848-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> SubmitControl -> 0'

  - id: 15008
    title: "確保「網域控制器：LDAP 伺服器簽章要求」設定為「需要簽章」（僅限 DC）"
    description: "此政策設定決定輕型目錄存取協定 (LDAP) 伺服器是否需要 LDAP 用戶端協商資料簽章。此設定的建議狀態是：需要簽名。注意：網域成員電腦必須將網路安全：LDAP 簽章要求（規則 2.3.11.8）設定為協商簽章或更高。如果不是，一旦在網域控制站上配置了上述要求簽章值，他們將無法進行身份驗證。幸運的是，協商簽章是客戶端配置中的預設設定。注意 #2：此策略設定對 LDAP 簡單綁定 (ldap_simple_bind) 或透過 SSL 的 LDAP 簡單綁定 (ldap_simple_bind_s) 沒有任何影響。 Windows XP Professional 隨附的 Microsoft LDAP 用戶端不使用 LDAP 簡單綁定或透過 SSL 的 LDAP 簡單綁定來與網域控制站通訊。注意#3：在啟用此設定之前，您應先確保沒有用戶端（包括基於伺服器的應用程式）配置為透過未簽署的 LDAP 與 Active Directory 進行驗證，因為變更此設定將破壞這些應用程式。此類應用程式應先重新配置為使用簽署 LDAP、安全性 LDAP (LDAPS) 或 IPsec 保護的連線。"
    rationale: "未簽署的網路流量容易受到中間人攻擊。在此類攻擊中，入侵者捕獲伺服器和客戶端之間的資料包，修改它們，然後將它們轉發到客戶端。對於 LDAP 伺服器，攻擊者可能會導致用戶端根據 LDAP 目錄中的錯誤記錄做出決策。為了降低組織網路遭受此類入侵的風險，您可以實施強大的實體安全措施來保護網路基礎架構。此外，您還可以實施 Internet 協定安全性 (IPsec) 驗證標頭模式 (AH)，該模式對 IP 流量執行相互驗證和封包完整性，使所有類型的中間人攻擊變得極為困難。此外，允許使用常規的、未簽署的 LDAP 允許透過網路以明文形式接收憑證，這很容易導致帳戶密碼被網路上的其他系統攔截。"
    remediation: "要通過 GP 設定推薦的配置，將以下 UI 路徑設置為要求簽名：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: LDAP server signing requirements."
    compliance:
      - cis: ["2.3.5.2"]
      - cis_csc: ["3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - https://blogs.technet.microsoft.com/russellt/2016/01/13/identifying-clear-text-ldap-binds-to-your-dcs/
      - "CCE-35904-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters -> LDAPServerIntegrity -> 2'

  - id: 15009
    title: "確保“網域控制器：拒絕電腦帳戶密碼變更”設定為“停用”（僅限 DC）"
    description: "此安全性設定決定網域控制站是否拒絕成員電腦變更電腦帳戶密碼的請求。此設定的建議狀態是：停用。"
    rationale: "如果在網域中的所有網域控制站上啟用此原則設置，網域成員將無法變更其電腦帳戶密碼，並且這些密碼將更容易受到攻擊。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設置為停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: Refuse machine account password changes."
    compliance:
      - cis: ["2.3.5.3"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36921-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RefusePasswordChange -> 0'

  - id: 15010
    title: "確保“網域成員：對安全通道資料進行數位加密或簽署（始終）”設定為“啟用”"
    description: "此政策設定決定是否必須對網域成員發起的所有安全通道流量進行簽署或加密。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    remediation: "若要通過 GP 建立推薦配置，將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally encrypt or sign secure channel data (always)."
    compliance:
      - cis: ["2.3.6.1"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36142-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireSignOrSeal -> 1'

  - id: 15011
    title: "確保“網域成員：對安全通道資料進行數位加密（如果可能）”設定為“啟用”"
    description: "此政策設定決定網域成員是否應嘗試為其發起的所有安全通道流量協商加密。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally encrypt secure channel data (when possible)."
    compliance:
      - cis: ["2.3.6.2"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37130-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SealSecureChannel -> 1'

  - id: 15012
    title: "確保“網域成員：對安全通道資料進行數位簽章（如果可能）”設定為“啟用”"
    description: "此政策設定決定網域成員是否應嘗試協商其發起的所有安全通道流量是否必須進行數位簽章。數位簽章可保護流量不被任何在網路中擷取資料的人修改。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally sign secure channel data (when possible)."
    compliance:
      - cis: ["2.3.6.3"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37222-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SignSecureChannel -> 1'

  - id: 15013
    title: "確保“網域成員：停用電腦帳戶密碼變更”設定為“停用”"
    description: "此原則設定確定網域成員是否可以定期變更其電腦帳戶密碼。無法自動變更其帳戶密碼的電腦可能容易受到攻擊，因為攻擊者可能能夠確定系統網域帳戶的密碼。此設定的建議狀態是：停用。"
    rationale: "屬於某個網域的基於 Windows Server 2003 的電腦的預設設定是自動要求它們每 30 天變更其帳戶的密碼。如果停用此原則設置，執行 Windows Server 2003 的電腦將保留與其電腦帳戶相同的密碼。不再能夠自動更改其帳戶密碼的電腦面臨來自攻擊者的風險，攻擊者可以確定電腦網域帳戶的密碼。"
    remediation: "若要透過 GP 設定建議的配置，將以下 UI 路徑設為 Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Disable machine account password changes."
    compliance:
      - cis: ["2.3.6.4"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37508-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> DisablePasswordChange -> 0'

  - id: 15014
    title: "確保“網域成員：需要強（Windows 2000 或更高版本）會話金鑰”設定為“啟用”"
    description: "啟用此策略設定後，只能使用能夠使用強（128 位元）會話金鑰加密安全通道資料的網域控制站建立安全通道。要啟用此策略設置，網域中的所有網域控制站都必須能夠使用強密鑰加密安全通道資料，這意味著所有網域控制站必須運行 Microsoft Windows 2000 或更高版本。此設定的建議狀態為：已啟用。"
    rationale: "Windows 2000 中用於在網域控制站和成員電腦之間建立安全通道通訊的會話金鑰比以前的 Microsoft 作業系統中的會話金鑰強大得多。只要有可能，您就應該利用這些更強大的會話金鑰來幫助保護安全通道通訊免受試圖劫持網路會話和竊聽的攻擊。 （竊聽是一種駭客行為，其中網路資料在傳輸過程中被讀取或更改。資料可以被修改以隱藏或更改發送者，或被重新導向。）"
    remediation: "若要透過群組原則建立建議的配置，請將以下 UI 路徑設定為「已啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Require strong (Windows 2000 or later) session key."
    compliance:
      - cis: ["2.3.6.6"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37614-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireStrongKey -> 1'

  - id: 15015
    title: "確保“互動式登入：不顯示最後的使用者名稱”設定為“已啟用”"
    description: "此政策設定決定最後登入組織中用戶端電腦的使用者的帳戶名稱是否將顯示在每台電腦各自的 Windows 登入畫面中。啟用此策略設定可防止入侵者從組織中的桌上型電腦或筆記型電腦的螢幕上直觀地收集帳戶名稱。此設定的建議狀態為：已啟用。"
    rationale: "有權存取控制台的攻擊者（例如，具有實體存取權限的人或能夠透過遠端桌面服務連接到伺服器的人）可以查看最後登入伺服器的使用者的名稱。然後，攻擊者可以嘗試猜測密碼、使用字典或使用暴力攻擊來嘗試登入。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Do not display last user name."
    compliance:
      - cis: ["2.3.7.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36056-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DontDisplayLastUserName -> 1'

  - id: 15016
    title: "確保“互動式登入：不需要 CTRL+ALT+DEL”設定為“停用”"
    description: "此政策設定確定使用者在登入之前是否必須按 CTRL+ALT+DEL。此設定的建議狀態是：停用。"
    rationale: "Microsoft 開發此功能是為了讓有某些身體缺陷的使用者更輕鬆地登入執行 Windows 的電腦。如果使用者不需要按 CTRL+ALT+DEL，他們很容易受到試圖攔截其密碼的攻擊。如果在登入前需要按 CTRL+ALT+DEL，則使用者密碼將透過可信任路徑進行傳遞。攻擊者可以安裝看起來像標準 Windows 登入對話方塊的特洛伊木馬程式並捕獲使用者的密碼。然後，攻擊者就可以使用該使用者擁有的任何權限等級登入受感染的帳戶。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Do not require CTRL+ALT+DEL"
    compliance:
      - cis: ["2.3.7.2"]
      - cis_csc: ["8"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37637-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DisableCAD -> 0'

  - id: 15017
    title: "確保“互動式登入：電腦不活動限制”設定為“900 秒或更少，但不是 0”"
    description: "Windows 會注意到登入工作階段的不活動狀態，如果不活動時間超過不活動限制，則螢幕保護程式將執行，鎖定工作階段。此設定的建議狀態是：900 秒或更少，但不是 0。"
    rationale: "如果使用者離開時忘記鎖定計算機，則路人可能會劫持計算機。"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為900秒或更少，但不能為0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Machine inactivity limit."
    compliance:
      - cis: ["2.3.7.3"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38235-8"
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs -> 0'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs -> n:^(\d+) compare <= 900'

  - id: 15018
    title: "確保“互動式登入：先前登入快取的次數（以防網域控制站無法使用）”設定為“4 次或更少的登入”"
    description: "此策略設定決定使用者是否可以使用快取的帳戶資訊登入 Windows 網域。網域帳戶的登入資訊可以快取在本機，以便即使無法聯繫網域控制器，使用者也可以登入。此策略設定決定在本機快取其登入資訊的唯一使用者的數量。如果該值設為 0，則停用登入快取功能。能夠存取伺服器檔案系統的攻擊者可以找到此快取資訊並使用暴力攻擊來確定使用者密碼。此設定的建議狀態為：4 次或更少的登入。"
    rationale: "分配給此策略設定的數字表示電腦將在本機快取其登入資訊的使用者數量。如果該數字設定為 4，則電腦快取 4 個使用者的登入資訊。當第 5 個使用者登入電腦時，伺服器將覆蓋最舊的快取登入工作階段。存取電腦控制台的使用者的登入憑證將會快取在該電腦上。能夠存取電腦檔案系統的攻擊者可以找到此快取資訊並使用暴力攻擊來嘗試確定使用者密碼。為了減輕此類攻擊，Windows 會對資訊進行加密並隱藏其實體位置。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 4 或更少次登入：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Number of previous logons to cache (in case domain controller is not available)"
    compliance:
      - cis: ["2.3.7.6"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37439-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> CachedLogonsCount -> n:^(\d+) compare <= 4'

  - id: 15019
    title: "確保“互動式登入：提示使用者在過期前更改密碼”設定為“5 到 14 天之間”"
    description: "此策略設定確定提前多久警告使用者其密碼將過期。建議您將此原則設定配置為至少 5 天但不超過 14 天，以便在使用者密碼過期時充分警告使用者。此設定的建議狀態為：5 到 14 天之間。"
    rationale: "建議將使用者密碼配置為定期過期。需要警告使用者他們的密碼即將過期，否則當密碼過期時，他們可能會無意中被鎖定在電腦之外。這種情況可能會導致本地存取網路的使用者感到困惑，或使用戶無法透過撥接或虛擬私人網路 (VPN) 連線存取組織的網路。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為 5 至 14 天之間的值: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Prompt user to change password before expiration."
    compliance:
      - cis: ["2.3.7.7"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37622-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> PasswordExpiryWarning -> n:^(\d+) compare >= 5'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> PasswordExpiryWarning -> n:^(\d+) compare >= 5 && n:^(\d+) compare <= 14'

  - id: 15020
    title: "確保“互動式登入：需要網域控制器身份驗證才能解鎖工作站”設定為“已啟用”"
    description: "解鎖鎖定的電腦需要登入資訊。對於網域帳戶，此安全性設定決定是否需要聯絡網域控制站來解鎖電腦。此設定的建議狀態為： Enabled 。"
    rationale: "預設情況下，電腦會在記憶體中快取所有經過本機驗證的使用者的憑證。電腦使用這些快取的憑證來驗證任何嘗試解鎖控制台的人。使用快取憑證時，在對帳戶進行身份驗證後，不會考慮或套用最近對帳戶進行的任何變更（例如使用者權限指派、帳戶鎖定或帳戶已停用）。使用者權限不會更新，並且（更重要的是）禁用的帳戶仍然能夠解鎖電腦的控制台。"
    remediation: "要通過 GP 實現建議的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Require Domain Controller Authentication to unlock workstation"
    compliance:
      - cis: ["2.3.7.8"]
      - cis_csc: ["16.9"]
      - pci_dss: ["8.6"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38240-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ForceUnlockLogon -> 1'

  - id: 15021
    title: "確保「互動式登入：智慧卡刪除行為」設定為「鎖定工作站」或更高版本"
    description: "此策略設定確定從智慧卡讀卡機中取出登入使用者的智慧卡時會發生什麼情況。此設定的建議狀態為：鎖定工作站。如果遠端桌面服務工作階段也符合基準，請將此設定配置為強制登出或中斷連線。"
    rationale: "使用者有時會在離開工作站時忘記鎖定工作站，從而導致惡意使用者有可能存取他們的電腦。如果使用智慧卡進行身份驗證，當卡片被移除時，電腦應自動鎖定自身，以確保只有擁有智慧卡的使用者才能使用這些憑證存取資源。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Lock Workstation（或者，如果適用於您的環境，設置為 Force Logoff 或 Disconnect 如果是遠端桌面服務會話）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Smart card removal behavior."
    compliance:
      - cis: ["2.3.7.9"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.6"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38333-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScRemoveOption -> r:^1$|^2$|^3$'

  - id: 15022
    title: "確保“Microsoft 網路用戶端：對通訊進行數位簽章（始終）”設定為“啟用”"
    description: "此政策設定確定 SMB 用戶端元件是否需要封包簽署。注意：當基於 Windows Vista 的電腦啟用此原則設定並且它們連接到遠端伺服器上的檔案或列印共用時，該設定與其配套設定 Microsoft 網路伺服器同步非常重要：對通訊進行數位簽署（始終）那些伺服器。有關這些設定的詳細資訊，請參閱威脅和對策指南第 5 章中的「Microsoft 網路用戶端和伺服器：數位簽章通訊（四個相關設定）」部分。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Digitally sign communications (always)."
    compliance:
      - cis: ["2.3.8.1"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36325-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature -> 1'

  - id: 15023
    title: "確保“Microsoft 網路用戶端：對通訊進行數位簽章（如果伺服器同意）”設定為“啟用”"
    description: "此政策設定決定 SMB 用戶端是否嘗試協商 SMB 封包簽章。注意：在網路上的 SMB 用戶端上啟用此原則設定可以使它們完全有效地與環境中的所有用戶端和伺服器進行封包簽署。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Digitally sign communications (if server agrees)."
    compliance:
      - cis: ["2.3.8.2"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36269-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature -> 1'

  - id: 15024
    title: "確保“Microsoft 網路用戶端：將未加密的密碼傳送至第三方 SMB 伺服器”設定為“停用”"
    description: "此政策設定確定 SMB 重新導向程式是否在驗證期間向不支援密碼加密的第三方 SMB 伺服器傳送純文字密碼。建議您停用此策略設置，除非有充分的業務案例來啟用它。如果啟用此策略設置，將允許在網路上使用未加密的密碼。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，伺服器可以透過網路將明文密碼傳輸到提供 SMB 服務的其他計算機，這是一個重大的安全風險。這些其他電腦可能不會使用 Windows Server 2003 中包含的任何 SMB 安全機制。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設定為已停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Send unencrypted password to third-party SMB servers."
    compliance:
      - cis: ["2.3.8.3"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37863-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnablePlainTextPassword -> 0'

  - id: 15025
    title: "確保“Microsoft 網路伺服器：掛起會話之前所需的空閒時間量”設定為“15 分鐘或更少，但不是 0”"
    description: "此策略設定可讓您指定在 SMB 會話因不活動而暫停會話之前必須經過的連續空閒時間量。管理員可以使用此策略設定來控制電腦何時掛起不活動的 SMB 會話。如果用戶端活動恢復，會話將自動重新建立。值 0 似乎允許會話無限期地持續。最大值為99999，即超過69天；實際上，該值會停用該設定。此設定的建議狀態是：15 分鐘或更少，但不是 0。"
    rationale: "每個 SMB 會話都會消耗伺服器資源，大量空會話會降低伺服器速度或可能導致伺服器失敗。攻擊者可以重複建立 SMB 會話，直到伺服器的 SMB 服務變得緩慢或無回應。"
    remediation: "要通過 GP 設定建議配置，將以下 UI 路徑設置為 15 分鐘或更少，但不能是 0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Amount of idle time required before suspending session."
    compliance:
      - cis: ["2.3.9.1"]
      - cis_csc: ["3"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38046-9"
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect -> 0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect -> n:^(\d+) compare <= 15'

  - id: 15026
    title: "確保“Microsoft 網路伺服器：對通訊進行數位簽章（始終）”設定為“啟用”"
    description: "此策略設定確定 SMB 伺服器元件是否需要封包簽署。在混合式環境中啟用此策略設定可防止下游用戶端將工作站用作網路伺服器。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "要通過 GP 設定建議的配置，將以下 UI 路徑設定為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Digitally sign communications (always)."
    compliance:
      - cis: ["2.3.9.2"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37864-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RequireSecuritySignature -> 1'

  - id: 15027
    title: "確保“Microsoft 網路伺服器：對通訊進行數位簽章（如果客戶端同意）”設定為“啟用”"
    description: "此原則設定決定 SMB 伺服器是否將與請求它的用戶端協商 SMB 封包簽章。如果用戶端沒有發出簽章請求，且未啟用 Microsoft 網路伺服器：數位簽章通訊（始終）設置，則無需簽章即可允許連線。注意：在網路上的 SMB 用戶端上啟用此原則設置，使其能夠完全有效地與環境中的所有用戶端和伺服器進行封包簽署。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "要通過GP建立推薦配置, 將以下UI路徑設定為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Digitally sign communications (if client agrees)."
    compliance:
      - cis: ["2.3.9.3"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-35988-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> EnableSecuritySignature -> 1'

  - id: 15028
    title: "確保“Microsoft 網路伺服器：登入時間到期時斷開客戶端連線”設定為“啟用”"
    description: "此安全性設定決定是否在使用者帳戶的有效登入時間之外斷開連接到本機的使用者。此設定會影響伺服器訊息區塊 (SMB) 元件。如果啟用此策略設置，您還應該啟用網路安全：登入時間到期時強制登出（規則 2.3.11.6）。如果您的組織為使用者配置登入時間，則需要此政策設定來確保它們有效。此設定的建議狀態為：已啟用。"
    rationale: "如果您的組織為使用者配置登入時間，則啟用此策略設定是有意義的。否則，在登入時間之外不應存取網路資源的使用者實際上可能能夠透過在允許的時間內建立的會話繼續使用這些資源。"
    remediation: "要通過 GP 設定建議的配置，請將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Disconnect clients when logon hours expire."
    compliance:
      - cis: ["2.3.9.4"]
      - cis_csc: ["16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37972-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff -> 1'

  - id: 15029
    title: "確保「Microsoft 網路伺服器：伺服器 SPN 目標名稱驗證等級」設定為「如果用戶端提供則接受」或更高"
    description: "此政策設定控制具有共用資料夾或印表機的電腦（伺服器）在用戶端電腦使用伺服器訊息區塊 (SMB) 協定建立會話時提供的服務主體名稱 (SPN) 上執行的驗證等級。伺服器訊息區塊 (SMB) 協定為檔案和列印共用以及其他網路操作（例如遠端 Windows 管理）提供了基礎。 SMB 協定支援在 SMB 用戶端提供的驗證 blob 內驗證 SMB 伺服器服務主體名稱 (SPN)，以防止針對 SMB 伺服器的一類攻擊（稱為 SMB 中繼攻擊）。此設定將影響 SMB1 和 SMB2。此設定的建議狀態為：如果客戶端提供則接受。將此設定配置為客戶端必需也符合基準。注意：自MS KB3161561 安全性修補程式發布以來，當與UNC 路徑增強（即規則18.5.14.1）同時使用時，此設定可能會在網域控制站上導致嚴重問題（例如複製問題、群組原則編輯問題和藍屏當機）。因此，CIS 建議不要在網域控制站上部署此設定。"
    rationale: "電腦的身份可以被欺騙以獲取對網路資源的未經授權的存取。"
    remediation: "要通過群組策略建立建議的配置，請將以下 UI 路徑設定為「接受（由客戶端提供時）」(配置為「必須由客戶端」也符合基準)：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Server SPN target name validation level"
    compliance:
      - cis: ["2.3.9.5"]
      - cis_csc: ["14"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - https://support.microsoft.com/en-us/help/3161561/ms16-075-and-ms16-076-description-of-the-security-update-for-windows-n
      - "CCE-36170-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> SMBServerNameHardeningLevel ->  n:^(\d+) compare >= 1'

  # Section 2.3 - Security Options

  - id: 15030
    title: "確保“網路存取：不允許匿名列舉 SAM 帳戶”設定為“啟用”"
    description: "此政策設定控制匿名使用者列舉安全帳戶管理員 (SAM) 中的帳戶的能力。如果啟用此策略設置，具有匿名連接的使用者將無法列舉您環境中的系統上的網域帳戶使用者名稱。此策略設定還允許對匿名連線進行其他限制。此設定的建議狀態為：已啟用。注意：此策略對網域控制站沒有影響。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱並使用該資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者來獲取密碼或某種形式的安全資訊）"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow anonymous enumeration of SAM accounts."
    compliance:
      - cis: ["2.3.10.2"]
      - cis_csc: ["16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36316-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymousSAM -> 1'

  - id: 15031
    title: "確保“網路存取：不允許匿名列舉 SAM 帳戶和共用”設定為“啟用”"
    description: "此政策設定控制匿名使用者列舉 SAM 帳戶和共享的能力。如果啟用此策略設置，匿名使用者將無法列舉環境中系統上的網域帳戶使用者名稱和網路共用名稱。此設定的建議狀態為：已啟用。注意：此策略對網域控制站沒有影響。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱和共享資源，並使用這些資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者來獲取密碼或某種形式的安全資訊）"
    remediation: "要通過GP建立推薦配置，將以下U路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow anonymous enumeration of SAM accounts and shares."
    compliance:
      - cis: ["2.3.10.3"]
      - cis_csc: ["16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36316-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymous -> 1'

  - id: 15032
    title: "確保“網路存取：不允許儲存網路驗證的密碼和憑證”設定為“已啟用”"
    description: "此原則設定確定憑證管理員（以前稱為儲存的使用者名稱和密碼）是否會儲存密碼或憑證以供日後在取得網域驗證時使用。此設定的建議狀態為：已啟用。注意：對此設定的變更只有在 Windows 重新啟動後才會生效。"
    rationale: "使用者登入電腦後可以存取快取的密碼。儘管此資訊聽起來很明顯，但如果使用者在不知情的情況下執行讀取密碼並將其轉發給另一個未經授權的使用者的惡意程式碼，則可能會出現問題。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設定為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow storage of passwords and credentials for network authentication."
    compliance:
      - cis: ["2.3.10.4"]
      - cis_csc: ["16.14"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-38119-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> DisableDomainCreds -> 1'

  - id: 15033
    title: "確保“網路存取：讓每個人權限套用至匿名使用者”設定為“停用”"
    description: "此策略設定決定為電腦的匿名連線指派哪些附加權限。此設定的建議狀態是：停用。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱和共享資源，並使用這些資訊嘗試猜測密碼、執行社會工程攻擊或發動 DoS 攻擊。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設為已停用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Let Everyone permissions apply to anonymous users."
    compliance:
      - cis: ["2.3.10.5"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36148-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> EveryoneIncludesAnonymous -> 0'

  - id: 15034
    title: "設定“網路存取：可以匿名存取的命名管道”"
    description: "此策略設定決定哪些通訊會話或管道將具有允許匿名存取的屬性和權限。此設定的建議狀態是： - 等級 1 - 網域控制器。此設定的建議狀態為：LSARPC、NETLOGON、SAMR 和（啟用舊電腦瀏覽器服務時）BROWSER。 - 1 級 - 會員伺服器。此設定的建議狀態為：<空白>（即無），或（啟用舊版電腦瀏覽器服務時）瀏覽器。注意：擁有遠端桌面授權角色服務的遠端桌面服務角色的成員伺服器將需要對此建議的特殊例外，以允許匿名存取 HydraLSPipe 和 TermServLicensing 命名管道。"
    rationale: "限制可以匿名存取的命名管道將減少系統的攻擊面。"
    remediation: "為了透過 GP 建立建議的配置，請配置以下 UI 路徑：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Named Pipes that can be accessed anonymously."
    compliance:
      - cis: ["2.3.10.6"]
      - cis_csc: ["14.1", "16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-38258-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionPipes -> r:lsarpc && r:netlogon && r:samr'

  - id: 15035
    title: "設定“網路存取：遠端存取註冊表路徑”"
    description: "此策略設定可決定透過網路存取哪些登錄路徑，無論 winreg 註冊表項的存取控制清單 (ACL) 中所列的使用者或群組為何。注意：Windows XP 中不存在此設定。 Windows XP 中有一個具有該名稱的設置，但在 Windows Server 2003、Windows Vista 和 Windows Server 2008（非 R2）中，該設定稱為「網路存取：遠端存取登錄路徑和子路徑」。注意#2：配置此設定時，您指定一個或多個物件的清單。輸入清單時使用的分隔符號是換行或回車字元，即鍵入清單中的第一個對象，按 Enter 按鈕，鍵入下一個對象，再次按 Enter 等。列表。它還在群組原則編輯器的顯示窗格和策略結果集控制台中呈現為逗號分隔的清單。它在註冊表中記錄為 REG_MULTI_SZ 值中的換行分隔清單。"
    rationale: "註冊表是一個包含電腦配置資訊的資料庫，其中許多資訊都是敏感資訊。攻擊者可以使用此資訊來促進未經授權的活動。為了降低此類攻擊的風險，在整個註冊表中分配了適當的 ACL，以幫助防止未經授權的使用者存取。"
    remediation: "要透過 GP 設定推薦的配置，請將以下使用者介面路徑設置為：System\\CurrentControlSet\\Control\\ProductOptions | System\\CurrentControlSet\\Control\\Server Applications | Software\\Microsoft\\Windows NT\\CurrentVersion. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Remotely accessible registry paths."
    compliance:
      - cis: ["2.3.10.7"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37194-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine -> r:System\\CurrentControlSet\\Control\\ProductOptions'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Server Applications'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine -> r:Software\\Microsoft\\Windows NT\\CurrentVersion'

  - id: 15036
    title: "配置“網路存取：遠端存取註冊表路徑和子路徑”"
    description: "此策略設定可決定透過網路存取哪些登錄路徑和子路徑，無論 winreg 登錄機碼的存取控制清單 (ACL) 中所列的使用者或群組為何。注意：在 Windows XP 中，此設定稱為“網路存取：遠端存取登錄路徑”，Windows Vista、Windows Server 2008（非 R2）和 Windows Server 2003 中具有相同名稱的設定在 Windows XP 中不存在。注意#2：配置此設定時，您指定一個或多個物件的清單。輸入清單時使用的分隔符號是換行或回車字元，即鍵入清單中的第一個對象，按 Enter 按鈕，鍵入下一個對象，再次按 Enter 等。列表。它還在群組原則編輯器的顯示窗格和策略結果集控制台中呈現為逗號分隔的清單。它在註冊表中記錄為 REG_MULTI_SZ 值中的換行分隔清單。"
    rationale: "註冊表包含敏感的電腦配置訊息，攻擊者可能會利用這些資訊來進行未經授權的活動。事實上，在整個註冊表中分配的預設 ACL 具有相當大的限制性，有助於保護註冊表免遭未經授權的用戶存取，從而降低了此類攻擊的風險。"
    remediation: "若要通過 GP 建立推薦配置，將以下 UI 路徑設置為：System\\CurrentControlSet\\Control\\Print\\Printers | System\\CurrentControlSet\\Services\\Eventlog Software\\Microsoft\\OLAP Server | Software\\Microsoft\\Windows NT\\CurrentVersion\\Print Software\\Microsoft\\Windows | NT\\CurrentVersion\\Windows System\\CurrentControlSet\\Control\\ContentIndex | System\\CurrentControlSet\\Control\\Terminal Server | System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig | System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration | Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib | System\\CurrentControlSet\\Services\\SysmonLog | Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local | Policies\\Security Options\\Network access: Remotely accessible registry paths | and sub-paths。當伺服器擁有 Active Directory 憑證服務角色與憑證授權角色服務時，上述列表還應包括：System\\CurrentControlSet\\Services\\CertSvc。當伺服器安裝 WINS 伺服器功能時，上述列表還應包括：System\\CurrentControlSet\\Services\\WINS。"
    compliance:
      - cis: ["2.3.10.8"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36347-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Print\\Printers'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Services\\Eventlog Software\\Microsoft\\OLAP Server Software\\Microsoft\\Windows NT\\CurrentVersion\\Print Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows System\\CurrentControlSet\\Control\\ContentIndex'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Terminal Server'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Services\\SysmonLog'

  - id: 15037
    title: "確保“網路存取：限制對命名管道和共享的匿名存取”設定為“啟用”"
    description: "啟用後，此策略設定將匿名存取權限限制為僅對網路存取：可以匿名存取的命名管道和網路存取：可以匿名存取的共用設定中指定的共用和管道。此策略設定透過在 HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters 註冊表項中新增值為 1 的 RestrictNullSessAccess 來控制對電腦上共用的空會話存取。此登錄值可開啟或關閉空會話共用，以控制伺服器服務是否限制未經驗證的用戶端對命名資源的存取。此設定的建議狀態為：已啟用。"
    rationale: "空會話是一個弱點，可以透過環境中電腦上的共用（包括預設共用）來利用。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Restrict anonymous access to Named Pipes and Shares."
    compliance:
      - cis: ["2.3.10.9"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36021-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RestrictNullSessAccess -> 1'

  - id: 15038
    title: "確保“網路存取：可以匿名存取的共用”設定為“無”"
    description: "此策略設定確定匿名使用者可以存取哪些網路共用。此策略設定的預設配置影響不大，因為所有使用者都必須經過身份驗證才能存取伺服器上的共用資源。此設定的建議狀態為：<空白>（即無）。"
    rationale: "在此設定中允許任何值都是非常危險的。任何網路使用者都可以存取列出的任何共享，這可能會導致敏感資料的暴露或損壞。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為<空白>（即無）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Shares that can be accessed anonymously."
    compliance:
      - cis: ["2.3.10.10"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-38095-6"
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionShares'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionShares -> r:\.'
  - id: 15039
    title: "確保“網路存取：本機帳戶的共用和安全性模型”設定為“經典 - 本機使用者以自己的身分進行驗證”"
    description: "此政策設定決定如何對使用本機帳戶的網路登入進行驗證。經典選項允許精確控制對資源的存取，包括為不同使用者指派對相同資源的不同類型的存取權限。僅訪客選項可讓您平等對待所有使用者。在這種情況下，所有使用者都以訪客身份進行身份驗證，只是為了獲得對給定資源的相同存取等級。此設定的建議狀態是：經典 - 本機使用者以自己的身分進行身份驗證。注意：此設定不會影響使用 Telnet 或遠端桌面服務（以前稱為終端機服務）等服務遠端執行的互動式登入。"
    rationale: "使用僅限來賓模型，任何可以透過網路對您的電腦進行身份驗證的使用者都會以來賓權限進行身份驗證，這可能意味著他們將沒有對該電腦上的共用資源的寫入存取權限。儘管此限制確實提高了安全性，但它使授權使用者存取這些電腦上的共用資源變得更加困難，因為這些資源上的 ACL 必須包括來賓帳戶的存取控制條目 (ACE)。對於經典模型，本機帳戶應該受到密碼保護。否則，如果啟用了來賓存取，則任何人都可以使用這些使用者帳戶來存取共用系統資源。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為Classic - local users authenticate as themselves: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Sharing and security model for local accounts."
    compliance:
      - cis: ["2.3.10.11"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["7.1.3"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37623-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> ForceGuest -> 0'

  - id: 15040
    title: "確保“網路安全：允許本機系統使用 NTLM 的電腦身分”設定為“已啟用”"
    description: "此政策設定決定在還原至 NTLM 驗證時使用協商的本機系統服務是否可以使用電腦識別。至少 Windows 7 或 Windows Server 2008 R2 支援此原則。此設定的建議狀態為：已啟用。"
    rationale: "連接到執行早於 Windows Vista 或 Windows Server 2008（非 R2）的 Windows 版本的電腦時，作為本機系統執行並使用還原為 NTLM 的 SPNEGO（協商）的服務將使用電腦識別。在 Windows 7 中，如果您要連線到執行 Windows Server 2008 或 Windows Vista 的計算機，則系統服務將使用電腦識別或 NULL 工作階段。當與 NULL 會話連線時，系統會建立一個系統產生的會話金鑰，該金鑰不提供任何保護，但允許應用程式對資料進行簽署和加密而不會出現錯誤。當與電腦身分連接時，支援簽章和加密以提供資料保護。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Allow Local System to use computer identity for NTLM."
    compliance:
      - cis: ["2.3.11.1"]
      - cis_csc: ["14", "16"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-38341-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> UseMachineId -> 1'

  - id: 15041
    title: "確保“網路安全：允許 LocalSystem NULL 會話回退”設定為“停用”"
    description: "此政策設定決定與 LocalSystem 一起使用時是否允許 NTLM 回退到 NULL 會話。此設定的建議狀態是：停用。"
    rationale: "NULL 會話的安全性較低，因為根據定義它們未經身份驗證。"
    remediation: "要透過 GP 設定建議的配置, 將以下介面路徑設置為已停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Allow LocalSystem NULL session fallback."
    compliance:
      - cis: ["2.3.11.2"]
      - cis_csc: ["14"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37035-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> allownullsessionfallback -> 0'

  - id: 15042
    title: "確保“網路安全：允許對此電腦的 PKU2U 身份驗證請求使用線上身分”設定為“停用”"
    description: "此設定確定線上身份是否能夠對此電腦進行身份驗證。 Windows 7 和 Windows Server 2008 R2 中引入的基於公鑰加密的使用者到使用者 (PKU2U) 協定是作為安全性支援提供者 (SSP) 實現的。 SSP 支援點對點身份驗證，特別是透過名為「家庭群組」的 Windows 7 媒體和檔案共用功能，該功能允許非網域成員的電腦之間進行共用。在 PKU2U 中，協商身份驗證包引入了新的擴充 Spnego.dll。在先前版本的 Windows 中，Negotiate 決定要使用 Kerberos 還是 NTLM 進行驗證。 Negotiate 的擴充 SSP Negoexts.dll 被 Windows 視為驗證協定，支援包括 PKU2U 在內的 Microsoft SSP。當電腦設定為使用線上 ID 接受驗證請求時，Negoexts.dll 會呼叫用於登入的電腦上的 PKU2U SSP。 PKU2U SSP 取得本機憑證並在對等電腦之間交換原則。在對等電腦上進行驗證後，元資料中的憑證將傳送至登入對等方進行驗證，並將使用者的憑證與安全性權杖相關聯，然後登入程序完成。此設定的建議狀態是：停用。"
    rationale: "PKU2U 協定是一種點對點身份驗證協定 - 身份驗證應在大多數託管網路中集中管理。"
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為「已停用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network Security: Allow PKU2U authentication requests to this computer to use online identities."
    compliance:
      - cis: ["2.3.11.3"]
      - cis_csc: ["16.9"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-38047-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u -> AllowOnlineID -> 0'

  - id: 15043
    title: "確保“網路安全：配置 Kerberos 允許的加密類型”設定為“RC4_HMAC_MD5、AES128_HMAC_SHA1、AES256_HMAC_SHA1、未來加密類型”"
    description: "此策略設定可讓您設定允許 Kerberos 使用的加密類型。此設定的建議狀態為：AES128_HMAC_SHA1、AES256_HMAC_SHA1、未來加密類型。注意：某些舊版應用程式和作業系統可能需要 RC4_HMAC_MD5 - 我們建議您在您的環境中進行測試並驗證是否可以安全刪除它。出於評分目的，我們允許使用 RC4_HMAC_MD5 作為可選設定。"
    rationale: "每種加密演算法的強度各不相同，選擇更強的演算法將降低妥協的風險，但是當電腦嘗試使用不支援它們的系統進行身份驗證時，這樣做可能會導致問題。"
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 AES128_HMAC_SHA1、AES256_HMAC_SHA1、Future encryption types: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Configure encryption types allowed for Kerberos."
    compliance:
      - cis: ["2.3.11.4"]
      - cis_csc: ["16.14"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37755-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters -> SupportedEncryptionTypes -> r:r:2147483644|2147483640'

  - id: 15044
    title: "確保“網路安全：下次變更密碼時不儲存 LAN Manager 雜湊值”設定為“啟用”"
    description: "此原則設定決定更改密碼時是否儲存新密碼的 LAN Manager (LM) 雜湊值。與加密性更強的 Microsoft Windows NT 雜湊相比，LM 雜湊相對較弱且容易受到攻擊。由於 LM 雜湊值儲存在本機的安全資料庫中，因此如果資料庫受到攻擊，密碼很容易被洩露。注意：啟用此策略設定後，較舊的作業系統和某些第三方應用程式可能會失敗。另請注意，啟用此設定後，需要更改所有帳戶的密碼才能獲得適當的好處。此設定的建議狀態為：已啟用。"
    rationale: "SAM 檔案可能成為尋求存取使用者名稱和密碼雜湊值的攻擊者的目標。此類攻擊使用特殊工具來破解密碼，然後可以使用這些工具來冒充使用者並取得網路資源的存取權限。如果啟用此策略設置，將無法阻止這些類型的攻擊，但這些類型的攻擊將更難成功。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Do not store LAN Manager hash value on next password change."
    compliance:
      - cis: ["2.3.11.5"]
      - cis_csc: ["16.14"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36326-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> NoLMHash -> 1'

  - id: 15045
    title: "確保“網路安全：登入時間到期時強制登出”設定為“啟用”"
    description: "此政策設定決定是否在使用者帳戶的有效登入時間之外斷開連接到本機的使用者。此設定會影響伺服器訊息區塊 (SMB) 元件。如果啟用此策略設置，您也應該啟用 Microsoft 網路伺服器：登入時間到期時中斷用戶端連線（規則 2.3.9.4）。此設定的建議狀態為：已啟用。注意：此建議未評分，因為沒有與其對應的記錄註冊表值。我們仍然強烈建議將其配置為“已啟用”，以確保正確執行登入時間（配置後）。"
    rationale: "如果停用此設置，使用者可以在分配的登入時間之外保持與電腦的連接。"
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設置為啟用。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Force logoff when logon hours expire."
    compliance:
      - cis: ["2.3.11.6"]
      - cis_csc: ["16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36270-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff -> 1'

  - id: 15046
    title: "確保「網路安全：LAN Manager 驗證等級」設定為「僅傳送 NTLMv2 回應」。拒絕 LM 和 NTLM'"
    description: "LAN Manager (LM) 是早期 Microsoft 用戶端/伺服器軟體系列（早於 Windows NT），可讓使用者在單一網路上將個人電腦連結在一起。 LM 網路功能包括透明檔案和列印共享、使用者安全功能和網路管理工具。在 Active Directory 網域中，Kerberos 協定是預設驗證協定。但是，如果由於某種原因未協商 Kerberos 協定，Active Directory 將使用 LM、NTLM 或 NTLMv2。 LAN Manager 驗證包括LM、NTLM 和NTLM 版本2 (NTLMv2) 變體，並且是用於在所有Windows 用戶端執行以下操作時對其進行身份驗證的協定： - 加入網域- 在Active Directory 林之間進行驗證- 向下級網域 - 對不執行 Windows 2000、Windows Server 2003 或 Windows XP 的電腦進行驗證 - 對不在網域中的電腦進行驗證。網路安全：LAN Manager 驗證等級設定決定網路登入使用哪種質詢/回應身分驗證協定。此選擇會影響用戶端使用的身份驗證協定等級、協商的會話安全性等級以及伺服器接受的驗證等級。此設定的建議狀態是：僅傳送 NTLMv2 回應。拒絕 LM 和 NTLM。"
    rationale: "預設情況下，Windows 2000 和 Windows XP 用戶端會配置為傳送 LM 和 NTLM 驗證回應（基於 Windows 95 和基於 Windows 98 的用戶端僅傳送 LM）。 Windows Vista / Windows Server 2008（非 R2）之前的作業系統中的預設設定允許所有用戶端透過伺服器進行驗證並使用其資源。然而，這意味著 LM 回應（最弱的身份驗證回應形式）是透過網路發送的，攻擊者有可能嗅探該流量以更輕鬆地重現用戶的密碼。 Windows 95、Windows 98 和Windows NT 作業系統無法使用Kerberos 版本5 協定進行驗證。因此，在 Windows Server 2003 網域中，這些電腦預設使用 LM 和 NTLM 協定進行網路驗證。您可以使用 NTLMv2 對 Windows 95、Windows 98 和 Windows NT 實作更安全的驗證協定。對於登入過程，NTLMv2 使用安全通道來保護驗證過程。即使您對較舊的用戶端和伺服器使用 NTLMv2，但作為網域成員的基於 Windows 的用戶端和伺服器也將使用 Kerberos 驗證協定向 Windows Server 2003 或更高版本的網域控制站進行驗證。由於這些原因，強烈建議盡可能限制 LM 和 NTLM（非 v2）的使用。"
    remediation: "要透過 GP 設定建議的配置，請將以下 UI 路徑設定為：Send NTLMv2 response only. Refuse LM & NTLM: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: LAN Manager authentication level."
    compliance:
      - cis: ["2.3.11.7"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36173-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LmCompatibilityLevel -> 5'

  - id: 15047
    title: "確保「網路安全：LDAP 用戶端簽章要求」設定為「協商簽章」或更高版本"
    description: "此政策設定決定代表發出 LDAP BIND 請求的用戶端請求的資料簽章等級。注意：此策略設定對 LDAP 簡單綁定 (ldap_simple_bind) 或透過 SSL 的 LDAP 簡單綁定 (ldap_simple_bind_s) 沒有任何影響。 Windows XP Professional 隨附的 Microsoft LDAP 用戶端不使用 ldap_simple_bind 或 ldap_simple_bind_s 與網域控制站通訊。此設定的建議狀態為：協商簽名。將此設定配置為需要簽名也符合基準。"
    rationale: "未簽署的網路流量容易受到中間人攻擊，入侵者捕獲客戶端和伺服器之間的資料包，修改它們，然後將它們轉發到伺服器。對於 LDAP 伺服器，這種敏感度意味著攻擊者可能會導致伺服器根據 LDAP 查詢中的錯誤或變更的資料做出決策。為了降低網路中的這種風險，您可以實施強大的實體安全措施來保護網路基礎架構。此外，如果您需要透過 IPsec 驗證標頭對所有網路封包進行數位簽名，則可能會使所有類型的中間人攻擊變得極其困難。"
    remediation: "若要透過組合政策 (GP) 建立建議的配置，請將以下使用者介面路徑設定為協商簽署 (設定為需要簽署也符合標準)：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: LDAP client signing requirements."
    compliance:
      - cis: ["2.3.11.8"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36858-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP -> LDAPClientIntegrity -> n:^(\d+) compare >= 1'

  - id: 15048
    title: "確保“網路安全：基於 NTLM SSP（包括安全性 RPC）客戶端的最低會話安全性”設定為“需要 NTLMv2 會話安全性，需要 128 位元加密”"
    description: "此原則設定決定用戶端允許使用 NTLM 安全性支援提供者 (SSP) 的應用程式執行哪些行為。 SSP 介面 (SSPI) 由需要驗證服務的應用程式使用。該設定不會修改身份驗證序列的工作方式，而是要求使用 SSPI 的應用程式中的某些行為。此設定的建議狀態是：需要 NTLMv2 會話安全性、需要 128 位元加密。注意：這些值取決於網路安全性：LAN Manager 驗證等級（規則 2.3.11.7）安全性設定值。"
    rationale: "您可以為此政策設定啟用這兩個選項，以協助保護使用 NTLM 安全性支援提供者 (NTLM SSP) 的網路流量免遭取得相同網路存取權限的攻擊者暴露或竄改。換句話說，這些選項有助於防止中間人攻擊。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為要求 NTLMv2 會話安全性，要求 128 位元加密: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Minimum session security for NTLM SSP based (including secure RPC) clients."
    compliance:
      - cis: ["2.3.11.9"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37553-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinClientSec -> 537395200'

  - id: 15049
    title: "確保“網路安全：基於 NTLM SSP（包括安全性 RPC）伺服器的最低會話安全性”設定為“需要 NTLMv2 會話安全性，需要 128 位元加密”"
    description: "此原則設定決定伺服器允許使用 NTLM 安全性支援提供者 (SSP) 的應用程式執行哪些行為。 SSP 介面 (SSPI) 由需要驗證服務的應用程式使用。該設定不會修改身份驗證序列的工作方式，而是要求使用 SSPI 的應用程式中的某些行為。此設定的建議狀態是：需要 NTLMv2 會話安全性、需要 128 位元加密。注意：這些值取決於網路安全性：LAN Manager 驗證等級（規則 2.3.11.7）安全性設定值。"
    rationale: "您可以啟用此政策設定的所有選項，以協助保護使用 NTLM 安全性支援提供者 (NTLM SSP) 的網路流量免遭取得相同網路存取權限的攻擊者暴露或竄改。也就是說，這些選項有助於防止中間人攻擊。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為需求 NTLMv2 會話安全性，需求 128 位元加密: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Minimum session security for NTLM SSP based (including secure RPC) servers."
    compliance:
      - cis: ["2.3.11.10"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - https://workbench.cisecurity.org/benchmarks/288
      - "CCE-37835-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinServerSec -> 537395200'

  - id: 15050
    title: "確保“關機：允許系統無需登入即可關閉”設定為“停用”"
    description: "此策略設定確定當使用者未登入時是否可以關閉電腦。如果啟用此策略設置，則可以在 Windows 登入畫面上使用關機指令。建議停用此策略設置，以限制具有系統憑證的使用者關閉電腦的能力。此設定的建議狀態是：停用。注意：在 Server 2008 R2 及更早版本中，此設定對遠端桌面 (RDP)/終端服務工作階段沒有影響 - 它僅影響本機控制台。但是，Microsoft 更改了 Windows Server 2012（非 R2）及更高版本中的行為，如果設定為“啟用”，則還允許 RDP 會話關閉或重新啟動伺服器。"
    rationale: "可以本地存取控制台的使用者可以關閉電腦。攻擊者還可以走到本機控制台並重新啟動伺服器，這將導致臨時 DoS 情況。攻擊者還可以關閉伺服器並使其所有應用程式和服務不可用。如同上面的描述所述，在Windows Server 2012（非R2）及更高版本中，啟用此設定的拒絕服務(DoS) 風險會顯著增加，因為即使是遠端使用者也可以從Windows Server 2012 的登入畫面關閉或重新啟動伺服器。"
    remediation: "要透過 GP 建立推薦的配置，請將以下用戶界面路徑設置為禁用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Shutdown: Allow system to be shut down without having to log on."
    compliance:
      - cis: ["2.3.13.1"]
      - cis_csc: ["5.1"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36788-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ShutdownWithoutLogon -> 0'

  - id: 15051
    title: "確保“系統物件：要求非 Windows 子系統不區分大小寫”設定為“啟用”"
    description: "此策略設定決定是否對所有子系統強制執行不區分大小寫。 Microsoft Win32 子系統不區分大小寫。但是，核心支援其他子系統區分大小寫，例如 UNIX 的可移植作業系統介面 (POSIX)。由於 Windows 不區分大小寫（但 POSIX 子系統將支援區分大小寫），因此如果不強制執行此策略設置，則 POSIX 子系統的使用者可能會透過使用混合大小寫標記來建立與另一個檔案同名的檔案。這種情況可能會阻止使用典型 Win32 工具的另一使用者存取這些檔案，因為只有其中一個檔案可用。此設定的建議狀態為：已啟用。"
    rationale: "由於 Windows 不區分大小寫，但 POSIX 子系統支援區分大小寫，因此如果不啟用此策略設置，該子系統的使用者可能會建立與另一個檔案同名但大小寫不同的檔案。當使用者嘗試從普通 Win32 工具存取此類檔案時，這種情況可能會讓使用者感到困惑，因為只有其中一個檔案可用。"
    remediation: "要經由 GP 建立建議的配置，將以下的 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System objects: Require case insensitivity for non- Windows subsystems."
    compliance:
      - cis: ["2.3.15.1"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37885-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel -> ObCaseInsensitive -> 1'

  - id: 15052
    title: "確保“系統物件：加強內部系統物件（例如符號連結）的預設權限”設定為“啟用”"
    description: "此策略設定決定物件的預設自主存取控制清單 (DACL) 的強度。 Active Directory 維護共享系統資源的全域列表，例如 DOS 裝置名稱、互斥體和號誌。這樣，物件就可以在程序之間定位和共享。每種類型的物件都是使用預設 DACL 建立的，該 DACL 指定誰可以存取這些物件以及授予哪些權限。此設定的建議狀態為：已啟用。"
    rationale: "此設定確定物件的預設 DACL 的強度。 Windows 維護共享電腦資源的全域列表，以便可以在程序之間定位和共享物件。每種類型的物件都是使用預設 DACL 建立的，該 DACL 指定誰可以存取這些物件以及具有哪些權限。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)."
    compliance:
      - cis: ["2.3.15.2"]
      - cis_csc: ["14.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37644-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager -> ProtectionMode -> 1'

  - id: 15053
    title: "確保“使用者帳戶控制：內建管理員帳戶的管理員批准模式”設定為“啟用”"
    description: "此策略設定控制內建管理員帳戶的管理員批准模式的行為。此設定的建議狀態為：已啟用。"
    rationale: "Windows Vista 中引入的使用者帳戶控制功能試圖緩解的風險之一是惡意軟體在提升的憑證下執行，而使用者或管理員不知道其活動。這些程式的攻擊媒介是發現名為「管理員」的帳戶的密碼，因為該使用者帳戶是為所有 Windows 安裝建立的。為了解決此風險，在 Windows Vista 和更高版本中，現在預設為內建管理員帳戶停用。在新電腦的預設安裝中，最初透過以下兩種方式之一設定對電腦具有管理控制權的帳戶： - 如果電腦未加入網域，則您建立的第一個使用者帳戶具有與本機使用者相同的權限行政人員。 - 如果電腦加入網域，則不會建立本機管理員帳戶。如果需要本機管理員帳戶，則企業或網域管理員必須登入電腦並建立帳戶。安裝 Windows 後，可以手動啟用內建管理員帳戶，但我們強烈建議保持停用該帳戶。"
    remediation: "要透過 GP 設定推薦的配置，將以下 UI 路徑設定為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Admin Approval Mode for the Built-in Administrator account."
    compliance:
      - cis: ["2.3.17.1"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36494-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> FilterAdministratorToken -> 1'

  - id: 15054
    title: "確保“使用者帳戶控制：允許 UIAccess 應用程式在不使用安全桌面的情況下提示提升”設定為“停用”"
    description: "此政策設定控制使用者介面輔助功能（UIAccess 或 UIA）程式是否可以自動停用標準使用者使用的提升提示的安全桌面。此設定的建議狀態是：停用。"
    rationale: "Windows Vista 中引入的 UAC 功能試圖緩解的風險之一是惡意軟體在提升的憑證下運行，而使用者或管理員不知道其活動。此設定允許管理員在透過遠端協助連線時執行需要提升權限的操作。這提高了安全性，因為即使最終用戶支援是遠端提供的，組織也可以使用 UAC。但是，它還增加了風險，即管理員可能允許非特權使用者共用管理員在遠端桌面會話期間需要使用的應用程式的提升權限，從而降低了安全性。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設定為停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop."
    compliance:
      - cis: ["2.3.17.2"]
      - cis_csc: ["16"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36863-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableUIADesktopToggle -> 0'

  - id: 15055
    title: "確保“使用者帳戶控制：管理員批准模式下管理員提升提示的行為”設定為“在安全桌面上提示同意”"
    description: "此策略設定控制管理員提升提示的行為。此設定的建議狀態是：在安全桌面上提示同意。"
    rationale: "Windows Vista 中引入的 UAC 功能試圖緩解的風險之一是惡意軟體在提升的憑證下運行，而使用者或管理員不知道其活動。此設定提高了管理員對提升權限操作的認識，並允許管理員在惡意程式嘗試提升其權限時阻止該程式提升其權限。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為在安全桌面上提示同意: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode."
    compliance:
      - cis: ["2.3.17.3"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37029-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorAdmin -> 2'

  - id: 15056
    title: "確保“用戶帳戶控制：標準用戶的提升提示行為”設定為“自動拒絕提升請求”"
    description: "此策略設定控制標準使用者的提升提示的行為。此設定的建議狀態為：自動拒絕提升請求。"
    rationale: "Windows Vista 中引入的使用者帳戶控制功能試圖緩解的風險之一是惡意程式在提升的憑證下執行，而使用者或管理員不知道其活動。此設定讓使用者意識到程式需要使用提升的權限操作，並要求使用者能夠提供管理憑證才能執行該程式。"
    remediation: "要通過 GP 設置建議配置，將以下 UI 路徑設置為自動拒絕提升請求：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Behavior of the elevation prompt for standard users."
    compliance:
      - cis: ["2.3.17.4"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36864-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorUser -> 0'

  - id: 15057
    title: "確保“使用者帳戶控制：檢測應用程式安裝並提示提升”設定為“啟用”"
    description: "此策略設定控制電腦的應用程式安裝偵測的行為。此設定的建議狀態為：已啟用。"
    rationale: "某些惡意軟體在獲得運行權限後會嘗試自行安裝。例如，具有可信任應用程式外殼的惡意軟體。使用者可能已授予程式運行權限，因為該程式是受信任的，但如果隨後提示他們安裝未知組件，則這提供了另一種在軟體造成損害之前捕獲該軟體的方法。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Detect application installations and prompt for elevation."
    compliance:
      - cis: ["2.3.17.5"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36533-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableInstallerDetection -> 1'

  - id: 15058
    title: "確保“使用者帳戶控制：僅提升安裝在安全位置的 UIAccess 應用程式”設定為“啟用”"
    description: "此原則設定控制請求以使用者介面可存取性 (UIAccess) 完整性等級執行的應用程式是否必須駐留在檔案系統中的安全位置。安全位置僅限於以下位置：...\\Program Files\\，包括子資料夾； ...\\Windows\\system32\\; ...\\Program Files (x86)\\，包括子資料夾（適用於 64 位元版本的 Windows）。注意：Windows 會對請求以 UIAccess 完整性等級執行的任何互動式應用程式強制執行公鑰基礎架構 (PKI) 簽章檢查，無論此安全性設定的狀態為何。此設定的建議狀態為：已啟用。"
    rationale: "當應用程式的權限從標準使用者提升到管理員時，UIAccess Integrity 允許應用程式繞過使用者介面權限隔離 (UIPI) 限制。這是支援可存取性功能所必需的，例如將使用者介面傳輸為替代形式的螢幕閱讀器。使用 UIAccess 權限啟動的程序具有以下功能： - 設定前景視窗。 -使用SendInput函數驅動任何應用程式視窗。 - 使用低階掛鉤、原始輸入、GetKeyState、GetAsyncKeyState 和 GetKeyboardInput 對所有完整性等級使用讀取輸入。 - 設定日記鉤。 -To 使用 AttachThreadInput 將執行緒附加到更高完整性的輸入佇列。"
    remediation: "若要透過 GP 設定推薦的配置，請將以下的 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Only elevate UIAccess applications that are installed in secure locations."
    compliance:
      - cis: ["2.3.17.6"]
      - cis_csc: ["5.1"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37057-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableSecureUIAPaths -> 1'

  - id: 15059
    title: "確保“使用者帳戶控制：在管理員批准模式下運行所有管理員”設定為“已啟用”"
    description: "此政策設定控制電腦的所有使用者帳戶控制 (UAC) 政策設定的行為。如果變更此策略設置，則必須重新啟動電腦。此設定的建議狀態為：已啟用。注意：如果停用此原則設置，安全中心會通知您作業系統的整體安全性已降低。"
    rationale: "這是開啟或關閉 UAC 的設定。如果停用此設置，將不會使用 UAC，且系統上不會出現任何依賴 UAC 的安全優勢和風險緩解措施。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Run all administrators in Admin Approval Mode."
    compliance:
      - cis: ["2.3.17.7"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36869-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableLUA -> 1'

  - id: 15060
    title: "確保“使用者帳戶控制：提示提升時切換到安全桌面”設定為“已啟用”"
    description: "此策略設定控制是否在互動式使用者的桌面或安全桌面上顯示提升請求提示。此設定的建議狀態為：已啟用。"
    rationale: "標準提升提示對話方塊可能會被欺騙，這可能會導致用戶向惡意軟體洩露其密碼。安全桌面在提示提升時呈現出非常明顯的外觀，使用者桌面變暗，提升提示 UI 更加突出。這增加了習慣安全桌面的使用者識別欺騙性提升提示對話方塊而不會上當的可能性。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Switch to the secure desktop when prompting for elevation."
    compliance:
      - cis: ["2.3.17.8"]
      - cis_csc: ["5.1"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36866-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> PromptOnSecureDesktop -> 1'

  - id: 15061
    title: "確保“用戶帳戶控制：將檔案和註冊表寫入失敗虛擬化到每個用戶位置”設定為“啟用”"
    description: "此策略設定控制應用程式寫入失敗是否會重新導向到定義的註冊表和檔案系統位置。此策略設定可以緩解以管理員身分執行的應用程式並將執行時間應用程式資料寫入至： - %ProgramFiles% - %Windir% - %Windir%\\system32 - HKEY_LOCAL_MACHINE\\Software。此設定的建議狀態為：已啟用。"
    rationale: "此設定透過確保舊應用程式僅將資料寫入允許的位置來減少漏洞。"
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Virtualize file and registry write failures to per-user locations."
    compliance:
      - cis: ["2.3.17.9"]
      - pci_dss: ["6.5.8"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37064-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableVirtualization -> 1'

  ###############################################
  # 9 Windows Firewall with Advanced Security
  ###############################################
  ###############################################
  # 9.1 Domain Profile
  ###############################################
  # 9.1.1 Ensure 'Windows Firewall: Domain: Firewall state' is set to 'On'
  - id: 15062
    title: "確保“Windows 防火牆：網域：防火牆狀態”設定為“開啟（建議）”"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設定為開啟 (建議)：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Firewall state."
    compliance:
      - cis: ["9.1.1"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36062-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> EnableFirewall -> 1'

  # 9.1.2 Ensure 'Windows Firewall: Domain: Inbound connections' is set to 'Block (default)'
  - id: 15063
    title: "確保“Windows 防火牆：網域：入站連線”設定為“封鎖（預設）”"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "要通過GP設定推薦的配置，請將以下UI路徑設置為阻止（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Inbound connections."
    compliance:
      - cis: ["9.1.2"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38117-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultInboundAction -> 1'

  # 9.1.3 Ensure 'Windows Firewall: Domain: Outbound connections' is set to 'Allow (default)'
  - id: 15064
    title: "確保“Windows 防火牆：網域：出站連線”設定為“允許（預設）”"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    remediation: "為了通過 GP 建立推薦的配置，請將以下 UI 路徑設定為允許（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Outbound connections."
    compliance:
      - cis: ["9.1.3"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36146-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultOutboundAction -> 0'

  # 9.1.4 Ensure 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No'
  - id: 15065
    title: "確保“Windows 防火牆：網域：設定：顯示通知”設定為“否”"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態為：否。的訊息。"
    rationale: "防火牆通知可能很複雜，可能會讓最終用戶感到困惑，導致他們無法解決警報。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設為否: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Settings Customize\\Display a notification."
    compliance:
      - cis: ["9.1.4"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-38041-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DisableNotifications -> 1'

  # 9.1.5 Ensure 'Windows Firewall: Domain: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log'

  - id: 15066
    title: "確保“Windows 防火牆：網域：日誌記錄：名稱”設定為“%SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log”"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 %SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Name"
    compliance:
      - cis: ["9.1.5"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37482-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\domainfw.log'

  # 9.1.6 Ensure 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16384 KB or greater'

  - id: 15067
    title: "確保“Windows 防火牆：網域：日誌記錄：大小限制 (KB)”設定為“16384 KB 或更大”"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為16,384 KB或更大：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Size limit (KB)."
    compliance:
      - cis: ["9.1.6"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-36088-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  # 9.1.7 Ensure 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes'
  - id: 15068
    title: "確保“Windows 防火牆：網域：日誌記錄：記錄丟棄的資料包”設定為“是”"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為是: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Log dropped packets."
    compliance:
      - cis: ["9.1.7"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37523-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogDroppedPackets -> 1'

  # 9.1.8 Ensure 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes'
  - id: 15069
    title: "確保“Windows 防火牆：網域：日誌記錄：記錄成功的連線”設定為“是”"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "為了通過 GP 建立推薦配置, 將以下 UI 路徑設置為 Yes: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Log successful connections."
    compliance:
      - cis: ["9.1.8"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-36393-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogSuccessfulConnections -> 1'

  ###############################################
  # 9.2 Private Profile
  ###############################################

  # 9.2.1 Ensure 'Windows Firewall: Private: Firewall state' is set to 'On'
  - id: 15070
    title: "確保“Windows 防火牆：專用：防火牆狀態”設定為“開啟（建議）”"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設定為開啟 (建議)：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Firewall state."
    compliance:
      - cis: ["9.2.1"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38239-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> EnableFirewall -> 1'

  # 9.2.2 Ensure 'Windows Firewall: Private: Inbound connections' is set to 'Block (default)'
  - id: 15071
    title: "確保“Windows 防火牆：專用：入站連線”設定為“封鎖（預設）”"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為阻止 (預設值): Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Inbound connections."
    compliance:
      - cis: ["9.2.2"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38042-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultInboundAction -> 1'

  # 9.2.3 Ensure 'Windows Firewall: Private: Outbound connections' is set to 'Allow (default)'
  - id: 15072
    title: "確保“Windows 防火牆：專用：出站連線”設定為“允許（預設）”"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。注意：如果將出站連線設定為“封鎖”，然後使用GPO 部署防火牆策略，則接收GPO 設定的電腦將無法接收後續的群組原則更新，除非您建立並部署使群組原則能夠正常工作的出站規則。核心網路的預先定義規則包括使群組策略發揮作用的出站規則。確保這些出站規則處於活動狀態，並在部署之前徹底測試防火牆設定檔。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為允許（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Outbound connections."
    compliance:
      - cis: ["9.2.3"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38332-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultOutboundAction -> 0'

  # 9.2.4 Ensure 'Windows Firewall: Private: Outbound connections' is set to 'Allow (default)'
  - id: 15073
    title: "確保“Windows 防火牆：專用：設定：顯示通知”設定為“否”"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態為：否。的訊息。"
    rationale: "防火牆通知可能很複雜，可能會讓最終用戶感到困惑，導致他們無法解決警報。"
    remediation: "要通過GP設置推薦的配置，將以下UI路徑設置為否: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Settings Customize\\Display a notification."
    compliance:
      - cis: ["9.2.4"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37621-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DisableNotifications -> 1'

  # 9.2.5 Ensure 'Windows Firewall: Private: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\privatefw.log'
  - id: 15074
    title: "確保“Windows 防火牆：專用：日誌記錄：名稱”設定為“%SYSTEMROOT%\\System32\\logfiles\\firewall\\privatefw.log”"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SYSTEMROOT%\\System32\\logfiles\\firewall\\privatefw.log。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為%SYSTEMROOT%\\System32\\logfiles\\firewall\\privatefw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Name"
    compliance:
      - cis: ["9.2.5"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37569-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\privatefw.log'

  # 9.2.6 Ensure 'Windows Firewall: Private: Logging: Size limit (KB)' is set to '16384 KB or greater'
  - id: 15075
    title: "確保“Windows 防火牆：專用：日誌記錄：大小限制 (KB)”設定為“16384 KB 或更大”"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為 16,384 KB 或更大：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Size limit (KB)。"
    compliance:
      - cis: ["9.2.6"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-38178-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  # 9.2.7 Ensure 'Windows Firewall: Private: Logging: Log dropped packets' is set to 'Yes'
  - id: 15076
    title: "確保“Windows 防火牆：專用：日誌記錄：記錄丟棄的封包”設定為“是”"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設定為Yes：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Log dropped packets."
    compliance:
      - cis: ["9.2.7"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-35972-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogDroppedPackets -> 1'

  # 9.2.8 Ensure 'Windows Firewall: Private: Logging: Log successful connections' is set to 'Yes'
  - id: 15077
    title: "確保“Windows 防火牆：專用：日誌記錄：記錄成功的連線”設定為“是”"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過GP設定建議的配置，將以下介面路徑設定為Yes: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Log successful connections."
    compliance:
      - cis: ["9.2.8"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37387-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogSuccessfulConnections -> 1'

  ###############################################
  # 9.3 Public Profile
  ###############################################

  # 9.3.1 Ensure 'Windows Firewall: Public: Firewall state' is set to 'On'
  - id: 15078
    title: "確保“Windows 防火牆：公有：防火牆狀態”設定為“開啟（建議）”"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為“開啟（推薦）”：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Firewall state."
    compliance:
      - cis: ["9.3.1"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37862-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> EnableFirewall -> 1'

  # 9.3.2 Ensure 'Windows Firewall: Public: Inbound connections' is set to 'Block (default)'
  - id: 15079
    title: "確保“Windows 防火牆：公用：入站連線”設定為“封鎖（預設）”"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為封鎖（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Inbound connections."
    compliance:
      - cis: ["9.3.2"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36057-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultInboundAction -> 1'

  # 9.3.3 Ensure 'Windows Firewall: Public: Outbound connections' is set to 'Allow (default)'
  - id: 15080
    title: "確保“Windows 防火牆：公共：出站連線”設定為“允許（預設）”"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。注意：如果將出站連線設定為“封鎖”，然後使用GPO 部署防火牆策略，則接收GPO 設定的電腦將無法接收後續的群組原則更新，除非您建立並部署使群組原則能夠正常工作的出站規則。核心網路的預先定義規則包括使群組策略發揮作用的出站規則。確保這些出站規則處於活動狀態，並在部署之前徹底測試防火牆設定檔。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    remediation: "要透過群組原則建立推薦的配置，請將以下使用者介面路徑設置為允許（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Outbound connections."
    compliance:
      - cis: ["9.3.3"]
      - cis_csc: ["9.2"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37434-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultOutboundAction -> 0'

  # 9.3.4 Ensure 'Windows Firewall: Public: Settings: Display a notification' is set to 'No'
  - id: 15081
    title: "確保“Windows 防火牆：公共：設定：顯示通知”設定為“否”"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態是：否。"
    rationale: "當防火牆規則阻止某些類型的網路活動時，某些組織可能更願意避免警告使用者。但是，在排除涉及防火牆的網路問題時，通知會很有幫助。"
    remediation: "要透過 GP 建立建議的組態，將以下 UI 路徑設定為「否」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Display a notification."
    compliance:
      - cis: ["9.3.4"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-38043-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DisableNotifications -> 1'

  # 9.3.5 Ensure 'Windows Firewall: Public: Apply local firewall rules' is set to 'No'
  - id: 15082
    title: "確保“Windows 防火牆：公用：設定：套用本機防火牆規則”設定為“否”"
    description: "此設定控制是否允許本機管理員建立與群組原則配置的防火牆規則一起套用的本機防火牆規則。此設定的建議狀態為：否。的訊息。"
    rationale: "i當處於公共設定檔中時，每台電腦不應有特殊的本機防火牆例外。這些設定應由集中策略管理。"
    remediation: "若要透過GP設置建議的配置，請將以下UI路徑設置為否: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Apply local firewall rules."
    compliance:
      - cis: ["9.3.5"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37861-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalPolicyMerge -> 0'

  # 9.3.6 Ensure 'Windows Firewall: Public: Apply local connection security rules' is set to 'No'
  - id: 15083
    title: "確保“Windows 防火牆：公用：設定：套用本機連線安全規則”設定為“否”"
    description: "此設定控制是否允許本機管理員建立與群組原則配置的連線安全規則一起套用的連線安全規則。此設定的建議狀態是：否。"
    rationale: "具有管理權限的使用者可能會建立防火牆規則，使系統遭受遠端攻擊。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為否：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Apply local connection security rules."
    compliance:
      - cis: ["9.3.6"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36268-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0'

  # 9.3.7 Ensure 'Windows Firewall: Private: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\publicfw.log'
  - id: 15084
    title: "確保“Windows 防火牆：公共：日誌記錄：名稱”設定為“%SYSTEMROOT%\\System32\\logfiles\\firewall\\publicfw.log”"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SYSTEMROOT%\\System32\\logfiles\\firewall\\publicfw.log。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設定為%SYSTEMROOT%\\System32\\logfiles\\firewall\\publicfw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Name"
    compliance:
      - cis: ["9.3.7"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37266-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\publicfw.log'

  # 9.3.8 Ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16384 KB or greater''
  - id: 15085
    title: "確保“Windows 防火牆：公共：日誌記錄：大小限制 (KB)”設定為“16384 KB 或更大”"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過 GP 設定推薦的配置，將以下 UI 路徑設置為 16,384 KB 或更大：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Size limit (KB)。"
    compliance:
      - cis: ["9.3.8"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-36395-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  # 9.3.9 Ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes''
  - id: 15086
    title: "確保“Windows 防火牆：公共：日誌記錄：記錄丟棄的封包”設定為“是”"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過GP建立推薦的配置，將以下UI路徑設置為 Yes : Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Log dropped packets."
    compliance:
      - cis: ["9.3.9"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37265-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogDroppedPackets -> 1'

  # 9.3.10 Ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes''
  - id: 15087
    title: "確保“Windows 防火牆：公用：日誌記錄：記錄成功的連線”設定為“是”"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為是：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Log successful connections."
    compliance:
      - cis: ["9.3.10"]
      - cis_csc: ["6.2"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-36394-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogSuccessfulConnections -> 1'

  # Section 18.1 - Control Panel
  - id: 15088
    title: "確保“防止啟用鎖定螢幕攝影機”設定為“已啟用”"
    description: "停用「電腦設定」中的鎖定畫面攝影機切換開關，並防止在鎖定畫面上呼叫攝影機。此設定的建議狀態為：已啟用。"
    rationale: "停用鎖定螢幕攝影機可將鎖定螢幕提供的保護擴充到攝影機功能。"
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設置為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Personalization\\Prevent enabling lock screen camera。注意：此群組原則路徑預設情況下可能不存在。此路徑由群組原則範本 ControlPanelDisplay.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 和 Server 2012 R2 行政模板（或更新版本）中。"
    compliance:
      - cis: ["18.1.1.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38347-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenCamera -> 1'

  - id: 15089
    title: "確保“防止啟用鎖定螢幕幻燈片放映”設定為“已啟用”"
    description: "停用「電腦設定」中的鎖定螢幕投影片設定並阻止在鎖定畫面上播放投影片。此設定的建議狀態為：已啟用。"
    rationale: "停用鎖定螢幕投影片放映可將鎖定畫面提供的保護擴及投影片放映內容。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Personalization\\Prevent enabling lock screen slide show. 注意: 此群組策略路徑預設可能不存在。它由群組策略範本 ControlPanelDisplay.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 和 Server 2012 R2 行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.1.1.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38348-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenSlideshow -> 1'

  # Section 18.2 - LAPS

  - id: 15090
    title: "確保 LAPS AdmPwd GPO 擴充功能/CSE 已安裝"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "為了使用LAPS，需要進行小規模的Active Directory Schema更新，並且必須在每個受管理的電腦上安裝Group Policy Client Side Extension (CSE)。當LAPS安裝時，檔案AdmPwd.dll必須存在於以下位置並註冊在Windows中（LAPS AdmPwd GPO Extension/CSE安裝程序會為你完成這項工作）：C:\\Program Files\\LAPS\\CSE\\AdmPwd.dll"
    compliance:
      - cis: ["18.2.1"]
      - cis_csc: ["16.9"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'

  - id: 15091
    title: "確保“不允許密碼過期時間長於政策要求的時間”設定為“已啟用”"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：已啟用。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設為啟用: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Do not allow password expiration time longer than required by policy 注意: 這個組策略路徑預設情況下不存在。需要額外的組策略模板 (AdmPwd.admx/adml) - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.2.2"]
      - cis_csc: ["16.2"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PwdExpirationProtectionEnabled -> 1'

  - id: 15092
    title: "確保“啟用本機管理員密碼管理”設定為“已啟用”"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：已啟用。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Enable Local Admin Password Management 注意: 此群組原則路徑預設情況下並不存在。需要額外的群組原則模板 (AdmPwd.admx/adml) - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.2.3"]
      - cis_csc: ["16.9"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> AdmPwdEnabled -> 1'

  - id: 15093
    title: "確保“密碼設定：密碼複雜性”設定為“啟用：大字母 + 小字母 + 數字 + 特殊字元”"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：啟用：大字母+小字母+數字+特殊字元。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為啟用，並將密碼複雜性選項配置為大寫字母 + 小寫字母 + 數字 + 特殊字元：Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings 注意：此群組原則路徑預設不存在。需要額外的群組原則模板 (AdmPwd.admx/adml) - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.2.4"]
      - cis_csc: ["5.7"]
      - pci_dss: ["8.2.3"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordComplexity -> 4'

  - id: 15094
    title: "確保“密碼設定：密碼長度”設定為“啟用：15 或更多”"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為： 啟用：15 或更多。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "要透過 GP 設定推薦的配置，將以下 UI 路徑設置為 Enabled，並將 Password Length 選項配置為 15 或更多: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings 注意: 此群組原則路徑預設並不存在。需要額外的群組原則範本 (AdmPwd.admx/adml) - 它包含在微軟本機管理員密碼解決方案 (LAPS) 中。"
    compliance:
      - cis: ["18.2.5"]
      - cis_csc: ["5.7"]
      - pci_dss: ["8.2.3"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordLength -> n:^(\d+) compare >= 15'

  - id: 15095
    title: "確保“密碼設定：密碼期限（天）”設定為“啟用：30 或更少”"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為： 啟用：30 或更少。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設定為啟用，並將密碼有效期（天）選項配置為30或更少：Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings 注意：此群組策略路徑預設情況下不存在。需要額外的群組策略模板（AdmPwd.admx/adml）- 其包含在Microsoft Local Administrator Password Solution（LAPS）中。"
    compliance:
      - cis: ["18.2.6"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordAgeDays -> n:^(\d+) compare <= 30'

  # Section 18.3 - MS Security Guide
  - id: 15096
    title: "確保“在網路登入時對本機帳戶套用 UAC 限制”設定為“已啟用”"
    description: "此設定控製本機帳戶是否可用於透過網路登入進行遠端管理（例如，NET USE、連線至 C$ 等）。當在多個系統上配置相同的帳戶和密碼時，本機帳戶面臨憑證被盜的高風險。啟用此策略可顯著降低該風險。啟用：將 UAC 令牌過濾套用至網路登入的本機帳戶。停用管理員等強大群組中的成員資格，並從產生的存取權杖中刪除強大的權限。這會將 LocalAccountTokenFilterPolicy 註冊表值配置為 0。停用：透過將LocalAccountTokenFilterPolicy 註冊表值配置為1，允許本機帳戶在透過網路登入進行身份驗證時擁有完全管理權限。和其他攻擊」憑證竊取技術的檔案。有關 LocalAccountTokenFilterPolicy 的詳細資訊，請參閱 Microsoft 知識庫文章 951016：Windows Vista 中使用者帳戶控制和遠端限制的說明。此設定的建議狀態為：已啟用。"
    rationale: "當在多個系統上配置相同的帳戶和密碼時，本機帳戶面臨憑證被盜的高風險。確保啟用此策略可以顯著降低該風險。"
    remediation: "要透過群組原則設定建議配置，將以下UI路徑設為已啟用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Apply UAC restrictions to local accounts on network logons 注意: 此群組原則路徑預設不存在。需要額外的群組原則範本(SecGuide.admx/adml) - 可以從Microsoft取得。"
    compliance:
      - cis: ["18.3.1"]
      - cis_csc: ["5.8"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - https://www.microsoft.com/en-us/download/details.aspx?id=36036
      - https://support.microsoft.com/en-us/help/951016/description-of-user-account-control-and-remote-restrictions-in-windows
      - https://blogs.technet.microsoft.com/secguide/2017/08/30/security-baseline-for-windows-10-creators-update-v1703-final/
      - "CCE-37069-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> LocalAccountTokenFilterPolicy -> 0'

  - id: 15097
    title: "確保“配置 SMB v1 用戶端驅動程式”設定為“啟用：停用驅動程式”"
    description: "此設定配置伺服器訊息區塊版本 1 (SMBv1) 用戶端驅動程式服務 ( MRxSmb10 ) 的啟動類型，建議停用該啟動類型。此設定的建議狀態為： 啟用：停用驅動程式。注意：在任何情況下，都不要將此整體設定配置為“已停用”，因為這樣做會完全刪除基礎註冊表項，從而導致嚴重問題。"
    rationale: "自 2016 年 9 月以來，Microsoft 強烈鼓勵禁用 SMBv1，並不再在現代網路中使用，因為它是一個已有 30 年歷史的設計，比 SMBv2 和 SMBv3 等較新的設計更容易受到攻擊。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設置為啟用：Disable driver : Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 client driver。注意：此組策略路徑預設情況下不存在。需要一個額外的組策略模板（SecGuide.admx/adml）- 可從微軟獲取。"
    compliance:
      - cis: ["18.3.2"]
      - cis_csc: ["9.1"]
    references:
      - https://www.microsoft.com/en-us/download/details.aspx?id=36036
      - https://blogs.technet.microsoft.com/filecab/2017/06/01/smb1-product-clearinghouse/
      - https://blogs.technet.microsoft.com/secguide/2017/08/30/security-baseline-for-windows-10-creators-update-v1703-final/
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10 -> Start -> 4'

  - id: 15098
    title: "確保“配置 SMB v1 伺服器”設定為“停用”"
    description: "此設定配置伺服器訊息區塊版本 1 (SMBv1) 協定的伺服器端處理。此設定的建議狀態為：Disabled。"
    rationale: "自 2016 年 9 月以來，Microsoft 強烈鼓勵禁用 SMBv1，並不再在現代網路中使用，因為它是一個已有 30 年歷史的設計，比 SMBv2 和 SMBv3 等較新的設計更容易受到攻擊。"
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設定為停用：Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 server 注意：此群組原則路徑預設不存在。需要額外的群組原則範本 ( SecGuide.admx/adml )"
    compliance:
      - cis: ["18.3.3"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "https://techcommunity.microsoft.com/t5/storage-at-microsoft/stop-using-smb1/ba-p/425858"
      - "https://docs.microsoft.com/en-us/archive/blogs/staysafe/disable-smb-v1-in-managed-environments-with-ad-group-policy"
      - "https://docs.microsoft.com/en-us/archive/blogs/secguide/disabling-smbv1-through-group-policy"
      - "https://docs.microsoft.com/en-us/archive/blogs/secguide/security-baseline-for-windows-10-creators-update-v1703-final"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters -> SMB1 -> 0'

  - id: 15099
    title: "確保“啟用結構化異常處理覆蓋保護 (SEHOP)”設定為“已啟用”"
    description: "Windows 包括對結構化異常處理覆蓋保護 (SEHOP) 的支援。我們建議啟用此功能以提高電腦的安全性設定檔。此設定的建議狀態為： Enabled 。"
    rationale: "此功能旨在阻止使用結構化異常處理程序 (SEH) 覆蓋技術的漏洞利用。這種保護機制是在運作時提供的。因此，它有助於保護應用程序，無論它們是否使用最新的改進（例如 /SAFESEH 選項）進行編譯。"
    remediation: "若要通過 GP 設定推薦的配置，將以下 UI 路徑設置為“啟用” : Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Enable Structured Exception Handling Overwrite Protection (SEHOP) 注意: 此群組原則路徑預設不存在。需要額外的群組原則模板 ( SecGuide.admx/adml )"
    compliance:
      - cis: ["18.3.4"]
      - cis_csc: ["8.4"]
      - pci_dss: ["6.2"]
      - nist_800_53: ["SI.2", "SA.11", "SI.4"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["A1.2", "CC6.8"]
    references:
      - "https://blogs.technet.microsoft.com/secguide/2017/08/30/security-baseline-for-windows-10-creators-update-v1703-final/"
      - "https://support.microsoft.com/en-us/help/956607/how-to-enable-structured-exception-handling-overwrite-protection-sehop"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel -> DisableExceptionChainValidation -> 0'

  - id: 15100
    title: "確保“WDigest 身份驗證”設定為“停用”"
    description: "啟用 WDigest 驗證後，Lsass.exe 會在記憶體中保留使用者明文密碼的副本，從而有被盜的風險。如果未配置此設置，則 Windows 8.1 和 Windows Server 2012 R2 中將停用 WDigest 驗證；在早期版本的 Windows 和 Windows Server 中預設啟用它。此設定的建議狀態是：停用。"
    rationale: "防止憑證以明文形式儲存在記憶體中可以減少憑證被盜的機會。"
    remediation: "要通過GP建立推薦的配置，設置以下UI路徑為禁用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\WDigest Authentication (disabling may require KB2871997) 注意: 預設情況下，這個組策略路徑是不存在的。需要額外的組策略模板（SecGuide.admx/adml） - 它可以從微軟獲得。"
    compliance:
      - cis: ["18.3.5"]
      - cis_csc: ["16.14"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - https://www.microsoft.com/en-us/download/details.aspx?id=36036
      - https://support.microsoft.com/en-us/help/2871997/microsoft-security-advisory-update-to-improve-credentials-protection-a
      - https://blogs.technet.microsoft.com/secguide/2017/08/30/security-baseline-for-windows-10-creators-update-v1703-final/
      - "CCE-38444-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -> UseLogonCredential -> 0'

  # Section 18.4 - MSS (Legacy)
  - id: 15101
    title: "確保“MSS：（AutoAdminLogon）啟用自動登入（不建議）”設定為“停用”"
    description: "此設定獨立於 Windows XP 和 Windows Vista 中的歡迎畫面功能；如果停用該功能，則不會停用此設定。如果將電腦設定為自動登入，則任何能夠實際存取該電腦的人也可以存取該電腦上的所有內容，包括該電腦所連接的任何一個或多個網路。此外，如果啟用自動登入，密碼將以明文形式儲存在註冊表中，並且儲存此值的特定註冊表項可由經過驗證的使用者群組遠端讀取。此設定的建議狀態是：停用。"
    rationale: "如果將電腦設定為自動登入，則任何能夠實際存取該電腦的人也可以存取該電腦上的所有內容，包括該電腦連接到的一個或多個網路。此外，如果啟用自動登入，密碼將以明文儲存在註冊表中。儲存此設定的特定註冊表項可由經過驗證的使用者群組遠端讀取。因此，只有當電腦受到實體保護並且確保不受信任的使用者無法遠端查看註冊表時，此條目才適用。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended) 注意: 這個群組原則路徑預設情況下不存在，需要額外的群組原則模板 (MSS-legacy.admx/adml) - 可以從這篇 TechNet 部落格文章取得: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.1"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - https://support.microsoft.com/en-us/help/324737/how-to-turn-on-automatic-logon-in-windows
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-37067-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> AutoAdminLogon -> 0'

  - id: 15102
    title: "確保“MSS：（DisableIPSourceRouting IPv6）IP來源路由保護等級（防止資料包欺騙）”設定為“啟用：最高保護，來源路由完全停用”"
    description: "IP 來源路由是一種允許發送方確定資料封包在網路中應遵循的 IP 路由的機制。此設定的建議狀態為： 啟用：最高保護，來源路由完全停用。"
    rationale: "攻擊者可以使用來源路由資料包來掩蓋其身分和位置。來源路由允許發送資料包的電腦指定資料包所採用的路由。"
    remediation: "要透過GP建立建議的設定，請將以下UI路徑設定為Enabled: Highest protection, source routing is completely disabled: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing) 注意：此群組原則路徑預設不存在。需要額外的群組原則模板 (MSS-legacy.admx/adml) - 可從這篇TechNet博客文章取得：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.2"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.6"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-36871-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -> DisableIPSourceRouting -> 2'

  - id: 15103
    title: "確保“MSS：(DisableIPSourceRouting) IP 來源路由保護等級（防止資料包欺騙）”設定為“啟用：最高保護，來源路由完全停用”"
    description: "IP 來源路由是一種允許發送方確定資料封包通過網路應採用的 IP 路由的機制。對於企業環境，建議將此設定配置為“未定義”；對於高安全性環境，建議將此設定配置為“最高保護”，以完全停用來源路由。此設定的建議狀態為： 啟用：最高保護，來源路由完全停用。"
    rationale: "攻擊者可以使用來源路由資料包來掩蓋其身分和位置。來源路由允許發送資料包的電腦指定資料包所採用的路由。"
    remediation: "要透過 GP 建立推薦的設定，將以下 UI 路徑設成已啟用：最高保護，完全禁用來源路由：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing) 注意：此群組原則路徑預設情況下不存在。需要額外的群組原則範本 (MSS-legacy.admx/adml) - 可從這篇 TechNet 部落格文章獲取：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.3"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.6"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-36535-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> DisableIPSourceRouting -> 2'

  - id: 15104
    title: "確保“MSS：（啟用ICMPRedirect）允許 ICMP 重新導向覆蓋 OSPF 產生的路由”設定為“停用”"
    description: "Internet 控制訊息協定 (ICMP) 重新導向會導致 IPv4 堆疊偵測主機路由。這些路由會覆寫開放最短路徑優先 (OSPF) 產生的路由。此設定的建議狀態是：停用。"
    rationale: "此行為是預期的。問題在於，ICMP 重新導向偵測路由的 10 分鐘逾時期限會暫時造成一種網路狀況，即流量將不再正確路由到受影響的主機。忽略此類 ICMP 重新導向將限制系統遭受攻擊的機會，從而影響其參與網路的能力。"
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes 注意: 此群組原則路徑預設情況下不存在。需要額外的群組原則模板 (MSS-legacy.admx/adml)，可以從這篇TechNet部落格文章獲得: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.4"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - nist_800_53: ["SC.5"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-37988-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> EnableICMPRedirect -> 0'

  # Section 18.4 - MSS (Legacy)
  - id: 15105
    title: "確保“MSS：（KeepAliveTime）以毫秒為單位發送保持活動資料包的頻率”設定為“啟用：300,000 或 5 分鐘”"
    description: "該值控制 TCP 嘗試透過發送保持活動資料包來驗證空閒連線是否仍然完好的頻率。如果遠端電腦仍然可以存取，它就會確認保持活動資料包。此設定的建議狀態為： 啟用：300,000 或 5 分鐘（建議）。"
    rationale: "能夠連接到網路應用程式的攻擊者可以建立大量連接以導致 DoS 情況。"
    remediation: "要通過GP設定推薦配置，請將以下UI路徑設置為已啟用：300,000或5分鐘（推薦）：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds. 注意：此群組策略路徑預設情況下不存在。需要附加的群組策略模板（MSS-legacy.admx/adml） - 它可以從這個TechNet博客文章中獲得：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.5"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - "CCE-36868-8"
      - "https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> KeepAliveTime -> 300000'

  - id: 15106
    title: "確保“MSS：(NoNameReleaseOnDemand)允許電腦忽略來自 WINS 伺服器以外的 NetBIOS 名稱釋放請求”設定為“啟用”"
    description: "TCP/IP 上的 NetBIOS 是一種網路協定，它提供了一種輕鬆地將在基於 Windows 的系統上註冊的 NetBIOS 名稱解析為在這些系統上配置的 IP 位址的方法。此設定會決定電腦在收到名稱釋放請求時是否釋放其 NetBIOS 名稱。此設定的建議狀態為：已啟用。"
    rationale: "NetBT 協定設計為不使用身份驗證，因此容易受到欺騙。欺騙使傳輸看起來像是來自執行該操作的用戶以外的用戶。惡意使用者可以利用該協定未經身份驗證的性質向目標電腦發送名稱衝突資料報，這將導致電腦放棄其名稱並且不回應查詢。攻擊者可以透過網路傳送請求並查詢電腦以釋放其 NetBIOS 名稱。與可能影響應用程式的任何變更一樣，建議您在更改生產環境之前在非生產環境中測試此變更。此類攻擊的結果可能是導致目標電腦出現間歇性連線問題，甚至阻止使用網路芳鄰、網域登入、NET SEND 指令或其他 NetBIOS 名稱解析。"
    remediation: "透過 GP 建立建議的設定，將以下 UI 路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (NoNameReleaseOnDemand) 允許電腦忽略來自 WINS 伺服器以外的 NetBIOS 名稱釋放請求 注意：預設情況下不存在此群組原則路徑。需要額外的群組原則模板(MSS-legacy.admx/adml) - 可從此 TechNet 部落格文章取得：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.6"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.6"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-36879-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NoNameReleaseOnDemand -> 1'

  - id: 15107
    title: "確保“MSS：（PerformRouterDiscovery）允許 IRDP 偵測和設定預設閘道位址（可能導致 DoS）”設定為“停用”"
    description: "此設定用於啟用或停用 Internet 路由器發現協定 (IRDP)，該協定允許系統按照 RFC 1256 中的描述基於每個介面自動偵測和設定預設閘道位址。此設定的建議狀態是：停用。"
    rationale: "控制同一網段上的電腦的攻擊者可以設定網路上的電腦來冒充路由器。然後，其他啟用了 IRDP 的電腦將嘗試透過已受感染的電腦路由其流量。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS). 注意: 此組策略路徑預設不存在。 需要一個額外的組策略模板 (MSS-legacy.admx/adml) - 可從這篇TechNet博客文章中獲得: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.7"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - "CCE-38065-9"
      - "https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> PerformRouterDiscovery -> 0'

  - id: 15108
    title: "確保“MSS：（SafeDllSearchMode）啟用安全 DLL 搜尋模式（建議）”設定為“啟用”"
    description: "DLL 搜尋順序可以設定為透過以下兩種方式之一搜尋正在執行的程序請求的 DLL： - 首先搜尋系統路徑中指定的資料夾，然後搜尋目前工作資料夾。 - 先搜尋目前工作資料夾，然後搜尋系統路徑中指定的資料夾。啟用後，登錄值設定為 1。停用後，登錄值設定為 0，系統會先搜尋目前工作資料夾，然後搜尋系統路徑中指定的資料夾。應用程式將被迫先在系統路徑中搜尋 DLL。對於需要應用程式中包含的這些 DLL 的唯一版本的應用程序，此條目可能會導致效能或穩定性問題。此設定的建議狀態為：已啟用。"
    rationale: "如果使用者在不知情的情況下執行與包含系統 DLL 修改版本的其他檔案封裝在一起的惡意程式碼，則惡意程式碼可能會載入這些 DLL 的自己版本，並可能增加程式碼可能造成的損害類型和程度。"
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended) 注意: 此群組原則路徑預設不存在。需要額外的群組原則範本(MSS-legacy.admx/adml) - 可從此TechNet博客文章獲得: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.8"]
      - cis_csc: ["8"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-36351-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager -> SafeDllSearchMode -> 1'

  - id: 15109
    title: "確保“MSS：(ScreenSaverGracePeriod) 螢幕保護程式寬限期到期之前的時間（以秒為單位，建議為 0）”設定為“啟用：5 秒或更少”"
    description: "當啟用螢幕保護程式鎖定時，Windows 在啟動螢幕保護程式和控制台實際自動鎖定之間有一個寬限期。此設定的建議狀態為： 啟用：5 秒或更少。"
    rationale: "螢幕保護程式鎖定生效之前允許使用者移動的預設寬限期為五秒。如果您保留預設的寬限期配置，您的電腦很容易受到其他人的潛在攻擊，這些人可能會在鎖定生效之前接近控制台並嘗試登入電腦。可以在註冊表中輸入條目來調整寬限期的長度。"
    remediation: "要透過 GP 建立推薦配置，將以下 UI 路徑設置為啟用：5 秒或更少：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended) 注意：此群組原則路徑預設不存在。需要額外的群組原則模板 (MSS-legacy.admx/adml) - 可從此 TechNet 博客文章中獲取：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.9"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-37993-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScreenSaverGracePeriod -> n:^(\d+) compare <= 5'

  - id: 15110
    title: "確保“MSS：(TcpMaxDataRetransmissions IPv6)未確認資料重傳次數”設定為“啟用：3”"
    description: "此設定控制在連線中止之前 TCP 重新傳輸單一資料段（非連線段）的次數。連接上每次連續重傳，重傳逾時都會加倍。當響應恢復時它會重置。基本逾時值由測量的連線往返時間動態決定。此設定的建議狀態為：啟用：3。"
    rationale: "如果惡意使用者從未針對目標電腦傳輸的資料發送任何確認訊息，則可能會耗盡目標電腦的資源。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為啟用：3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted. 注意：此組策略路徑預設情況下不存在。需要額外的組策略模板（MSS-legacy.admx/adml） - 它可以從這個TechNet博客文章： The MSS settings - Microsoft Security Guidance blog 中獲取。"
    compliance:
      - cis: ["18.4.10"]
      - cis_csc: ["9"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
      - nist_800_53: ["SC.5"]
    references:
      - "CCE-37846-3"
      - "https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> TcpMaxDataRetransmissions -> 3'

  - id: 15111
    title: "確保“MSS：(TcpMaxDataRetransmissions)未確認資料重傳次數”設定為“啟用：3”"
    description: "此設定控制在連線中止之前 TCP 重新傳輸單一資料段（非連線段）的次數。連接上每次連續重傳，重傳逾時都會加倍。當響應恢復時它會重置。基本逾時值由測量的連線往返時間動態決定。此設定的建議狀態為：啟用：3。"
    rationale: "如果惡意使用者從未針對目標電腦傳輸的資料發送任何確認訊息，則可能會耗盡目標電腦的資源。"
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設置為已啟用：3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted. 注意：此群組原則路徑預設不存在。需要額外的群組原則模板 (MSS-legacy.admx/adml) - 可從此 TechNet 部落格文章獲得：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.11"]
      - cis_csc: ["9"]
      - nist_800_53: ["SC.5"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    references:
      - "CCE-36051-1"
      - "https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> TcpMaxDataRetransmissions -> 3'

  - id: 15112
    title: "確保“MSS：（警告等級）系統將產生警告的安全事件日誌的百分比閾值”設定為“啟用：90% 或更低”"
    description: "當日誌達到使用者定義的閾值時，此設定可以在安全事件日誌中產生安全審核。此設定的建議狀態為： 啟用：90% 或更低。注意：如果日誌設定配置為根據需要覆蓋事件或覆蓋 x 天之前的事件，則不會產生此事件。"
    rationale: "如果安全日誌達到其容量的 90%，且電腦尚未配置為根據需要覆蓋事件，則較新的事件將不會寫入日誌。如果日誌已達到其容量，且電腦已設定為在無法再將事件記錄到安全日誌時關閉，則電腦將關閉並且無法再提供網路服務。"
    remediation: "若要通過GP建立推薦的配置, 將以下UI路徑設置為啟用: 90%或更少: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning 注意: 此群組原則路徑預設情況下不存在。需要額外的群組原則模板(MSS-legacy.admx/adml) - 可以從這個TechNet博客文章獲取: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.4.12"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.7"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
      - "CCE-36880-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security -> WarningLevel -> n:^(\d+) compare <= 90'

  # Section 18.5 - Network

  - id: 15113
    title: "確保“關閉多播名稱解析”設定為“啟用”"
    description: "LLMNR 是輔助名稱解析協定。使用 LLMNR，可以透過單一子網路上的本機網路連結使用多重播放將查詢從用戶端電腦傳送到相同子網路上也啟用了 LLMNR 的另一台用戶端電腦。 LLMNR 不需要 DNS 伺服器或 DNS 用戶端配置，並在無法進行常規 DNS 名稱解析的情況下提供名稱解析。此設定的建議狀態為： Enabled 。"
    rationale: "攻擊者可以在網路上偵聽這些 LLMNR (UDP/5355) 或 NBT-NS (UDP/137) 廣播並對其做出回應，欺騙主機認為它知道所請求系統的位置。注意：要完全緩解本機名稱解析中毒，除了此設定之外，還應將每個已安裝 NIC 的屬性設為「停用 TCP/IP 上的 NetBIOS」（在 NIC 屬性的 WINS 標籤上）。不幸的是，沒有全域設定可以自動套用於所有 NIC 來實現此目的 - 它是針對每個 NIC 的設置，隨不同的 NIC 硬體安裝而變化。"
    remediation: "要通過 GP 建立建議配置，請將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\DNS Client\\Turn off multicast name resolution 注意：此組策略路徑預設可能不存在。它由包含在 Microsoft Windows 8.0 & Server 2012（非 R2）管理模板（或更新版本）中的組策略模板 DnsClient.admx/adml 提供。"
    compliance:
      - cis: ["18.5.4.2"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37450-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableMulticast -> 0'

  - id: 15114
    title: "確保“開啟映射器 I/O (LLTDIO) 驅動程式”設定為“停用”"
    description: "此策略設定更改映射器 I/O 網路協定驅動程式的操作行為。 LLTDIO 允許電腦發現其所連接的網路的拓撲。它還允許電腦發起服務品質請求，例如頻寬估計和網路健康分析。此設定的建議狀態是：停用。"
    rationale: "為了幫助防止可能發現和連接到未經授權的設備，應停用此設定以防止響應網路拓撲發現的網路流量。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設為禁用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Mapper I/O (LLTDIO) driver。注意：此群組原則路徑由群組原則範本 LinkLayerTopologyDiscovery.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.5.9.1"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38170-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowLLTDIOOnDomain -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowLLTDIOOnPublicNet -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableLLTDIO -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> ProhibitLLTDIOOnPrivateNet -> 0'

  - id: 15115
    title: "確保“開啟響應器 (RSPNDR) 驅動程式”設定為“停用”"
    description: "此策略設定更改響應程式網路協定驅動程式的操作行為。響應程序允許電腦參與鏈路層拓撲發現請求，以便可以在網路上發現並定位它。它還允許電腦參與服務品質活動，例如頻寬估計和網路健康分析。此設定的建議狀態是：停用。"
    rationale: "為了幫助防止可能發現和連接到未經授權的設備，應停用此設定以防止響應網路拓撲發現的網路流量。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為已停用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Responder (RSPNDR) driver。注意：此群組原則路徑由 Group Policy 模板 LinkLayerTopologyDiscovery.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.5.9.2"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37959-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowRspndrOnDomain -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowRspndrOnPublicNet -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableRspndr -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> ProhibitRspndrOnPrivateNet -> 0'

  - id: 15116
    title: "確保“關閉 Microsoft 對等網路服務”設定為“啟用”"
    description: "對等名稱解析協定 (PNRP) 允許將名稱分散式解析為 IPv6 位址和連接埠號碼。該協定在雲端環境中運行。雲端是一組可以使用相同 IPv6 範圍相互通訊的對等電腦。點對點協定允許 RTC、協作、內容分發和分散式處理領域的應用程式。此設定的建議狀態為：已啟用。"
    rationale: "此設定增強了環境的安全性並降低了與對等網路相關的整體風險暴露。"
    remediation: "要透過GP建立推薦的設定，請將以下UI路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Microsoft Peer-to-Peer Networking Services\\Turn off Microsoft Peer-to-Peer Networking Services。注意：此群組原則路徑由包含在所有版本Microsoft Windows 管理範本中的群組原則範本P2P- pnrp.admx/adml提供。"
    compliance:
      - cis: ["18.5.10.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37699-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet -> Disabled -> 1'

  - id: 15117
    title: "確保“禁止在 DNS 網域網路上安裝和設定橋接器”設定為“已啟用”"
    description: "您可以使用此程序來控制使用者安裝和設定網橋的能力。此設定的建議狀態為：已啟用。"
    rationale: "網路橋接設定（如果啟用）允許使用者建立第 2 層媒體存取控制 (MAC) 橋接，使他們能夠將兩個或多個實體網段連接在一起。因此，網橋允許連接到兩個不同網路的電腦在這些網路之間共用資料。在企業管理的環境中，需要將網路流量控制為僅經過授權的路徑，讓使用者建立網橋會增加橋接網路的風險和攻擊面。"
    remediation: "若要通過GP建立建議配置，將以下UI路徑設定為啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Prohibit installation and configuration of Network Bridge on your DNS domain network 注意：此群組原則路徑由群組原則範本NetworkConnections.admx/adml提供，該範本包含在所有版本的Microsoft Windows系統管理範本中。"
    compliance:
      - cis: ["18.5.11.2"]
      - cis_csc: ["5.1"]
      - pci_dss: ["1.3.5"]
      - tsc: ["CC6.6"]
    references:
      - "CCE-38002-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_AllowNetBridge_NLA -> 0'

  - id: 15118
    title: "確保“設定網路位置時要求網域使用者提升權限”設定為“已啟用”"
    description: "此策略設定決定在設定網路位置時是否要求網域使用者提升權限。此設定的建議狀態為：已啟用。"
    rationale: "允許一般使用者設定網路位置會增加風險和攻擊面。"
    remediation: "若要透過GP建立推薦的配置, 將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Require domain users to elevate when setting a network's location 注意: 此群組原則路徑可能預設不存在。它由群組原則範本NetworkConnections.admx/adml提供，該範本隨附於Microsoft Windows 7 & Server 2008 R2管理範本(或更新版本)中。"
    compliance:
      - cis: ["18.5.11.3"]
      - cis_csc: ["5.1"]
      - pci_dss: ["1.3.5"]
      - tsc: ["CC6.6"]
    references:
      - "CCE-38188-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_StdDomainUserSetLocation -> 1'

  - id: 15119
    title: 'Ensure ''Hardened UNC Paths'' is set to ''Enabled, with "Require Mutual Authentication" and "Require Integrity" set for all NETLOGON and SYSVOL shares'''
    description: '此策略設定配置對 UNC 路徑的安全存取。此設定的建議狀態為：啟用，並為所有 NETLOGON 和 SYSVOL 共用設定「需要相互驗證」和「需要完整性」。'
    rationale: "2015 年 2 月，作為 MS15-011 / MSKB 3000483 安全性更新的一部分，Microsoft 發布了一種新的控制機制來減輕群組原則中的安全風險。此機制需要安裝新的安全性更新，還需要將特定的群組原則設定部署到 Windows Vista / Server 2008（非 R2）或更高版本的網域中的所有電腦（未啟用啟用此功能的相關安全性修補程式）針對Server 2003 發布）。安全性更新也提供了新的群組原則範本 ( NetworkProvider.admx/adml )。新 GPO 範本就位後，以下是修復群組原則安全風險的最低要求： \\\\*\\NETLOGON RequireMutualAuthentication=1, RequireIntegrity=1 \\\\*\\SYSVOL RequireMutualAuthentication=1,要求完整性=1"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為啟用並至少配置以下路徑： \\\\*\\NETLOGON RequireMutualAuthentication=1, RequireIntegrity=1 \\\\*\\SYSVOL RequireMutualAuthentication=1, RequireIntegrity=1 Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Provider\\Hardened UNC Paths 注意：此組策略路徑預設不存在。需要額外的組策略模板（NetworkProvider.admx/adml）"
    compliance:
      - cis: ["18.5.14.1"]
      - cis_csc: ["3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\NETLOGON -> r:RequireMutualAuthentication=1 && r:RequireIntegrity=1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\SYSVOL -> r:RequireMutualAuthentication=1 && r:RequireIntegrity=1'

  # Section 18.5 - Network
  - id: 15120
    title: "停用 IPv6（確保 TCPIP6 參數「DisabledComponents」設定為「0xff (255)」）"
    description: "Internet 協定版本 6 (IPv6) 是電腦用來透過 Internet 以及家庭和企業網路交換資訊的一組協定。與 IPv4 相比，IPv6 允許分配更多的 IP 位址。較舊的網路、主機和作業系統可能本身不支援 IPv6。此設定的建議狀態為：DisabledComponents - 0xff (255)"
    rationale: "由於絕大多數私人企業管理的網路不需要使用 IPv6（因為它們可以存取私有 IPv4 位址），因此停用 IPv6 元件可以減少可能的攻擊面，從而更難以監控流量。因此，我們建議在不需要時將 IPv6 設定為停用狀態。"
    remediation: "要設置建議的配置，將以下註冊表值設置為0xff (255) (DWORD): HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters:DisabledComponents。注意：此更改在重新啟動計算機之前不會生效。注意 #2：儘管 Microsoft 沒有提供配置此註冊表值的 ADMX 模板，但在 CIS 基準修復工具包中提供了自定義 .ADM 模板 (Disable-IPv6-Components-KB929852.adm) 以便於其配置。請注意，簡單地取消 .ADM 模板中的群組政策設置並不會“撤銷”已應用的更改。相反，必須應用相反的設置以將註冊表值更改為相反狀態。"
    compliance:
      - cis: ["18.5.19.2.1"]
      - cis_csc: ["9"]
      - pci_dss: ["2.2.2"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> DisabledComponents -> 255'

  - id: 15121
    title: "確保“使用 Windows Connect Now 設定無線設定”設定為“停用”"
    description: "此策略設定允許使用 Windows Connect Now (WCN) 設定無線設定。 WCN Registrar 支援透過 Windows 可攜式裝置 API (WPD) 和 USB 隨身碟透過內建 802.11 Wi-Fi 發現和設定乙太網路 (UPnP) 裝置。還可以使用其他選項來允許透過特定媒體進行發現和配置。此設定的建議狀態是：停用。"
    rationale: "此設定增強了環境的安全性，並降低了與使用者配置無線設定相關的整體風險。"
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Configuration of wireless settings using Windows Connect Now。注意：此組策略路徑由組策略模板 WindowsConnectNow.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.5.20.1"]
      - cis_csc: ["15.4"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37481-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> EnableRegistrars -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableUPnPRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableInBand802DOT11Registrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableFlashConfigRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableWPDRegistrar -> 0'

  - id: 15122
    title: "確保“禁止存取 Windows Connect Now 精靈”設定為“啟用”"
    description: "此策略設定禁止存取 Windows Connect Now (WCN) 精靈。此設定的建議狀態為：已啟用。"
    rationale: "允許標準使用者存取 Windows Connect Now 精靈會增加風險和攻擊面。"
    remediation: "若要通過 GP 設定建議的配置，請設置以下 UI 路徑為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Network\\Network\\Windows Connect Now\\Prohibit access of the Windows Connect Now wizards。 注意: 該組策略路徑預設可能不存在。它由組策略模板 WindowsConnectNow.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.5.20.2"]
      - cis_csc: ["15.4"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36109-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI -> DisableWcnUi -> 1'

  - id: 15123
    title: "確保“最小化同時連接到 Internet 或 Windows 網域的數量”設定為“已啟用”"
    description: "此策略設定可防止電腦同時連接到基於網域的網路和非基於網域的網路。此設定的建議狀態為：已啟用。"
    rationale: "阻止同時連線有助於防止使用者在不知不覺中允許網路流量在 Internet 和企業管理的網路之間流動。"
    remediation: "要透過GP建立建議的配置，將以下界面路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connection Manager\\Minimize the number of simultaneous connections to the Internet or a Windows Domain 注意：此組策略路徑預設可能不存在。它由Group Policy模板WCM.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012 (非R2)管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.5.21.1"]
      - cis_csc: ["12"]
      - pci_dss: ["1.3.5"]
      - tsc: ["CC6.6"]
    references:
      - "CCE-38338-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fMinimizeConnections -> 1'

  # Section 18.5.21 - Windows Connection Manager
  - id: 15124
    title: "確保“連接到經過網域驗證的網路時禁止連接到非網域網路”設定為“已啟用”"
    description: "此策略設定可防止電腦同時連接到基於網域的網路和非基於網域的網路。"
    rationale: "潛在的擔憂是用戶會在不知情的情況下允許網路流量在不安全的公共網路和企業管理的網路之間流動。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\Network\\Windows Connection Manager\\Prohibit connection to non-domain networks when connected to domain authenticated network."
    compliance:
      - cis: ["18.5.21.2"]
      - cis_csc: ["12"]
      - pci_dss: ["2.2.4", "1.3.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2", "CC6.1"]
    references:
      - "CCE-37627-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fBlockNonDomain -> 1'

  # Section 18.8 - System
  - id: 15125
    title: "確保“在程序建立事件中包含指令列”設定為“停用”"
    description: "此策略設定決定在建立新程序時在安全審核事件中記錄哪些資訊。此設定的建議狀態是：停用。"
    rationale: "啟用此策略設定後，任何對安全事件具有讀取存取權限的使用者都可以讀取任何成功建立的程序的指令列參數。指令列參數可能包含敏感或私人訊息，例如密碼或使用者資料。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Audit Process Creation\\Include command line in process creation events 注意: 此群組策略路徑可能預設不存在。它由群組策略模板AuditSettings.admx/adml提供，該模板包含於 Microsoft Windows 8.1 及 Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.3.1"]
      - cis_csc: ["16.14"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36925-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit -> ProcessCreationIncludeCmdLine_Enabled -> 0'

  - id: 15126
    title: "確保“遠端主機允許委派不可匯出的憑證”設定為“已啟用”"
    description: "遠端主機允許委派不可匯出的憑證。使用憑證委派時，裝置會提供遠端主機可匯出版本的憑證。這使用戶面臨遠端主機上的攻擊者竊取憑證的風險。受限管理模式和 Windows Defender Remote Credential Guard 功能是幫助防範此風險的兩個選項。此設定的建議狀態為： Enabled 。"
    rationale: "受限管理模式旨在透過確保可重複使用的憑證不會儲存在可能受到損害的遠端裝置的記憶體中來幫助保護管理員帳戶。 Windows Defender Remote Credential Guard 透過將 Kerberos 請求重新導向回請求連接的設備，幫助你透過遠端桌面連線保護你的憑證。應該啟用並支援這兩個功能，因為它們可以減少憑證被盜的機會。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Credentials Delegation\\Remote host allows delegation of non-exportable credentials 注意：此組策略路徑預設可能不存在。它由組策略範本 CredSsp.admx/adml 提供，該範本包含在 Microsoft Windows 10 發行版本1703（或更新版本）的管理範本中。"
    compliance:
      - cis: ["18.8.4.1"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "https://docs.microsoft.com/en-us/windows/access-protection/remote-credential-guard"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation -> AllowProtectedCreds -> 1'

  - id: 15127
    title: "確保“啟動驅動程式初始化策略”設定為“啟用：良好、未知和不良但關鍵”"
    description: "此策略設定可讓您指定根據早期啟動反惡意軟體啟動驅動程式確定的分類來初始化哪些啟動啟動驅動程式。早期啟動反惡意軟體引導啟動驅動程式可以為每個引導啟動驅動程式傳回以下分類： - 良好：驅動程式已簽署且未被竄改。 -Bad：驅動程式已被識別為惡意軟體。建議您不要允許初始化已知的不良驅動程式。 -Bad, but required for boot: 驅動程式已被識別為惡意軟體，但如果不載入此驅動程式，電腦將無法成功啟動。 -未知：此驅動程式尚未經過您的惡意軟體偵測應用程式的證明，並且尚未被早期啟動反惡意軟體啟動驅動程式分類。如果啟用此策略設置，您將能夠選擇下次啟動電腦時要初始化的引導啟動驅動程式。如果您的惡意軟體偵測應用程式不包含早期啟動反惡意軟體啟動驅動程式，或者您的早期啟動反惡意軟體啟動驅動程式已停用，則此設定無效，所有啟動驅動程式都會被初始化。此設定的建議狀態為： 啟用：良好、未知和不良但關鍵。"
    rationale: "此策略設定有助於減少已感染系統的惡意軟體的影響。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設為已啟用: Good, unknown and bad but critical: Computer Configuration\\Policies\\Administrative Templates\\System\\Early Launch Antimalware\\Boot-Start Driver Initialization Policy 注意: 此群組原則路徑預設可能不存在。它由群組原則模板 EarlyLaunchAM.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012（非 R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.14.1"]
      - cis_csc: ["8"]
      - pci_dss: ["5.1.1"]
      - nist_800_53: ["SI.3"]
      - tsc: ["CC6.8"]
    references:
      - "CCE-37912-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch -> DriverLoadPolicy -> 3'

  - id: 15128
    title: "確保“配置註冊表策略處理：不在定期後台處理期間套用”設定為“啟用：FALSE”"
    description: "「定期後台處理期間不套用」選項可防止系統在電腦使用時在背景更新受影響的策略。停用背景更新後，政策變更將在下次使用者登入或系統重新啟動後生效。此設定的建議狀態為： 已啟用：FALSE（未選取）。"
    rationale: "與等到下一次使用者登入或系統重新啟動相比，將此選項設為 false（未選取）將確保網域原則變更更快生效。"
    remediation: "要透過 GP 建立建議配置，請將以下 UI 路徑設定為 Enabled，然後將 Do not apply during periodic background processing 選項設定為 FALSE（未勾選）：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Configure registry policy processing 注意：此群組原則路徑預設可能不存在。它由 GroupPolicy.admx/adml 提供，這些模板包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理模板（或更新版）中。"
    compliance:
      - cis: ["18.8.21.2"]
      - cis_csc: ["3.7"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36169-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> 0'

  - id: 15129
    title: "確保“配置註冊表策略處理：即使群組原則物件未更改也進行處理”設定為“啟用：TRUE”"
    description: "即使策略未更改，「即使群組原則物件未更改也進行處理」選項也會更新並重新套用原則。此設定的建議狀態為： 啟用：TRUE（選取）。"
    rationale: "將此選項設為 true（選取）將確保可能已在本機配置的未經授權的變更強制再次符合基於網域的群組原則設定。"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設定為啟用，然後將即使群組策略對象未更改也處理選項設定為TRUE（已勾選）：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Configure registry policy processing 注意：此群組策略路徑可能預設不存在。 它是由GroupPolicy.admx/adml的群組策略模板提供，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.8.21.3"]
      - cis_csc: ["3.7"]
      - pci_dss: ["11.5.1"]
      - tsc: ["PI1.4", "PI1.5", "CC6.1", "CC6.8", "CC7.2", "CC7.3", "CC7.4"]
    references:
      - "CCE-36169-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> 0'

  - id: 15130
    title: "確保“關閉群組原則後台刷新”設定為“停用”"
    description: "此策略設定可防止在電腦使用時更新群組原則。此策略設定適用於電腦、使用者和網域控制站的群組原則。此設定的建議狀態是：停用。"
    rationale: "與等到下次使用者登入或系統重新啟動相比，此設定可確保群組原則變更更快生效。"
    remediation: "若要透過 GP 設定建議的配置，將以下路徑中的 UI 設定為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Turn off background refresh of Group Policy 注意：此群組原則路徑由 GroupPolicy.admx/adml 群組原則範本提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.8.21.4"]
      - cis_csc: ["3.7"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37712-7"
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableBkGndGroupPolicy'

  # Section 18.8 - System
  - id: 15131
    title: "確保“關閉透過 HTTP 下載列印驅動程式”設定為“啟用”"
    description: "此原則設定控制電腦是否可以透過 HTTP 下載列印驅動程式套件。若要設定 HTTP 列印，可能需要透過 HTTP 下載標準作業系統安裝中不可用的印表機驅動程式。此設定的建議狀態為：已啟用。"
    rationale: "使用者可能會下載包含惡意程式碼的驅動程式。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off downloading of print drivers over HTTP 注意: 此群組策略路徑由包含在所有版本Microsoft Windows管理模板中的ICM.admx/adml群組策略模板提供。"
    compliance:
      - cis: ["18.8.22.1.1"]
      - cis_csc: ["2"]
      - pci_dss: ["6"]
      - nist_800_53: ["SI.3"]
    references:
      - "CCE-36625-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableWebPnPDownload -> 1'

  - id: 15132
    title: "確保“關閉手寫個人化資料共享”設定為“啟用”"
    description: "此設定會關閉手寫辨識個人化工具的資料共用。手寫辨識個人化工具使平板電腦使用者能夠透過提供書寫範例來使手寫辨識適應自己的書寫風格。該工具可以選擇與 Microsoft 共用使用者書寫範例，以改善未來版本的 Windows 中的手寫識別。該工具會產生報表並透過安全連線將其傳輸給 Microsoft。此設定的建議狀態為：已啟用。"
    rationale: "一個人的筆跡是個人識別資訊 (PII)，尤其是當涉及到您的簽名時。因此，在許多環境中，未經使用者明確批准而自動將 PII 上傳到網站是不可接受的。"
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting personalization data sharing。注意: 該群組原則路徑預設可能不存在。它是由Group Policy範本ShapeCollector.admx/adml提供的，該範本包含在Microsoft Windows 7 & Server 2008 R2管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.22.1.2"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37911-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC -> PreventHandwritingDataSharing -> 1'

  - id: 15133
    title: "確保“關閉手寫識別錯誤報告”設定為“啟用”"
    description: "關閉手寫辨識錯誤報告工具。手寫識別錯誤報告工具使用戶能夠報告在 Tablet PC 輸入面板中遇到的錯誤。該工具會產生錯誤報告並透過安全連線將其傳輸給 Microsoft。 Microsoft 使用這些錯誤報告來改進未來版本的 Windows 中的手寫辨識。此設定的建議狀態為：已啟用。"
    rationale: "一個人的筆跡是個人識別資訊 (PII)，尤其是當涉及到您的簽名時。因此，在許多環境中，未經使用者明確批准而自動將 PII 上傳到網站是不可接受的。"
    remediation: "如要通過GP設置建議配置，請將以下UI路徑設定為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting recognition error reporting。注意：此群組原則路徑由群組原則模板InkWatson.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.8.22.1.3"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36203-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports -> PreventHandwritingErrorReports -> 1'

  - id: 15134
    title: "確保“如果 URL 連線引用 Microsoft.com，則關閉 Internet 連線精靈”設定為“已啟用”"
    description: "此政策設定指定 Internet 連線精靈是否可以連線至 Microsoft 以下載 Internet 服務提供者 (ISP) 的清單。此設定的建議狀態為：已啟用。"
    rationale: "在企業管理的環境中，我們希望降低使用者在不知情的情況下暴露敏感資料的風險。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下用戶界面路徑設置為“已啟用”：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com。注意：此組策略路徑由 Group Policy 模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.8.22.1.4"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37163-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard -> ExitOnMSICW -> 1'

  - id: 15135
    title: "確保“關閉 Web 發布和線上訂購精靈的 Internet 下載”設定為“啟用”"
    description: "此策略設定控制 Windows 是否下載 Web 發佈和線上訂購精靈的提供者清單。此設定的建議狀態為：已啟用。"
    rationale: "儘管風險很小，但啟用此設定將降低用戶在不知情的情況下透過此功能下載惡意內容的可能性。"
    remediation: "要透過GP建立推薦的配置，將以下UI路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet download for Web publishing and online ordering wizards 注意: 此群組原則路徑由Group Policy範本ICM.admx/adml提供，該範本包含在所有版本的Microsoft Windows系統管理範本中。"
    compliance:
      - cis: ["18.8.22.1.5"]
      - cis_csc: ["7"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36096-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoWebServices -> 1'

  - id: 15136
    title: "確保“關閉透過 HTTP 的列印”設定為“已啟用”"
    description: "此原則設定可讓您停用用戶端電腦透過 HTTP 列印的功能，從而允許電腦列印到 Intranet 和 Internet 上的印表機。此設定的建議狀態為：已啟用。"
    rationale: "透過此功能透過 HTTP 傳輸的資訊不受保護，並且可能被惡意使用者攔截。因此，它不經常在企業託管環境中使用。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為 Enabled：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off printing over HTTP 注意：此群組原則路徑由 Group Policy 模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.8.22.1.6"]
      - cis_csc: ["13.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36920-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableHTTPPrinting -> 1'

  - id: 15137
    title: "確保“如果 URL 連線引用 Microsoft.com，則關閉註冊”設定為“已啟用”"
    description: "此政策設定指定 Windows 註冊精靈是否連接到 Microsoft.com 進行線上註冊。此設定的建議狀態為：已啟用。"
    rationale: "企業管理環境中的使用者不應註冊自己的 Windows 副本，並在此過程中提供自己的 PII。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Registration if URL connection is referring to Microsoft.com。 注意：該組策略路徑由Group Policy模板ICM.admx/adml提供，該模板包含在所有版本的Microsoft Windows Administrative Templates中。"
    compliance:
      - cis: ["18.8.22.1.7"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36352-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control -> NoRegistration -> 1'

  - id: 15138
    title: "確保“關閉搜尋伴侶內容檔案更新”設定為“啟用”"
    description: "此策略設定指定Search Companion 是否應在本機和 Internet 搜尋期間自動下載內容更新。此設定的建議狀態為：已啟用。"
    rationale: "用戶可能會因為搜尋的主題而在不知不覺中洩露敏感訊息，這種風險很小。這種風險非常低，因為即使啟用此設置，用戶仍然必須向所需的搜尋引擎提交搜尋查詢才能執行搜尋。"
    remediation: "要透過 GP 設定建議的配置，將以下的 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Search Companion content file updates。注意: 此群組原則路徑由包括在所有版本的 Microsoft Windows 管理範本中的群組原則範本 ICM.admx/adml 提供。"
    compliance:
      - cis: ["18.8.22.1.8"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36884-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion -> DisableContentFileUpdates -> 1'

  - id: 15139
    title: 'Ensure ''Turn off the "Order Prints" picture task'' is set to ''Enabled'''
    description: '此策略設定指定「線上訂購列印」任務是否可從 Windows 資料夾中的圖片任務中取得。線上訂購印刷品嚮導用於下載提供者清單並允許用戶線上訂購印刷品。此設定的建議狀態為：已啟用。'
    rationale: "在企業管理的環境中，我們希望降低使用者在不知情的情況下暴露敏感資料的風險。"
    remediation: "要透過 GP 建立建議的配置, 將以下 UI 路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Order Prints\" picture task. 注意: 此群組原則路徑由群組原則範本 ICM.admx/adml 提供, 該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.8.22.1.9"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38275-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoOnlinePrintsWizard -> 1'

  - id: 15140
    title: 'Ensure ''Turn off the "Publish to Web" task for files and folders'' is set to ''Enabled'''
    description: "此政策設定指定「將此檔案發佈到Web」、「將此資料夾發佈到Web」和「將所選項目發佈到Web」任務是否可從Windows 資料夾中的「資料和資料夾任務」中取得。 Web 發布精靈用於下載提供者清單並允許使用者將內容發佈到 Web。此設定的建議狀態為：已啟用。"
    rationale: "使用者可以向組織控制以外的公共服務發布機密或敏感資訊。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Publish to Web\" task for files and folders 注意：這個群組原則路徑由群組原則範本 ICM.admx/adml 提供，此範本包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.8.22.1.10"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37090-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoPublishingWizard -> 1'

  - id: 15141
    title: "確保“關閉 Windows Messenger 客戶體驗改善計劃”設定為“啟用”"
    description: "此策略設定指定 Windows Messenger 是否可以收集有關如何使用 Windows Messenger 軟體和服務的匿名資訊。 Microsoft 使用透過客戶體驗改善計畫收集的資訊來偵測軟體缺陷，以便可以更快地修正這些缺陷，啟用此設定將減少 Microsoft 為此目的收集的資料量。此設定的建議狀態為：已啟用。"
    rationale: "大型企業託管環境可能不希望 Microsoft 從託管客戶端電腦收集資訊。"
    remediation: "要透過GP建立推薦設定，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the Windows Messenger Customer Experience Improvement Program. 注意：此群組原則路徑由群組原則範本ICM.admx/adml提供，並包含在所有版本的Microsoft Windows管理範本中。"
    compliance:
      - cis: ["18.8.22.1.11"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36628-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client -> CEIP -> 2'

  - id: 15142
    title: "確保“關閉 Windows 客戶體驗改善計劃”設定為“啟用”"
    description: "此策略設定指定 Windows Messenger 是否可以收集有關如何使用 Windows Messenger 軟體和服務的匿名資訊。 Microsoft 使用透過 Windows 客戶體驗改善計畫收集的資訊來偵測軟體缺陷，以便可以更快地修正這些缺陷，啟用此設定將減少 Microsoft 為此目的收集的資料量。此設定的建議狀態為：已啟用。"
    rationale: "大型企業託管環境可能不希望 Microsoft 從託管客戶端電腦收集資訊。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Customer Experience Improvement Program。注意：此組策略路徑由組策略模板ICM.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.8.22.1.12"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36174-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows -> CEIPEnable -> 0'

  - id: 15143
    title: "確保“關閉 Windows 錯誤報告”設定為“啟用”"
    description: "此策略設定控制是否向 Microsoft 報告錯誤。錯誤報告用於報告有關發生故障或停止回應的系統或應用程式的資訊，並用於提高產品品質。此設定的建議狀態為：已啟用。"
    rationale: "如果 Windows 錯誤發生在安全的企業管理環境中，則應將錯誤直接回報給 IT 人員以進行故障排除和修復。直接向 Microsoft 報告這些錯誤對公司沒有任何好處，並且存在在不知情的情況下暴露敏感資料作為錯誤的一部分的風險。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Error Reporting. 注意: 此群組策略路徑由群組策略模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.8.22.1.13"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-35964-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> Disabled -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PCHealth\ErrorReporting -> DoReport -> 0'

  - id: 15144
    title: "確保“禁止將使用者輸入法複製到系統帳戶以進行登入”設定為“已啟用”"
    description: "此策略可防止將使用者輸入法自動複製到系統帳戶以在登入畫面上使用。使用者只能使用系統帳戶中啟用的一組輸入法。此設定的建議狀態為：已啟用。"
    rationale: "這是增加系統帳戶安全性的一種方法。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為已啟用： Computer Configuration\\Policies\\Administrative Templates\\System\\Locale Services\\Disallow copying of user input methods to the system account for sign-in. 注意：此群組原則路徑可能預設不存在。它是由包含在 Microsoft Windows 8.0 與 Server 2012（非 R2）管理範本（或更新版本）中的群組原則範本 Globalization.admx/adml 提供的。"
    compliance:
      - cis: ["18.8.26.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36343-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International -> BlockUserInputMethodsForSignIn -> 1'

  - id: 15145
    title: "確保“不顯示網頁選擇 UI”設定為“已啟用”"
    description: "此策略設定可讓你控制是否任何人都可以與登入畫面上的可用網頁 UI 互動。此設定的建議狀態為：已啟用。"
    rationale: "未經授權的使用者可以將電腦與網路斷開連接，或者可以在不登入 Windows 的情況下將電腦連接到其他可用網路。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設為「已啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Do not display network selection UI 注意：此組策略路徑預設情況下可能不存在。它由 Group Policy 模板 Logon.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 & Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.27.1"]
      - cis_csc: ["5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38353-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontDisplayNetworkSelectionUI -> 1'

  - id: 15146
    title: "確保“不列舉已加入網域的電腦上的已連線使用者”設定為“已啟用”"
    description: "此政策設定可防止在加入網域的電腦上列舉已連線的使用者。此設定的建議狀態為：已啟用。"
    rationale: "惡意使用者可以使用此功能來收集其他使用者的帳戶名，然後該資訊可以與其他類型的攻擊結合使用，例如猜測密碼或社交工程。此對策的價值很小，因為具有網域憑證的使用者可以使用其他方法收集相同的帳戶資訊。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Do not enumerate connected users on domain-joined computers 注意: 此組策略路徑預設情況下可能不存在。它由組策略模板 Logon.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.27.2"]
      - cis_csc: ["16.9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37838-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontEnumerateConnectedUsers -> 1'

  - id: 15147
    title: "確保“列舉加入網域的電腦上的本機使用者”設定為“停用”"
    description: "此策略設定允許在加入網域的電腦上列舉本機使用者。此設定的建議狀態是：停用。"
    rationale: "惡意使用者可以使用此功能來收集其他使用者的帳戶名，然後該資訊可以與其他類型的攻擊結合使用，例如猜測密碼或社交工程。此對策的價值很小，因為具有網域憑證的使用者可以使用其他方法收集相同的帳戶資訊。"
    remediation: "若要透過 GP 建立推薦配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Enumerate local users on domain-joined computers 注意：此組策略路徑預設可能不存在。它由包含在 Microsoft Windows 8.0 和 Server 2012 (非 R2) 系統管理模板 (或更新版本) 中的組策略模板 Logon.admx/adml 提供。"
    compliance:
      - cis: ["18.8.27.3"]
      - cis_csc: ["16.9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-35894-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnumerateLocalUsers -> 0'

  - id: 15148
    title: "確保“關閉鎖定螢幕上的應用程式通知”設定為“已啟用”"
    description: "此策略設定可讓您阻止應用程式通知出現在鎖定畫面上。此設定的建議狀態為：已啟用。"
    rationale: "應用程式通知可能會顯示敏感的業務或個人資料。"
    remediation: "要透過GP建立推薦配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn off app notifications on the lock screen 注意：此群組策略路徑可能預設不存在。它由群組策略模板Logon.admx/adml提供，該模板包含在Microsoft Windows 8.0及Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.27.4"]
      - cis_csc: ["16.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-35893-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DisableLockScreenAppNotifications -> 1'

  - id: 15149
    title: "確保“關閉圖片密碼登入”設定為“啟用”"
    description: "此政策設定可讓您控制網域使用者是否可以使用圖片密碼登入。此設定的建議狀態為： Enabled 。注意：如果允許圖片密碼功能，則使用時使用者的網域密碼會快取在系統保管庫中。"
    rationale: "圖片密碼無需輸入複雜密碼。在共享工作環境中，只要有人觀察螢幕上的手勢，進行簡單的肩衝浪，就可以讓該人無需知道複雜的密碼即可存取系統。帶有影像的垂直監視器螢幕在遠處比水平擊鍵更清晰，從而增加了成功觀察滑鼠手勢的可能性。"
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn off picture password sign-in 注意: 此群組原則路徑預設可能不存在。它是由 Group Policy 模板 CredentialProviders.admx/adml 提供，包含在 Microsoft Windows 8.0 & Server 2012 (non-R2) Administrative Templates (或更新版本) 中。"
    compliance:
      - cis: ["18.8.27.5"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockDomainPicturePassword -> 1'

  - id: 15150
    title: "確保“開啟便利 PIN 登入”設定為“停用”"
    description: "此政策設定可讓您控制網域使用者是否可以使用便利 PIN 登入。在 Windows 10 中，便利 PIN 被具有更強安全性的 Passport 取代。若要為網域使用者設定 Passport，請使用電腦設定\\管理範本\\Windows 元件\\Microsoft Passport for Work 下的原則。注意：使用此功能時，使用者的網域密碼將快取在系統保管庫中。此設定的建議狀態是：停用。"
    rationale: "PIN 碼是由比密碼少得多的字元創建的，因此在大多數情況下，PIN 碼的穩健性遠不如密碼。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設為停用：Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn on convenience PIN sign-in 注意：此群組原則路徑可能預設不存在。它由群組原則範本 CredentialProviders.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 & Server 2012（非 R2）管理範本中（或更新版本）。注意 #2：在較舊的 Microsoft Windows 管理範本中，此設置最初命名為 Turn on PIN sign-in，但從 Windows 10 Release 1511 管理範本開始，該設置被重新命名。"
    compliance:
      - cis: ["18.8.27.6"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37528-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowDomainPINLogon -> 0'

  - id: 15151
    title: "確保“電腦喚醒時需要密碼（使用電池）”設定為“已啟用”"
    description: "指定當系統從睡眠狀態恢復時是否提示使用者輸入密碼。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可確保將無人值守的電腦從睡眠狀態喚醒的任何人都必須提供登入憑證才能存取系統。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Require a password when a computer wakes (on battery) 注意：此群組原則路徑可能預設不存在。它由群組原則範本 Power.admx/adml 提供，該範本包含於 Microsoft Windows 8.0 和 Server 2012 (非 R2) 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.33.6.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36881-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> 1'

  - id: 15152
    title: "確保“電腦喚醒（插入電源）時需要密碼”設定為“已啟用”"
    description: "指定當系統從睡眠狀態恢復時是否提示使用者輸入密碼。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可確保將無人值守的電腦從睡眠狀態喚醒的任何人都必須提供登入憑證才能存取系統。"
    remediation: "要通過 GP 設定建議的配置，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Require a password when a computer wakes (plugged in) 注意：此群組原則路徑可能在預設情況下不存在。它由群組原則模板 Power.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 和 Server 2012 (非 R2) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.33.6.2"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37066-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> 1'

  - id: 15153
    title: "確保“配置提供遠端協助”設定為“停用”"
    description: "此策略設定可讓您開啟或關閉此電腦上的提供（未經請求的）遠端協助。服務台和支援人員將無法主動提供協助，但他們仍可回應使用者的協助要求。此設定的建議狀態是：停用。"
    rationale: "用戶可能會被欺騙並接受惡意用戶主動提供的遠端協助。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為停用: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Assistance\\Configure Offer Remote Assistance 注意: 預設情況下此群組原則路徑可能不存在。它由群組原則範本 RemoteAssistance.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.35.1"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36388-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowUnsolicited -> 0'

  - id: 15154
    title: "確保“配置請求的遠端協助”設定為“停用”"
    description: "此策略設定可讓您開啟或關閉此電腦上的請求（請求）遠端協助。此設定的建議狀態是：停用。"
    rationale: "流氓管理員可能會獲得對其他使用者桌面會話的存取權限，但他們無法在未經使用者許可的情況下連接到使用者的電腦或控制該電腦。當專家嘗試連線時，使用者仍然可以選擇拒絕連線或授予專家僅查看權限。使用者必須明確點擊「是」按鈕才能允許專家遠端控制工作站。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Assistance\\Configure Solicited Remote Assistance 注意: 預設情況下，這個組策略路徑可能不存在。它由組策略模板RemoteAssistance.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012 (非R2) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.35.2"]
      - cis_csc: ["5.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37281-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowToGetHelp -> 0'

  # Section 18.8.36 - Remote Procedure Call
  - id: 15155
    title: "確保“啟用 RPC 端點映射器用戶端身份驗證”設定為“已啟用”"
    description: "此策略設定控制 RPC 用戶端在進行的呼叫包含身份驗證資訊時是否使用端點映射器服務進行身份驗證。執行 Windows NT4（所有 Service Pack）的電腦上的端點映射器服務無法處理以此方式提供的驗證資訊。如果將此原則設定套用至信任網域 DC，則可能會導致單向林信任出現特定問題（請參閱 Microsoft KB3073942），因此我們不建議將其套用至網域控制站。注意：此策略只有在系統重新啟動後才會生效。此設定的建議狀態為：已啟用。"
    rationale: "對 RPC 服務的匿名存取可能會導致資訊意外洩露給未經身份驗證的使用者。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Enable RPC Endpoint Mapper Client Authentication 注意：此群組原則路徑預設可能不存在。它是由包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中的群組原則模板RPC.admx/adml提供的。"
    compliance:
      - cis: ["18.8.36.1"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - https://support.microsoft.com/en-us/help/3073942/rpc-endpoint-mapper-client-authentication-prevents-users-and-groups-fr
      - "CCE-37346-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> EnableAuthEpResolution -> 1'

  - id: 15156
    title: "確保“限制未經身份驗證的 RPC 用戶端”設定為“啟用：已驗證”"
    description: "此策略設定控制 RPC 伺服器在運作時如何處理連接到 RPC 伺服器的未經驗證的 RPC 用戶端。"
    rationale: "未經身份驗證的 RPC 通訊可能會造成安全漏洞。"
    remediation: "若要透過 GP 建立推薦的配置，將以下的 UI 路徑設置為啟用: Authenticated: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Restrict Unauthenticated RPC clients."
    compliance:
      - cis: ["18.8.36.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36559-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> RestrictRemoteClients -> 1'

  - id: 15157
    title: "確保“Microsoft 支援診斷工具：開啟與支援提供者的 MSDT 互動通訊”設定為“停用”"
    description: "此策略設定配置 Microsoft 支援診斷工具 (MSDT) 與支援提供者的互動式通訊。 MSDT 收集診斷資料以供支援專業人員進行分析。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "要通過GP建立推薦的配置，將以下用戶界面路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Microsoft Support Diagnostic Tool\\Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider. 注意: 此群組政策路徑可能預設不存在。它由Group Policy template MSDT.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.44.5.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38161-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy -> DisableQueryRemoteServer -> 0'

  - id: 15158
    title: "確保“啟用/停用 PerfTrack”設定為“停用”"
    description: "此策略設定指定是啟用還是停用回應事件追蹤。此設定的建議狀態是：停用。"
    rationale: "啟用後，給定事件的聚合資料將傳輸給 Microsoft。此選項可以限制特定使用者的此功能、設定同意等級以及指定可以傳送錯誤報告的特定程式。但是，強烈建議集中限制執行 PerfTrack 的能力，以限制未經授權或不必要的使用、資料外洩或無意通訊的可能性。"
    remediation: "若要通過 GP 設定建議的配置，將以下 UI 路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Windows Performance PerfTrack\\Enable/Disable PerfTrack。注意：此群組政策路徑預設可能不存在。它由 Group Policy 模板 PerformancePerftrack.admx/adml 提供，該模板包含在 Microsoft Windows 7 & Server 2008 R2 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.8.44.11.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36648-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> 0'

  - id: 15159
    title: "確保“關閉廣告 ID”設定為“啟用”"
    description: "此策略設定會關閉廣告 ID，防止應用程式使用該 ID 來實現跨應用程式的體驗。此設定的建議狀態為：已啟用。"
    rationale: "出於廣告目的追蹤用戶活動，即使是匿名的，也可能涉及隱私問題。在企業管理的環境中，應用程式不應需要或要求追蹤目標廣告。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\User Profiles\\Turn off the advertising ID。注意：此群組策略路徑預設可能不存在。它由包含在Microsoft Windows 8.1 & Server 2012 R2管理模板（或更新版本）中的群組策略模板UserProfiles.admx/adml提供。"
    compliance:
      - cis: ["18.8.46.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36931-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo -> DisabledByGroupPolicy -> 1'

  - id: 15160
    title: "確保“啟用 Windows NTP 用戶端”設定為“已啟用”"
    description: "此原則設定指定是否啟用 Windows NTP 用戶端。啟用 Windows NTP 用戶端可讓您的電腦將其電腦時鐘與其他 NTP 伺服器同步。如果您決定使用第三方時間提供者，您可能需要停用此服務。此設定的建議狀態為：已啟用。"
    rationale: "可靠且準確的時間記錄對於許多服務和安全要求非常重要，包括但不限於分散式應用程式、身份驗證服務、多用戶資料庫和日誌記錄服務。使用 NTP 用戶端（具有安全操作）可確保功能準確性，並且是審查安全相關事件時的焦點。"
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Client。注意：此群組原則路徑由群組原則範本 W32Time.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 行政範本中。"
    compliance:
      - cis: ["18.8.49.1.1"]
      - cis_csc: ["6.1"]
      - pci_dss: ["10.4"]
      - nist_800_53: ["AU.8"]
      - tsc: ["CC7.2"]
    references:
      - "CCE-37843-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient -> Enabled -> 1'

  - id: 15161
    title: "確保“啟用 Windows NTP 伺服器”設定為“停用”"
    description: "此原則設定可讓您指定是否啟用 Windows NTP 伺服器。"
    rationale: "由於 Kerberos 驗證時間戳記的敏感度以及確保準確的安全性日誌記錄，正確的時間同步配置在企業託管環境中至關重要。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設定為已停用：Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Server."
    compliance:
      - cis: ["18.8.49.1.2"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - nist_800_53: ["AU.8"]
      - tsc: ["CC6.3", "CC7.2"]
    references:
      - "CCE-37319-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer -> Enabled -> 0'

  # Section 18.9 - Windows Components
  - id: 15162
    title: "確保“允許 Microsoft 帳戶可選”設定為“已啟用”"
    description: "透過此策略設置，您可以控制 Microsoft 帳戶對於需要帳戶登入的 Windows 應用程式商店應用程式是否是可選的。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可讓組織在存取 Windows 應用程式商店應用程式時使用其企業使用者帳戶，而不是使用其 Microsoft 帳戶。這使組織可以更好地控制相關憑證。 Microsoft 帳戶無法集中管理，因此無法對其應用程式企業憑證安全性策略，這可能會使使用 Microsoft 帳戶存取的任何資訊面臨風險。"
    remediation: "若要透過 GP 設定建議的配置，將以下 UI 路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App runtime\\Allow Microsoft accounts to be optional 注意: 此群組原則路徑可能預設不存在。它由群組原則範本 AppXRuntime.admx/adml 提供，此範本包含在 Microsoft Windows 8.1 & Server 2012 R2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.6.1"]
      - cis_csc: ["16.9"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-38354-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> MSAOptional -> 1'

  - id: 15163
    title: "確保“禁止非磁碟區設備自動播放”設定為“已啟用”"
    description: "此政策設定不允許 MTP 裝置（例如相機或手機）自動播放。此設定的建議狀態為：已啟用。"
    rationale: "攻擊者可以利用此功能啟動程式來損壞客戶端電腦或電腦上的資料。"
    remediation: "要透過GP設定推薦的配置，將以下使用者介面路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Disallow Autoplay for non-volume devices 注意：此群組原則路徑預設可能不存在。它由Group Policy模板AutoPlay.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.8.1"]
      - cis_csc: ["8.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37636-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoAutoplayfornonVolume -> 1'

  - id: 15164
    title: "確保“設定自動運行的預設行為”設定為“啟用：不執行任何自動運行指令”"
    description: "此策略設定設定自動運行指令的預設行為。自動運行指令通常儲存在 autorun.inf 檔案中。他們經常啟動安裝程式或其他例程。此設定的建議狀態為： 啟用：不執行任何自動執行指令。"
    rationale: "在 Windows Vista 之前，當插入包含自動執行指令的媒體時，系統將自動執行該程序，無需使用者乾預。這會產生主要的安全性問題，因為程式碼可能會在使用者不知情的情況下執行。從 Windows Vista 開始，預設行為是提示使用者是否要執行自動執行指令。自動執行指令在「自動播放」對話方塊中表示為處理程序。"
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設定為啟用：不執行任何自動執行指令：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Set the default behavior for AutoRun 注意：此群組原則路徑可能預設不存在。它由包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中的群組原則模板AutoPlay.admx/adml提供。"
    compliance:
      - cis: ["18.9.8.2"]
      - cis_csc: ["8.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38217-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoAutorun -> 1'

  - id: 15165
    title: "確保“關閉自動播放”設定為“啟用：所有驅動器”"
    description: "一旦您將媒體插入驅動器，自動播放就會開始從驅動器讀取內容，這會導致程式或音訊媒體的安裝檔案立即啟動。攻擊者可以利用此功能啟動程式來損壞電腦或電腦上的資料。預設情況下，某些可移動磁碟機類型（例如磁碟機和網路磁碟機）上的自動播放功能處於停用狀態，但 CD-ROM 磁碟機上則不會。注意：您無法使用此策略設定在預設情況下停用自動播放的電腦磁碟機（例如磁碟機和網路磁碟機）上啟用自動播放。此設定的建議狀態為： 啟用：所有磁碟機。"
    rationale: "攻擊者可以利用此功能啟動程式來損壞客戶端電腦或電腦上的資料。"
    remediation: "要通過 GP 設置建議的配置，請將以下 UI 路徑設置為 Enabled: All drives: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Turn off Autoplay 注意: 此組策略路徑由 Group Policy 模板 AutoPlay.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.8.3"]
      - cis_csc: ["8.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36875-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoDriveTypeAutoRun -> 255'

  - id: 15166
    title: "確保“不顯示密碼顯示按鈕”設定為“已啟用”"
    description: "此策略設定允許你配置密碼顯示按鈕在密碼輸入使用者體驗中的顯示。此設定的建議狀態為：已啟用。"
    rationale: "當輸入長而複雜的密碼時，尤其是使用觸控螢幕時，這是一個有用的功能。潛在的風險是其他人可能會在偷偷觀察您的螢幕時看到您的密碼。"
    remediation: "要通過GP設置推薦配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Do not display the password reveal button 注意：此組策略路徑預設情況下可能不存在。它由Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）包含的組策略模板CredUI.admx/adml提供。"
    compliance:
      - cis: ["18.9.15.1"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37534-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI -> DisablePasswordReveal -> 1'

  - id: 15167
    title: "確保“列舉提升時的管理員帳戶”設定為“停用”"
    description: "此策略設定控制當使用者嘗試提升正在執行的應用程式時是否顯示管理員帳戶。此設定的建議狀態是：停用。"
    rationale: "用戶可以看到管理員帳戶列表，這使得登入控制台會話的惡意用戶更容易嘗試破解這些帳戶的密碼。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Enumerate administrator accounts on elevation 注意：此群組政策路徑由包含在所有版本的 Microsoft Windows 管理模板中的群組政策模板 CredUI.admx/adml 提供。"
    compliance:
      - cis: ["18.9.15.2"]
      - cis_csc: ["16"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36512-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI -> EnumerateAdministrators -> 0'

  - id: 15168
    title: "確保“預設操作和緩解設定”設定為“啟用”（以及子設定）"
    description: "此設定配置偵測和進階 ROP 緩解後的預設操作。此設定的建議狀態是：預設操作和緩解設定 - 已啟用；深鉤 - 已啟用；  反繞路 - 已啟用；停用功能 - 已啟用；漏洞利用操作 - 使用者配置"
    rationale: "這些 ROP 緩解措施的進階緩解措施適用於 EMET 中的所有配置軟體：Deep Hooks 保護關鍵 API 以及頂級關鍵 API 使用的後續較低等級 API。 Anti Detours 透過執行被鉤住的函數序言的副本，然後跳到序言之後的函數，從而使規避鉤子的攻擊變得無效。停用函數將阻止對 ntdll!LdrHotPatchRoutine 的調用，以減少濫用 API 的潛在漏洞。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\Default Action and Mitigation Settings。注意：此群組原則路徑預設不存在。需要額外的群組原則範本（EMET.admx/adml）－此範本包含在Microsoft Enhanced Mitigation Experience Toolkit（EMET）中。"
    compliance:
      - cis: ["18.9.24.2"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38427-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> AntiDetours -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> BannedFunctions -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> DeepHooks -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> ExploitAction -> 2'

  - id: 15169
    title: "確保“Internet Explorer 預設保護”設定為“啟用”"
    description: "此設定決定是否將建議的 EMET 緩解措施應用於 Internet Explorer。此設定的建議狀態為： Enabled 。"
    rationale: "將 EMET 緩解措施應用於 Internet Explorer 將有助於降低針對 Internet Explorer 的攻擊的可靠性。"
    remediation: "若要通過 GP 建立建議的配置，請將以下UI路徑設置為啟用 : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\Default Protections for Internet Explorer 注意：此組策略路徑預設不存在。需要額外的組策略範本（ EMET.admx/adml ）- 它包含在 Microsoft Enhanced Mitigation Experience Toolkit (EMET) 中。"
    compliance:
      - cis: ["18.9.24.3"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38428-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Internet Explorer\iexplore.exe'

  - id: 15170
    title: "確保“流行軟體的預設保護”設定為“啟用”"
    description: "此設定可決定是否將建議的 EMET 緩解措施應用於以下流行軟體：7-Zip； Adobe Photoshop；福昕閱讀器;谷歌瀏覽器;谷歌談話； iTunes； Microsoft Live Writer；Microsoft Lync Communicator；Microsoft 相片庫；Microsoft SkyDrive； IRC；火狐瀏覽器; Mozilla 雷鳥； Opera；洋涇浜；QuickTime 播放器；真實玩家；蘋果瀏覽器; Skype；視訊LAN VLC； Winamp; Windows 即時郵件； Windows媒體播放器; WinRAR； WinZip。此設定的建議狀態為： Enabled 。"
    rationale: "將 EMET 緩解措施應用於流行的軟體包將有助於降低針對它們的漏洞的可靠性。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\Default Protections for Popular Software 注意: 此組策略路徑預設情況下不存在。需要額外的組策略模板 (EMET.admx/adml) - 該模板包含在 Microsoft 增強緩解經驗工具包（EMET）中。"
    compliance:
      - cis: ["18.9.24.4"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36750-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\7-Zip\7z.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\7-Zip\7zFM.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\7-Zip\7zG.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Adobe\Adobe Photoshop CS*\Photoshop.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Foxit Reader\Foxit Reader.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Google\Chrome\Application\chrome.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Google\Google Talk\googletalk.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\iTunes\iTunes.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Microsoft Lync\communicator.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\mIRC\mirc.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Mozilla Firefox\firefox.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Mozilla Firefox\plugin-container.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Mozilla Thunderbird\plugin-container.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Mozilla Thunderbird\thunderbird.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Opera\*\opera.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Opera\opera.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Pidgin\pidgin.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\QuickTime\QuickTimePlayer.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Real\RealPlayer\realconverter.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Real\RealPlayer\realplay.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Safari\Safari.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\SkyDrive\SkyDrive.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Skype\Phone\Skype.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\VideoLAN\VLC\vlc.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Winamp\winamp.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Windows Live\Mail\wlmail.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Windows Live\Photo Gallery\WLXPhotoGallery.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Windows Live\Writer\WindowsLiveWriter.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Windows Media Player\wmplayer.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\WinRAR\rar.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\WinRAR\unrar.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\WinRAR\winrar.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\WinZip\winzip32.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\WinZip\winzip64.exe'

  - id: 15171
    title: "確保“建議軟體的預設保護”設定為“已啟用”"
    description: "此設定確定是否將建議的 EMET 緩解措施應用於以下軟體：Adobe Acrobat； Adobe Acrobat 閱讀器； Microsoft Office 套件應用程式；甲骨文Java；寫字板。此設定的建議狀態為： Enabled 。"
    rationale: "將 EMET 緩解措施應用於建議的軟體將有助於降低針對這些軟體的攻擊的可靠性。"
    remediation: "要透過 GP 設定推薦的配置，將以下使用者介面路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\Default Protections for Recommended Software 注意: 此群組原則路徑預設不存在。需要額外的群組原則模板（EMET.admx/adml）- 它包含在 Microsoft Enhanced Mitigation Experience Toolkit (EMET) 中。"
    compliance:
      - cis: ["18.9.24.5"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36515-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Adobe\*\Reader\AcroRd32.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Adobe\Acrobat*\Acrobat\Acrobat.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Java\jre*\bin\java.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Java\jre*\bin\javaw.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Java\jre*\bin\javaws.exe'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\EXCEL.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\INFOPATH.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\LYNC.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\MSACCESS.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\MSPUB.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\OIS.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\OUTLOOK.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\POWERPNT.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\PPTVIEW.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\VISIO.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\VPREVIEW.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\OFFICE1*\WINWORD.EXE'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\Defaults -> *\Windows NT\Accessories\wordpad.exe'

  - id: 15172
    title: "確保“系統 ASLR”設定為“啟用：應用程式選擇加入”"
    description: "此設定決定應用程式如何註冊到地址空間佈局隨機化 (ASLR)。此設定的建議狀態為：啟用：應用程式選擇加入。"
    rationale: "ASLR 降低了程序記憶體的可預測性，這反過來又有助於降低針對記憶體損壞漏洞的利用的可靠性。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為已啟用：Application Opt-In :Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\System ASLR 注意：預設情況下不會存在此群組策略路徑。需要額外的群組策略模板（EMET.admx/adml）- 這包含在 Microsoft Enhanced Mitigation Experience Toolkit (EMET) 中。"
    compliance:
      - cis: ["18.9.24.6"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38437-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> ASLR -> 3'

  - id: 15173
    title: "確保“系統 DEP”設定為“啟用：應用程式選擇退出”"
    description: "此設定決定應用程式如何註冊到資料執行保護 (DEP)。此設定的建議狀態為：啟用：應用程式選擇退出。"
    rationale: "DEP 將應用程式記憶體頁面標記為不可執行，這會降低給定漏洞運行攻擊者控制的程式碼的能力。"
    remediation: "為了通過GP建立建議的配置，將以下UI路徑設置為啟用：Application Opt-Out : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\System DEP 注意：此組策略路徑預設不存在。需要額外的組策略模板 (EMET.admx/adml) - 它包含在Microsoft強化緩解體驗工具包(EMET)中。"
    compliance:
      - cis: ["18.9.24.7"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38438-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> DEP -> 2'

  - id: 15174
    title: "確保“系統 SEHOP”設定為“啟用：應用程式選擇退出”"
    description: "此設定決定應用程式如何註冊結構化異常處理程序覆蓋保護 (SEHOP)。此設定的建議狀態為：啟用：應用程式選擇退出。"
    rationale: "當軟體元件遭受記憶體損壞漏洞時，漏洞利用可能能夠覆蓋包含控制軟體如何處理異常的資料結構的記憶體。透過以受控方式破壞這些結構，漏洞利用程式可能能夠執行任意程式碼。 SEHOP 在使用這些結構處理異常之前驗證它們的完整性，這會降低利用結構化異常處理程序覆蓋的漏洞利用的可靠性。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為已啟用: Application Opt-Out : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\EMET\\System SEHOP 注意: 此群組策略路徑預設不存在，需要額外的群組策略模板 ( EMET.admx/adml ) - 這包含在Microsoft Enhanced Mitigation Experience Toolkit (EMET) 中。"
    compliance:
      - cis: ["18.9.24.7"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38438-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings -> SEHOP -> 2'

  - id: 15175
    title: "確保“應用程式：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Application\\Control Event Log behavior when the log file reaches its maximum size 注意：此群組原則路徑由群組原則範本 EventLog.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。注意 #2: 在舊的 Microsoft Windows 管理範本中，此設置最初名為 Retain old events，但從 Windows 8.0 和 Server 2012（非 R2）管理範本開始更名。"
    compliance:
      - cis: ["18.9.26.1.1"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37775-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> Retention -> 0'

  - id: 15176
    title: "確保“應用程式：指定最大日誌檔案大小 (KB)”設定為“啟用：32,768 或更大”"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為Enabled：32,768或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Application\\Specify the maximum log file size (KB) 注意：此組策略路徑由組策略模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。第二點注意：在較舊的Microsoft Windows管理模板中，此設置最初名為Maximum Log Size (KB)，但從Windows 8.0和Server 2012（非R2）管理模板開始重命名。"
    compliance:
      - cis: ["18.9.26.1.2"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37948-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> MaxSize -> n:^(\d+) compare >= 32768'

  - id: 15177
    title: "確保“安全性：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Security\\Control Event Log behavior when the log file reaches its maximum size 注意: 這條組策略路徑由組策略模板 EventLog.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。注意 #2: 在較舊的 Microsoft Windows 管理模板中，這個設置最初被命名為保留舊事件，但從 Windows 8.0 及 Server 2012 (非 R2) 管理模板開始，該設置被重新命名。"
    compliance:
      - cis: ["18.9.26.2.1"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37145-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> Retention -> 0'

  - id: 15178
    title: "確保“安全性：指定最大日誌檔案大小 (KB)”設定為“啟用：196,608 或更大”"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：196,608 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為啟用：196,608 或更高：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Security\\Specify the maximum log file size (KB) 注意：此群組原則路徑由群組原則範本 EventLog.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 行政模板中。注意 #2：在舊版的 Microsoft Windows 行政模板中，此設置最初名為 Maximum Log Size (KB)，從 Windows 8.0 和 Server 2012（非 R2）行政模板開始更名。"
    compliance:
      - cis: ["18.9.26.2.2"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37695-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> MaxSize -> n:^(\d+) compare >= 196608'

  - id: 15179
    title: "確保“設定：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Setup\\Control Event Log behavior when the log file reaches its maximum size 注意: 此群組原則路徑由群組原則模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。 注意#2: 在較舊的Microsoft Windows管理模板中，此設置最初名為Retain old events，但從Windows 8.0和Server 2012（非R2）管理模板開始更名。"
    compliance:
      - cis: ["18.9.26.3.1"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-38276-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> Retention -> 0'

  - id: 15180
    title: "確保“設定：指定最大日誌檔案大小 (KB)”設定為“啟用：32,768 或更大”"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過GP建立推薦設定，請將以下UI路徑設置為Enabled: 32,768或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Setup\\Specify the maximum log file size (KB) 注意：此群組原則路徑由群組原則模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows行政模板中。注意#2：在較舊的Microsoft Windows行政模板中，此設置最初命名為Maximum Log Size (KB)，但從Windows 8.0和Server 2012（非R2）行政模板開始改名。"
    compliance:
      - cis: ["18.9.26.3.2"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-37526-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> MaxSize -> n:^(\d+) compare >= 32768'

  - id: 15181
    title: "確保“系統：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過組策略建立推薦的配置，將以下路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\System\\Control Event Log behavior when the log file reaches its maximum size 注意：此組策略路徑由組策略模板 EventLog.admx/adml 提供，並包含在所有版本的 Microsoft Windows Administrative Templates 中。注意 #2：在舊版 Microsoft Windows Administrative Templates 中，此設置最初命名為保留舊事件，但從 Windows 8.0 和 Server 2012（非 R2）Administrative Templates 開始重命名為現在的名稱。"
    compliance:
      - cis: ["18.9.26.4.1"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-36160-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> Retention -> 0'

  - id: 15182
    title: "確保“系統：指定最大日誌檔案大小 (KB)”設定為“啟用：32,768 或更大”"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過GP設置推薦的配置，將以下UI路徑設置為Enabled: 32,768或更大: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\System\\Specify the maximum log file size (KB) 注意：此群組原則路徑由群組原則範本EventLog.admx/adml提供，該範本包含在所有版本的Microsoft Windows管理範本中。 注意#2：在較舊的Microsoft Windows管理範本中，此設置最初名為Maximum Log Size (KB)，但從Windows 8.0與Server 2012 (非R2)管理範本開始更名。"
    compliance:
      - cis: ["18.9.26.4.2"]
      - cis_csc: ["6.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    references:
      - "CCE-36092-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> MaxSize -> n:^(\d+) compare >= 32768'

  - id: 15183
    title: "確保“關閉資源管理器的資料執行保護”設定為“停用”"
    description: "停用資料執行保護可以允許某些舊插件應用程式在不終止資源管理器的情況下運作。此設定的建議狀態是：停用。"
    rationale: "資料執行保護是 Explorer 支援的重要安全功能，有助於限制某些類型惡意軟體的影響。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設定為「已停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off Data Execution Prevention for Explorer 注意: 此群組原則路徑可能預設不存在。它是由群組原則範本 Explorer.admx/adml 提供，包含在 Microsoft Windows 7 和 Server 2008 R2 行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.30.2"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37809-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoDataExecutionPrevention -> 0'

  - id: 15184
    title: "確保“關閉損壞時的堆終止”設定為“停用”"
    description: "此策略設定可讓您配置 shell 協定可以具有的功能量。當使用該協定的全部功能時，應用程式可以開啟資料夾並啟動檔案。保護模式減少了該協定的功能，允許應用程式僅開啟一組有限的資料夾。當處於保護模式時，應用程式無法使用此協定開啟檔案。建議將此協定保留在保護模式下，以提高 Windows 的安全性。此設定的建議狀態是：停用。"
    rationale: "將檔案和資料夾的開啟限制在有限的範圍內可以減少系統的攻擊面。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off shell protocol protected mode 注意：此群組原則路徑由群組原則範本 WindowsExplorer.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.30.3"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36660-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoHeapTerminationOnCorruption -> 0'

  - id: 15185
    title: "確保“關閉 shell 協定保護模式”設定為“停用”"
    description: "此策略設定可讓您配置 shell 協定可以具有的功能量。當使用該協定的全部功能時，應用程式可以開啟資料夾並啟動檔案。保護模式減少了該協定的功能，允許應用程式僅開啟一組有限的資料夾。當處於保護模式時，應用程式無法使用此協定開啟檔案。建議將此協定保留在保護模式下，以提高 Windows 的安全性。此設定的建議狀態是：停用。"
    rationale: "將檔案和資料夾的開啟限制在有限的範圍內可以減少系統的攻擊面。"
    remediation: "若要通過群組原則設定建議的配置，請將以下使用者介面路徑設置為 Disabled：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off shell protocol protected mode 注意：此群組原則路徑由群組原則模板 WindowsExplorer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.9.30.4"]
      - cis_csc: ["8.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36809-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> PreXPSP2ShellProtocolBehavior -> 0'

  # Section 18.9 - System

  # Section 18.9.39 - Location and Sensors
  - id: 15186
    title: "確保“關閉 Windows 位置提供者”設定為“啟用”"
    description: "此政策設定關閉電腦的 Windows 位置提供者功能。"
    rationale: "此設定會影響 Windows 位置提供者功能（例如 GPS 或其他位置追蹤）。"
    remediation: "要透過 GP 設定建議的配置，將以下的 UI 路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Location and Sensors\\Windows Location Provider\\Turn off Windows Location Provider."
    compliance:
      - cis: ["18.9.39.1.1"]
    references:
      - "CCE-38225-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableWindowsLocationProvider -> 1'

  - id: 15187
    title: "確保“關閉位置”設定為“啟用”"
    description: "此策略設定關閉電腦的位置功能。此設定的建議狀態為：已啟用。"
    rationale: "此設定會影響位置功能（例如 GPS 或其他位置追蹤）。從安全角度來看，在大多數情況下向軟體透露您的位置並不是一個好主意，但也有合法用途，例如地圖軟體。但是，它們不應該在高安全性環境中使用。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Location and Sensors\\Turn off location。注意：此群組原則路徑預設可能不存在。它是由群組原則範本Sensors.admx/adml提供，該範本是隨Microsoft Windows 7和Server 2008 R2行政範本（或更新版本）一起提供的。"
    compliance:
      - cis: ["18.9.39.2"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36886-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableLocation -> 1'

  - id: 15188
    title: "確保“阻止使用 OneDrive 進行檔案儲存”設定為“已啟用”"
    description: "此策略設定可讓你阻止應用程式和功能使用下一代同步客戶端處理 OneDrive 上的檔案。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可防止使用者使用新一代同步用戶端意外將機密或敏感的公司資訊上傳至 OneDrive 雲端服務。"
    remediation: "若要透過 GP 建立建議的配置, 將以下使用者介面路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\OneDrive\\Prevent the usage of OneDrive for file storage 注意：此群組原則路徑預設可能不存在。它是由群組原則範本 SkyDrive.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 及 Server 2012 R2 管理範本中（或更新）。然而，我們強烈建議您僅使用包含在 Microsoft Windows 10 1607 版及 Server 2016 管理範本中的版本（或更新）。舊版本的範本在 OneDrive 和 SkyDrive 的不同範本檔案中有衝突的設置，直到上述版本才徹底清理乾淨。注意 #2：在舊版 Microsoft Windows 管理範本中，此設置名為 Prevent the usage of SkyDrive for file storage，但從 Windows 10 RTM（1507 版）管理範本開始，它被重新命名。"
    compliance:
      - cis: ["18.9.52.1"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36939-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive -> DisableFileSyncNGSC -> 1'

  - id: 15189
    title: "確保“阻止在 Windows 8.1 上使用 OneDrive 進行檔案儲存”設定為“已啟用”"
    description: "此政策設定可讓你阻止應用程式和功能使用舊版 OneDrive/SkyDrive 用戶端處理 OneDrive 上的檔案。此設定的建議狀態為：已啟用。注意：儘管此設定的名稱如此，但它適用於任何 Windows 作業系統上的舊版 OneDrive 用戶端。"
    rationale: "啟用此設定可防止使用者使用舊版 OneDrive/SkyDrive 用戶端意外將機密或敏感公司資訊上傳至 OneDrive 雲端服務。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\OneDrive\\Prevent the usage of OneDrive for file storage on Windows 8.1 注意: 此群組政策路徑預設情況下可能不存在。它由群組政策模板 SkyDrive.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (或更新版本) 中。我們強烈建議您僅使用該版本的模板或更新版本。在上述版本之前的模板中，不同模板檔案中的 OneDrive 和 SkyDrive 設置存在衝突，直到在上述版本中得到了妥善清理。"
    compliance:
      - cis: ["18.9.52.2"]
      - cis_csc: ["13"]
      - pci_dss: ["12.3.8"]
    references:
      - "CCE-36939-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Onedrive -> DisableFileSync -> 1'

  - id: 15190
    title: "確保“不允許儲存密碼”設定為“啟用”"
    description: "此政策設定有助於防止遠端桌面用戶端在電腦上保存密碼。此設定的建議狀態為：已啟用。注意：如果此政策設定之前配置為“已停用”或“未配置”，則遠端桌面用戶端第一次與任何伺服器斷開連接時，先前儲存的任何密碼都將被刪除。"
    rationale: "能夠實際存取電腦的攻擊者可能能夠破壞保存密碼的保護。危害使用者帳戶並連接到其電腦的攻擊者可以使用已儲存的密碼來存取其他主機。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Connection Client\\Do not allow passwords to be saved 注意: 此群組原則路徑是由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.58.2.2"]
      - cis_csc: ["16.4"]
      - pci_dss: ["12.3.8"]
    references:
      - "CCE-36223-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DisablePasswordSaving -> 1'

  - id: 15191
    title: "確保“將遠端桌面服務使用者限制為單一遠端桌面服務會話”設定為“已啟用”"
    description: "此策略設定可讓您將使用者限制為單一遠端桌面服務會話。此設定的建議狀態為：已啟用。"
    rationale: "此設定可確保透過遠端桌面連接到伺服器的使用者和管理員將繼續使用相同會話 - 如果他們斷開連接並重新連接，他們將返回到先前使用的相同會話，從而防止建立第二個同時會話。這既可以透過讓伺服器託管不必要的額外會話（這會為伺服器帶來額外的負載）來防止不必要的資源使用，也可以確保使用者體驗的一致性。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Connections\\Restrict Remote Desktop Services users to a single Remote Desktop Services session。注意：此群組原則路徑由 Group Policy 模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。注意 #2：在較早的 Microsoft Windows Administrative Templates 中，該設置被命名為限制 Terminal Services 用戶到單一遠端會話，但從 Windows 7 和 Server 2008 R2 開始改名為限制遠端桌面服務用戶到單一遠端桌面服務會話。"
    compliance:
      - cis: ["18.9.58.3.2.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37708-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fSingleSessionPerUser -> 1'

  - id: 15192
    title: "確保“不允許 COM 連接埠重新導向”設定為“已啟用”"
    description: "此原則設定指定是否阻止在遠端桌面服務工作階段中將資料從遠端電腦重新導向至用戶端 COM 連接埠。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 COM 連接埠重新導向，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    remediation: "若要透過GP建立推薦配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow COM port redirection。注意：此群組原則路徑是由群組原則模板TerminalServer.admx/adml提供的，並包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.58.3.3.1"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37696-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCcm -> 1'

  - id: 15193
    title: "確保“不允許磁碟機重新導向”設定為“已啟用”"
    description: "此策略設定阻止使用者將其用戶端電腦上的本機磁碟機共用給他們存取的遠端桌面伺服器。對應的驅動器以以下格式顯示在Windows 資源管理器的會話資料夾樹中： \\\\TSClient\\<driveletter>$ 如果共用本機磁碟機，則它們很容易受到想要利用其上儲存的資料的入侵者的攻擊。此設定的建議狀態為：已啟用。"
    rationale: "資料可以從使用者的遠端桌面服務會話轉發到使用者的本機計算機，而無需任何直接的使用者互動。已存在於受感染伺服器上的惡意軟體將在遠端桌面會話期間對使用者的本機電腦進行直接且隱密的磁碟存取。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow drive redirection 注意: 此群組原則路徑由包含在所有版本Microsoft Windows管理模板中的群組原則模板TerminalServer.admx/adml提供。"
    compliance:
      - cis: ["18.9.58.3.3.2"]
      - cis_csc: ["13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36509-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCdm -> 1'

  - id: 15194
    title: "確保“不允許 LPT 連接埠重新導向”設定為“已啟用”"
    description: "此策略設定指定是否阻止在遠端桌面服務工作階段期間將資料重新導向至用戶端 LPT 連接埠。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 LPT 連接埠重新導向，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    remediation: "若要透過 GP 建立推薦設定，請將以下使用者介面路徑設定為 已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow LPT port redirection。注意：此群組原則路徑由群組原則範本 TerminalServer.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.58.3.3.3"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37778-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLPT -> 1'

  - id: 15195
    title: "確保“不允許支援的即插即用裝置重新導向”設定為“已啟用”"
    description: "此策略設定可讓您控制將受支援的即插即用裝置（例如 Windows 可攜式裝置）重新導向至遠端桌面服務工作階段中的遠端電腦。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中對即插即用裝置重新導向的需求非常少，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    remediation: "要透過GP設立推薦的配置，請將以下UI路徑設置為Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow supported Plug and Play device redirection. 注意：此群組原則路徑由群組原則模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows行政模板中。"
    compliance:
      - cis: ["18.9.58.3.3.4"]
      - cis_csc: ["9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37477-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisablePNPRedir -> 1'

  - id: 15196
    title: "確保“連接時始終提示輸入密碼”設定為“啟用”"
    description: "此原則設定指定遠端桌面服務是否始終在連線時提示用戶端電腦輸入密碼。您可以使用此原則設定強制要求登入遠端桌面服務的使用者輸入密碼，即使他們已經在遠端桌面連線用戶端中提供了密碼。此設定的建議狀態為：已啟用。"
    rationale: "使用者在建立新的遠端桌面連線捷徑時可以選擇儲存其使用者名稱和密碼。如果執行遠端桌面服務的伺服器允許使用此功能的使用者登入伺服器但不輸入密碼，則獲得使用者電腦實體存取權限的攻擊者可能會連接到遠端桌面伺服器透過遠端桌面連線捷徑，即使他們可能不知道用戶的密碼。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Always prompt for password upon connection 注意: 此群組原則路徑由 Group Policy 模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。注意#2: 在 Microsoft Windows Vista Administrative Templates 中，此設置名為 Always prompt client for password upon connection，但從 Windows Server 2008（非 R2）開始更名。"
    compliance:
      - cis: ["18.9.58.3.9.1"]
      - cis_csc: ["16.14"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37929-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fPromptForPassword -> 1'

  - id: 15197
    title: "確保“需要安全 RPC 通訊”設定為“已啟用”"
    description: "此策略設定可讓您指定遠端桌面服務是需要與所有用戶端進行安全遠端程序呼叫 (RPC) 通訊還是允許不安全的通訊。您可以使用此策略設定僅允許經過驗證和加密的請求來增強與用戶端的 RPC 通訊的安全性。此設定的建議狀態為：已啟用。"
    rationale: "允許不安全的 RPC 通訊可能會使伺服器遭受中間人攻擊和資料外洩攻擊。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require secure RPC communication 注意：此群組原則路徑由群組原則模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows行政模板中。"
    compliance:
      - cis: ["18.9.58.3.9.2"]
      - cis_csc: ["3.4"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37567-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fEncryptRPCTraffic -> 1'

  - id: 15198
    title: "確保“設定客戶端連線加密等級”設定為“啟用：高等級”"
    description: "此策略設定指定是否需要使用特定的加密等級來保護遠端桌面協定 (RDP) 連線期間用戶端電腦和 RD 會話主機伺服器之間的通訊。此策略僅在您使用本機 RDP 加密時適用。但是，不建議使用本機 RDP 加密（而不是 SSL 加密）。此策略不適用於 SSL 加密。此設定的建議狀態為： 啟用：高等級。"
    rationale: "如果允許使用低階加密的遠端桌面用戶端連接，則攻擊者更有可能解密任何捕獲的遠端桌面服務網路流量。"
    remediation: "要透過GP建立建議配置，將以下UI路徑設定為啟用：高級別：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Set client connection encryption level 注意：此群組原則路徑由群組原則模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.58.3.9.3"]
      - cis_csc: ["3.4"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36627-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MinEncryptionLevel -> 3'

  - id: 15199
    title: "確保“為活動但空閒的遠端桌面服務會話設定時間限制”設定為“啟用：15 分鐘或更短”"
    description: "此策略設定可讓您指定活動遠端桌面服務工作階段在自動中斷連線之前可以空閒（無需使用者輸入）的最長時間。此設定的建議狀態為： 啟用：15 分鐘或更短。"
    rationale: "此設定有助於防止活動的遠端桌面會話在不使用時長時間佔用計算機，從而防止大量不活動的會話消耗計算資源。此外，如果使用者的密碼已更改但舊會話仍在運行，則舊的、被遺忘的遠端桌面會話仍然處於活動狀態，可能會導緻密碼鎖定。對於限制連接使用者數量的系統（例如，預設管理模式下的伺服器 - 僅 2 個會話），其他使用者的舊但仍處於活動狀態的會話可能會阻止其他使用者連接，從而導致有效的拒絕服務。"
    remediation: "要透過GP設置推薦配置，請將以下UI路徑設為已啟用：15分鐘或更少：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for active but idle Remote Desktop Services sessions。注意：此群組原則路徑由群組原則模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。注意#2：在舊版Microsoft Windows管理模板中，此設置名稱為Set time limit for active but idle Terminal Services sessions，但從Windows 7和Server 2008 R2管理模板開始已重新命名。"
    compliance:
      - cis: ["18.9.58.3.10.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37562-6"
      - https://workbench.cisecurity.org/benchmarks/766
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime -> n:^(\d+) compare <= 900000'

  - id: 15200
    title: "確保“為斷開連線的會話設定時間限制”設定為“啟用：1 分鐘”"
    description: "此策略設定可讓您設定斷開連線的遠端桌面服務工作階段的時間限制。此設定的建議狀態為： 啟用：1 分鐘。"
    rationale: "此設定有助於防止活動的遠端桌面會話在不使用時長時間佔用計算機，從而防止大量已斷開連接但仍處於活動狀態的會話消耗計算資源。此外，如果使用者的密碼已更改但舊會話仍在運行，則舊的、被遺忘的遠端桌面會話仍然處於活動狀態，可能會導緻密碼鎖定。對於限制連接使用者數量的系統（例如，預設管理模式下的伺服器 - 僅 2 個會話），其他使用者的舊但仍處於活動狀態的會話可能會阻止其他使用者連接，從而導致有效的拒絕服務。此設定對於確保正確終止斷開連線的會話非常重要。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Enabled：1 minute: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for disconnected sessions. 注意：此群組政策路徑由群組政策模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.9.58.3.10.2"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-37949-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxDisconnectionTime -> 60000'

  - id: 15201
    title: "確保“退出時不刪除臨時資料夾”設定為“停用”"
    description: "此策略設定指定遠端桌面服務是否在登出時保留使用者的每個會話暫存資料夾。此設定的建議狀態是：停用。"
    rationale: "敏感資訊可能包含在臨時資料夾內，並且對登入系統的其他管理員可見。"
    remediation: "要通過群組原則建立建議的配置，請設置以下用戶界面路徑為已停用： Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Temporary Folders\\Do not delete temp folders upon exit 注意：此群組原則路徑由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。 注意 #2：在舊版 Microsoft Windows 管理模板中，此設置名稱為 「Do not delete temp folder upon exit」，但從 Windows 8.0 & Server 2012 (非 R2) 管理模板開始，它被重新命名。"
    compliance:
      - cis: ["18.9.58.3.11.1"]
      - cis_csc: ["14.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37946-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DeleteTempDirsOnExit -> 1'

  - id: 15202
    title: "確保“不要在每個會話中使用臨時資料夾”設定為“停用”"
    description: "預設情況下，遠端桌面服務會在 RD 會話主機伺服器上為使用者在 RD 會話主機伺服器上維護的每個活動會話建立一個單獨的臨時資料夾。臨時資料夾是在 RD 會話主機伺服器上使用者設定檔資料夾下的 Temp 資料夾中建立的，並以 sessionid 命名。此臨時資料夾用於儲存各個臨時檔案。為了回收磁碟空間，當使用者從會話註銷時，臨時資料夾將被刪除。此設定的建議狀態是：停用。"
    rationale: "停用此設定可使快取資料獨立於每個會話，既減少了會話之間共享快取資料出現問題的可能性，也使可能的敏感資料與每個使用者會話分開。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Temporary Folders\\Do not use temporary folders per session 注意：此群組政策路徑由群組政策範本 TerminalServer.admx/adml 提供，並包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.58.3.11.2"]
      - cis_csc: ["14.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-38180-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> PerSessionTempDir -> 1'

  - id: 15203
    title: "確保“阻止下載附件”設定為“啟用”"
    description: "此策略設定可阻止使用者將附件（檔案附件）從 RSS 來源下載到使用者的電腦。此設定的建議狀態為：已啟用。"
    rationale: "允許透過 RSS 來源下載附件可能會引入可能具有惡意目的的檔案。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\RSS Feeds\\Prevent downloading of enclosures 注意：此組策略路徑由InetRes.admx/adml提供，該模板包含在所有版本的Microsoft Windows行政模板中。注意 #2：在較舊的Microsoft Windows行政模板中，此設置名為Turn off downloading of enclosures，但從Windows 8.0 & Server 2012 (non-R2)行政模板開始，此設置被重命名。"
    compliance:
      - cis: ["18.9.59.1"]
      - cis_csc: ["7.2"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-37126-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds -> DisableEnclosureDownload -> 1'

  - id: 15204
    title: "確保“允許加密檔案索引”設定為“停用”"
    description: "此策略設定控制是否允許對加密項目建立索引。更改此設定後，索引將完全重建。索引位置必須使用全磁碟區加密（例如 BitLocker 磁碟機加密或非 Microsoft 解決方案），以維護加密檔案的安全性。此設定的建議狀態是：停用。"
    rationale: "建立索引並允許用戶搜尋加密檔案可能會洩露加密檔案中儲存的機密資料。"
    remediation: "若要透過 GP 設定建議的配置，請將以下的 UI 路徑設置為「已停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow indexing of encrypted files 注意: 此群組原則路徑是由群組原則範本 Search.admx/adml 提供，此範本包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.60.2"]
      - cis_csc: ["13.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-38277-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowIndexingEncryptedStoresOrItems -> 0'

  - id: 15205
    title: "確保“設定在搜尋中共享哪些資訊”設定為“啟用：匿名資訊”"
    description: "可以與 Bing 搜尋分享各種級別的資訊，包括使用者資訊和位置。配置此設定可防止使用者選擇共享資訊的等級並啟用最嚴格的選擇。此設定的建議狀態為： 啟用：匿名資訊。"
    rationale: "限制與 Microsoft Bing 共享的搜尋資訊可以增強隱私和安全性。"
    remediation: "要透過群組政策(GP)建立建議的配置，請將以下使用者介面路徑設置為啟用: 匿名資訊: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Set what information is shared in Search. 注意: 此群組政策路徑可能在預設情況下不存在。它是由群組政策範本Search.admx/adml提供，該範本包含在Microsoft Windows 8.1和Server 2012 R2管理範本（或更高版本）中。"
    compliance:
      - cis: ["18.9.60.3"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36937-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> ConnectedSearchPrivacy -> 3'

  - id: 15206
    title: "確保“關閉 KMS 用戶端線上 AVS 驗證”設定為“啟用”"
    description: "金鑰管理服務 (KMS) 是一種 Microsoft 授權啟動方法，需要設定本機伺服器來儲存軟體授權。 KMS 伺服器本身需要連接到 Microsoft 來啟動 KMS 服務，但後續的網路用戶端可以透過 KMS 伺服器啟動 Microsoft Windows 作業系統和/或其 Microsoft Office，而不是直接連接到 Microsoft。此政策設定可讓您選擇不自動向 Microsoft 傳送 KMS 用戶端啟動資料。此設定的建議狀態為：已啟用。"
    rationale: "儘管 KMS 授權方法不需要 KMS 用戶端連線到 Microsoft，但它們仍然會自動向 Microsoft 發送 KMS 用戶端啟動狀態資料。阻止發送此資訊有助於減少高安全環境中的隱私問題。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Software Protection Platform\\Turn off KMS Client Online AVS Validation. 注意: 此群組原則路徑預設情況下可能不存在。它由群組原則模板AVSValidationGP.admx/adml提供，該模板包含在Microsoft Windows 10 RTM (版本1507) 管理模板中 (或更新版本)。"
    compliance:
      - cis: ["18.9.65.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform -> NoGenTicket -> 1'

  # Section - 18.9.76.9 - Reporting

  - id: 15207
    title: "確保“配置本機設定覆蓋以向 Microsoft MAPS 報告”設定為“停用”"
    description: '此原則設定為加入 Microsoft Active Protection Service (MAPS) 的設定配置本機覆蓋，Microsoft 現在已將其重新命名為「Windows Defender 防毒雲端保護服務」。此設定只能透過群組原則進行設定。此設定的建議狀態為：Disabled。'
    rationale: "應在企業託管環境中集中決定是否參與 Microsoft MAPS / Windows Defender 防毒雲保護服務以進行惡意軟體報告，以便其中的所有電腦在這方面表現一致。將此設定配置為「停用」可確保決策保持集中管理。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為 Disabled : Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\MAPS\\Configure local setting override for reporting to Microsoft MAPS 注意：此群組策略路徑可能預設不存在。它是由群組策略模板 WindowsDefender.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.76.3.1"]
      - cis_csc: ["8"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36940-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> LocalSettingOverrideSpynetReporting -> 0'

  - id: 15208
    title: "確保“加入 Microsoft MAPS”設定為“停用”"
    description: "此原則設定可讓你加入 Microsoft Active Protection Service (MAPS)，Microsoft 現在已將其重新命名為「Windows Defender 防毒雲端保護服務」。 Microsoft MAPS / Windows Defender 防毒雲端保護服務是一個線上社群，可協助您選擇如何應對潛在威脅。該社群還幫助阻止新的惡意軟體感染的傳播。您可以選擇發送有關檢測到的軟體的基本或附加資訊。其他資訊可協助 Microsoft 建立新定義並協助其保護您的電腦。可能的選項有： - (0x0) 停用（預設） - (0x1) 基本會員資格- (0x2) 高級會員資格基本會員資格將向Microsoft 發送有關已檢測到的軟體的基本訊息，包括該軟體來自您應用或執行的操作的位置。除了基本資訊之外，高級會員資格還會向 Microsoft 發送有關惡意軟體、間諜軟體和潛在有害軟體的更多資訊，包括軟體檔案的位置、軟體的運作方式以及它如何影響您的電腦。此設定的建議狀態是：停用。"
    rationale: "如果刪除了有害軟體，將傳送的訊息可能包括電腦上偵測到的項目的位置等資訊。資訊將自動收集和發送。在某些情況下，個人資訊可能會無意中傳送給 Microsoft。但是，Microsoft 聲明不會使用此資訊來識別您的身分或與您聯絡。出於高安全環境中的隱私原因，最好完全阻止這些資料提交。"
    remediation: "若要透過GP建立推薦的配置，請將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\MAPS\\Join Microsoft MAPS。注意：此群組策略路徑預設情況下可能不存在。它由群組策略模板WindowsDefender.admx/adml提供，此模板包含在Microsoft Windows 8.1 & Server 2012 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.76.3.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> SpynetReporting'

  - id: 15209
    title: "確保“開啟行為監控”設定為“已啟用”"
    description: "此策略設定可讓你設定 Windows Defender 防毒的行為監控。此設定的建議狀態為： Enabled 。"
    rationale: "在執行 Windows Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    remediation: "要透過 GP 建立推薦配置，將以下 UI 路徑設定為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Real-Time Protection\\Turn on behavior monitoring 注意：此群組原則路徑預設情況下可能不存在。它由群組原則範本 WindowsDefender.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 & Server 2012 R2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.76.7.1"]
      - cis_csc: ["8.1"]
      - pci_dss: ["5.2"]
    references:
      - "CCE-38389-3"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection -> DisableBehaviorMonitoring -> 0'

  - id: 15210
    title: "確保“配置 Watson 事件”設定為“已停用”"
    description: "此策略設定可讓您設定是否傳送 Watson 事件。"
    rationale: "Watson 事件是當程式或服務當機或失敗時發送給 Microsoft 的報告，包括自動提交的可能性。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為“已禁用”：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Reporting\\Configure Watson events."
    compliance:
      - cis: ["18.9.76.9.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-36950-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting -> DisableGenericRePorts -> 1'

  - id: 15211
    title: "確保“掃描可移動磁碟機”設定為“已啟用”"
    description: "此策略設定可讓您管理在執行完整掃描時是否掃描可移動磁碟機（例如 USB 隨身碟）內容中的惡意軟體和不需要的軟體。此設定的建議狀態為： Enabled 。"
    rationale: "確保任何現有的可移動磁碟機始終包含在任何類型的掃描中非常重要，因為可移動磁碟機更有可能包含從外部非託管電腦引入企業託管環境的惡意軟體。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Scan\\Scan removable drives 注意：此組策略路徑預設情況下可能不存在。它由組策略模板WindowsDefender.admx/adml提供，該模板包含在Microsoft Windows 8.1和Server 2012 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.76.10.1"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-38409-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableRemovableDriveScanning -> 0'

  - id: 15212
    title: "確保“開啟電子郵件掃描”設定為“已啟用”"
    description: "此策略設定可讓您設定電子郵件掃描。啟用電子郵件掃描時，引擎將根據特定格式解析郵箱和郵件檔案，以分析郵件正文和附件。目前支援多種電子郵件格式，例如：pst (Outlook)、dbx、mbx、mime (Outlook Express)、binhex (Mac)。此設定的建議狀態為： Enabled 。"
    rationale: "應使用 Windows Defender Antivirus 等防毒解決方案掃描傳入的電子郵件，因為電子郵件附件是惡意軟體滲透電腦的常用攻擊媒介。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Scan\\Turn on e-mail scanning 注意：此群組策略路徑預設可能不存在。它是由包含在Microsoft Windows 8.1和Server 2012 R2管理模板（或更新版本）中的群組策略模板WindowsDefender.admx/adml提供的。"
    compliance:
      - cis: ["18.9.76.10.2"]
      - cis_csc: ["13"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-36958-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableEmailScanning -> 0'

  - id: 15213
    title: "確保“關閉 Windows Defender 防毒”設定為“停用”"
    description: "此政策設定會關閉 Windows Defender 防毒功能。如果該設定配置為“停用”，Windows Defender 防毒軟體將運行並掃描電腦是否存在惡意軟體和其他可能不需要的軟體。此設定的建議狀態為：Disabled。"
    rationale: "確保最新的、更新的防毒產品掃描每台電腦是否有惡意檔案活動非常重要。 Microsoft 在 Windows Defender 防毒中提供了開箱即用的有效解決方案。選擇購買信譽良好的第三方防毒解決方案的組織可以選擇免除此建議，而不是商業替代方案。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為Disabled：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Turn off Windows Defender AntiVirus 注意：該組策略路徑由Group Policy模板WindowsDefender.admx/adml提供，該模板包含在所有版本的Microsoft Windows Administratives Templates中。 注意#2：在較舊的Microsoft Windows Administrative Templates中，此設置最初名為Turn off Windows Defender，但從Windows 10 Release 1703 Administrative Templates開始重命名。"
    compliance:
      - cis: ["18.9.76.14"]
      - cis_csc: ["8.1"]
      - pci_dss: ["5.2"]
      - tsc: ["CC6.8"]
    references:
      - "CCE-36082-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> DisableAntiSpyware -> 0'

  - id: 15214
    title: "確保“配置 Windows Defender SmartScreen”設定為“啟用：警告並防止繞過”"
    description: "此策略設定可讓您管理 Windows SmartScreen 的行為。 Windows SmartScreen 透過在執行從 Internet 下載的無法識別的程式之前向使用者發出警告，幫助保持電腦更安全。一些有關啟用此功能的 PC 上運行的檔案和程式的資訊將發送給 Microsoft。此設定的建議狀態為： 啟用：警告並防止繞過。"
    rationale: "Windows SmartScreen 透過在執行從 Internet 下載的無法識別的程式之前向使用者發出警告，幫助保持電腦更安全。但是，由於一些有關 PC 上運行的檔案和程式的資訊會發送給 Microsoft，因此一些組織可能更願意停用它。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設置為啟用：警告並防止繞過：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Explorer\\Configure Windows Defender SmartScreen 注意：此群組策略路徑預設可能不存在。它由群組策略模板 WindowsExplorer.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 及 Server 2012（非 R2）管理模板（或更新版本）中。注意 #2：在較舊的 Microsoft Windows 管理模板中，此設置最初被命名為 Configure Windows SmartScreen，但從 Windows 10 1703 版管理模板開始重新命名。"
    compliance:
      - cis: ["18.9.80.1.1"]
      - cis_csc: ["2"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    references:
      - "CCE-35859-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableSmartScreen -> 2'

  - id: 15215
    title: "確保“配置預設同意”設定為“啟用：發送資料前始終詢問”"
    description: "此設定可讓您設定錯誤報告的預設同意處理。此設定的建議狀態為： 啟用：發送資料之前始終詢問。"
    rationale: "錯誤報告可能包含敏感訊息，不應自動發送給任何人。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為啟用: 發送資料前一律詢問: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Error Reporting\\Consent\\Configure Default consent 注意: 此群組原則路徑由Microsoft Windows管理模板中所有版本包含的群組原則模板ErrorReporting.admx/adml提供。"
    compliance:
      - cis: ["18.9.81.2.1"]
      - cis_csc: ["13"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-37112-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting\Consent -> DefaultConsent -> 1'

  - id: 15216
    title: "確保“自動發送作業系統產生的錯誤報告的記憶體轉儲”設定為“停用”"
    description: "此策略設定控制是否可以將支援作業系統產生的錯誤報告的記憶體轉儲自動傳送給 Microsoft。此策略不適用於第 3 方產品產生的錯誤報告或記憶體轉儲以外的其他資料。此設定的建議狀態是：停用。"
    rationale: "記憶體轉儲可能包含敏感訊息，不應自動發送給任何人。"
    remediation: "要通過組策略設置推薦配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Error Reporting\\Automatically send memory dumps for OS- generated error reports 注意: 此組策略路徑預設可能不存在。它由組策略模板ErrorReporting.admx/adml提供，該模板包含在Microsoft Windows 8.1和Server 2012 R2的管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.81.3"]
      - cis_csc: ["13"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36978-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> AutoApproveOSDumps -> 0'

  - id: 15217
    title: "確保“允許使用者控制安裝”設定為“停用”"
    description: "此設定控制是否允許使用者更改通常僅系統管理員可用的安裝選項。 Windows Installer 的安全功能通常會阻止使用者變更通常為系統管理員保留的安裝選項，例如指定檔案的安裝目錄。如果 Windows Installer 偵測到安裝套件允許使用者變更受保護的選項，它將停止安裝並顯示一則訊息。只有當安裝程式在特權安全上下文中執行時，這些安全功能才會起作用，在特權安全性上下文中，安裝程式有權存取使用者拒絕的目錄。此設定的建議狀態是：停用。"
    rationale: "在企業管理的環境中，只有具有管理權限的 IT 人員才能在系統上安裝或變更軟體。允許使用者對安裝進行任何控制可能會帶來未經批准的軟體被安裝或從系統中刪除的風險，這可能會導致系統容易受到損害。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為 Disabled：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Allow user control over installs 注意：此群組原則路徑由包含於所有版本的 Microsoft Windows Administrative Templates 的群組原則範本 MSI.admx/adml 提供。注意#2：在舊版的 Microsoft Windows Administrative Templates 中，此設定為 Enable user control over installs，但從 Windows 8.0 和 Server 2012 (非 R2) 行政範本開始就被重新命名。"
    compliance:
      - cis: ["18.9.85.1"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36400-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> EnableUserControl -> 0'

  - id: 15218
    title: "確保“始終使用提升的權限安裝”設定為“停用”"
    description: "此設定控制 Windows Installer 在系統上安裝任何程式時是否應使用系統權限。注意：此設定同時出現在「電腦設定」和「使用者設定」資料夾中。若要使此設定生效，您必須在兩個資料夾中啟用該設定。注意：如果啟用，熟練用戶可以利用此設定授予的權限來更改其權限並獲得對受限檔案和資料夾的永久存取權限。請注意，不保證此設定的使用者配置版本的安全性。此設定的建議狀態是：停用。"
    rationale: "權限有限的使用者可以透過建立 Windows Installer 安裝套件來利用此功能，該安裝套件會建立屬於本機內建管理員群組的新本機帳戶、將其目前帳戶新增至本機內建管理員群組、安裝惡意軟體，或進行其他未經授權的活動。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Always install with elevated privileges 注意：此群組原則路徑是由所有版本的 Microsoft Windows 管理範本中包含的群組原則範本 MSI.admx/adml 提供的。"
    compliance:
      - cis: ["18.9.85.2"]
      - cis_csc: ["5.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    references:
      - "CCE-36919-9"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> AlwaysInstallElevated -> 0'

  - id: 15219
    title: "確保“封鎖 Windows Installer 腳本的 Internet Explorer 安全性提示”設定為“停用”"
    description: "此策略設定控制是否允許基於 Web 的程式在電腦上安裝軟體而不通知使用者。此設定的建議狀態是：停用。"
    rationale: "抑制系統警告可能會帶來安全風險並增加系統的攻擊面。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設置為已停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Prevent Internet Explorer security prompt for Windows Installer scripts。注意：此群組原則路徑是由隨所有版本的 Microsoft Windows 管理模板一起包含的 Group Policy 模板 MSI.admx/adml 提供。注意#2：在較舊的 Microsoft Windows 管理模板中，此設置最初命名為 Disable IE security prompt for Windows Installer scripts，但從 Windows 8.0 和 Server 2012 (non-R2) 管理模板開始重命名。"
    compliance:
      - cis: ["18.9.85.3"]
      - cis_csc: ["7"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - "CCE-37524-6"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> SafeForScripting -> 0'

  - id: 15220
    title: "確保“系統啟動的重新啟動後自動登入最後一個互動式使用者”設定為“停用”"
    description: "此策略設定控制 Windows 更新重新啟動系統後裝置是否自動登入最後一個互動式使用者。此設定的建議狀態是：停用。"
    rationale: "停用此功能將防止快取使用者憑證和未經授權使用設備，並確保使用者知道重新啟動。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Logon Options\\Sign-in last interactive user automatically after a system-initiated restart 注意: 此Group Policy路徑預設可能不存在。它由Group Policy模板WinLogon.admx/adml提供，該模板包含在Microsoft Windows 8.1 & Server 2012 R2管理模板（或更新）中。"
    compliance:
      - cis: ["18.9.86.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["8.6"]
      - tsc: ["CC6.1"]
    references:
      - "CCE-36977-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableAutomaticRestartSignOn -> 1'

  - id: 15221
    title: "確保“開啟 PowerShell 腳本區塊日誌記錄”設定為“停用”"
    description: "此原則設定允許將所有 PowerShell 腳本輸入記錄到 Microsoft-Windows-PowerShell/操作事件日誌中。此設定的建議狀態是：停用。注意：在 Microsoft 自己的強化指南中，他們建議使用相反的值“啟用”，因為記錄此資料可以改進對 PowerShell 攻擊事件的調查。但是，PowerShell 操作日誌上的預設 ACL 允許互動式使用者（即任何登入使用者）讀取它，因此可能會將密碼或其他敏感資訊暴露給未經授權的使用者。如果 Microsoft 將來鎖定該日誌的預設 ACL（例如，僅將其限制為管理員），那麼我們將在未來版本中重新考慮此建議。"
    rationale: "在 PowerShell 日誌中擷取密碼存在潛在風險。此設定僅用於除錯目的，而不是在正常操作中，確保將其設定為“禁用”非常重要。"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Script Block Logging 注意: 此組策略路徑預設可能不存在。它由隨Microsoft Windows 10 RTM（版本1507）管理模板（或更新版本）附帶的組策略模板PowerShellExecutionPolicy.admx/adml提供。"
    compliance:
      - cis: ["18.9.95.1"]
      - cis_csc: ["16.4"]
      - pci_dss: ["12.3.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging -> EnableScriptBlockLogging -> 0'

  - id: 15222
    title: "確保“開啟 PowerShell 轉錄”設定為“停用”"
    description: "此策略設定可讓您將 Windows PowerShell 指令的輸入和輸出擷取到基於文字的記錄中。此設定的建議狀態是：停用。"
    rationale: "如果啟用此設置，則存在密碼可能以純文字形式儲存在 PowerShell_transcript 輸出檔案中的風險。"
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Transcription 注意: 此群組原則路徑預設可能不存在。它是由群組原則模板 PowerShellExecutionPolicy.admx/adml 提供，該模板包含在 Microsoft Windows 10 RTM (版本 1507) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.95.2"]
      - cis_csc: ["16.4"]
      - pci_dss: ["12.3.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription -> EnableTranscripting -> 0'

  - id: 15223
    title: "確保“允許基本身份驗證”設定為“停用”"
    description: "此原則設定可讓您管理 Windows 遠端管理 (WinRM) 用戶端是否使用基本驗證。此設定的建議狀態是：停用。"
    rationale: "基本身份驗證不如 WinRM 中提供的其他身份驗證方法可靠，因為包括密碼在內的憑證以純文字形式傳輸。能夠捕獲執行 WinRM 的網路上的資料包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Allow Basic authentication 注意：此組策略路徑由組策略模板WindowsRemoteManagement.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.97.1.1"]
      - cis_csc: ["16.13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36310-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowBasic -> 0'

  - id: 15224
    title: "確保“允許未加密的流量”設定為“停用”"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 用戶端是否透過網路傳送和接收未加密的訊息。此設定的建議狀態是：停用。"
    rationale: "對 WinRM 網路流量進行加密可降低攻擊者在 WinRM 訊息透過網路傳輸時查看或修改 WinRM 訊息的風險。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Allow unencrypted traffic 注意: 此群組原則路徑由群組原則模板 WindowsRemoteManagement.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.97.1.2"]
      - cis_csc: ["16.13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37726-7"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowUnencryptedTraffic -> 0'

  - id: 15225
    title: "確保“禁止摘要式身份驗證”設定為“啟用”"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 用戶端是否不使用摘要式驗證。此設定的建議狀態為：已啟用。"
    rationale: "摘要式驗證的穩健性不如 WinRM 中可用的其他驗證方法，能夠擷取執行 WinRM 的網路上的封包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    remediation: "要透過 GP 建立建議配置，請將以下使用者介面路徑設置為“啟用”：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Disallow Digest authentication 注意：此群組原則路徑由群組原則範本 WindowsRemoteManagement.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.97.1.3"]
      - cis_csc: ["16.13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-38318-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowDigest -> 0'

  - id: 15226
    title: "確保“允許基本身份驗證”設定為“停用”"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否接受來自遠端用戶端的基本驗證。此設定的建議狀態是：停用。"
    rationale: "基本身份驗證不如 WinRM 中提供的其他身份驗證方法可靠，因為包括密碼在內的憑證以純文字形式傳輸。能夠捕獲執行 WinRM 的網路上的資料包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    remediation: "若要透過 GP 設定建議的配置，將以下 UI 路徑設為已停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow Basic authentication 注意：這個群組原則路徑是由群組原則範本 WindowsRemoteManagement.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.97.2.1"]
      - cis_csc: ["16.13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36254-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowBasic -> 0'

  - id: 15227
    title: "確保“允許透過 WinRM 進行遠端伺服器管理”設定為“停用”"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否會自動在網路上偵聽預設 HTTP 連接埠上的 HTTP 傳輸要求。此設定的建議狀態是：停用。"
    rationale: "任何功能都是潛在的攻擊途徑，那些啟用入站網路連線的功能尤其危險。僅在受信任的網路上啟用 Windows 遠端管理 (WinRM) 服務，並在可行時採用 IPsec 等其他控制措施。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設定為已停用: Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow remote server management through WinRM。註：此群組原則路徑由群組原則模板WindowsRemoteManagement.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。註#2：在舊版Microsoft Windows管理模板中，該設定最初被命名為Allow automatic configuration of listeners，但從Windows 8.0和Server 2012（非R2）管理模板開始更名。"
    compliance:
      - cis: ["18.9.97.2.2"]
      - cis_csc: ["3.4"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-37927-1"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowAutoConfig -> 0'

  - id: 15228
    title: "確保“允許未加密的流量”設定為“停用”"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否透過網路傳送和接收未加密的訊息。此設定的建議狀態是：停用。"
    rationale: "對 WinRM 網路流量進行加密可降低攻擊者在 WinRM 訊息透過網路傳輸時查看或修改 WinRM 訊息的風險。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為已禁用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow unencrypted traffic 注意：這個群組原則路徑是由群組原則模板 WindowsRemoteManagement.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.97.2.3"]
      - cis_csc: ["16.13"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-38223-4"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowUnencryptedTraffic -> 0'

  - id: 15229
    title: "確保“禁止 WinRM 儲存 RunAs 憑證”設定為“啟用”"
    description: "透過此策略設置，您可以管理 Windows 遠端管理 (WinRM) 服務是否允許儲存任何外掛程式的運行身分憑證。此設定的建議狀態為：已啟用。注意：如果啟用然後停用此策略設置，則先前為 RunAsPassword 配置的任何值都需要重置。"
    rationale: "儘管儲存 RunAs 憑證的功能是一項方便的功能，但它會稍微增加帳戶外洩的風險。例如，如果您在無人看管幾分鐘之前忘記鎖定桌面，其他人不僅可以存取您電腦的桌面，還可以存取您透過 WinRM 使用快取的 RunAs 憑證管理的任何主機。"
    remediation: "要通過 GP 設置建議的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Disallow WinRM from storing RunAs credentials 注意: 此組策略路徑可能預設不存在。它由組策略模板 WindowsRemoteManagement.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012 (non-R2) Administrative Templates (或更新版本) 中。"
    compliance:
      - cis: ["18.9.97.2.4"]
      - cis_csc: ["16.4"]
      - pci_dss: ["12.3.8"]
    references:
      - "CCE-36000-8"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> DisableRunAs -> 1'

  - id: 15230
    title: "確保“允許遠端 Shell 存取”設定為“停用”"
    description: "此策略設定可讓您管理對所有支援的 shell 的遠端存取配置以執行腳本和指令。此設定的建議狀態是：停用。注意：此設定的 GPME 幫助文字措辭不正確，這意味著將其配置為「啟用」將拒絕新的遠端 Shell 連接，將其設為「停用」將允許遠端 Shell 連接。事實恰恰相反（並且與設定的標題一致）。這是 Microsoft 在管理範本中的措詞錯誤。"
    rationale: "任何功能都是潛在的攻擊途徑，那些啟用入站網路連線的功能尤其危險。僅在受信任的網路上啟用 Windows Remote Shell，並在可行時採用 IPsec 等其他控制措施。"
    remediation: "若要通過 GP 建立建議配置，請將以下 UI 路徑設置為已禁用：Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Shell\\Allow Remote Shell Access。注意：此組策略路徑由 Group Policy 模板 WindowsRemoteShell.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.9.98.1"]
      - cis_csc: ["3.4"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36499-2"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS -> AllowRemoteShellAccess -> 0'

  - id: 15231
    title: "確保“配置自動更新”設定為“啟用”"
    description: "此政策設定指定您環境中的電腦是否將從 Windows Update 或 WSUS 接收安全更新。如果將此原則設定配置為“啟用”，作業系統將識別網路連線何時可用，然後使用網路連線搜尋 Windows 更新或指定的 Intranet 網站以取得適用於它們的更新。將此策略設定配置為「啟用」後，在「配置自動更新屬性」對話方塊中選擇以下三個選項之一以指定服務的工作方式： - 2 - 通知下載和自動安裝（下載任何更新之前通知） - 3 - 自動下載並通知安裝（自動下載更新並在準備安裝時通知。）（預設） - 4 - 自動下載並安排安裝（自動下載更新並按照下面指定的時間表安裝。） ) - 5 - 允許本機管理員選擇設定（將上述選擇的決定權留給本機管理員（不建議）） 此設定的建議狀態為：啟用。注意：子設定「配置自動更新：」有 4 個可能的值 - 所有這些值都有效，具體取決於特定的組織需求，但如果可行，我們建議使用值 4 - 自動下載並安排安裝。此建議不是評分要求。注意#2：使用第 3 方解決方案進行修補的組織可以選擇免除此設置，並將其配置為“禁用”，以便本機 Windows 更新機制不會幹擾第 3 方修補過程。"
    rationale: "儘管每個版本的Windows在發布前都經過了徹底的測試，但在產品發貨後仍有可能發現問題。配置自動更新設定可以幫助您確保環境中的電腦始終安裝最新的關鍵作業系統更新和服務包。"
    remediation: "為了通過GP建立建議的配置，設置以下UI路徑為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Configure Automatic Updates 注意：此群組原則路徑由隨所有版本的Microsoft Windows管理模板一起提供的群組原則模板WindowsUpdate.admx/adml提供。"
    compliance:
      - cis: ["18.9.101.2"]
      - cis_csc: ["4.5"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - "CCE-36172-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoUpdate -> 0'

  - id: 15232
    title: "確保“配置自動更新：計劃安裝日”設定為“0 - 每天”"
    description: "此政策設定指定環境中的電腦何時從 Windows Update 或 WSUS 接收安全性更新。此設定的建議狀態是：0 - 每天。注意：僅在規則 18.9.101.2 中選擇 4 - 自動下載並安排安裝時，此設定才適用。如果選擇任何其他選項，則不會產生任何影響。"
    rationale: "儘管每個版本的Windows在發布前都經過了徹底的測試，但在產品發貨後仍有可能發現問題。配置自動更新設定可以幫助您確保環境中的電腦始終安裝最新的關鍵作業系統更新和服務包。"
    remediation: "要透過 GP 設定推薦的配置，將以下 UI 路徑設置為 0 - 每天：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Configure Automatic Updates: Scheduled install day 注意：此群組策略路徑由群組策略範本 WindowsUpdate.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.101.3"]
      - cis_csc: ["4.5"]
      - pci_dss: ["6.2"]
    references:
      - "CCE-36172-5"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> ScheduledInstallDay -> 0'

  - id: 15233
    title: "確保“登入使用者不會自動重新啟動計劃的自動更新安裝”設定為“停用”"
    description: "此政策設定指定自動更新將等待登入電腦的使用者重新啟動電腦以完成計劃的安裝。此設定的建議狀態是：停用。注意：此設定僅在您設定自動更新以執行計劃的更新安裝時適用。如果將“配置自動更新”設定配置為“已停用”，則此設定無效。"
    rationale: "某些安全性更新需要重新啟動電腦才能完成安裝。如果電腦無法自動重新啟動，則最新更新將無法完全安裝，並且在重新啟動之前不會將新更新下載到電腦。如果沒有自動重新啟動功能，沒有安全意識的使用者可能會選擇無限期延遲重啟，從而使電腦處於不太安全的狀態。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\No auto-restart with logged on users for scheduled automatic updates installations 注意: 此群組原則路徑由群組原則模板 WindowsUpdate.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。 注意 #2: 在舊版本的 Microsoft Windows Administrative Templates 中，這個設置起初名為 No auto-restart for scheduled Automatic Updates installations，但從 Windows 7 和 Server 2008 R2 Administrative Templates 開始重新命名。"
    compliance:
      - cis: ["18.9.101.4"]
      - cis_csc: ["4.5"]
      - pci_dss: ["6.2"]
    references:
      - "CCE-37027-0"
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoRebootWithLoggedOnUsers -> 0'
