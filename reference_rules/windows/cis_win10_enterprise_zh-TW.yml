# Security Configuration Assessment
# CIS Checks for Windows 10 Enterprise
# Copyright (C) 2015, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# CIS Microsoft Windows 10 Enterprise (Release 21H2) Benchmark v1.12.0 - 02-15-2022

policy:
  id: "cis_win10_enterprise"
  file: "cis_win10_enterprise.yml"
  name: "CIS Microsoft Windows 10 Enterprise Benchmark v1.12.0"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for Microsoft Windows 10 Enterprise."
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check that the Windows platform is Windows 10"
  description: "Requirements for running the CIS benchmark Domain Controller under Windows 10"
  condition: all
  rules:
    - 'r:HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion -> ProductName -> r:^Windows 10'

checks:
  # 1.1 Password Policy
  - id: 15500
    title: "確保「強制執行密碼歷史記錄」設定為「24 個或更多密碼」。"
    description: "此政策設定決定在重新使用舊密碼之前必須與使用者帳戶關聯的更新的唯一密碼的數量。此原則設定的值必須介於 0 到 24 個密碼之間。 Windows Vista 的預設值為 0 個密碼，但網域中的預設值為 24 個密碼。為了維持此原則設定的有效性，請使用最短密碼期限設定來防止使用者重複變更其密碼。此設定的建議狀態是：24 個或更多密碼。注意：密碼原則設定（第 1.1 節）和帳戶鎖定原則設定（第 1.2 節）必須透過預設網域原則 GPO 應用，以便作為預設行為對網域使用者帳戶全域生效。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。注意#2：截至本基準測試發佈時，Microsoft 目前保存的密碼最多為 24 個。有關更多資訊，請存取強制執行密碼歷史記錄 (Windows 10) - Windows 安全性 |微軟檔案"
    rationale: "使用者使用相同密碼的時間越長，攻擊者透過暴力攻擊決定密碼的機會就越大。此外，只要密碼保持不變，任何可能已洩露的帳戶都將仍然可以被利用。如果需要更改密碼但不阻止密碼重複使用，或者如果使用者不斷重複使用少量密碼，則良好密碼策略的有效性會大大降低。如果為此策略設定指定較小的數字，使用者將能夠重複使用相同的少量密碼。如果您沒有同時配置「最短密碼期限」設置，使用者可能會重複變更其密碼，直到可以重新使用其原始密碼。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 24 個或更多密碼: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Enforce password history"
    compliance:
      - cis: ["1.1.1"]
      - cis_csc: ["5.2"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Length of password history maintained:\s+(\d+) compare >= 24'

  - id: 15501
    title: "確保「密碼最長期限」設定為「365 天或更少，但不是 0」。"
    description: "此原則設定定義使用者在密碼過期之前可以使用其密碼的時間。此策略設定的值範圍為 0 到 999 天。如果將該值設為 0，則密碼永遠不會過期。由於攻擊者可以破解密碼，因此更改密碼的頻率越高，攻擊者使用破解密碼的機會就越少。但是，該值設定得越低，由於使用者必須更改密碼或忘記當前密碼，因此向幫助台支援呼叫增加的可能性就越大。此設定的建議狀態為 365 天或更少，但不是 0。作為其預設行為。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "密碼存在的時間越長，受到暴力攻擊、攻擊者獲得有關用戶的一般知識或用戶共享密碼的破壞的可能性就越大。將密碼最長期限設定配置為 0，以便使用者永遠不需要更改其密碼，這是一個主要的安全風險，因為只要有效使用者俱有授權存取權限，惡意使用者就可以使用受損的密碼。"
    remediation: "要透過GP建立建議的設定，請將以下UI路徑設為365天或更少，但不能為0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Maximum password age"
    compliance:
      - cis: ["1.1.2"]
      - cis_csc: ["5.2"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Maximum password age \(days\):\s+(\d+) compare <= 365'
      - 'c:net.exe accounts -> n:Maximum password age \(days\):\s+(\d+) compare > 0'

  - id: 15502
    title: "確保「密碼最短期限」設定為「1 天或以上」。"
    description: "此原則設定決定在變更密碼之前必須使用密碼的天數。此策略設定的值範圍介於 1 到 999 天之間。 （您也可以將該值設為 0 以允許立即變更密碼。）此設定的預設值為 0 天。此設定的建議狀態為：1 天或更多天）。注意：密碼原則設定（第 1.1 節）和帳戶鎖定原則設定（第 1.2 節）必須透過預設網域原則 GPO 應用，以便作為預設行為對網域使用者帳戶全域生效。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "用戶可能有他們喜歡使用的最喜歡的密碼，因為它們易於記住並且他們相信他們的密碼選擇是安全的，不會被洩露。不幸的是，密碼會被洩露，如果攻擊者以特定個人的用戶帳戶為目標，並且預先了解有關該用戶的資料，則重複使用舊密碼可能會導致安全漏洞。為了解決密碼重複使用問題，需要組合安全性設定。將此政策設定與「強制密碼歷史記錄」設定結合使用可防止舊密碼輕鬆重複使用。例如，如果您配置強制密碼歷史記錄設定以確保使用者無法重複使用最近12 個密碼中的任何一個，則他們可以在幾分鐘內更改密碼13 次並重複使用開始時使用的密碼，除非您也配置了最低密碼年齡設定為大於 0 的數字。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為1天或更多天數：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Minimum password age"
    compliance:
      - cis: ["1.1.3"]
      - cis_csc: ["5.2"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Minimum password age \(days\):\s+(\d+) compare >= 1'

  - id: 15503
    title: "確保“最小密碼長度”設定為“14 個或更多字元”。"
    description: "此原則設定決定組成使用者帳戶密碼的最少字元數。關於如何確定組織的最佳密碼長度有許多不同的理論，但也許「密碼短語」是比「密碼」更好的術語。在 Microsoft Windows 2000 及更高版本中，密碼可能會很長並且可以包含空格。因此，諸如“我想喝一杯 5 美元的奶昔”之類的短語是有效的密碼短語；它是一個比 8 或 10 個隨機數字和字母組成的字串強得多的密碼，而且更容易記住。必須教育使用者如何正確選擇和維護密碼，尤其是密碼長度。在企業環境中，最小密碼長度設定的理想值為 14 個字元，但是您應該調整該值以滿足組織的業務要求。此設定的建議狀態是：14 個或更多字元。注意：在Windows Server 2016 及更早版本的Windows Server 中，本機安全性原則(LSP)、本機群組原則編輯器(LGPE) 和群組原則管理編輯器(GPME) 的GUI 不允許您將此值設為大於14 個字元。但是，從 Windows Server 2019 開始，Microsoft 變更了 GUI，允許最小密碼長度為 20 個字元。注意 #2：密碼原則設定（第 1.1 節）和帳戶鎖定原則設定（第 1.2 節）必須透過預設網域原則 GPO 應用，以便作為預設行為對網域使用者帳戶全域生效。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "密碼攻擊的類型包括字典攻擊（嘗試使用常用單字和短語）和暴力攻擊（嘗試所有可能的字元組合）。此外，攻擊者有時會嘗試取得帳戶資料庫，以便他們可以使用工具來發現帳戶和密碼。"
    remediation: "要通過 GP 建立推薦設定，請將以下 UI 路徑設置為 14 或更多字元：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Minimum password length"
    compliance:
      - cis: ["1.1.4"]
      - cis_csc: ["5.2"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Minimum password length:\s+(\d+) compare >= 14'

  - id: 15505
    title: "確保「放寬最小密碼長度限制」設定為「啟用」。"
    description: "此原則設定決定是否可以將最小密碼長度設定增加到超過 14 個字元的舊限制。有關詳細資訊，請參閱以下 Microsoft 安全部落格。此設定的建議狀態為：已啟用。注意：此設定僅影響電腦上的本機帳戶。網域帳戶僅受網域控制站上的設定影響，因為網域帳戶是儲存在網域控制站上的。"
    rationale: "在未使用 MFA 的情況下，此設定將啟用更長且通常更強的密碼或密碼短語。"
    remediation: "若要透過 GP 建立建議的設定，將以下 UI 路徑設為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Relax minimum password length limits. 注意：此設定僅在 Windows 10 Release 2004 和 Server 2022（或更新版本）的內建 OS 安全性模板中可用，且不適用於較舊版本的 OS 或可下載的管理模板 (ADMX/ADML)。因此，您必須使用 Windows 10 Release 2004 或 Server 2022 系統（或更新版本）來使用群組政策管理控制台 (GPMC) 或群組政策管理編輯器 (GPME) 來查看或編輯此設定。"
    compliance:
      - cis: ["1.1.6"]
      - cis_csc: ["5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SAM'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SAM -> RelaxMinimumPasswordLengthLimits'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SAM -> RelaxMinimumPasswordLengthLimits -> 1'

  - id: 15506
    title: "確保「帳戶鎖定持續時間」設定為「15 分鐘或以上」。"
    description: "此策略設定確定鎖定的帳戶解鎖並且用戶可以嘗試再次登入之前必須經過的時間長度。此設定透過指定鎖定帳戶保持不可用狀態的分鐘數來實現此目的。如果此策略設定的值配置為 0，則鎖定的帳戶將保持鎖定狀態，直到管理員手動解鎖它們。儘管將此策略設定的值配置為較高值似乎是個好主意，但此類配置可能會增加幫助台收到的解鎖因錯誤鎖定的帳戶的呼叫數量。用戶應該了解鎖保持在原位的時間長度，以便他們意識到只有在極其迫切需要重新存取電腦時才需要致電幫助台。此設定的建議狀態為：15 分鐘或更多分鐘。注意：密碼原則設定（第 1.1 節）和帳戶鎖定原則設定（第 1.2 節）必須透過預設網域原則 GPO 應用，以便作為預設行為對網域使用者帳戶全域生效。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "如果攻擊者濫用帳戶鎖定閾值並反覆嘗試使用特定帳戶登入，則可能會造成拒絕服務 (DoS) 情況。配置帳戶鎖定閾值設定後，帳戶將在指定的失敗嘗試次數後被鎖定。如果您將帳戶鎖定持續時間設定配置為 0，則帳戶將保持鎖定狀態，直到管理員手動解鎖為止。"
    remediation: "若要通過 GP 設置推薦配置，將以下 UI 路徑設定為 15 分鐘或更長時間: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy\\Account lockout duration"
    compliance:
      - cis: ["1.2.1"]
      - cis_csc: ["4.10"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Lockout duration \(minutes\):\s+(\d+) compare >= 15'

  - id: 15507
    title: "確保「帳戶鎖定閾值」設定為「5 次或更少的無效登入嘗試，但不是 0 次」。"
    description: "此政策設定決定帳戶被鎖定之前嘗試登入失敗的次數。將此策略設為 0 不符合基準，因為這樣做會停用帳戶鎖定閾值。此設定的建議狀態是：5 次或更少的無效登入嘗試，但不是 0。行為，對網域使用者帳戶全域生效。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "設定帳戶鎖定閾值可降低線上密碼暴力攻擊成功的可能性。將帳戶鎖定閾值設定得太低會導致意外鎖定和/或惡意行為者故意鎖定帳戶的風險增加。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為5次或更少的無效登入嘗試，但不是0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy\\Account lockout threshold"
    compliance:
      - cis: ["1.2.2"]
      - cis_csc: ["4.10"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Lockout threshold:\s+(\d+) compare > 0'
      - 'c:net.exe accounts -> n:Lockout threshold:\s+(\d+) compare <= 5'

  - id: 15508
    title: "確保「重設帳戶鎖定計數器之後」設定為「15 分鐘或更多分鐘」。"
    description: "此策略設定決定帳戶鎖定閾值重設為零之前的時間長度。此策略設定的預設值為「未定義」。如果定義了帳戶鎖定閾值，則此重設時間必須小於或等於帳戶鎖定持續時間設定的值。如果您將此策略設定保留為預設值或將該值配置為太長的間隔，您的環境可能容易受到 DoS 攻擊。攻擊者可能會對組織中的所有使用者惡意執行多次失敗的登入嘗試，這將鎖定他們的帳戶。如果沒有確定重設帳戶鎖定的策略，則這將是管理員的手動任務。相反，如果為此策略設定配置了合理的時間值，則使用者將被鎖定一段時間，直到所有帳戶自動解鎖。此設定的建議狀態為：15 分鐘或更多分鐘。注意：密碼原則設定（第 1.1 節）和帳戶鎖定原則設定（第 1.2 節）必須透過預設網域原則 GPO 應用，以便作為預設行為對網域使用者帳戶全域生效。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "如果使用者多次輸錯密碼，可能會意外地將自己鎖定在帳戶之外。為了減少此類意外鎖定的可能性，設定後重設帳戶鎖定計數器確定追蹤失敗登入嘗試和觸發鎖定的計數器重設為 0 之前必須經過的分鐘數。"
    remediation: "要透過 GP 建立建議的設定，將以下 UI 路徑設成 15 分鐘或更長時間：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy\\Reset account lockout counter after"
    compliance:
      - cis: ["1.2.3"]
      - cis_csc: ["4.10"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Lockout observation window \(minutes\):\s+(\d+) compare >= 15'

  - id: 15509
    title: "確保「帳戶：管理員帳戶狀態」設定為「已停用」。"
    description: "此策略設定在正常操作期間啟用或停用管理員帳戶。當電腦啟動到安全模式時，管理員帳戶始終處於啟用狀態，無論此設定如何配置。請注意，當透過群組原則套用於網域控制器組織單位時，此設定不會產生任何影響，因為網域控制站沒有本機帳戶資料庫。它可以透過群組原則在網域層級進行配置，類似於帳戶鎖定和密碼原則設定。此設定的建議狀態是：停用。"
    rationale: "在某些組織中，維護本機帳戶的定期密碼變更的定期計劃可能是一項艱鉅的管理挑戰。因此，您可能希望停用內建管理員帳戶，而不是依靠定期更改密碼來保護其免受攻擊。停用此內建帳戶的另一個原因是，無論登入失敗多少次，它都無法被鎖定，這使其成為嘗試猜測密碼的暴力攻擊的主要目標。此外，此帳戶具有眾所周知的安全性識別碼 (SID)，並且有第三方工具允許使用 SID 而不是帳戶名稱進行身份驗證。這種能力意味著即使您重新命名了Administrator帳戶，攻擊者也可以透過使用SID登入來發動暴力攻擊。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Administrator account status"
    compliance:
      - cis: ["2.3.1.1"]
      - cis_csc: ["4.7"]
    condition: any
    rules:
      - 'c:net user administrator -> r:Account active\s+No'
      - "c:net user administrator -> r:The user name could not be found."

  - id: 15510
    title: "確保「帳戶：封鎖 Microsoft 帳戶」設定為「使用者無法新增或使用 Microsoft 帳戶登入」。"
    description: "此策略設定阻止使用者在此電腦上新增新的 Microsoft 帳戶。此設定的建議狀態為：使用者無法新增或使用 Microsoft 帳戶登入。"
    rationale: "想要有效實施身分識別管理策略並嚴格控制用於登入其電腦的帳戶的組織可能會希望阻止 Microsoft 帳戶。組織可能還需要封鎖 Microsoft 帳戶，以滿足適用於其資訊系統的合規性標準的要求。"
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為「使用者無法新增或登入 Microsoft 帳戶」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Block Microsoft accounts"
    compliance:
      - cis: ["2.3.1.2"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> NoConnectedUser'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> NoConnectedUser -> 3'

  - id: 15511
    title: "確保「帳戶：訪客帳戶狀態」設定為「已停用」。"
    description: "此政策設定決定是啟用還是停用來賓帳戶。來賓帳戶允許未經身份驗證的網路使用者存取系統。此設定的建議狀態是：停用。注意：當透過群組原則套用於網域控制器組織單位時，此設定不會產生任何影響，因為網域控制站沒有本機帳戶資料庫。它可以透過群組原則在網域層級進行配置，類似於帳戶鎖定和密碼原則設定。"
    rationale: "預設來賓帳戶允許未經身份驗證的網路使用者以來賓身份登入，無需密碼。這些未經授權的使用者可以透過網路存取來賓帳戶可存取的任何資源。此功能意味著任何具有允許存取來賓帳戶、來賓群組或所有人群組權限的網路共享都可以透過網路進行存取，這可能會導致資料外洩或損壞。"
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設定為「停用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Guest account status"
    compliance:
      - cis: ["2.3.1.3"]
      - cis_csc: ["4.7"]
    condition: all
    rules:
      - 'c:net user guest -> r:Account active\s+No'

  - id: 15512
    title: "確保「帳戶：限製本機帳戶僅使用空白密碼進行控制台登入」設定為「啟用」。"
    description: "此政策設定決定是否可以使用不受密碼保護的本機帳戶從實體電腦控制台以外的位置登入。如果啟用此政策設置，密碼為空的本機帳戶將無法從遠端用戶端電腦登入網路。此類帳戶只能透過電腦鍵盤登入。此設定的建議狀態為：已啟用。"
    rationale: "空白密碼對電腦安全構成嚴重威脅，應透過組織政策和適當的技術措施來禁止。事實上，Active Directory 網域的預設設定需要至少七個字元的複雜密碼。但是，如果能夠建立新帳戶的使用者繞過基於網域的密碼策略，他們可能會建立具有空白密碼的帳戶。例如，使用者可以建立一台獨立計算機，建立一個或多個密碼為空的帳戶，然後將該計算機加入網域。密碼為空的本機帳戶仍然可以使用。任何知道這些不受保護的帳戶之一的名稱的人都可以使用它進行登入。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Limit local account use of blank passwords to console logon only"
    compliance:
      - cis: ["2.3.1.4"]
      - cis_csc: ["5.2"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LimitBlankPasswordUse'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LimitBlankPasswordUse -> 1'

  - id: 15513
    title: "配置「帳戶：重新命名管理員帳戶」。"
    description: "內建本機管理員帳戶是眾所周知的帳戶名稱，是攻擊者的目標。建議為此帳戶選擇其他名稱，並避免使用表示管理或提升存取權限的帳戶的名稱。請務必變更本機管理員的預設描述（透過電腦管理控制台）。"
    rationale: "管理員帳戶存在於所有執行 Windows 2000 或更高版本作業系統的電腦上。如果您重新命名此帳戶，則未經授權的人員猜測此特權使用者名稱和密碼組合的難度會稍微增加一些。無論攻擊者使用錯誤密碼多少次，都無法鎖定內建管理員帳號。此功能使管理員帳戶成為嘗試猜測密碼的暴力攻擊的熱門目標。此對策的價值會降低，因為該帳戶具有眾所周知的 SID，並且有第三方工具允許使用 SID 而不是帳戶名稱進行身份驗證。因此，即使您重新命名了Administrator帳戶，攻擊者也可以透過使用SID登入來發動暴力攻擊。"
    remediation: "要透過群組原則建立建議的配置，請配置以下使用者介面路徑: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Rename administrator account"
    compliance:
      - cis: ["2.3.1.5"]
      - cis_csc: ["4.7"]
    condition: all
    rules:
      - "c:net user administrator -> r:The user name could not be found."

  - id: 15514
    title: "配置「帳戶：重新命名訪客帳戶」。"
    description: "內建的本機來賓帳戶是攻擊者另一個熟知的名稱。建議將此帳戶重新命名為不表示其用途的名稱。即使您停用此帳戶（建議這樣做），也請確保將其重新命名以提高安全性。"
    rationale: "來賓帳戶存在於所有執行 Windows 2000 或更高版本作業系統的電腦上。如果您重新命名此帳戶，則未經授權的人員猜測此特權使用者名稱和密碼組合的難度會稍微增加一些。"
    remediation: "若要通過GP建立推薦的配置，請配置以下UI路徑: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Rename guest account"
    compliance:
      - cis: ["2.3.1.6"]
      - cis_csc: ["4.7"]
    condition: all
    rules:
      - "c:net user guest -> r:The user name could not be found."

  - id: 15515
    title: "確保「審核：強制審核原則子類別設定（Windows Vista 或更高版本）覆蓋審核原則類別設定」設定為「啟用」。"
    description: "此政策設定允許管理員啟用 Windows Vista 中提供的更精確的審核功能。 Windows Server 2003 Active Directory 中可用的稽核原則設定尚不包含用於管理新稽核子類別的設定。為了正確應用此基準中規定的審核策略，審核：強制審核原則子類別設定（Windows Vista 或更高版本）覆蓋審核原則類別設定設定需要設定為啟用。此設定的建議狀態為：已啟用。重要提示：對於可能產生大量流量的審核設定要非常謹慎。例如，如果您對所有權限使用子類別啟用成功或失敗審核，則產生的大量審核事件可能會導致很難在安全性日誌中找到其他類型的項目。這種配置也可能對系統效能產生重大影響。"
    rationale: "在 Windows Vista 中引入審核子類別之前，很難在每個系統或每個使用者層級追蹤事件。較大的事件類別產生了太多的事件，需要審計的關鍵資訊很難找到。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings"
    compliance:
      - cis: ["2.3.2.1"]
      - cis_csc: ["8.5"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> SCENoApplyLegacyAuditPolicy'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> SCENoApplyLegacyAuditPolicy -> 1'

  - id: 15516
    title: "確保「審核：如果無法記錄安全審核，則立即關閉系統」設定為「停用」。"
    description: "此策略設定確定系統在無法記錄安全事件時是否關閉。可信任電腦系統評估標準 (TCSEC)-C2 和通用標準認證要求在審核系統無法記錄可審核事件的情況下防止可審核事件發生。 Microsoft 選擇透過在審核系統發生故障時停止系統並顯示停止訊息來滿足此要求。啟用此政策設定後，如果因任何原因無法記錄安全審核，系統將關閉。如果啟用審核：如果無法記錄安全審核，則立即關閉系統設置，則可能會發生意外的系統故障。管理負擔可能會很大，特別是如果您還將安全日誌的保留方法配置為「不覆蓋事件」（手動清除日誌）。此配置會導致否認威脅（備份操作員可能否認他們備份或恢復資料）成為拒絕服務 (DoS) 漏洞，因為如果伺服器因登入事件和其他安全問題而不堪重負，則可能會被迫關閉寫入安全性日誌的事件。此外，由於關閉不正常，可能會對作業系統、應用程式或資料造成不可挽回的損壞。儘管 NTFS 檔案系統在電腦非正常關機時保證其完整性，但它不能保證每個應用程式的每個資料檔案在電腦重新啟動時仍處於可用形式。此設定的建議狀態是：停用。"
    rationale: "如果電腦無法將事件記錄到安全性日誌中，則在發生安全事件後可能無法查看關鍵證據或重要的故障排除資訊。此外，攻擊者可能會產生大量安全性日誌事件來故意強制電腦關閉。"
    remediation: "若要通過 GP 設置建議配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Audit: Shut down system immediately if unable to log security audits"
    compliance:
      - cis: ["2.3.2.2"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.7"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> CrashOnAuditFail'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> CrashOnAuditFail -> 0'

  - id: 15517
    title: "確保“設備：允許格式化和彈出可移動媒體”設定為“管理員和互動用戶”。"
    description: "此策略設定決定允許誰格式化和彈出可移動 NTFS 媒體。您可以使用此策略設定來防止未經授權的使用者刪除一台電腦上的資料，以便在他們擁有本機管理員權限的另一台電腦上存取該資料。此設定的建議狀態是：管理員和互動用戶。"
    rationale: "使用者可以將可移動磁碟上的資料移到他們具有管理權限的另一台電腦上。然後，使用者可以取得任何檔案的所有權，授予自己完全控制權，並檢視或修改任何檔案。大多數可移動儲存裝置將透過按機械按鈕彈出媒體，這一事實削弱了此策略設定的優勢。"
    remediation: "要通過 GP 建立建議的配置，將以下使用者介面路徑設為 管理員和互動式使用者: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Devices: Allowed to format and eject removable media"
    compliance:
      - cis: ["2.3.4.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> AllocateDASD'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> AllocateDASD -> 2'

  - id: 15518
    title: "確保「裝置：阻止使用者安裝印表機驅動程式」設定為「啟用」。"
    description: "若要讓電腦列印到共用印表機，必須在本機電腦上安裝此共用印表機的驅動程式。此安全性設定決定誰可以在連接到共用印表機時安裝印表機驅動程式。此設定的建議狀態為：已啟用。注意：此設定不會影響新增本機印表機的功能。此設定不會影響管理員。"
    rationale: "在某些組織中，允許使用者在自己的工作站上安裝印表機驅動程式可能是合適的。但是，在高安全性環境中，您應該只允許管理員而不是使用者執行此操作，因為安裝印表機驅動程式可能會無意中導致電腦變得不太穩定。惡意使用者可能會故意安裝不適當的印表機驅動程式來損壞計算機，或者使用者可能會意外安裝偽裝成印表機驅動程式的惡意軟體。攻擊者可以將特洛伊木馬程式偽裝成印表機驅動程式。該程式可能對使用者來說似乎必須使用它來列印，但這樣的程式可能會在您的電腦網路上釋放惡意程式碼。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Devices: Prevent users from installing printer drivers"
    compliance:
      - cis: ["2.3.4.2"]
      - pci_dss: ["2.2.4", "2.2.5"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC6.3", "CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers -> AddPrinterDrivers'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers -> AddPrinterDrivers -> 1'

  - id: 15519
    title: "確保「網域成員：對安全通道資料進行數位加密或簽署（始終）」設定為「啟用」。"
    description: "此政策設定決定是否必須對網域成員發起的所有安全通道流量進行簽署或加密。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally encrypt or sign secure channel data (always)"
    compliance:
      - cis: ["2.3.6.1"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireSignOrSeal'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireSignOrSeal -> 1'

  - id: 15520
    title: "確保「網域成員：對安全通道資料進行數位加密（如果可能）」設定為「啟用」。"
    description: "此政策設定決定網域成員是否應嘗試為其發起的所有安全通道流量協商加密。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally encrypt secure channel data (when possible)"
    compliance:
      - cis: ["2.3.6.2"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SealSecureChannel'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SealSecureChannel -> 1'

  - id: 15521
    title: "確保「網域成員：對安全通道資料進行數位簽章（如果可能）」設定為「啟用」。"
    description: "此政策設定決定網域成員是否應嘗試協商其發起的所有安全通道流量是否必須進行數位簽章。數位簽章可保護流量不被任何在網路中擷取資料的人修改。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally sign secure channel data (when possible)"
    compliance:
      - cis: ["2.3.6.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SignSecureChannel'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SignSecureChannel -> 1'

  - id: 15522
    title: "確保「網域成員：停用電腦帳戶密碼變更」設定為「停用」。"
    description: "此原則設定確定網域成員是否可以定期變更其電腦帳戶密碼。無法自動變更其帳戶密碼的電腦可能容易受到攻擊，因為攻擊者可能能夠確定系統網域帳戶的密碼。此設定的建議狀態是：停用。注意：電腦帳戶密碼過期可能會導致出現一些問題，特別是當電腦恢復到先前的時間點狀態時，這在虛擬機器中很常見。根據還原的時間，儲存在電腦上的舊電腦帳戶密碼可能不再被網域控制器識別，因此電腦失去了網域信任。這也可能會破壞非持續性 VDI 實施以及具有不允許對作業系統磁碟區進行永久更改的寫入過濾器的裝置。某些組織可能會選擇免除此建議，並在這些情況下停用電腦帳戶密碼過期。"
    rationale: "屬於某個網域的基於 Windows Server 2003 的電腦的預設設定是自動要求它們每 30 天變更其帳戶的密碼。如果停用此原則設置，執行 Windows Server 2003 的電腦將保留與其電腦帳戶相同的密碼。不再能夠自動更改其帳戶密碼的電腦面臨來自攻擊者的風險，攻擊者可以確定電腦網域帳戶的密碼。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Disable machine account password changes"
    compliance:
      - cis: ["2.3.6.4"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> DisablePasswordChange'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> DisablePasswordChange -> 0'

  - id: 15523
    title: "確保「網域成員：機器帳戶密碼最長期限」設定為「30 天或更少，但不是 0」。"
    description: "此政策設定確定電腦帳戶密碼的最長允許期限。預設情況下，網域成員每 30 天自動變更一次網域密碼。如果顯著增加此間隔以使電腦不再更改其密碼，攻擊者將有更多時間對其中一個電腦帳戶進行暴力攻擊。此設定的建議狀態是：30 天或更少，但不是 0。注意#2：電腦帳戶密碼過期可能會導致出現一些問題，特別是當電腦恢復到先前的時間點狀態時，這在虛擬機器中很常見。根據還原的時間，儲存在電腦上的舊電腦帳戶密碼可能不再被網域控制器識別，因此電腦失去了網域信任。這也可能會破壞非持續性 VDI 實施以及具有不允許對作業系統磁碟區進行永久更改的寫入過濾器的裝置。某些組織可能會選擇免除此建議，並在這些情況下停用電腦帳戶密碼過期。"
    rationale: "在基於 Active Directory 的網域中，每台電腦都像每個使用者一樣都有一個帳戶和密碼。預設情況下，網域成員每 30 天自動變更其網域密碼。如果顯著增加此間隔，或將其設為 0，以便電腦不再更改其密碼，攻擊者將有更多時間進行暴力攻擊以猜測一個或多個電腦帳戶的密碼。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為30天或更少，但不能是0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Maximum machine account password age"
    compliance:
      - cis: ["2.3.6.5"]
    condition: all
    rules:
      - 'c:net.exe accounts -> n:Maximum password age (days):\s+(\d+) compare <= 30'
      - 'c:net.exe accounts -> n:Maximum password age (days):\s+(\d+) compare > 0'

  - id: 15524
    title: "確保「網域成員：需要強（Windows 2000 或更高版本）會話金鑰」設定為「啟用」。"
    description: "啟用此策略設定後，只能使用能夠使用強（128 位元）會話金鑰加密安全通道資料的網域控制站建立安全通道。要啟用此策略設置，網域中的所有網域控制站都必須能夠使用強密鑰加密安全通道資料，這意味著所有網域控制站必須運行 Microsoft Windows 2000 或更高版本。此設定的建議狀態為：已啟用。"
    rationale: "Windows 2000 中用於在網域控制站和成員電腦之間建立安全通道通訊的會話金鑰比以前的 Microsoft 作業系統中的會話金鑰強大得多。只要有可能，您就應該利用這些更強大的會話金鑰來幫助保護安全通道通訊免受試圖劫持網路會話和竊聽的攻擊。 （竊聽是一種駭客行為，其中網路資料在傳輸過程中被讀取或更改。資料可以被修改以隱藏或更改發送者，或被重新導向。）"
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Require strong (Windows 2000 or later) session key"
    compliance:
      - cis: ["2.3.6.6"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireStrongKey'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireStrongKey -> 1'

  - id: 15525
    title: "確保“互動式登入：不需要 CTRL+ALT+DEL”設定為“停用”。"
    description: "此政策設定確定使用者在登入之前是否必須按 CTRL+ALT+DEL。此設定的建議狀態是：停用。"
    rationale: "Microsoft 開發此功能是為了讓有某些身體缺陷的使用者更輕鬆地登入執行 Windows 的電腦。如果使用者不需要按 CTRL+ALT+DEL，他們很容易受到試圖攔截其密碼的攻擊。如果在登入前需要按 CTRL+ALT+DEL，則使用者密碼將透過可信任路徑進行傳遞。攻擊者可以安裝看起來像標準 Windows 登入對話方塊的特洛伊木馬程式並捕獲使用者的密碼。然後，攻擊者就可以使用該使用者擁有的任何權限等級登入受感染的帳戶。"
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Do not require CTRL+ALT+DEL"
    compliance:
      - cis: ["2.3.7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DisableCAD'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DisableCAD -> 0'

  - id: 15526
    title: "確保「互動式登入：不顯示上次登入」設定為「啟用」。"
    description: "此政策設定決定最後登入組織中用戶端電腦的使用者的帳戶名稱是否將顯示在每台電腦各自的 Windows 登入畫面中。啟用此策略設定可防止入侵者從組織中的桌上型電腦或筆記型電腦的螢幕上直觀地收集帳戶名稱。此設定的建議狀態為：已啟用。"
    rationale: "有權存取控制台的攻擊者（例如，具有實體存取權限的人或能夠透過遠端桌面服務連接到伺服器的人）可以查看最後登入伺服器的使用者的名稱。然後，攻擊者可以嘗試猜測密碼、使用字典或使用暴力攻擊來嘗試登入。"
    remediation: "要透過 GP 設定推薦的配置，將下列 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Don't display last signed-in. 注意：在舊版本的 Microsoft Windows 中，此設置名為 Interactive logon: Do not display last user name，但從 Windows 10 Release 1703 開始重命名。"
    compliance:
      - cis: ["2.3.7.2"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DontDisplayLastUserName'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DontDisplayLastUserName -> 1'

  - id: 15527
    title: "確保「互動式登入：電腦帳戶鎖定閾值」設定為「10 次或更少的無效登入嘗試，但不是 0」。"
    description: "此安全性設定決定導致電腦被鎖定的失敗登入嘗試次數。對已使用 CTRL+ALT+DELETE 或受密碼保護的螢幕保護程式鎖定的工作站或成員伺服器的失敗密碼嘗試將計為失敗的登入嘗試。電腦鎖定策略僅在啟用了 BitLocker 來保護作業系統磁碟區的電腦上強制執行。請確保啟用適當的復原密碼備份原則。此設定的建議狀態是：10 次或更少的無效登入嘗試，但不是 0。 1 到 3 之間的值將被解釋為 4。"
    rationale: "如果計算機遺失或被盜，或者內部威脅嘗試對計算機進行暴力密碼攻擊，請務必確保 BitLocker 鎖定計算機，從而防止成功的攻擊。"
    remediation: "要通過GP設置推薦配置，將以下UI路徑設定為10次或更少的無效登入嘗試，但不能為0: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Machine account lockout threshold"
    compliance:
      - cis: ["2.3.7.3"]
      - cis_csc: ["4.10"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> MaxDevicePasswordFailedAttempts'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> MaxDevicePasswordFailedAttempts -> 0'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> MaxDevicePasswordFailedAttempts -> n:^(\d+) compare <=30'

  - id: 15528
    title: "確保「互動式登入：電腦不活動限制」設定為「900 秒或更少，但不是 0」。"
    description: "Windows 會注意到登入工作階段的不活動狀態，如果不活動時間超過不活動限制，則螢幕保護程式將執行，鎖定工作階段。此設定的建議狀態是：900 秒或更少，但不是 0。"
    rationale: "如果使用者離開時忘記鎖定計算機，則路人可能會劫持計算機。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為 900 秒或更少，但不能為 0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Machine inactivity limit"
    compliance:
      - cis: ["2.3.7.4"]
      - cis_csc: ["4.3"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs -> 0'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs -> n:^(\d+) compare <= 900'

  - id: 15529
    title: "配置「互動式登入：嘗試登入的使用者的訊息文字」。"
    description: "此策略設定指定使用者登入時向其顯示的文字訊息。將下列群組原則設定為與您組織的安全性和操作要求一致的值。"
    rationale: "在登入前顯示警告訊息可以在攻擊發生之前警告攻擊者其不當行為的後果，有助於防止攻擊。它還可以透過在登入過程中通知員工適當的策略來幫助強化公司策略。此文字通常出於法律原因而使用，例如，警告使用者濫用公司資訊的後果，或警告他們的行為可能會受到審核。注意：您顯示的任何警告都應先得到組織的法律和人力資源代表的批准。"
    remediation: "為了通過 GP 建立建議的配置，請將以下 UI 路徑配置為符合貴組織安全性和運營要求的值：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Message text for users attempting to log on"
    compliance:
      - cis: ["2.3.7.5"]
    condition: all
    rules:
      - 'not c:reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\system /v legalnoticetext -> r:\s+legalnoticetext\s+REG_SZ\s+$'

  - id: 15530
    title: "配置「互動式登入：嘗試登入的使用者的訊息標題」。"
    description: "此策略設定指定使用者登入系統時看到的視窗標題列中顯示的文字。以符合您組織的安全性和操作要求的方式配置此設定。"
    rationale: "在登入前顯示警告訊息可以在攻擊發生之前警告攻擊者其不當行為的後果，有助於防止攻擊。它還可以透過在登入過程中通知員工適當的策略來幫助強化公司策略。"
    remediation: "要透過 GP 設立建議的配置，請將以下 UI 路徑配置為符合您的組織的安全和操作要求的相應值: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Message title for users attempting to log on"
    compliance:
      - cis: ["2.3.7.6"]
    condition: all
    rules:
      - 'not c:reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\system /v legalnoticecaption -> r:\s+legalnoticecaption\s+REG_SZ\s+$'

  - id: 15531
    title: "確保「互動式登入：先前登入快取的次數（如果網域控制器不可用）」設定為「4 次或更少的登入」。"
    description: "此策略設定決定使用者是否可以使用快取的帳戶資訊登入 Windows 網域。網域帳戶的登入資訊可以快取在本機，以便即使無法聯繫網域控制器，使用者也可以登入。此策略設定決定在本機快取其登入資訊的唯一使用者的數量。如果該值設為 0，則停用登入快取功能。能夠存取伺服器檔案系統的攻擊者可以找到此快取資訊並使用暴力攻擊來確定使用者密碼。此設定的建議狀態為：4 次或更少的登入。"
    rationale: "分配給此策略設定的數字表示電腦將在本機快取其登入資訊的使用者數量。如果該數字設定為 4，則電腦快取 4 個使用者的登入資訊。當第 5 個使用者登入電腦時，伺服器將覆蓋最舊的快取登入工作階段。存取電腦控制台的使用者的登入憑證將會快取在該電腦上。能夠存取電腦檔案系統的攻擊者可以找到此快取資訊並使用暴力攻擊來嘗試確定使用者密碼。為了減輕此類攻擊，Windows 會對資訊進行加密並隱藏其實體位置。"
    remediation: "若要透過 GP 設定建議的設定，請將以下 UI 路徑設至 4 個或更少的登入次數：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Number of previous logons to cache (in case domain controller is not available)"
    compliance:
      - cis: ["2.3.7.7"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> CachedLogonsCount'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> CachedLogonsCount -> n:^(\d+) compare <= 4'

  - id: 15532
    title: "確保「互動式登入：提示使用者在過期前更改密碼」設定為「5 到 14 天之間」。"
    description: "此策略設定確定提前多久警告使用者其密碼將過期。建議您將此原則設定配置為至少 5 天但不超過 14 天，以便在使用者密碼過期時充分警告使用者。此設定的建議狀態為：5 到 14 天之間。"
    rationale: "需要警告使用者他們的密碼即將過期，否則當密碼過期時，他們可能會無意中被鎖定在電腦之外。這種情況可能會導致本地存取網路的使用者感到困惑，或使用戶無法透過撥接或虛擬私人網路 (VPN) 連線存取組織的網路。"
    remediation: "要通過 GP 設定推薦的配置，將以下 UI 路徑設定為 5 至 14 天之間的值：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Prompt user to change password before expiration"
    compliance:
      - cis: ["2.3.7.8"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> PasswordExpiryWarning'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> PasswordExpiryWarning -> n:^(\d+) compare >= 5 && n:^(\d+) compare <= 14'

  - id: 15533
    title: "確保「互動式登入：智慧卡刪除行為」設定為「鎖定工作站」或更高版本。"
    description: "此策略設定確定從智慧卡讀卡機中取出登入使用者的智慧卡時會發生什麼情況。此設定的建議狀態為：鎖定工作站。如果遠端桌面服務工作階段也符合基準，請將此設定配置為強制登出或中斷連線。"
    rationale: "使用者有時會在離開工作站時忘記鎖定工作站，從而導致惡意使用者有可能存取他們的電腦。如果使用智慧卡進行身份驗證，當卡片被移除時，電腦應自動鎖定自身，以確保只有擁有智慧卡的使用者才能使用這些憑證存取資源。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為 Lock Workstation（或，如果適用於您的環境，Force Logoff 或 Disconnect 如果是遠端桌面服務會話）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Smart card removal behavior"
    compliance:
      - cis: ["2.3.7.9"]
      - cis_csc: ["4.3"]
      - pci_dss: ["8.6"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScRemoveOption'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScRemoveOption -> r:^1$|^2$'

  - id: 15534
    title: "確保「Microsoft 網路用戶端：對通訊進行數位簽署（始終）」設定為「啟用」。"
    description: '此政策設定確定 SMB 用戶端元件是否需要封包簽署。注意：當基於 Windows Vista 的電腦啟用此原則設定並且它們連接到遠端伺服器上的檔案或列印共用時，該設定與其配套設定 Microsoft 網路伺服器同步非常重要：對通訊進行數位簽署（始終）那些伺服器。有關這些設定的詳細資訊，請參閱威脅和對策指南第 5 章中的「Microsoft 網路用戶端和伺服器：數位簽章通訊（四個相關設定）」部分。此設定的建議狀態為：已啟用。'
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "為了通過 GP 建立推薦的配置, 將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Digitally sign communications (always)"
    compliance:
      - cis: ["2.3.8.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature -> 1'

  - id: 15535
    title: "確保「Microsoft 網路用戶端：對通訊進行數位簽章（如果伺服器同意）」設定為「啟用」。"
    description: "此政策設定決定 SMB 用戶端是否嘗試協商 SMB 封包簽章。注意：在網路上的 SMB 用戶端上啟用此原則設定可以使它們完全有效地與環境中的所有用戶端和伺服器進行封包簽署。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "如要通過 GP 建立推薦配置，請設定以下 UI 路徑為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Digitally sign communications (if server agrees)"
    compliance:
      - cis: ["2.3.8.2"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature -> 1'

  - id: 15536
    title: "確保「Microsoft 網路用戶端：將未加密的密碼傳送至第三方 SMB 伺服器」設定為「停用」。"
    description: "此政策設定確定 SMB 重新導向程式是否在驗證期間向不支援密碼加密的第三方 SMB 伺服器傳送純文字密碼。建議您停用此策略設置，除非有充分的業務案例來啟用它。如果啟用此策略設置，將允許在網路上使用未加密的密碼。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，伺服器可以透過網路將明文密碼傳輸到提供 SMB 服務的其他計算機，這是一個重大的安全風險。這些其他電腦可能不會使用 Windows Server 2003 中包含的任何 SMB 安全機制。"
    remediation: "要透過 GP 設定推薦的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Send unencrypted password to third-party SMB servers"
    compliance:
      - cis: ["2.3.8.3"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnablePlainTextPassword'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnablePlainTextPassword -> 0'

  - id: 15537
    title: "確保「Microsoft 網路伺服器：掛起會話之前所需的空閒時間量」設定為「15 分鐘或更少」。"
    description: "此策略設定可讓您指定在 SMB 會話因不活動而暫停會話之前必須經過的連續空閒時間量。管理員可以使用此策略設定來控制電腦何時掛起不活動的 SMB 會話。如果用戶端活動恢復，會話將自動重新建立。最大值為99999，即超過69天；實際上，該值會停用該設定。此設定的建議狀態是：15 分鐘或更少。"
    rationale: "每個 SMB 會話都會消耗伺服器資源，大量空會話會降低伺服器速度或可能導致伺服器失敗。攻擊者可以重複建立 SMB 會話，直到伺服器的 SMB 服務變得緩慢或無回應。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為 15 分鐘或更少：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Amount of idle time required before suspending session"
    compliance:
      - cis: ["2.3.9.1"]
      - cis_csc: ["4.3"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect -> n:^(\d+) compare <= 15'

  - id: 15538
    title: "確保「Microsoft 網路伺服器：對通訊進行數位簽章（始終）」設定為「啟用」。"
    description: "此策略設定確定 SMB 伺服器元件是否需要封包簽署。在混合式環境中啟用此策略設定可防止下游用戶端將工作站用作網路伺服器。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "若要透過 GP 建立建議的設定，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Digitally sign communications (always)"
    compliance:
      - cis: ["2.3.9.2"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RequireSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RequireSecuritySignature -> 1'

  - id: 15539
    title: "確保「Microsoft 網路伺服器：對通訊進行數位簽章（如果用戶端同意）」設定為「啟用」。"
    description: "此原則設定決定 SMB 伺服器是否將與請求它的用戶端協商 SMB 封包簽章。如果用戶端沒有發出簽章請求，且未啟用 Microsoft 網路伺服器：數位簽章通訊（始終）設置，則無需簽章即可允許連線。注意：在網路上的 SMB 用戶端上啟用此原則設置，使其能夠完全有效地與環境中的所有用戶端和伺服器進行封包簽署。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    remediation: "要透過 GP 確立建議的配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Digitally sign communications (if client agrees)"
    compliance:
      - cis: ["2.3.9.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> EnableSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> EnableSecuritySignature -> 1'

  - id: 15540
    title: "確保「Microsoft 網路伺服器：登入時間到期時中斷用戶端連線」設定為「啟用」。"
    description: "此安全性設定決定是否在使用者帳戶的有效登入時間之外斷開連接到本機的使用者。此設定會影響伺服器訊息區塊 (SMB) 元件。如果啟用此策略設置，您還應該啟用網路安全：登入時間到期時強制登出（規則 2.3.11.6）。如果您的組織為使用者配置登入時間，則需要此政策設定來確保它們有效。此設定的建議狀態為：已啟用。"
    rationale: "如果您的組織為使用者配置登入時間，則啟用此策略設定是有意義的。否則，在登入時間之外不應存取網路資源的使用者實際上可能能夠透過在允許的時間內建立的會話繼續使用這些資源。"
    remediation: "要通過GP設立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Disconnect clients when logon hours expire"
    compliance:
      - cis: ["2.3.9.4"]
      - cis_csc: ["5.6"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff -> 1'

  - id: 15541
    title: "確保「Microsoft 網路伺服器：伺服器 SPN 目標名稱驗證等級」設定為「如果用戶端提供則接受」或更高。"
    description: "此政策設定控制具有共用資料夾或印表機的電腦（伺服器）在用戶端電腦使用伺服器訊息區塊 (SMB) 協定建立會話時提供的服務主體名稱 (SPN) 上執行的驗證等級。伺服器訊息區塊 (SMB) 協定為檔案和列印共用以及其他網路操作（例如遠端 Windows 管理）提供了基礎。 SMB 協定支援在 SMB 用戶端提供的驗證 blob 內驗證 SMB 伺服器服務主體名稱 (SPN)，以防止針對 SMB 伺服器的一類攻擊（稱為 SMB 中繼攻擊）。此設定將影響 SMB1 和 SMB2。此設定的建議狀態為：如果客戶端提供，則接受。將此設定配置為客戶端必需也符合基準。"
    rationale: "電腦的身份可以被欺騙以獲取對網路資源的未經授權的存取。"
    remediation: "若要透過 GP 建立建議配置，請將下列 UI 路徑設置為「接受如果由客戶提供」（配置為「需要來自客戶」也符合基準）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Server SPN target name validation level"
    compliance:
      - cis: ["2.3.9.5"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> SMBServerNameHardeningLevel'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> SMBServerNameHardeningLevel -> n:^(\d+) compare >= 1'

  - id: 15542
    title: "確保「網路存取：允許匿名 SID/名稱轉換」設定為「停用」。"
    description: "此策略設定確定匿名使用者是否可以要求另一個使用者的安全識別碼 (SID) 屬性，或使用 SID 取得其對應的使用者名稱。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，則具有本機存取權限的使用者可以使用眾所周知的管理員 SID 來了解內建管理員帳戶的真實名稱，即使該帳戶已重新命名。然後，該人可以使用該帳號名稱發動密碼猜測攻擊。"
    remediation: "若要透過群組原則建立建議的配置，請將以下使用者介面路徑設置為「停用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Allow anonymous SID/Name translation"
    compliance:
      - cis: ["2.3.10.1"]
    condition: all
    rules:
      - 'c:powershell "$null = secedit /export /cfg $env:temp/secexport.cfg; $(gc $env:temp/secexport.cfg | Select-String \"LSAAnonymousNameLookup\").ToString().Split(\"=\")[1].Trim()" -> r:0'

  - id: 15543
    title: "確保「網路存取：不允許匿名列舉 SAM 帳戶」設定為「啟用」。"
    description: "此政策設定控制匿名使用者列舉安全帳戶管理員 (SAM) 中的帳戶的能力。如果啟用此策略設置，具有匿名連接的使用者將無法列舉您環境中的系統上的網域帳戶使用者名稱。此策略設定還允許對匿名連線進行其他限制。此設定的建議狀態為：已啟用。注意：此策略對網域控制站沒有影響。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱並使用該資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者以獲取密碼或某種形式的安全資訊。）"
    remediation: "若要透過GP設定建議的設定，將以下UI路徑設定為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow anonymous enumeration of SAM accounts"
    compliance:
      - cis: ["2.3.10.2"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymousSAM'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymousSAM -> 1'

  - id: 15544
    title: "確保「網路存取：不允許匿名列舉 SAM 帳戶和共用」設定為「啟用」。"
    description: "此政策設定控制匿名使用者列舉 SAM 帳戶和共享的能力。如果啟用此策略設置，匿名使用者將無法列舉環境中系統上的網域帳戶使用者名稱和網路共用名稱。此設定的建議狀態為：已啟用。注意：此策略對網域控制站沒有影響。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱和共享資源，並使用這些資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者以獲取密碼或某種形式的安全資訊。）"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow anonymous enumeration of SAM accounts and shares"
    compliance:
      - cis: ["2.3.10.3"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymous'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymous -> 1'

  - id: 15545
    title: "確保「網路存取：不允許儲存網路驗證的密碼和憑證」設定為「啟用」。"
    description: "此原則設定確定憑證管理員（以前稱為儲存的使用者名稱和密碼）是否會儲存密碼或憑證以供日後在取得網域驗證時使用。此設定的建議狀態為：已啟用。注意：對此設定的變更只有在 Windows 重新啟動後才會生效。"
    rationale: "使用者登入電腦後可以存取快取的密碼。儘管此資訊聽起來很明顯，但如果使用者在不知情的情況下執行讀取密碼並將其轉發給另一個未經授權的使用者的惡意程式碼，則可能會出現問題。"
    remediation: "若要通過GP建立建議的配置，請設置以下UI路徑為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow storage of passwords and credentials for network authentication"
    compliance:
      - cis: ["2.3.10.4"]
      - pci_dss: ["3.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> DisableDomainCreds'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> DisableDomainCreds -> 1'

  - id: 15546
    title: "確保「網路存取：讓每個人權限套用至匿名使用者」設定為「停用」。"
    description: "此策略設定決定為電腦的匿名連線指派哪些附加權限。此設定的建議狀態是：停用。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱和共享資源，並使用這些資訊嘗試猜測密碼、執行社會工程攻擊或發動 DoS 攻擊。"
    remediation: "要透過 GP 設定建議的配置，將以下的使用者界面路徑設置為「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Let Everyone permissions apply to anonymous users"
    compliance:
      - cis: ["2.3.10.5"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> EveryoneIncludesAnonymous'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> EveryoneIncludesAnonymous -> 0'

  - id: 15547
    title: "確保「網路存取：可以匿名存取的命名管道」設定為「無」。"
    description: "此策略設定決定哪些通訊會話或管道將具有允許匿名存取的屬性和權限。此設定的建議狀態為：<空白>（即無）。"
    rationale: "限制可以匿名存取的命名管道將減少系統的攻擊面。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為<空白>（即無）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Named Pipes that can be accessed anonymously"
    compliance:
      - cis: ["2.3.10.6"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionPipes'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionPipes -> r:\S+'

  - id: 15548
    title: "確保配置「網路存取：遠端存取註冊表路徑」。"
    description: "此策略設定可決定透過網路存取哪些登錄路徑，無論 winreg 註冊表項的存取控制清單 (ACL) 中所列的使用者或群組為何。注意：Windows XP 中不存在此設定。 Windows XP 中有一個具有該名稱的設置，但在 Windows Server 2003、Windows Vista 和 Windows Server 2008（非 R2）中，它被稱為「網路存取：遠端存取登錄路徑和子路徑」。注意#2：配置此設定時，您指定一個或多個物件的清單。輸入清單時使用的分隔符號是換行或回車字元，即鍵入清單中的第一個對象，按 Enter 按鈕，鍵入下一個對象，再次按 Enter 等。列表。它還在群組原則編輯器的顯示窗格和策略結果集控制台中呈現為逗號分隔的清單。它在註冊表中記錄為 REG_MULTI_SZ 值中的換行分隔清單。此設定的建議狀態為：System\\CurrentControlSet\\Control\\ProductOptions System\\CurrentControlSet\\Control\\Server Applications Software\\Microsoft\\Windows NT\\CurrentVersion"
    rationale: "註冊表是一個包含電腦配置資訊的資料庫，其中許多資訊都是敏感資訊。攻擊者可以使用此資訊來促進未經授權的活動。為了降低此類攻擊的風險，在整個註冊表中分配了適當的 ACL，以幫助防止未經授權的使用者存取。"
    remediation: "要透過GP建立推薦的配置，請將以下UI路徑設定為: System\\CurrentControlSet\\Control\\ProductOptions System\\CurrentControlSet\\Control\\Server Applications SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Remotely accessible registry paths"
    compliance:
      - cis: ["2.3.10.7"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine -> r:System\\CurrentControlSet\\Control\\ProductOptions System\\CurrentControlSet\\Control\\Server Applications Software\\Microsoft\\Windows NT\\CurrentVersion'

  - id: 15549
    title: "確保配置「網路存取：遠端存取註冊表路徑和子路徑」。"
    description: "此政策設定決定了哪些註冊表路徑及子路徑會被透過網路存取，無論使用者或組別在winreg註冊表鍵的存取控制清單(ACL)中列出。注意：在Windows XP中，此設定稱為'Network access: Remotely accessible registry paths'，在Windows Vista、Windows Server 2008（非R2）和Windows Server 2003中具有相同名稱的設定在Windows XP中不存在。注意2：當你配置此設定時，你需指定一個或多個物件的列表。輸入列表時使用的分隔符是換行或回車字元，即在列表中輸入第一個物件，按Enter鍵，輸入下一個物件，再次按Enter等等。該設置值儲存在群組政策安全模板中為逗號分隔的列表。它在群組政策編輯器的顯示窗格和政策結果集控制台中也顯示為逗號分隔的列表。它以REG_MULTI_SZ值在註冊表中作為換行分隔的列表記錄。此設定的推薦狀態為：System\\CurrentControlSet\\Control\\Print\\Printers System\\CurrentControlSet\\Services\\Eventlog Software\\Microsoft\\OLAP Server Software\\Microsoft\\Windows NT\\CurrentVersion\\Print Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows System\\CurrentControlSet\\Control\\ContentIndex System\\CurrentControlSet\\Control\\Terminal Server System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib System\\CurrentControlSet\\Services\\SysmonLog"
    rationale: "註冊表包含敏感的電腦配置訊息，攻擊者可能會利用這些資訊來進行未經授權的活動。事實上，在整個註冊表中分配的預設 ACL 具有相當大的限制性，有助於保護註冊表免遭未經授權的用戶存取，從而降低了此類攻擊的風險。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為： System\\CurrentControlSet\\Control\\Print\\Printers System\\CurrentControlSet\\Services\\Eventlog SOFTWARE\\Microsoft\\OLAP Server SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows System\\CurrentControlSet\\Control\\ContentIndex System\\CurrentControlSet\\Control\\Terminal Server System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Perflib System\\CurrentControlSet\\Services\\SysmonLog Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Remotely accessible registry paths and sub-paths"
    compliance:
      - cis: ["2.3.10.8"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Print\\Printers'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Services\\Eventlog'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:Software\\Microsoft\\OLAP Server'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:Software\\Microsoft\\Windows NT\\CurrentVersion\\Print'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\ContentIndex'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Terminal Server'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:System\\CurrentControlSet\\Services\\SysmonLog'

  - id: 15550
    title: "確保「網路存取：限制對命名管道和共享的匿名存取」設定為「啟用」。"
    description: "啟用後，此策略設定將匿名存取權限限制為僅對網路存取：可以匿名存取的命名管道和網路存取：可以匿名存取的共用設定中指定的共用和管道。此策略設定透過在 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters 註冊表項中新增值為 1 的 RestrictNullSessAccess 來控制對電腦上共用的空會話存取。此登錄值可開啟或關閉空會話共用，以控制伺服器服務是否限制未經驗證的用戶端對命名資源的存取。此設定的建議狀態為：已啟用。"
    rationale: "空會話是一個弱點，可以透過環境中電腦上的共用（包括預設共用）來利用。"
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Restrict anonymous access to Named Pipes and Shares"
    compliance:
      - cis: ["2.3.10.9"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RestrictNullSessAccess'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RestrictNullSessAccess -> 1'

  - id: 15551
    title: "確保「網路存取：限制允許遠端呼叫 SAM 的用戶端」設定為「管理員：遠端存取：允許」。"
    description: '此政策設定可讓您限制與 SAM 的遠端 RPC 連線。此設定的建議狀態是：管理員：遠端存取：允許。注意：需要 Windows 10 R1607、Server 2016 或更高版本的作業系統才能在群組原則中存取和設定此值。注意#2：如果您的組織正在使用 Azure 進階威脅防護 (APT)，則需要將服務帳戶「AATP 服務」新增至建議設定。有關新增「AATP 服務」帳戶的詳細資訊，請參閱配置 SAM-R 以在 Microsoft Defender for Identity | 中啟用橫向移動路徑檢測。微軟檔案。'
    rationale: "確保未經授權的使用者無法匿名列出本地帳戶名稱或群組並使用這些資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者以獲取密碼或某種形式的安全資訊。）"
    remediation: "透過 GP 建立推薦的配置，將以下使用者介面路徑設定為 Administrators: Remote Access: Allow: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Restrict clients allowed to make remote calls to SAM"
    compliance:
      - cis: ["2.3.10.10"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> restrictremotesam'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> restrictremotesam -> r:O:BAG:BAD:\(A;;RC;;;BA\)'

  - id: 15552
    title: "確保「網路存取：可以匿名存取的共用」設定為「無」。"
    description: "此策略設定確定匿名使用者可以存取哪些網路共用。此策略設定的預設配置影響不大，因為所有使用者都必須經過身份驗證才能存取伺服器上的共用資源。此設定的建議狀態為：<空白>（即無）。"
    rationale: "在此設定中允許任何值都是非常危險的。任何網路使用者都可以存取列出的任何共享，這可能會導致敏感資料的暴露或損壞。"
    remediation: "若要透過 GP 設定建議的配置，將以下 UI 路徑設置為<空白>（即無）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Shares that can be accessed anonymously"
    compliance:
      - cis: ["2.3.10.11"]
      - cis_csc: ["3.3"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionShares'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionShares -> \S+'

  - id: 15553
    title: "確保「網路存取：本機帳戶的共用和安全模型」設定為「經典 - 本機使用者以自己的身分進行驗證」。"
    description: "此政策設定決定如何對使用本機帳戶的網路登入進行驗證。經典選項允許精確控制對資源的存取，包括為不同使用者指派對相同資源的不同類型的存取權限。僅訪客選項可讓您平等對待所有使用者。在這種情況下，所有使用者都以訪客身份進行身份驗證，只是為了獲得對給定資源的相同存取等級。此設定的建議狀態是：經典 - 本機使用者以自己的身分進行身份驗證。注意：此設定不會影響使用 Telnet 或遠端桌面服務（以前稱為終端機服務）等服務遠端執行的互動式登入。"
    rationale: "使用僅限來賓模型，任何可以透過網路對您的電腦進行身份驗證的使用者都會以來賓權限進行身份驗證，這可能意味著他們將沒有對該電腦上的共用資源的寫入存取權限。儘管此限制確實提高了安全性，但它使授權使用者存取這些電腦上的共用資源變得更加困難，因為這些資源上的 ACL 必須包括來賓帳戶的存取控制條目 (ACE)。對於經典模型，本機帳戶應該受到密碼保護。否則，如果啟用了來賓存取，則任何人都可以使用這些使用者帳戶來存取共用系統資源。"
    remediation: "若要通過 GP 建立建議配置，將以下 UI 路徑設置為經典模式 - 本地用戶以自己的身份進行身份驗證: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Sharing and security model for local accounts"
    compliance:
      - cis: ["2.3.10.12"]
      - pci_dss: ["7.1.3"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> ForceGuest'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> ForceGuest -> 0'

  # 2.3.11.1 Ensure 'Network security: Allow Local System to use computer identity for NTLM' is set to 'Enabled'
  - id: 15554
    title: "確保「網路安全：允許本機系統使用 NTLM 的電腦標識」設定為「已啟用」。"
    description: "此政策設定決定在還原至 NTLM 驗證時使用協商的本機系統服務是否可以使用電腦識別。至少 Windows 7 或 Windows Server 2008 R2 支援此原則。此設定的建議狀態為：已啟用。"
    rationale: "連接到執行早於 Windows Vista 或 Windows Server 2008（非 R2）的 Windows 版本的電腦時，作為本機系統執行並使用還原為 NTLM 的 SPNEGO（協商）的服務將使用電腦識別。在 Windows 7 中，如果您要連線到執行 Windows Server 2008 或 Windows Vista 的計算機，則系統服務將使用電腦識別或 NULL 工作階段。當與 NULL 會話連線時，系統會建立一個系統產生的會話金鑰，該金鑰不提供任何保護，但允許應用程式對資料進行簽署和加密而不會出現錯誤。當與電腦身分連接時，支援簽章和加密以提供資料保護。"
    remediation: "要通過 GP 設定推薦的配置，將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Allow Local System to use computer identity for NTLM"
    compliance:
      - cis: ["2.3.11.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> UseMachineId'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> UseMachineId -> 1'

  # 2.3.11.2 Ensure 'Network security: Allow LocalSystem NULL session fallback' is set to 'Disabled'
  - id: 15555
    title: "確保「網路安全：允許 LocalSystem NULL 會話回退」設定為「停用」。"
    description: "此政策設定決定與 LocalSystem 一起使用時是否允許 NTLM 回退到 NULL 會話。此設定的建議狀態是：停用。"
    rationale: "NULL 會話的安全性較低，因為根據定義它們未經身份驗證。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「停用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Allow LocalSystem NULL session fallback"
    compliance:
      - cis: ["2.3.11.2"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> allownullsessionfallback'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> allownullsessionfallback -> 0'

  # 2.3.11.3 Ensure 'Network Security: Allow PKU2U authentication requests to this computer to use online identities' is set to 'Disabled'
  - id: 15556
    title: "確保「網路安全：允許對此電腦的 PKU2U 身份驗證請求使用線上身分」設定為「停用」。"
    description: "此設定確定線上身份是否能夠對此電腦進行身份驗證。 Windows 7 和 Windows Server 2008 R2 中引入的基於公鑰加密的使用者到使用者 (PKU2U) 協定是作為安全性支援提供者 (SSP) 實現的。 SSP 支援點對點身份驗證，特別是透過名為 HomeGroup 的 Windows 7 媒體和檔案共用功能，該功能允許在非網域成員的電腦之間進行共用。在 PKU2U 中，協商身份驗證包引入了新的擴充 Spnego.dll。在先前版本的 Windows 中，Negotiate 決定要使用 Kerberos 還是 NTLM 進行驗證。 Negotiate 的擴充 SSP Negoexts.dll 被 Windows 視為驗證協定，支援包括 PKU2U 在內的 Microsoft SSP。當電腦設定為使用線上 ID 接受驗證請求時，Negoexts.dll 會呼叫用於登入的電腦上的 PKU2U SSP。 PKU2U SSP 取得本機憑證並在對等電腦之間交換原則。在對等電腦上進行驗證後，元資料中的憑證將傳送至登入對等方進行驗證，並將使用者的憑證與安全性權杖相關聯，然後登入程序完成。此設定的建議狀態是：停用。"
    rationale: "PKU2U 協定是一種點對點身份驗證協定 - 身份驗證應在大多數託管網路中集中管理。"
    remediation: "要透過群組原則設定建議的配置，將以下UI路徑設為「停用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network Security: Allow PKU2U authentication requests to this computer to use online identities"
    compliance:
      - cis: ["2.3.11.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u -> AllowOnlineID'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u -> AllowOnlineID -> 0'

  # 2.3.11.4 Ensure 'Network Security: Configure encryption types allowed for Kerberos' is set to 'RC4_HMAC_MD5, AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types'
  - id: 15557
    title: "確保「網路安全：設定 Kerberos 允許的加密類型」設定為「AES128_HMAC_SHA1、AES256_HMAC_SHA1、未來加密類型」。"
    description: "此策略設定可讓您設定允許 Kerberos 使用的加密類型。此設定的建議狀態為：AES128_HMAC_SHA1、AES256_HMAC_SHA1、未來加密類型。注意：某些舊版應用程式和作業系統可能仍需要 RC4_HMAC_MD5 - 我們建議您在您的環境中進行測試並驗證是否可以安全刪除它。"
    rationale: "每種加密演算法的強度各不相同，選擇更強的演算法將降低妥協的風險，但是當電腦嘗試使用不支援它們的系統進行身份驗證時，這樣做可能會導致問題。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 AES128_HMAC_SHA1、AES256_HMAC_SHA1、Future encryption types: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Configure encryption types allowed for Kerberos"
    compliance:
      - cis: ["2.3.11.4"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters -> SupportedEncryptionTypes'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters -> SupportedEncryptionTypes -> r:2147483644|2147483640'

  # 2.3.11.5 Ensure 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled'
  - id: 15558
    title: "確保「網路安全：下次變更密碼時不儲存 LAN Manager 雜湊值」設定為「啟用」。"
    description: "此原則設定決定更改密碼時是否儲存新密碼的 LAN Manager (LM) 雜湊值。與加密性更強的 Microsoft Windows NT 雜湊相比，LM 雜湊相對較弱且容易受到攻擊。由於 LM 雜湊值儲存在本機的安全資料庫中，因此如果資料庫受到攻擊，密碼很容易被洩露。注意：啟用此策略設定後，較舊的作業系統和某些第三方應用程式可能會失敗。另請注意，啟用此設定後，需要更改所有帳戶的密碼才能獲得適當的好處。此設定的建議狀態為：已啟用。"
    rationale: "SAM 檔案可能成為尋求存取使用者名稱和密碼雜湊值的攻擊者的目標。此類攻擊使用特殊工具來破解密碼，然後可以使用這些工具來冒充使用者並取得網路資源的存取權限。如果啟用此策略設置，將無法阻止這些類型的攻擊，但這些類型的攻擊將更難成功。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Do not store LAN Manager hash value on next password change"
    compliance:
      - cis: ["2.3.11.5"]
      - cis_csc: ["3.11"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> NoLMHash'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> NoLMHash -> 1'

  # 2.3.11.6 Ensure 'Network security: Force logoff when logon hours expire' is set to 'Enabled'
  - id: 15559
    title: "確保「網路安全：登入時間到期時強制登出」設定為「啟用」。"
    description: "此政策設定決定是否在使用者帳戶的有效登入時間之外斷開連接到本機的使用者。此設定會影響伺服器訊息區塊 (SMB) 元件。如果啟用此策略設置，您也應該啟用 Microsoft 網路伺服器：登入時間到期時中斷用戶端連線（規則 2.3.9.4）。此設定的建議狀態為：已啟用。"
    rationale: "如果停用此設置，使用者可以在分配的登入時間之外保持與電腦的連接。"
    remediation: "若要通過 GP 建立建議配置，將以下 UI 路徑設置為「啟用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Force logoff when logon hours expire"
    compliance:
      - cis: ["2.3.11.6"]
      - cis_csc: ["5.6"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff -> 1'

  # 2.3.11.7 Ensure 'Network security: LAN Manager authentication level' is set to 'Send NTLMv2 response only. Refuse LM & NTLM'
  - id: 15560
    title: "確保「網路安全：LAN Manager 驗證等級」設定為「僅傳送 NTLMv2 回應」。拒絕 LM 和 NTLM'。"
    description: "LAN Manager (LM) 是早期 Microsoft 用戶端/伺服器軟體系列（早於 Windows NT），它允許使用者在單一網路上將個人電腦連結在一起。 LM 網路功能包括透明檔案和列印共享、使用者安全功能和網路管理工具。在 Active Directory 網域中，Kerberos 協定是預設驗證協定。但是，如果由於某種原因未協商 Kerberos 協定，Active Directory 將使用 LM、NTLM 或 NTLMv2。 LAN Manager 驗證包括LM、NTLM 和NTLM 版本2 (NTLMv2) 變體，並且是用於在所有Windows 用戶端執行以下操作時對其進行身份驗證的協定： - 加入網域- 在Active Directory 林之間進行驗證- 向下級網域 - 對不執行 Windows 2000、Windows Server 2003 或 Windows XP 的電腦進行驗證 - 對不在網域中的電腦進行驗證。網路安全：LAN Manager 驗證等級設定決定網路登入使用哪種質詢/回應身分驗證協定。此選擇會影響用戶端使用的身份驗證協定等級、協商的會話安全性等級以及伺服器接受的驗證等級。此設定的建議狀態是：僅傳送 NTLMv2 回應。拒絕 LM 和 NTLM。"
    rationale: "預設情況下，Windows 2000 和 Windows XP 用戶端會配置為傳送 LM 和 NTLM 驗證回應（基於 Windows 95 和基於 Windows 98 的用戶端僅傳送 LM）。 Windows Vista / Windows Server 2008（非 R2）之前的作業系統中的預設設定允許所有用戶端透過伺服器進行驗證並使用其資源。然而，這意味著 LM 回應（最弱的身份驗證回應形式）是透過網路發送的，攻擊者有可能嗅探該流量以更輕鬆地重現用戶的密碼。 Windows 95、Windows 98 和Windows NT 作業系統無法使用Kerberos 版本5 協定進行驗證。因此，在 Windows Server 2003 網域中，這些電腦預設使用 LM 和 NTLM 協定進行網路驗證。您可以使用 NTLMv2 對 Windows 95、Windows 98 和 Windows NT 實作更安全的驗證協定。對於登入過程，NTLMv2 使用安全通道來保護驗證過程。即使您對較舊的用戶端和伺服器使用 NTLMv2，但作為網域成員的基於 Windows 的用戶端和伺服器也將使用 Kerberos 驗證協定向 Windows Server 2003 或更高版本的網域控制站進行驗證。由於這些原因，強烈建議盡可能限制 LM 和 NTLM（非 v2）的使用。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為：Send NTLMv2 response only. Refuse LM & NTLM: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: LAN Manager authentication level"
    compliance:
      - cis: ["2.3.11.7"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LmCompatibilityLevel '
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LmCompatibilityLevel -> 5'

  # 2.3.11.8 Ensure 'Network security: LDAP client signing requirements' is set to 'Negotiate signing' or higher
  - id: 15561
    title: "確保「網路安全：LDAP 用戶端簽章要求」設定為「協商簽章」或更高。"
    description: "此政策設定決定代表發出 LDAP BIND 請求的用戶端請求的資料簽章等級。注意：此策略設定對 LDAP 簡單綁定 (ldap_simple_bind) 或透過 SSL 的 LDAP 簡單綁定 (ldap_simple_bind_s) 沒有任何影響。 Windows XP Professional 隨附的 Microsoft LDAP 用戶端不使用 ldap_simple_bind 或 ldap_simple_bind_s 與網域控制站通訊。此設定的建議狀態為：協商簽名。將此設定配置為需要簽名也符合基準。"
    rationale: "未簽署的網路流量容易受到中間人攻擊，入侵者捕獲客戶端和伺服器之間的資料包，修改它們，然後將它們轉發到伺服器。對於 LDAP 伺服器，這種敏感度意味著攻擊者可能會導致伺服器根據 LDAP 查詢中的錯誤或變更的資料做出決策。為了降低網路中的這種風險，您可以實施強大的實體安全措施來保護網路基礎架構。此外，如果您需要透過 IPsec 驗證標頭對所有網路封包進行數位簽名，則可能會使所有類型的中間人攻擊變得極其困難。"
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為協商簽名（配置為需要簽名也符合基準）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: LDAP client signing requirements"
    compliance:
      - cis: ["2.3.11.8"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP -> LDAPClientIntegrity'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP -> LDAPClientIntegrity -> n:(\d+) compare >= 1'

  # 2.3.11.9 Ensure 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients' is set to 'Require NTLMv2 session security, Require 128-bit encryption'
  - id: 15562
    title: "確保「網路安全：基於 NTLM SSP（包括安全性 RPC）用戶端的最低會話安全性」設定為「需要 NTLMv2 會話安全性，需要 128 位元加密」。"
    description: "此原則設定決定用戶端允許使用 NTLM 安全性支援提供者 (SSP) 的應用程式執行哪些行為。 SSP 介面 (SSPI) 由需要驗證服務的應用程式使用。該設定不會修改身份驗證序列的工作方式，而是要求使用 SSPI 的應用程式中的某些行為。此設定的建議狀態是：需要 NTLMv2 會話安全性、需要 128 位元加密。注意：這些值取決於網路安全性：LAN Manager 驗證等級（規則 2.3.11.7）安全性設定值。"
    rationale: "您可以為此政策設定啟用這兩個選項，以協助保護使用 NTLM 安全性支援提供者 (NTLM SSP) 的網路流量免遭取得相同網路存取權限的攻擊者暴露或竄改。換句話說，這些選項有助於防止中間人攻擊。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設定為要求NTLMv2會話安全性，要求128位元加密：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Minimum session security for NTLM SSP based (including secure RPC) clients"
    compliance:
      - cis: ["2.3.11.9"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinClientSec'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinClientSec -> 537395200'

  # 2.3.11.10 Ensure 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers' is set to 'Require NTLMv2 session security, Require 128-bit encryption'
  - id: 15563
    title: "確保「網路安全：基於 NTLM SSP（包括安全性 RPC）伺服器的最低會話安全性」設定為「需要 NTLMv2 會話安全性，需要 128 位元加密」。"
    description: "此原則設定決定伺服器允許使用 NTLM 安全性支援提供者 (SSP) 的應用程式執行哪些行為。 SSP 介面 (SSPI) 由需要驗證服務的應用程式使用。該設定不會修改身份驗證序列的工作方式，而是要求使用 SSPI 的應用程式中的某些行為。此設定的建議狀態是：需要 NTLMv2 會話安全性、需要 128 位元加密。注意：這些值取決於網路安全性：LAN Manager 驗證等級（規則 2.3.11.7）安全性設定值。"
    rationale: "您可以啟用此政策設定的所有選項，以協助保護使用 NTLM 安全性支援提供者 (NTLM SSP) 的網路流量免遭取得相同網路存取權限的攻擊者暴露或竄改。也就是說，這些選項有助於防止中間人攻擊。"
    remediation: "透過GP設定推薦的配置，將以下UI路徑設定為要求NTLMv2會話安全性，要求128位元加密: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Minimum session security for NTLM SSP based (including secure RPC) servers"
    compliance:
      - cis: ["2.3.11.10"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    references:
      - https://workbench.cisecurity.org/benchmarks/288
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinServerSec'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinServerSec -> 537395200'

  - id: 15564
    title: "確保「系統加密：對電腦上儲存的使用者金鑰強制實施強金鑰保護」設定為「首次使用金鑰時提示使用者」或更高等級。"
    description: "此策略設定決定使用者的私密金鑰（例如其 S-MIME 金鑰）是否需要使用密碼。此設定的建議狀態為：首次使用金鑰時提示使用者。將此設定配置為「使用者每次使用金鑰時都必須輸入密碼」也符合基準。"
    rationale: "如果使用者的帳戶遭到洩漏或其電腦無意中不安全，則惡意使用者可以使用為使用者儲存的金鑰來存取受保護的資源。您可以設定此策略設置，以便使用者每次使用金鑰時都必須提供與其網域密碼不同的密碼。此配置使攻擊者更難以存取本機儲存的使用者金鑰，即使攻擊者控制了使用者的電腦並確定了其登入密碼。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為首次使用金鑰時提示用戶（配置為每次使用金鑰時用戶必須輸入密碼也符合基準）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System cryptography: Force strong key protection for user keys stored on the computer"
    compliance:
      - cis: ["2.3.14.1"]
      - cis_csc: ["3.11"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Cryptography'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Cryptography -> ForceKeyProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Cryptography -> ForceKeyProtection -> n:(\d+) compare > 0'

  # 2.3.15.1 Ensure 'System objects: Require case insensitivity for non-Windows subsystems' is set to 'Enabled'
  - id: 15565
    title: "確保“系統物件：要求非 Windows 子系統不區分大小寫”設定為“啟用”。"
    description: "此策略設定決定是否對所有子系統強制執行不區分大小寫。 Microsoft Win32 子系統不區分大小寫。但是，核心支援其他子系統區分大小寫，例如 UNIX 的可移植作業系統介面 (POSIX)。由於 Windows 不區分大小寫（但 POSIX 子系統將支援區分大小寫），因此如果不強制執行此策略設置，則 POSIX 子系統的使用者可能會透過使用混合大小寫標記來建立與另一個檔案同名的檔案。這種情況可能會阻止使用典型 Win32 工具的另一使用者存取這些檔案，因為只有其中一個檔案可用。此設定的建議狀態為：已啟用。"
    rationale: "由於 Windows 不區分大小寫，但 POSIX 子系統支援區分大小寫，因此如果不啟用此策略設置，該子系統的使用者可能會建立與另一個檔案同名但大小寫不同的檔案。當使用者嘗試從普通 Win32 工具存取此類檔案時，這種情況可能會讓使用者感到困惑，因為只有其中一個檔案可用。"
    remediation: "要透過 GP 建立建議配置，將以下使用者介面路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System objects: Require case insensitivity for non-Windows subsystems"
    compliance:
      - cis: ["2.3.15.1"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel -> ObCaseInsensitive'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel -> ObCaseInsensitive -> 1'

  # 2.3.15.2 Ensure 'System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)' is set to 'Enabled'
  - id: 15566
    title: "確保「系統物件：加強內部系統物件（例如符號連結）的預設權限」設定為「啟用」。"
    description: "此策略設定決定物件的預設自主存取控制清單 (DACL) 的強度。 Active Directory 維護共享系統資源的全域列表，例如 DOS 裝置名稱、互斥體和號誌。這樣，物件就可以在程序之間定位和共享。每種類型的物件都是使用預設 DACL 建立的，該 DACL 指定誰可以存取這些物件以及授予哪些權限。此設定的建議狀態為：已啟用。"
    rationale: "此設定確定物件的預設 DACL 的強度。 Windows 維護共享電腦資源的全域列表，以便可以在程序之間定位和共享物件。每種類型的物件都是使用預設 DACL 建立的，該 DACL 指定誰可以存取這些物件以及具有哪些權限。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)"
    compliance:
      - cis: ["2.3.15.2"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager -> ProtectionMode'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager -> ProtectionMode -> 1'

  # 2.3.17.1 Ensure 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is set to 'Enabled'
  - id: 15567
    title: "確保「使用者帳戶控制：內建管理員帳戶的管理員批准模式」設定為「啟用」。"
    description: "此策略設定控制內建管理員帳戶的管理員批准模式的行為。此設定的建議狀態為：已啟用。"
    rationale: "Windows Vista 中引入的使用者帳戶控制功能試圖緩解的風險之一是惡意軟體在提升的憑證下執行，而使用者或管理員不知道其活動。這些程式的攻擊媒介是發現名為「管理員」的帳戶的密碼，因為該使用者帳戶是為所有 Windows 安裝建立的。為了解決此風險，在 Windows Vista 和更高版本中，現在預設為內建管理員帳戶停用。在新電腦的預設安裝中，最初透過以下兩種方式之一設定對電腦具有管理控制權的帳戶： - 如果電腦未加入網域，則您建立的第一個使用者帳戶具有與本機使用者相同的權限行政人員。 - 如果電腦加入網域，則不會建立本機管理員帳戶。如果需要本機管理員帳戶，則企業或網域管理員必須登入電腦並建立帳戶。安裝 Windows 後，可以手動啟用內建管理員帳戶，但我們強烈建議保持停用該帳戶。"
    remediation: "要透過 GP 建立推薦配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Admin Approval Mode for the Built-in Administrator account"
    compliance:
      - cis: ["2.3.17.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> FilterAdministratorToken'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> FilterAdministratorToken -> 1'

  - id: 15568
    title: "確保「使用者帳號控制：管理員批准模式下管理員提升提示的行為」設定為「在安全桌面上提示同意」。"
    description: "此策略設定控制管理員提升提示的行為。此設定的建議狀態是：在安全桌面上提示同意。"
    rationale: "Windows Vista 中引入的 UAC 功能試圖緩解的風險之一是惡意軟體在提升的憑證下運行，而使用者或管理員不知道其活動。此設定提高了管理員對提升權限操作的認識，並允許管理員在惡意程式嘗試提升其權限時阻止該程式提升其權限。"
    remediation: "要透過GP建立建議的配置，請將以下使用者介面路徑設置為在安全桌面上提示同意：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode"
    compliance:
      - cis: ["2.3.17.2"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorAdmin'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorAdmin -> r:^2$'

  - id: 15569
    title: "確保「使用者帳號控制：標準使用者的提升提示行為」設定為「自動拒絕提升請求」。"
    description: "此策略設定控制標準使用者的提升提示的行為。此設定的建議狀態為：自動拒絕提升請求。"
    rationale: "Windows Vista 中引入的使用者帳戶控制功能試圖緩解的風險之一是惡意程式在提升的憑證下執行，而使用者或管理員不知道其活動。此設定讓使用者意識到程式需要使用提升的權限操作，並要求使用者能夠提供管理憑證才能執行該程式。"
    remediation: "要通過GP建立推薦配置，設置以下UI路徑為自動拒絕提升請求: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Behavior of the elevation prompt for standard users"
    compliance:
      - cis: ["2.3.17.3"]
      - pci_dss: ["7.1.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorUser'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorUser -> 0'

  - id: 15570
    title: "確保「使用者帳戶控制：偵測應用程式安裝並提示提升」設定為「啟用」。"
    description: "此策略設定控制電腦的應用程式安裝偵測的行為。此設定的建議狀態為：已啟用。"
    rationale: "某些惡意軟體在獲得運行權限後會嘗試自行安裝。例如，具有可信任應用程式外殼的惡意軟體。使用者可能已授予程式運行權限，因為該程式是受信任的，但如果隨後提示他們安裝未知組件，則這提供了另一種在軟體造成損害之前捕獲該軟體的方法"
    remediation: "若要通過 GP 設定建議的配置，將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Detect application installations and prompt for elevation"
    compliance:
      - cis: ["2.3.17.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableInstallerDetection'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableInstallerDetection -> 1'

  - id: 15571
    title: "確保「使用者帳戶控制：僅提升安裝在安全位置的 UIAccess 應用程式」設定為「啟用」。"
    description: "此原則設定控制請求以使用者介面可存取性 (UIAccess) 完整性等級執行的應用程式是否必須駐留在檔案系統中的安全位置。安全位置僅限於以下位置： - ...\\Program Files\\，包含子資料夾 - ...\\Windows\\system32\\； - ...\\Program Files (x86)\\，包括子資料夾（適用於 64 位元版本的 Windows）。注意：Windows 會對請求以 UIAccess 完整性等級執行的任何互動式應用程式強制執行公鑰基礎架構 (PKI) 簽章檢查，無論此安全性設定的狀態為何。此設定的建議狀態為：已啟用。"
    rationale: "當應用程式的權限從標準使用者提升到管理員時，UIAccess Integrity 允許應用程式繞過使用者介面權限隔離 (UIPI) 限制。這是支援可存取性功能所必需的，例如將使用者介面傳輸為替代形式的螢幕閱讀器。使用 UIAccess 權限啟動的程序具有以下功能： - 設定前景視窗。 - 使用 SendInput 函數驅動任何應用程式視窗。 - 使用低階掛鉤、原始輸入、GetKeyState、GetAsyncKeyState 和 GetKeyboardInput 對所有完整性等級使用讀取輸入。 - 設定日記鉤。 - 使用 AttachThreadInput 將執行緒附加到更高完整性的輸入佇列。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Only elevate UIAccess applications that are installed in secure locations"
    compliance:
      - cis: ["2.3.17.5"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableSecureUIAPaths'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableSecureUIAPaths -> 1'

  - id: 15572
    title: "確保「使用者帳戶控制：在管理員批准模式下執行所有管理員」設定為「啟用」。"
    description: "此政策設定控制電腦的所有使用者帳戶控制 (UAC) 政策設定的行為。如果變更此策略設置，則必須重新啟動電腦。此設定的建議狀態為：已啟用。注意：如果停用此原則設置，安全中心會通知您作業系統的整體安全性已降低。"
    rationale: "這是開啟或關閉 UAC 的設定。如果停用此設置，將不會使用 UAC，且系統上不會出現任何依賴 UAC 的安全優勢和風險緩解措施。"
    remediation: "要透過群組原則建立建議的配置，將以下界面路徑設為「啟用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Run all administrators in Admin Approval Mode"
    compliance:
      - cis: ["2.3.17.6"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableLUA'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableLUA -> 1'

  - id: 15573
    title: "確保「使用者帳戶控制：提示提升時切換到安全桌面」設定為「已啟用」。"
    description: "此策略設定控制是否在互動式使用者的桌面或安全桌面上顯示提升請求提示。此設定的建議狀態為：已啟用。"
    rationale: "標準提升提示對話方塊可能會被欺騙，這可能會導致用戶向惡意軟體洩露其密碼。安全桌面在提示提升時呈現出非常明顯的外觀，使用者桌面變暗，提升提示 UI 更加突出。這增加了習慣安全桌面的使用者識別欺騙性提升提示對話方塊而不會上當的可能性。"
    remediation: "要透過群組原則（GP）建立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Switch to the secure desktop when prompting for elevation"
    compliance:
      - cis: ["2.3.17.7"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> PromptOnSecureDesktop'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> PromptOnSecureDesktop -> 1'

  - id: 15574
    title: "確保「使用者帳戶控制：將檔案和註冊表寫入失敗虛擬化到每個使用者位置」設定為「啟用」。"
    description: "此策略設定控制應用程式寫入失敗是否會重新導向到定義的註冊表和檔案系統位置。此策略設定可以減輕以管理員身分執行的應用程式並將執行時間應用程式資料寫入到： - %ProgramFiles% - %windir% - %windir%\\System32 - HKEY_LOCAL_MACHINE\\SOFTWARE。此設定的建議狀態為：已啟用。"
    rationale: "此設定透過確保舊應用程式僅將資料寫入允許的位置來減少漏洞。"
    remediation: "要透過 GP 設定建議的配置，請將以下 UI 路徑設為「啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Virtualize file and registry write failures to per-user locations"
    compliance:
      - cis: ["2.3.17.8"]
      - pci_dss: ["6.5.8"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableVirtualization'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableVirtualization -> 1'

  - id: 15575
    title: "確保「藍牙音訊閘道服務 (BTAGService)」設定為「停用」。"
    description: "支援藍牙免持設定檔的音訊閘道器角色的服務。此設定的建議狀態是：停用。"
    rationale: "藍牙技術具有固有的安全風險－尤其是在 v2.1 標準之前。無線藍牙流量沒有很好地加密（如果有的話），因此在高安全性環境中，不應允許它，儘管無法使用藍牙設備會增加不便。"
    remediation: "要通過 GP 建立建議的配置, 請將以下 UI 路徑設置為:「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Bluetooth Audio Gateway Service. 注意: 此服務首次出現在 Windows 10 Release 1803 中。 它似乎取代了舊的 Bluetooth Handsfree Service (BthHFSrv)，該服務在那個版本中被刪除 (這不只是重命名, 而是一個不同的服務)。"
    compliance:
      - cis: ["5.1"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BTAGService -> Start -> 4'

  - id: 15576
    title: "確保「藍牙支援服務 (bthserv)」設定為「停用」。"
    description: "藍牙服務支援遠端藍牙裝置的發現和關聯。此設定的建議狀態是：停用。"
    rationale: "藍牙技術具有固有的安全風險－尤其是在 v2.1 標準之前。無線藍牙流量沒有很好地加密（如果有的話），因此在高安全性環境中，不應允許它，儘管無法使用藍牙設備會增加不便。"
    remediation: "要透過GP建立建議的配置，請將以下UI途徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Bluetooth Support Service"
    compliance:
      - cis: ["5.2"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bthserv -> Start -> 4'

  - id: 15577
    title: "確保「下載的地圖管理器 (MapsBroker)」設定為「停用」。"
    description: "用於應用程式存取下載的地圖的 Windows 服務。該服務由存取下載地圖的應用程式按需啟動。"
    rationale: "地圖技術可能會不情願地向攻擊者和其他獲取資訊的軟體洩露您的位置。此外，在不需要時應盡量減少從第三方來源自動下載資料。因此，在高安全性環境中不需要此服務。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Downloaded Maps Manager"
    compliance:
      - cis: ["5.4"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MapsBroker -> Start -> 4'

  - id: 15578
    title: "確保「地理位置服務 (lfsvc)」設定為「停用」。"
    description: "此服務監視系統的目前位置並管理地理圍欄（具有關聯事件的地理位置）。此設定的建議狀態是：停用。"
    rationale: "此設定會影響位置功能（例如 GPS 或其他位置追蹤）。從安全角度來看，在大多數情況下向軟體透露您的位置並不是一個好主意，但也有合法用途，例如地圖軟體。但是，它們不應該在高安全性環境中使用。"
    remediation: "透過群組政策 (GP) 設定建議的配置，將以下 UI 路徑設為：「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Geolocation Service"
    compliance:
      - cis: ["5.5"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lfsvc -> Start -> 4'

  - id: 15579
    title: "確保“IIS 管理服務 (IISADMIN)”設定為“已停用”或“未安裝”。"
    description: "使伺服器能夠管理 IIS 元資料庫。 IIS 元資料庫儲存 SMTP 和 FTP 服務的配置。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 提供，但透過啟用可選的 Windows 功能（Internet 資訊服務）來安裝。注意#2：組織可以選擇選擇性地向 Web 開發人員授予例外，以允許在其工作站上使用 IIS（或其他 Web 伺服器），以便他們在本地測試和開發網頁。然而，組織應該追蹤這些機器並確保安全控制和緩解措施保持最新，以降低妥協風險。"
    rationale: "從工作站託管網站會增加安全風險，因為該工作站的攻擊面會大幅增加。如果沒有採取適當的安全緩解措施，成功攻擊的機會就會顯著增加。注意：此安全性問題適用於安裝在工作站上的任何 Web 伺服器應用程序，而不僅僅是 IIS。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為：「停用」或確保未安裝該服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\IIS Admin Service"
    compliance:
      - cis: ["5.6"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\IISADMIN'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\IISADMIN -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\IISADMIN -> Start -> 4'

  - id: 15580
    title: "確保「紅外線監視器服務 (irmon)」設定為「停用」或「未安裝」。"
    description: "檢測範圍內的其他紅外線設備並啟動檔案傳輸應用程式。此設定的建議狀態為：已停用或未安裝。"
    rationale: "紅外線連接可能是資料外洩的來源 - 特別是透過自動「檔案傳輸應用程式」功能。企業管理的系統應該使用比紅外線更安全的連接方法。"
    remediation: "要透過GP來建立建議的配置，將以下UI路徑設置為：「停用」或確保未安裝此服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Infrared monitor service"
    compliance:
      - cis: ["5.7"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\irmon'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\irmon -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\irmon -> Start -> 4'

  - id: 15581
    title: "確保「Internet 連線共用 (ICS) (SharedAccess)」設定為「停用」。"
    description: "為家庭或小型辦公室網路提供網路存取轉換、尋址、名稱解析和/或入侵防禦服務。此設定的建議狀態是：停用。"
    rationale: "Internet 連線共用(ICS) 是一項功能，可讓某人與網路上的其他電腦「共用」其Internet 連線- 它專為只有一台電腦可以存取Internet 的家庭或小型辦公環境而設計- 它有效地將那台電腦變成了一台電腦網路路由器。此功能會導致網路橋接，並可能繞過其他更安全的路徑。它不應該在任何企業管理的系統上使用。"
    remediation: "要通過GP確立建議配置，將以下UI路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Internet Connection Sharing (ICS)"
    compliance:
      - cis: ["5.8"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess -> Start -> 4'

  - id: 15582
    title: "確保「鏈路層拓撲發現映射器 (lltdsvc)」設定為「停用」。"
    description: "建立網路地圖，其中包含 PC 和裝置拓撲（連接）資訊以及描述每台 PC 和裝置的元資料。此設定的建議狀態是：停用。"
    rationale: "此服務啟用的功能可能會被用於未經授權的發現和連接網路設備。停用該服務有助於防止回應高安全環境中的網路拓撲發現請求。"
    remediation: "要透過群組原則設定建議的設定，將以下路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Link-Layer Topology Discovery Mapper"
    compliance:
      - cis: ["5.9"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lltdsvc -> Start -> 4'

  - id: 15583
    title: "確保「LxssManager (LxssManager)」設定為「已停用」或「未安裝」。"
    description: "LXSS Manager 服務支援執行本機 ELF 二進位檔案。該服務提供 ELF 二進位檔案在 Windows 上運行所需的基礎架構。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 一起提供，但透過啟用可選的 Windows 功能（適用於 Linux 的 Windows 子系統）來安裝。"
    rationale: "Linux 子系統 (LXSS) 管理器允許對 Windows 上的 Linux 應用程式進行完整的系統存取，包括檔案系統。雖然這確實可以為運行這些應用程式帶來一些功能和效能優勢，但如果駭客將惡意程式碼注入 Linux 應用程序，它也會帶來新的安全風險。為了獲得最佳安全性，最好在 Linux 上運行 Linux 應用程序，在 Windows 上執行 Windows 應用程式。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為：「停用」或確保未安裝此服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\LxssManager"
    compliance:
      - cis: ["5.10"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LxssManager'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LxssManager -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LxssManager -> Start -> 4'

  - id: 15584
    title: "確保「Microsoft FTP 服務 (FTPSVC)」設定為「已停用」或「未安裝」。"
    description: "使伺服器成為檔案傳輸協定 (FTP) 伺服器。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 一起提供，但透過啟用可選的 Windows 功能（Internet 資訊服務 - FTP 伺服器）來安裝。"
    rationale: "從工作站託管 FTP 伺服器（尤其是不安全的 FTP 伺服器）會增加安全性風險，因為該工作站的攻擊面會大大增加。注意：此安全性問題適用於安裝在工作站上的任何 FTP 伺服器應用程序，而不僅僅是 IIS。"
    remediation: "若要透過 GP 建立建議的設定，將以下 UI 路徑設定為：「停用」或確保未安裝該服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Microsoft FTP Service"
    compliance:
      - cis: ["5.11"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FTPSVC'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FTPSVC -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FTPSVC -> Start -> 4'

  - id: 15585
    title: "確保「Microsoft iSCSI 啟動器服務 (MSiSCSI)」設定為「停用」。"
    description: "管理從該電腦到遠端目標裝置的 Internet SCSI (iSCSI) 會話。此設定的建議狀態是：停用。"
    rationale: "為了直接連接到 iSCSI 設備，此服務至關重要。然而，iSCSI 本身使用非常弱的身份驗證協定 (CHAP)，這意味著 iSCSI 通訊的密碼很容易暴露，除非使用 IPsec 等其他技術隔離和/或加密所有流量。此服務通常更適合受控環境中的伺服器，而不是需要高安全性的工作站。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設定為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Microsoft iSCSI Initiator Service"
    compliance:
      - cis: ["5.12"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSiSCSI -> Start -> 4'

  - id: 15586
    title: "確保“OpenSSH SSH 伺服器 (sshd)”設定為“已停用”或“未安裝”。"
    description: "基於 SSH 協定的服務，透過不安全的網路在兩個不受信任的主機之間提供安全的加密通訊。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 提供，但透過啟用可選的 Windows 功能（OpenSSH 伺服器）來安裝。"
    rationale: "從工作站託管 SSH 伺服器會增加安全性風險，因為該工作站的攻擊面會大大增加。注意：此安全性問題適用於工作站上安裝的任何 SSH 伺服器應用程序，而不僅僅是 Windows 隨附的應用程式。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為：「停用」 或確保未安裝此服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\OpenSSH SSH Server"
    compliance:
      - cis: ["5.13"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sshd'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sshd -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sshd -> Start -> 4'

  - id: 15587
    title: "確保「對等名稱解析協定 (PNRPsvc)」設定為「停用」。"
    description: "使用對等名稱解析協定 (PNRP) 啟用 Internet 上的無伺服器對等名稱解析。此設定的建議狀態是：停用。"
    rationale: "對等名稱解析協定是一種分散式且（大部分）無伺服器的方式來處理客戶端之間的名稱解析。在高安全性環境中，依賴由授權人員維護的集中名稱解析方法更加安全。"
    remediation: "若要通過 GP 設置推薦的配置，將以下 UI 路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Peer Name Resolution Protocol"
    compliance:
      - cis: ["5.14"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PNRPsvc -> Start -> 4'

  - id: 15588
    title: "確保「對等網路分組 (p2psvc)」設定為「停用」。"
    description: "使用點對點分組啟用多方通訊。此設定的建議狀態是：停用。"
    rationale: "對等名稱解析協定是一種分散式且（大部分）無伺服器的方式來處理客戶端之間的名稱解析。在高安全性環境中，依賴由授權人員維護的集中名稱解析方法更加安全。"
    remediation: "要透過群組原則建立推薦的配置，將以下 UI 路徑設定為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Peer Networking Grouping"
    compliance:
      - cis: ["5.15"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\p2psvc -> Start -> 4'

  - id: 15589
    title: "確保「對等網路身分識別管理器 (p2pimsvc)」設定為「停用」。"
    description: "為對等名稱解析協定 (PNRP) 和對等分組服務提供身分識別服務。此設定的建議狀態是：停用。"
    rationale: "對等名稱解析協定是一種分散式且（大部分）無伺服器的方式來處理客戶端之間的名稱解析。在高安全性環境中，依賴由授權人員維護的集中名稱解析方法更加安全。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Peer Networking Identity Manager"
    compliance:
      - cis: ["5.16"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\p2pimsvc -> Start -> 4'

  - id: 15590
    title: "確保「PNRP 電腦名稱發布服務 (PNRPAutoReg)」設定為「停用」。"
    description: "該服務使用對等名稱解析協定發布電腦名稱。設定透過 netsh 上下文「p2p pnrp peer」進行管理。此設定的建議狀態是：停用。"
    rationale: "對等名稱解析協定是一種分散式且（大部分）無伺服器的方式來處理客戶端之間的名稱解析。在高安全性環境中，依賴由授權人員維護的集中名稱解析方法更加安全。"
    remediation: "若要透過GP建立建議的配置, 將以下UI路徑設定為: 「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\PNRP Machine Name Publication Service"
    compliance:
      - cis: ["5.17"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PNRPAutoReg -> Start -> 4'

  - id: 15591
    title: "確保「列印後台處理程序（Spooler）」設定為「停用」。"
    description: "此服務背景列印作業並處理與印表機的互動。此設定的建議狀態是：停用。"
    rationale: "在高安全環境中，應停用不必要的服務，尤其是那些已知有漏洞的服務。停用列印後台處理程序 (Spooler) 服務可以緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和針對該服務的其他攻擊。"
    remediation: "若要通過GP設置推薦的配置，請將以下使用者介面路徑設為: 「停用」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Print Spooler"
    compliance:
      - cis: ["5.18"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Spooler -> Start -> 4'

  - id: 15592
    title: "確保「問題報告和解決方案控制面板支援 (wercplsupport)」設定為「停用」。"
    description: "此服務支援查看、傳送和刪除「問題報告和解決方案」控制面板的系統層級問題報告。此設定的建議狀態是：停用。"
    rationale: "此服務涉及向 Microsoft 顯示/向 Microsoft 報告問題和解決方案的過程。在高安全性環境中，阻止發送此資訊有助於減少敏感公司資訊的隱私問題。"
    remediation: "若要透過 GP 建立建議的配置，請將以下使用者介面路徑設為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Problem Reports and Solutions Control Panel Support"
    compliance:
      - cis: ["5.19"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wercplsupport -> Start -> 4'

  - id: 15593
    title: "確保「遠端存取自動連線管理員 (RasAuto)」設定為「停用」。"
    description: "每當程式引用遠端 DNS 或 NetBIOS 名稱或位址時，就會建立與遠端網路的連線。此設定的建議狀態是：停用。"
    rationale: "此服務的功能是提供「請求撥號」類型的功能。在高安全性環境中，任何遠端「撥號」連線（無論是傳統撥入 POTS 還是 VPN）最好由使用者發起，而不是由系統自動發起。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Remote Access Auto Connection Manager"
    compliance:
      - cis: ["5.20"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RasAuto -> Start -> 4'

  - id: 15594
    title: "確保“遠端桌面配置（SessionEnv）”設定為“停用”。"
    description: "遠端桌面設定服務 (RDCS) 負責所有需要系統上下文的遠端桌面相關配置和會話維護活動。其中包括每個會話臨時資料夾、RD 主題和 RD 憑證。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，遠端桌面存取會增加安全風險。對於這些環境，應僅允許本機控制台存取。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Remote Desktop Configuration"
    compliance:
      - cis: ["5.21"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SessionEnv -> Start -> 4'

  - id: 15595
    title: "確保“遠端桌面服務 (TermService)”設定為“停用”。"
    description: "允許使用者以互動方式連接到遠端電腦。遠端桌面和遠端桌面會話主機伺服器依賴此服務。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，遠端桌面存取會增加安全風險。對於這些環境，應僅允許本機控制台存取。"
    remediation: "要透過群組原則建立建議的配置，將以下 UI 路徑設定為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Remote Desktop Services"
    compliance:
      - cis: ["5.22"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TermService -> Start -> 4'

  - id: 15596
    title: "確保「遠端桌面服務使用者模式連接埠重新導向器 (UmRdpService)」設定為「停用」。"
    description: "允許重新導向 RDP 連接的印表機/驅動器/連接埠。此設定的建議狀態是：停用。"
    rationale: "在安全敏感的環境中，希望減少可能的攻擊面 - 防止 COM、LPT 和 PnP 連接埠重新導向將減少 RDP 會話中資料外洩和/或惡意程式碼傳輸的意外途徑的數量。"
    remediation: "要通過 GP 建立推薦配置，將以下使用者介面路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Remote Desktop Services UserMode Port Redirector"
    compliance:
      - cis: ["5.23"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UmRdpService -> Start -> 4'

  - id: 15597
    title: "確保「遠端過程呼叫 (RPC) 定位器 (RpcLocator)」設定為「停用」。"
    description: "在 Windows 2003 和更早版本的 Windows 中，遠端程序呼叫 (RPC) 定位器服務管理 RPC 名稱服務資料庫。在 Windows Vista 和較新版本的 Windows 中，此服務不提供任何功能，其存在是為了應用程式相容性。此設定的建議狀態是：停用。"
    rationale: "這是一項遺留服務，除了非常舊的軟體的應用程式相容性之外沒有任何價值或目的。除非系統上仍在使用需要它的特定舊應用程序，否則應停用它。"
    remediation: "要通過 GP 設定建議的配置，將以下 UI 路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Remote Procedure Call (RPC) Locator"
    compliance:
      - cis: ["5.24"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RpcLocator -> Start -> 4'

  - id: 15598
    title: "確保「遠端註冊表（RemoteRegistry）」設定為「停用」。"
    description: "使遠端使用者能夠查看和修改此電腦上的註冊表設定。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，將註冊表暴露給遠端存取會增加安全風險。"
    remediation: "要建立建議的配置，通過GP設置以下UI路徑為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Remote Registry"
    compliance:
      - cis: ["5.25"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RemoteRegistry -> Start -> 4'

  - id: 15599
    title: "確保「路由和遠端存取 (RemoteAccess)」設定為「停用」。"
    description: "為區域網路和廣域網路環境中的企業提供路由服務。此設定的建議狀態是：停用。"
    rationale: "此服務的主要目的是提供 Windows 路由器功能 - 這不適合在企業管理環境中使用工作站。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Routing and Remote Access"
    compliance:
      - cis: ["5.26"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RemoteAccess -> Start -> 4'

  - id: 15600
    title: "確保“伺服器 (LanmanServer)”設定為“停用”。"
    description: "支援此電腦透過網路進行檔案、列印和命名管道共用。如果該服務停止，這些功能將無法使用。此設定的建議狀態是：停用。"
    rationale: "在高安全環境中，安全工作站應該只是客戶端，而不是伺服器。共享工作站資源進行遠端存取會增加安全風險，因為攻擊面明顯更高。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為：「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Server"
    compliance:
      - cis: ["5.27"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer -> Start -> 4'

  - id: 15601
    title: "確保「簡單 TCP/IP 服務 (simptcp)」設定為「停用」或「未安裝」。"
    description: "支援以下 TCP/IP 服務：字元產生器、日間、丟棄、回顯和當日報價。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 一起提供，但透過啟用可選的 Windows 功能（簡單 TCPIP 服務（即迴聲、白天等））來安裝。"
    rationale: "簡單 TCP/IP 服務在現代企業環境中幾乎沒有什麼用處 - ​​允許它們可能會增加暴露和攻擊風險。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為：「停用」或確保未安裝該服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Simple TCP/IP Services"
    compliance:
      - cis: ["5.28"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\simptcp'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\simptcp -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\simptcp -> Start -> 4'

  - id: 15602
    title: "確保“SNMP 服務 (SNMP)”設定為“已停用”或“未安裝”。"
    description: "允許此電腦處理簡單網路管理協定 (SNMP) 請求。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 提供，但透過啟用可選的 Windows 功能（簡單網路管理協定 (SNMP)）來安裝。"
    rationale: "支援入站網路連線的功能會增加攻擊面。在高安全性環境中，安全工作站的管理應在本地進行。"
    remediation: "要透過GP設定建議的配置，將以下使用者介面路徑設定為：「停用」或確保未安裝此服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\SNMP Service"
    compliance:
      - cis: ["5.29"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SNMP'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SNMP -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SNMP -> Start -> 4'

  - id: 15603
    title: "確保「特殊管理控制台幫助程式 (sacsvr)」設定為「停用」或「未安裝」。"
    description: "該服務允許管理員使用緊急管理服務遠端存取指令提示字元。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 提供，但透過啟用可選的 Windows 功能（Windows 緊急管理服務和序列控制台）來安裝。"
    rationale: "允許使用可遠端存取的指令提示字元來在電腦上執行遠端管理任務存在安全風險。"
    remediation: "要通過GP建立建議的配置, 請將以下UI路徑設置為:「停用」或確保未安裝該服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Special Administration Console Helper"
    compliance:
      - cis: ["5.30"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sacsvr'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sacsvr -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sacsvr -> Start -> 4'

  - id: 15604
    title: "確保“SSDP 發現 (SSDPSRV)”設定為“停用”。"
    description: "發現使用 SSDP 發現協定的網路設備和服務，例如 UPnP 設備。也宣佈在本機電腦上執行 SSDP 設備和服務。此設定的建議狀態是：停用。"
    rationale: "通用即插即用 (UPnP) 是一個真正的安全風險 - 它允許自動發現和連接網路設備。請注意，UPnP 與常規即插即用 (PnP) 不同。工作站不應在具有安全意識的企業管理環境中宣傳其服務（或自動發現並連接到網路服務）。"
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\SSDP Discovery"
    compliance:
      - cis: ["5.31"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SSDPSRV -> Start -> 4'

  - id: 15605
    title: "確保「UPnP 裝置主機 (upnphost)」設定為「停用」。"
    description: "允許在此電腦上託管 UPnP 裝置。此設定的建議狀態是：停用。"
    rationale: "通用即插即用 (UPnP) 是一個真正的安全風險 - 它允許自動發現和連接網路設備。請注意，UPnP 與常規即插即用 (PnP) 不同。工作站不應在具有安全意識的企業管理環境中宣傳其服務（或自動發現並連接到網路服務）。"
    remediation: "若要通過 GP 設定建議的配置，請將以下 UI 路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\UPnP Device Host"
    compliance:
      - cis: ["5.32"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\upnphost -> Start -> 4'

  - id: 15606
    title: "確保「Web 管理服務 (WMSvc)」設定為「已停用」或「未安裝」。"
    description: "Web 管理服務為管理員提供遠端和委派管理功能，以管理電腦上存在的 Web 伺服器、網站和應用程式。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 一起提供，但透過啟用可選的 Windows 功能（Internet 資訊服務 - Web 管理工具 - IIS 管理服務）來安裝。"
    rationale: "工作站上 IIS 的遠端 Web 管理會增加安全風險，因為該工作站的攻擊面會大幅增加。如果沒有採取適當的安全緩解措施，成功攻擊的機會就會顯著增加。"
    remediation: "要透過GP建立建議的配置，請將以下使用者介面路徑設為: 「停用」或確保未安裝該服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Web Management Service"
    compliance:
      - cis: ["5.33"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WMSvc'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WMSvc -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WMSvc -> Start -> 4'

  - id: 15607
    title: "確保「Windows 錯誤報告服務 (WerSvc)」設定為「停用」。"
    description: "允許在程式停止工作或回應時報告錯誤，並允許交付現有解決方案。還允許產生日誌以用於診斷和修復服務。此設定的建議狀態是：停用。"
    rationale: "如果 Windows 錯誤發生在安全的企業管理環境中，則應將錯誤直接回報給 IT 人員以進行故障排除和修復。直接向 Microsoft 報告這些錯誤對公司沒有任何好處，並且存在在不知情的情況下暴露敏感資料作為錯誤的一部分的風險。"
    remediation: "將以下UI路徑設置為:「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows Error Reporting Service"
    compliance:
      - cis: ["5.34"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WerSvc -> Start -> 4'

  - id: 15608
    title: "確保「Windows 事件收集器 (Wecsvc)」設定為「停用」。"
    description: "此服務管理對來自支援 WS-Management 協定的遠端來源的事件的持久訂閱。這包括 Windows Vista 事件日誌、硬體和支援 IPMI 的事件來源。該服務將轉發的事件儲存在本機事件日誌中。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，應盡量減少與安全工作站的遠端連接，並應在本地完成管理功能。"
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows Event Collector"
    compliance:
      - cis: ["5.35"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Wecsvc -> Start -> 4'

  - id: 15609
    title: "確保「Windows Media Player 網路共享服務 (WMPNetworkSvc)」設定為「已停用」或「未安裝」。"
    description: "使用通用即插即用將 Windows Media Player 庫共用給其他網路播放器和媒體裝置。此設定的建議狀態為：已停用或未安裝。"
    rationale: "來自媒體播放器的媒體網路共享在企業管理環境中不存在。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為：「停用」或確保未安裝服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows Media Player Network Sharing Service"
    compliance:
      - cis: ["5.36"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc -> Start -> 4'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc -> Start -> 4'

  - id: 15610
    title: "確保「Windows Mobile 熱點服務 (icssvc)」設定為「停用」。"
    description: "提供與其他裝置共享蜂窩資料連接的能力。此設定的建議狀態是：停用。"
    rationale: "從網域連接的電腦運行行動熱點的能力可以輕鬆地將內部網路暴露給戰爭司機或其他駭客。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為： 「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows Mobile Hotspot Service"
    compliance:
      - cis: ["5.37"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\icssvc -> Start -> 4'

  - id: 15611
    title: "確保「Windows 推播通知系統服務 (WpnService)」設定為「停用」。"
    description: "該服務在會話 0 中運行，並託管通知平台和連接提供程序，用於處理設備和 WNS 伺服器之間的連接。此設定的建議狀態是：停用。注意：在 Windows 10 的前兩個版本（R1507 和 R1511）中，此服務的顯示名稱最初命名為 Windows 推播通知服務 - 但從 Windows 10 R1607 開始，它被重新命名為 Windows 推播通知系統服務。"
    rationale: "Windows 推播通知服務 (WNS) 是一種從雲端/Internet 接收第 3 方通知和更新的機制。在高安全性環境中，應防止外部系統（尤其是組織外部託管的系統）對安全工作站產生影響。"
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows Push Notifications System Service"
    compliance:
      - cis: ["5.38"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WpnService -> Start -> 4'

  - id: 15612
    title: "確保「Windows PushToInstall 服務 (PushToInstall)」設定為「停用」。"
    description: "此服務管理從其他裝置或網路上執行的 Microsoft Store 應用程式推送到裝置的應用程式。此設定的建議狀態是：停用。"
    rationale: "在高安全性的託管環境中，應用程式安裝應由 IT 人員而不是最終使用者集中管理。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows PushToInstall Service (PushToInstall)"
    compliance:
      - cis: ["5.39"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PushToInstall -> Start -> 4'

  - id: 15613
    title: "確保「Windows 遠端管理 (WS-Management) (WinRM)」設定為「停用」。"
    description: "Windows 遠端管理 (WinRM) 服務實作 WS-Management 協定以進行遠端管理。 WS-Management 是用於遠端軟體和硬體管理的標準 Web 服務協定。 WinRM 服務在網路上偵聽 WS-Management 請求並處理它們。此設定的建議狀態是：停用。"
    rationale: "支援入站網路連線的功能會增加攻擊面。在高安全性環境中，安全工作站的管理應在本地進行。"
    remediation: "要通過 GP 設定建議的配置，請將以下用戶界面路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Windows Remote Management (WS-Management)"
    compliance:
      - cis: ["5.40"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WinRM -> Start -> 4'

  - id: 15614
    title: "確保「萬維網發布服務 (W3SVC)」設定為「已停用」或「未安裝」。"
    description: "透過 Internet 資訊服務管理員提供 Web 連線和管理。此設定的建議狀態為：已停用或未安裝。注意：預設不安裝此服務。它隨 Windows 一起提供，但透過啟用可選的 Windows 功能（Internet 資訊服務 - 萬維網服務）來安裝。注意#2：組織可以選擇選擇性地向 Web 開發人員授予例外，以允許在其工作站上使用 IIS（或其他 Web 伺服器），以便他們在本地測試和開發網頁。然而，組織應該追蹤這些機器並確保安全控制和緩解措施保持最新，以降低妥協風險。"
    rationale: "從工作站託管網站會增加安全風險，因為該工作站的攻擊面會大幅增加。如果沒有採取適當的安全緩解措施，成功攻擊的機會就會顯著增加。注意：此安全性問題適用於安裝在工作站上的任何 Web 伺服器應用程序，而不僅僅是 IIS。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為：「停用」或確保未安裝該服務。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\World Wide Web Publishing Service"
    compliance:
      - cis: ["5.41"]
      - cis_csc: ["4.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC -> Start -> 4'

  - id: 15615
    title: "確保「Xbox 附件管理服務 (XboxGipSvc)」設定為「停用」。"
    description: "此服務管理連接的 Xbox 配件。此設定的建議狀態是：停用。"
    rationale: "Xbox Live 是一項遊戲服務，在企業管理環境中沒有地位（也許除非它是一家遊戲公司）。"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為：「停用」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Xbox Accessory Management Service"
    compliance:
      - cis: ["5.42"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\XboxGipSvc -> Start -> 4'

  - id: 15616
    title: "確保「Xbox Live 驗證管理器 (XblAuthManager)」設定為「停用」。"
    description: "提供與 Xbox Live 互動的身份驗證和授權服務。此設定的建議狀態是：停用。"
    rationale: "Xbox Live 是一項遊戲服務，在企業管理環境中沒有地位（也許除非它是一家遊戲公司）。"
    remediation: "要透過 GP 建立建議的配置，請設定以下 UI 路徑為: 「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Xbox Live Auth Manager"
    compliance:
      - cis: ["5.43"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\XblAuthManager -> Start -> 4'

  - id: 15617
    title: "確保「Xbox Live 遊戲保存 (XblGameSave)」設定為「停用」。"
    description: "此服務同步 Xbox Live 啟用儲存功能的遊戲的儲存資料。此設定的建議狀態是：停用。"
    rationale: "Xbox Live 是一項遊戲服務，在企業管理環境中沒有地位（也許除非它是一家遊戲公司）。"
    remediation: "要透過群組原則建立建議的配置，請將以下 UI 路徑設置為: 「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Xbox Live Game Save"
    compliance:
      - cis: ["5.44"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\XblGameSave -> Start -> 4'

  - id: 15618
    title: "確保「Xbox Live 網路服務 (XboxNetApiSvc)」設定為「停用」。"
    description: "此服務支援 Windows.Networking.XboxLive 應用程式介面。此設定的建議狀態是：停用。"
    rationale: "Xbox Live 是一項遊戲服務，在企業管理環境中沒有地位（也許除非它是一家遊戲公司）。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為：「停用」. Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Xbox Live Networking Service"
    compliance:
      - cis: ["5.45"]
      - cis_csc: ["4.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\XboxNetApiSvc -> Start -> 4'

  - id: 15619
    title: "確保「Windows 防火牆：網域：防火牆狀態」設定為「開啟（建議）」。"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為開啟（建議）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Firewall state"
    compliance:
      - cis: ["9.1.1"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> EnableFirewall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> EnableFirewall -> 1'

  - id: 15620
    title: "確保「Windows 防火牆：網域：入站連線」設定為「封鎖（預設）」。"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為封鎖（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Inbound connections"
    compliance:
      - cis: ["9.1.2"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultInboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultInboundAction -> 1'

  - id: 15621
    title: "確保「Windows 防火牆：網域：出站連線」設定為「允許（預設）」。"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    remediation: "要通過GP設置推薦的配置，將以下UI路徑設置為允許（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Outbound connections"
    compliance:
      - cis: ["9.1.3"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultOutboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultOutboundAction -> 0'

  - id: 15622
    title: "確保「Windows 防火牆：網域：設定：顯示通知」設定為「否」。"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態為：否。的訊息。"
    rationale: "防火牆通知可能很複雜，可能會讓最終用戶感到困惑，導致他們無法解決警報。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「否」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Settings Customize\\Display a notification"
    compliance:
      - cis: ["9.1.4"]
      - cis_csc: ["4.5"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DisableNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DisableNotifications -> 1'

  - id: 15623
    title: "確保「Windows 防火牆：網域：日誌記錄：名稱」設定為「%SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過 GP 設定建議的配置，請將以下 UI 路徑設置為 %SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Name"
    compliance:
      - cis: ["9.1.5"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFilePath'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\domainfw.log'

  - id: 15624
    title: "確保「Windows 防火牆：網域：日誌記錄：大小限制 (KB)」設定為「16,384 KB 或更大」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP設置推薦配置，請將以下UI路徑設置為16,384 KB或更大: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Size limit (KB)"
    compliance:
      - cis: ["9.1.6"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFileSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  - id: 15625
    title: "確保「Windows 防火牆：網域：日誌記錄：記錄丟棄的封包」設定為「是」。"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「是」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Log dropped packets"
    compliance:
      - cis: ["9.1.7"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogDroppedPackets'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogDroppedPackets -> 1'

  - id: 15626
    title: "確保「Windows 防火牆：網域：日誌記錄：記錄成功的連線」設定為「是」。"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過群組策略建立建議的配置，請將以下UI路徑設置為「是」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Log successful connections"
    compliance:
      - cis: ["9.1.8"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogSuccessfulConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogSuccessfulConnections -> 1'

  - id: 15627
    title: "確保「Windows 防火牆：專用：防火牆狀態」設定為「開啟（建議）」。"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "要通過 GP 設置建議的配置, 請將以下 UI 路徑設置為 開啟 (建議): Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Firewall state"
    compliance:
      - cis: ["9.2.1"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> EnableFirewall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> EnableFirewall -> 1'

  - id: 15628
    title: "確保「Windows 防火牆：專用：入站連線」設定為「封鎖（預設）」。"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "要通過GP設立建議的配置，將以下UI路徑設置為封鎖（預設值）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Inbound connections"
    compliance:
      - cis: ["9.2.2"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultInboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultInboundAction -> 1'

  - id: 15629
    title: "確保「Windows 防火牆：專用：出站連線」設定為「允許（預設）」。"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。注意：如果將出站連線設定為“封鎖”，然後使用GPO 部署防火牆策略，則接收GPO 設定的電腦將無法接收後續的群組原則更新，除非您建立並部署使群組原則能夠正常工作的出站規則。核心網路的預先定義規則包括使群組策略發揮作用的出站規則。確保這些出站規則處於活動狀態，並在部署之前徹底測試防火牆設定檔。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為允許（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Outbound connections"
    compliance:
      - cis: ["9.2.3"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultOutboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultOutboundAction -> 0'

  - id: 15630
    title: "確保「Windows 防火牆：專用：設定：顯示通知」設定為「否」。"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態為：否。的訊息。"
    rationale: "防火牆通知可能很複雜，可能會讓最終用戶感到困惑，導致他們無法解決警報。"
    remediation: "要通過GP設定推薦的組態，將以下用戶界面路徑設置為「否」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Settings Customize\\Display a notification"
    compliance:
      - cis: ["9.2.4"]
      - cis_csc: ["4.5"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DisableNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DisableNotifications -> 1'

  - id: 15631
    title: "確保「Windows 防火牆：專用：日誌記錄：名稱」設定為「%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過群組原則建立建議的配置，請將以下使用者介面路徑設置為 %SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Name"
    compliance:
      - cis: ["9.2.5"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFilePath'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\privatefw.log'

  - id: 15632
    title: "確保「Windows 防火牆：專用：日誌記錄：大小限制 (KB)」設定為「16,384 KB 或更大」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過 GP 來建立建議的配置，請將下列 UI 路徑設置為 16,384 KB 或更大：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Size limit (KB)"
    compliance:
      - cis: ["9.2.6"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFileSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  - id: 15633
    title: "確保「Windows 防火牆：專用：日誌記錄：記錄丟棄的封包」設定為「是」。"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "欲透過GP建立推薦配置，將以下UI路徑設為「是」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Log dropped packets"
    compliance:
      - cis: ["9.2.7"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogDroppedPackets'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogDroppedPackets -> 1'

  - id: 15634
    title: "確保「Windows 防火牆：專用：日誌記錄：記錄成功的連線」設定為「是」。"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「是」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Log successful connections"
    compliance:
      - cis: ["9.2.8"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogSuccessfulConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogSuccessfulConnections -> 1'

  - id: 15635
    title: "確保「Windows 防火牆：公用：防火牆狀態」設定為「開啟（建議）」。"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "若要透過 GP 建立建議配置，請將以下 UI 路徑設定為開啟（建議）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Firewall state"
    compliance:
      - cis: ["9.3.1"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> EnableFirewall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> EnableFirewall -> 1'

  - id: 15636
    title: "確保「Windows 防火牆：公用：入站連線」設定為「封鎖（預設）」。"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為Block (default): Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Inbound connections"
    compliance:
      - cis: ["9.3.2"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultInboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultInboundAction -> 1'

  - id: 15637
    title: "確保「Windows 防火牆：公用：出站連線」設定為「允許（預設）」。"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。注意：如果將出站連線設定為“封鎖”，然後使用GPO 部署防火牆策略，則接收GPO 設定的電腦將無法接收後續的群組原則更新，除非您建立並部署使群組原則能夠正常工作的出站規則。核心網路的預先定義規則包括使群組策略發揮作用的出站規則。確保這些出站規則處於活動狀態，並在部署之前徹底測試防火牆設定檔。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為允許（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Outbound connections"
    compliance:
      - cis: ["9.3.3"]
      - cis_csc: ["4.5"]
      - pci_dss: ["1.2.3"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultOutboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultOutboundAction -> 0'

  - id: 15638
    title: "確保「Windows 防火牆：公用：設定：顯示通知」設定為「否」。"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態是：否。"
    rationale: "當防火牆規則阻止某些類型的網路活動時，某些組織可能更願意避免警告使用者。但是，在排除涉及防火牆的網路問題時，通知會很有幫助。"
    remediation: "若要通過群組策略建立建議的配置，請將以下 UI 路徑設置為「否」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Display a notification"
    compliance:
      - cis: ["9.3.4"]
      - cis_csc: ["4.5"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DisableNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DisableNotifications -> 1'

  - id: 15639
    title: "確保「Windows 防火牆：公用：設定：套用本機防火牆規則」設定為「否」。"
    description: "此設定控制是否允許本機管理員建立與群組原則配置的防火牆規則一起套用的本機防火牆規則。此設定的建議狀態為：否。的訊息。"
    rationale: "在公共設定檔中時，每台電腦不應有特殊的本地防火牆例外。這些設定應由集中策略管理。"
    remediation: "若要透過群組策略設定推薦配置，將以下使用者介面路徑設置為「否」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Apply local firewall rules"
    compliance:
      - cis: ["9.3.5"]
      - cis_csc: ["4.5"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalPolicyMerge'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalPolicyMerge -> 0'

  - id: 15640
    title: "確保「Windows 防火牆：公用：設定：套用本機連線安全規則」設定為「否」。"
    description: "此設定控制是否允許本機管理員建立與群組原則配置的連線安全規則一起套用的連線安全規則。此設定的建議狀態是：否。"
    rationale: "具有管理權限的使用者可能會建立防火牆規則，使系統遭受遠端攻擊。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為「否」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Apply local connection security rules"
    compliance:
      - cis: ["9.3.6"]
      - cis_csc: ["4.5"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalIPsecPolicyMerge'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0'

  - id: 15641
    title: "確保「Windows 防火牆：公用：日誌記錄：名稱」設定為「%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為 %SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Name"
    compliance:
      - cis: ["9.3.7"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFilePath'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\publicfw.log'

  - id: 15642
    title: "確保「Windows 防火牆：公用：日誌記錄：大小限制 (KB)」設定為「16,384 KB 或更大」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為 16,384 KB 或更大：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Size limit (KB)"
    compliance:
      - cis: ["9.3.8"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFileSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  - id: 15643
    title: "確保「Windows 防火牆：公共：日誌記錄：記錄丟棄的封包」設定為「是」。"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設定為「是」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Log dropped packets"
    compliance:
      - cis: ["9.3.9"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogDroppedPackets'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogDroppedPackets -> 1'

  - id: 15644
    title: "確保「Windows 防火牆：公用：日誌記錄：記錄成功的連線」設定為「是」。"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過 GP 建立建議的設定，將以下 UI 路徑設置為「是」。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Log successful connections"
    compliance:
      - cis: ["9.3.10"]
      - cis_csc: ["4.5", "8.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogSuccessfulConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogSuccessfulConnections -> 1'

  - id: 15645
    title: "確保“審核憑證驗證”設定為“成功和失敗”。"
    description: "此子類別會報告針對使用者帳戶登入要求提交的憑證的驗證測試結果。這些事件發生在對憑證具有權威性的電腦上。對於網域帳戶，網域控制站是權威的，而對於本機帳戶，本機電腦是權威的。在網域環境中，大多數帳戶登入事件發生在對網域帳戶具有權威的網域控制站的安全性日誌中。但是，當使用本機帳戶登入時，這些事件可能會發生在組織中的其他電腦上。此子類別的活動包括： - 4774：映射帳戶用於登入。 - 4775：無法對應帳戶以進行登入。 - 4776：網域控制器嘗試驗證帳戶的憑證。 - 4777：網域控制器無法驗證帳戶的憑證。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要透過 GP 建立推薦的設定，請將以下使用者介面路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\\Audit Credential Validation"
    compliance:
      - cis: ["17.1.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Credential Validation" -> r:Success and Failure'

  - id: 15646
    title: "確保“審核應用程式組管理”設定為“成功和失敗”。"
    description: "此原則設定可讓您審核由應用程式群組變更產生的事件，如下所示： - 建立、變更或刪除應用程式群組。 - 在應用程式群組中新增或刪除成員。應用程式群組由 Windows 授權管理器使用，它是 Microsoft 創建的一個靈活的框架，用於將基於角色的存取控制 (RBAC) 整合到應用程式中。有關 Windows 授權管理器的更多資訊，請存取 MSDN - Windows 授權管理器。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查事件時，審核此類別的事件可能很有用。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Success 和 Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Application Group Management"
    compliance:
      - cis: ["17.2.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Application Group Management" -> r:Success and Failure'

  - id: 15647
    title: "確保「審核安全群組管理」設定為包括「成功」。"
    description: "此子類別會報告安全性群組管理的每個事件，例如何時建立、變更或刪除安全性群組，或何時向安全性群組新增或刪除成員。如果啟用此審核策略設置，管理員可以追蹤事件以偵測安全群組帳戶的惡意、意外和授權建立。此子類別的事件包括： - 4727：已建立啟用安全性的全域群組。 - 4728：成員已新增至啟用安全性的全域群組。 - 4729：成員已從啟用安全的全域群組中刪除。 - 4730：已刪除啟用安全的全域群組。 - 4731：已建立啟用安全的本機群組。 - 4732：成員已新增至啟用安全的本機群組。 - 4733：成員已從啟用安全的本機群組中刪除。 - 4734：已刪除啟用安全的本機群組。 - 4735：啟用安全的本機群組已變更。 - 4737：啟用安全的全域群組已變更。 - 4754：建立了啟用安全的通用群組。 - 4755：啟用安全的通用群組已變更。 - 4756：成員已新增至啟用安全的通用群組。 - 4757：成員已從啟用安全的通用群組中刪除。 - 4758：已刪除啟用安全的通用群組。 - 4764：群組的類型已變更。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要透過 GP 設定建議的配置，將以下的 UI 路徑設定為包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Security Group Management"
    compliance:
      - cis: ["17.2.2"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Security Group Management" -> r:Success'

  - id: 15648
    title: "確保「審核使用者帳戶管理」設定為「成功和失敗」。"
    description: "此子類別報告使用者帳戶管理的每個事件，例如建立、變更或刪除使用者帳戶的時間；使用者帳戶被重新命名、停用或啟用；或設定或更改了密碼。如果啟用此審核策略設置，管理員可以追蹤事件以偵測惡意、意外和授權的使用者帳戶建立。此子類別的事件包括： - 4720：已建立使用者帳戶。 - 4722：使用者帳戶已啟用。 - 4723：嘗試變更帳戶密碼。 - 4724：嘗試重設帳戶密碼。 - 4725：使用者帳號已停用。 - 4726：使用者帳號已刪除。 - 4738：使用者帳戶已更改。 - 4740：使用者帳號被鎖定。 - 4765：SID 歷史記錄已新增至帳戶。 - 4766：嘗試將 SID 歷史記錄新增至帳戶失敗。 - 4767：用戶帳號已解鎖。 - 4780：ACL 是在屬於管理員群組成員的帳戶上設定的。 - 4781：帳戶名稱已變更： - 4794：嘗試設定目錄服務還原模式。 - 5376：憑證管理器憑證已備份。 - 5377：憑證管理器憑證已從備份中還原。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要通過GP建立推薦的配置，請將以下UI路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management"
    compliance:
      - cis: ["17.2.3"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"User Account Management" -> r:Success and Failure'

  - id: 15649
    title: "確保「審核 PNP 活動」設定為包括「成功」。"
    description: "此政策設定可讓您審核即插即用偵測到外部裝置的時間。此設定的建議狀態包括：成功。注意：需要 Windows 10、Server 2016 或更高版本的作業系統才能在群組原則中存取和設定此值。"
    rationale: "啟用此設定將允許使用者在裝置插入系統時審核事件。如果插入未經批准的設備，這可以幫助提醒 IT 人員。"
    remediation: "為了通過 GP 建立推薦的配置，請設置以下 UI 路徑以包含 Success: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Detailed Tracking\\Audit PNP Activity"
    compliance:
      - cis: ["17.3.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Plug and Play Events" -> r:Success'

  - id: 15650
    title: "確保“審核流程創建”設定為包括“成功”。"
    description: "此子類別報告程序的建立以及建立該程序的程式或使用者的名稱。此子類別的事件包括： - 4688：已建立新程序。 - 4696：主令牌已指派給程序。有關此設定的最新資訊，請參閱 Microsoft 知識庫文章 947226：Windows Vista 和 Windows Server 2008 中的安全性事件說明。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為包含“成功”：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Detailed Tracking\\Audit Process Creation"
    compliance:
      - cis: ["17.3.2"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Process Creation" -> r:Success'

  - id: 15651
    title: "確保「審核帳戶鎖定」設定為包括「失敗」。"
    description: "此子類別會報告使用者帳號因登入嘗試失敗次數過多而被鎖定的情況。此子類別的事件包括： - 4625：帳戶登入失敗。此設定的建議狀態包括：失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設置為包含失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Account Lockout"
    compliance:
      - cis: ["17.5.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Account Lockout" -> r:Failure'

  - id: 15652
    title: "確保「審核組成員資格」設定為包括「成功」。"
    description: "此原則可讓您審核使用者登入權杖中的群組成員識別資訊。此子類別中的事件是在建立登入工作階段的電腦上產生的。對於互動式登入，安全審核事件會在使用者登入的電腦上產生。對於網路登入，例如存取網路上的共用資料夾，安全性審核事件會在託管資源的電腦上產生。此設定的建議狀態包括：成功。注意：需要 Windows 10、Server 2016 或更高版本的作業系統才能在群組原則中存取和設定此值。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "為了通過GP建立推薦的配置，將以下UI路徑設置為包含成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Group Membership"
    compliance:
      - cis: ["17.5.2"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Group Membership" -> r:Success'

  - id: 15653
    title: "確保「審核註銷」設定為包括「成功」。"
    description: "此子類別會報告使用者何時從系統登出。這些事件發生在被存取的電腦上。對於互動式登入，這些事件的產生發生在登入的計算機上。如果進行網頁登入來存取共用，則會在託管所存取資源的電腦上產生這些事件。如果將此設定配置為“無審核”，則很難或不可能確定哪個使用者已存取或嘗試存取組織電腦。此子類別的活動包括： - 4634：帳戶已登出。 - 4647：用戶發起註銷。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要透過群組原則 (GP) 設定推薦的配置，請將以下使用者介面路徑設定為包括成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Logoff"
    compliance:
      - cis: ["17.5.3"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Logoff" -> r:Success'

  - id: 15654
    title: "確保“審核登入”設定為“成功和失敗”。"
    description: "此子類別報告使用者何時嘗試登入系統。這些事件發生在被存取的電腦上。對於互動式登入，這些事件的產生發生在登入的計算機上。如果進行網頁登入來存取共用，則會在託管所存取資源的電腦上產生這些事件。如果將此設定配置為“無審核”，則很難或不可能確定哪個使用者已存取或嘗試存取組織電腦。此子類別的活動包括： - 4624：帳戶已成功登入。 - 4625：帳號登入失敗。 - 4648：嘗試使用明確憑證登入。 - 4675：SID 已被過濾。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要通過GP設立建議的配置，請將以下UI路徑設定為Success和Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Logon"
    compliance:
      - cis: ["17.5.4"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Logon" -> r:Success and Failure'

  - id: 15655
    title: "確保「審核其他登入/登出事件」設定為「成功和失敗」。"
    description: "此子類別會報告其他登入/登出相關事件，例如遠端桌面服務工作階段已中斷和重新連線、使用 RunAs 在不同帳戶下執行程序以及鎖定和解鎖工作站。此子類別的事件包括： - 4649：偵測到重播攻擊。 - 4778：會話已重新連接到 Window Station。 - 4779：會話已從 Window Station 中斷。 - 4800：工作站被鎖定。 - 4801：工作站已解鎖。 - 4802：螢幕保護程式被呼叫。 - 4803：螢幕保護程式被關閉。 - 5378：策略不允許請求的憑證委派。 - 5632：請求對無線網路進行身份驗證。 - 5633：請求對有線網路進行身份驗證。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Other Logon/Logoff Events"
    compliance:
      - cis: ["17.5.5"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Other Logon/Logoff Events" -> r:Success and Failure'

  - id: 15656
    title: "確保「審核特殊登入」設定為包括「成功」。"
    description: "此子類別會報告何時使用特殊登入。特殊登入是具有管理員等效權限的登入，可用於將程序提升到更高層級。此子類別的事件包括： - 4964：特殊群組已指派給新登入。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要透過 GP 建立建議的配置，請設定以下 UI 路徑以包含成功記錄：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Special Logon"
    compliance:
      - cis: ["17.5.6"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Special Logon" -> r:Success'

  - id: 15657
    title: "確保“審核詳細檔案共用”設定為包括“失敗”。"
    description: "此子類別可讓您審核存取共用資料夾上的檔案和資料夾的嘗試。此子類別的事件包括： - 5145：檢查網路共用物件以查看是否可以授予客戶端所需的存取權限。此設定的建議狀態包括：失敗。"
    rationale: "審核失敗將記錄哪些未經授權的使用者嘗試（並失敗）存取此電腦上網路共用上的檔案或資料夾，這可能表示存在惡意意圖。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為包含失敗: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit Detailed File Share"
    compliance:
      - cis: ["17.6.1"]
      - cis_csc: ["3.3", "8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Detailed File Share" -> r:Failure'

  - id: 15658
    title: "確保“審核檔案共用”設定為“成功和失敗”。"
    description: "此原則設定可讓您審核存取共用資料夾的嘗試。此設定的推薦狀態是：成功和失敗。注意：共用資料夾沒有系統存取控制清單 (SACL)。如果啟用此策略設置，將對系統上所有共用資料夾的存取進行審核。"
    rationale: "在企業管理的環境中，工作站應該有有限的檔案共享活動，因為檔案伺服器通常會處理檔案共享活動的總體負擔。因此，工作站上任何異常的檔案共享活動可能有助於調查潛在的惡意活動。"
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit File Share"
    compliance:
      - cis: ["17.6.2"]
      - cis_csc: ["3.3", "8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"File Share" -> r:Success and Failure'

  - id: 15659
    title: "確保「審核其他物件存取事件」設定為「成功和失敗」。"
    description: "此策略設定可讓您審核由任務排程程序作業或 COM+ 物件的管理所產生的事件。對於排程程式作業，將審核以下內容： - 建立的作業。 - 作業已刪除。 - 啟用工作。 - 工作被停用。 - 工作更新。對於 COM+ 物件，將審核以下內容： - 新增的目錄物件。 - 更新了目錄物件。 - 目錄物件已刪除。此設定的推薦狀態是：成功和失敗。"
    rationale: "排程任務和 COM+ 物件的意外建立可能表示存在惡意活動。由於這些類型的操作通常數量較少，因此將它們捕獲在審核日誌中以供調查期間使用可能會很有用。"
    remediation: "要通過 GP 設定推薦的配置，將以下 UI 路徑設置為 Success 和 Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit Other Object Access Events"
    compliance:
      - cis: ["17.6.3"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Other Object Access Events" -> r:Success and Failure'

  - id: 15660
    title: "確保“審核可移動儲存”設定為“成功和失敗”。"
    description: "此政策設定可讓您審核使用者嘗試存取可移動儲存裝置上的檔案系統物件。僅針對請求的所有類型的存取的所有物件產生安全審核事件。如果配置此策略設置，則每次帳戶存取可移動儲存空間上的檔案系統物件時都會產生審核事件。成功審核記錄成功的嘗試，失敗審核記錄不成功的嘗試。如果未配置此策略設置，則當帳戶存取可移動儲存空間上的檔案系統物件時，不會產生審核事件。此設定的推薦狀態是：成功和失敗。注意：需要 Windows 8.0、Server 2012（非 R2）或更高版本的作業系統才能在群組原則中存取和設定此值。"
    rationale: "在調查事件時，審核可移動儲存可能很有用。例如，如果某人涉嫌將敏感資訊複製到 USB 隨身碟上。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit Removable Storage"
    compliance:
      - cis: ["17.6.4"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Removable Storage" -> r:Success and Failure'

  - id: 15661
    title: "確保「審核審核原則變更」設定為包括「成功」。"
    description: "此子類別會報告審核策略的更改，包括 SACL 更改。此子類別的事件包括： - 4715：物件上的審核原則 (SACL) 已變更。 - 4719：系統審核策略已變更。 - 4902：已建立每使用者審核策略表。 - 4904：嘗試註冊安全事件來源。 - 4905：嘗試取消註冊安全事件來源。 - 4906：CrashOnAuditFail 值已變更。 - 4907：物件的審核設定已更改。 - 4908：特殊群組登入表已修改。 - 4912：每用戶審核策略已更改。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要透過GP建立建議的設定，請設置以下UI路徑以包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change"
    compliance:
      - cis: ["17.7.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Audit Policy Change" -> r:Success'

  - id: 15662
    title: "確保“審核身份驗證策略變更”設定為包括“成功”。"
    description: "此子類別會報告身份驗證策略的變更。此子類別的事件包括 - 4706：為網域建立了新的信任。 - 4707：對網域的信任被刪除。 - 4713：Kerberos 策略已變更。 - 4716：可信任域資訊被修改。 - 4717：已向帳戶授予系統安全存取權限。 - 4718：系統安全存取權限已從帳戶中刪除。 - 4739：網域策略已變更。 - 4864：偵測到名稱空間衝突。 - 4865：新增了可信林資訊條目。 - 4866：刪除了受信任的林資訊條目。  - 4867：可信林資訊條目被修改。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要透過群組原則建立推薦的設定，將以下使用者介面路徑設為包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authentication Policy Change"
    compliance:
      - cis: ["17.7.2"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Authentication Policy Change" -> r:Success'

  - id: 15663
    title: "確保「審核授權政策變更」設定為包括「成功」。"
    description: "此子類別會報告授權策略的變更。此子類別的事件包括： - 4704：已指派使用者權限。 - 4705：使用者權限被刪除。 - 4706：為網域創建了新的信任。 - 4707：對網域的信任被刪除。 - 4714：加密資料復原策略已變更。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要透過 GP 建立建議的配置，請設置以下 UI 路徑以包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change"
    compliance:
      - cis: ["17.7.3"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Authorization Policy Change" -> r:Success'

  - id: 15664
    title: "確保「審核 MPSSVC 規則級原則變更」設定為「成功和失敗」。"
    description: "此子類別決定在變更 Microsoft 保護服務 (MPSSVC.exe) 的政策規則時作業系統是否會產生審核事件。此子類別的事件包括： - 4944：Windows 防火牆啟動時下列原則為啟用。 - 4945：Windows 防火牆啟動時列出了規則。 - 4946：對 Windows 防火牆例外清單進行了更改。新增了一條規則。 - 4947：對 Windows 防火牆例外清單進行了更改。修改了一條規則。 - 4948：Windows 防火牆例外清單已變更。刪除了一條規則。 - 4949：Windows 防火牆設定已還原為預設值。 - 4950：Windows 防火牆設定已變更。 - 4951：規則已被忽略，因為 Windows 防火牆無法辨識其主版本號。 - 4952：規則的部分內容已被忽略，因為 Windows 防火牆無法辨識其次要版本號。該規則的其他部分將得到執行。 - 4953：Windows 防火牆已忽略某個規則，因為它無法解析該規則。 - 4954：Windows 防火牆群組原則設定已變更。新設定已套用。 - 4956：Windows 防火牆已變更活動設定檔。 - 4957：Windows 防火牆未套用下列規則。 - 4958：Windows 防火牆未套用下列規則，因為該規則引用了未在此電腦上設定的項目。此設定的推薦狀態是：成功和失敗"
    rationale: "防火牆規則的變更對於了解電腦的安全狀態以及電腦免受網路攻擊的保護程度非常重要。"
    remediation: "若要透過群組原則建立建議的配置，請將以下 UI 路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit MPSSVC Rule-Level Policy Change"
    compliance:
      - cis: ["17.7.4"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"MPSSVC Rule-Level Policy Change" -> r:Success and Failure'

  - id: 15665
    title: "確保「審核其他策略變更事件」設定為包括「失敗」。"
    description: "此子類別包含有關EFS 資料復原代理程式變更、Windows 篩選平台篩選器中的變更、本機群組原則設定的安全性原則設定更新狀態、中央存取原則變更以及加密下一代(CNG​​) 作業的詳細故障排除事件的事件。 - 5063：嘗試了加密提供者操作。 - 5064：嘗試進行加密上下文操作。 - 5065：嘗試修改加密上下文。 - 5066：嘗試進行加密函數操作。 - 5067：嘗試修改加密函數。 - 5068：嘗試進行加密函數提供者操作。 - 5069：嘗試進行加密函數屬性操作。 - 5070：嘗試修改加密函數屬性。 - 6145：處理群組原則物件中的安全性原則時發生一個或多個錯誤。此設定的建議狀態包括：失敗。"
    rationale: "此設定可以幫助偵測應用程式的安全性設定中來自群組原則的錯誤以及與下一代加密 (CNG) 功能相關的故障事件。"
    remediation: "若要透過群組原則建立建議配置，將以下 UI 路徑設置為包含失敗: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Other Policy Change Events"
    compliance:
      - cis: ["17.7.5"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Other Policy Change Events" -> r:Failure'

  - id: 15666
    title: "確保“審核敏感權限使用”設定為“成功和失敗”。"
    description: "此子類別會報告使用者帳戶或服務何時使用敏感權限。敏感權限包括以下使用者權限： - 充當作業系統的一部分 - 備份檔案和目錄 - 建立令牌物件 - 偵錯程式 - 啟用電腦和使用者帳戶的委派信任 - 產生安全審核 - 模擬客戶端身分驗證後- 載入裝置驅動程式- 管理審核和安全性日誌- 修改韌體環境值- 替換程序級令牌- 復原檔案和目錄- 取得檔案或其他物件的所有權審核此子類別將建立大量事件。此子類別的事件包括： - 4672：指派給新登入的特殊權限。 - 4673：呼叫了特權服務。 - 4674：嘗試對特權物件進行操作。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要通過 GP 建立建議配置，將以下 UI 路徑設置為 Success 和 Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Privilege Use\\Audit Sensitive Privilege Use"
    compliance:
      - cis: ["17.8.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Sensitive Privilege Use" -> r:Success and Failure'

  - id: 15667
    title: "確保“審核 IPsec 驅動程式”設定為“成功和失敗”。"
    description: "此子類別會報告 Internet 協定安全性 (IPsec) 驅動程式的活動。此子類別的事件包括： - 4960：IPsec 丟棄了完整性檢查失敗的入站資料包。如果此問題仍然存在，則可能表示存在網路問題或資料包在傳輸至此電腦的過程中被修改。驗證從遠端電腦發送的資料包與本電腦接收的資料包是否相同。此錯誤也可能表示與其他 IPsec 實作的互通性問題。 - 4961：IPsec 丟棄了重播檢查失敗的入站資料包。如果此問題仍然存在，則可能表示此電腦受到重播攻擊。 - 4962：IPsec 丟棄了重播檢查失敗的入站資料包。入站資料包的序號太低，無法確保它不是重播。 - 4963：IPsec 丟棄了本應受到保護的入站明文資料包。這通常是由於遠端電腦在未通知此電腦的情況下更改了其 IPsec 策略。這也可能是欺騙攻擊嘗試。 - 4965：IPsec 從遠端電腦收到一個安全參數索引 (SPI) 不正確的封包。這通常是由損壞資料包的硬體故障引起的。如果這些錯誤仍然存在，請驗證從遠端電腦發送的資料包是否與此電腦接收的資料包相同。此錯誤也可能表示與其他 IPsec 實作的互通性問題。在這種情況下，如果連線沒有受到阻礙，則可以忽略這些事件。 - 5478：IPsec 服務已成功啟動。 - 5479：IPsec 服務已成功關閉。關閉 IPsec 服務可能會使電腦面臨更大的網路攻擊風險或使電腦面臨潛在的安全風險。 - 5480：IPsec 服務無法取得電腦上網路介面的完整清單。這會帶來潛在的安全風險，因為某些網路介面可能無法獲得所套用的 IPsec 過濾器所提供的保護。使用 IP 安全監視器管理單元來診斷問題。 - 5483：IPsec 服務無法初始化 RPC 伺服器。 IPsec 服務無法啟動。關閉 IPsec 服務可能會使電腦面臨更大的網路攻擊風險或使電腦面臨潛在的安全風險。 - 5485：IPsec 服務無法處理網路介面即插即用事件上的某些 IPsec 過濾器。這會帶來潛在的安全風險，因為某些網路介面可能無法獲得所套用的 IPsec 過濾器所提供的保護。使用 IP 安全監視器管理單元來診斷問題。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要經由 GP 建立建議的配置，將以下 UI 路徑設置為 Success 和 Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit IPsec Driver"
    compliance:
      - cis: ["17.9.1"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"IPsec Driver" -> r:Success and Failure'

  - id: 15668
    title: "確保“審核其他系統事件”設定為“成功和失敗”。"
    description: "此子類別會報告其他系統事件。此子類別的事件包括： - 5024：Windows 防火牆服務已成功啟動。 - 5025：Windows 防火牆服務已停止。 - 5027：Windows 防火牆服務無法從本機儲存檢索安全性原則。該服務將繼續執行當前政策。 - 5028：Windows 防火牆服務無法解析新的安全性原則。該服務將繼續執行目前執行的政策。 - 5029：Windows 防火牆服務無法初始化驅動程式。該服務將繼續執行當前政策。 - 5030：Windows 防火牆服務啟動失敗。 - 5032：Windows 防火牆無法通知使用者它阻止了應用程式接受網路上的傳入連線。 - 5033：Windows 防火牆驅動程式已成功啟動。 - 5034：Windows 防火牆驅動程式已停止。 - 5035：Windows 防火牆驅動程式無法啟動。 - 5037：Windows 防火牆驅動程式偵測到嚴重執行時錯誤。終止。 - 5058：關鍵檔案操作。 - 5059：按鍵遷移操作。此設定的推薦狀態是：成功和失敗。"
    rationale: "擷取這些審核事件可能有助於識別 Windows 防火牆何時未如預期運作。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為Success和Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Other System Events"
    compliance:
      - cis: ["17.9.2"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Other System Events" -> r:Success and Failure'

  - id: 15669
    title: "確保“審核安全狀態變更”設定為包括“成功”。"
    description: "此子類別會報告系統安全狀態的變化，例如安全子系統何時啟動和停止。此子類別的事件包括： - 4608：Windows 正在啟動。 - 4609：Windows 正在關閉。 - 4616：系統時間已更改。 - 4621：管理員從 CrashOnAuditFail 中恢復了系統。現在將允許非管理員使用者登入。某些可審核的活動可能尚未記錄。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "若要透過GP建立推薦的設定，將以下UI路徑設定為包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Security State Change"
    compliance:
      - cis: ["17.9.3"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Security State Change" -> r:Success'

  - id: 15670
    title: "確保“審核安全系統擴充”設定為包括“成功”。"
    description: "此子類別會報告安全子系統載入的擴充代碼（例如驗證包）。此子類別的事件包括： - 4610：本機安全機構已載入身分驗證套件。 - 4611：受信任的登入程序已向本地安全機構註冊。 - 4614：安全帳戶管理器已載入通知包。 - 4622：本地安全機構已載入安全性包。 - 4697：系統中安裝了服務。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要通過 GP 設定建議的配置，請將以下 UI 路徑設置為包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Security System Extension"
    compliance:
      - cis: ["17.9.4"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"Security System Extension" -> r:Success'

  - id: 15671
    title: "確保“審核系統完整性”設定為“成功和失敗”。"
    description: "此子類別報告違反安全子系統完整性的行為。此子類別的事件包括： - 4612：分配用於審核訊息排隊的內部資源已耗盡，導致某些審核遺失。 - 4615：LPC 連接埠使用無效。 - 4618：發生了受監控的安全事件模式。 - 4816：RPC 在解密傳入訊息時偵測到完整性違規。 - 5038：程式碼完整性決定檔案的影像雜湊無效。檔案可能會因未經授權的修改而損壞，或者無效的雜湊值可能表示潛在的磁碟裝置錯誤。 - 5056：執行了密碼自檢。 - 5057：加密基元操作失敗。 - 5060：驗證操作失敗。 - 5061：加密操作。 - 5062：執行了核心模式加密自我檢測。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    remediation: "要透過GP建立建議的配置，將以下的UI路徑設定為Success和Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit System Integrity"
    compliance:
      - cis: ["17.9.5"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'c:auditpol.exe /get /subcategory:"System Integrity" -> r:Success and Failure'

  - id: 15672
    title: "確保“防止啟用鎖定螢幕攝影機”設定為“已啟用”。"
    description: "停用「電腦設定」中的鎖定畫面攝影機切換開關，並防止在鎖定畫面上呼叫攝影機。此設定的建議狀態為：已啟用。"
    rationale: "停用鎖定螢幕攝影機可將鎖定螢幕提供的保護擴充到攝影機功能。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Personalization\\Prevent enabling lock screen camera。註：此群組策略路徑預設情況下可能不存在。它由群組策略模板ControlPanelDisplay.admx/adml提供，該模板包含在Microsoft Windows 8.1及Server 2012 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.1.1.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenCamera'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenCamera -> 1'

  - id: 15673
    title: "確保「阻止啟用鎖定螢幕幻燈片放映」設定為「已啟用」。"
    description: "停用「電腦設定」中的鎖定螢幕投影片設定並阻止在鎖定畫面上播放投影片。此設定的建議狀態為：已啟用。"
    rationale: "停用鎖定螢幕投影片放映可將鎖定畫面提供的保護擴及投影片放映內容。"
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設定為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Personalization\\Prevent enabling lock screen slide show。注意：此群組原則路徑預設可能不存在。它是由群組原則模板ControlPanelDisplay.admx/adml提供，該模板包含在Microsoft Windows 8.1及2012 R2行政模板（或更新版本）中。"
    compliance:
      - cis: ["18.1.1.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenSlideshow '
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenSlideshow -> 1'

  - id: 15674
    title: "確保「允許使用者啟用線上語音辨識服務」設定為「停用」。"
    description: "此策略支援輸入個人化的自動學習組件，包括語音、墨跡書寫和打字。自動學習可以收集語音和手寫模式、打字歷史記錄、聯絡人和最近的日曆資訊。使用 Cortana 需要它。在墨跡書寫和打字的情況下，所收集的部分資訊可能會儲存在使用者的 OneDrive 上；一些資訊將被上傳到微軟以個性化語音。此設定的建議狀態是：停用。"
    rationale: "如果啟用此設置，敏感資訊可能會儲存在雲端或傳送給 Microsoft。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Regional and Language Options\\Allow users to enable online speech recognition services。注意：此 群組原則 路徑預設情況下可能不存在。它由包含在 Microsoft Windows 10 RTM（版本 1507）管理模板（或更新版本）中的群組原則模板 Globalization.admx/adml 提供。注意 #2：在較舊的 Microsoft Windows 管理模板中，此設置最初命名為 Allow input personalization，但從 Windows 10 R1809 & Server 2019 管理模板開始，它被重命名為 Allow users to enable online speech recognition services。"
    compliance:
      - cis: ["18.1.2.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\InputPersonalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\InputPersonalization -> AllowInputPersonalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\InputPersonalization -> AllowInputPersonalization -> 0'

  - id: 15675
    title: "確保「允許線上提示」設定為「停用」。"
    description: "此策略設定配置「設定」應用程式的線上提示和幫助的檢索。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "若要透過 GP 建立建議的設定，請將以下使用者介面路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Allow Online Tips。注意: 預設情況下，這個群組政策路徑可能不存在。它是由群組政策範本 ControlPanel.admx/adml 提供的，該範本包含在 Microsoft Windows 10 1709 版及更新版本的管理範本中。"
    compliance:
      - cis: ["18.1.3"]
      - pci_dss: ["1.3.4"]
      - tsc: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> AllowOnlineTips'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> AllowOnlineTips -> 0'

  - id: 15676
    title: "確保 LAPS AdmPwd GPO 擴充功能/CSE 已安裝。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "為了使用LAPS，需要進行一項小的Active Directory Schema更新，並且必須在每台受管電腦上安裝Group Policy Client Side Extension (CSE)。當安裝LAPS時，AdmPwd.dll檔案必須存在於以下位置並在Windows中註冊(安裝LAPS AdmPwd GPO Extension/CSE會為你完成這個步驟)：C:\\Program Files\\LAPS\\CSE\\AdmPwd.dll"
    compliance:
      - cis: ["18.2.1"]
      - cis_csc: ["5.2", "5.4"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'

  - id: 15677
    title: "確保「不允許密碼過期時間長於政策要求的時間」設定為「已啟用」。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：已啟用。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Do not allow password expiration time longer than required by policy. 注意: 此組策略路徑預設情況下不存在。需要一個額外的組策略模板（AdmPwd.admx/adml）- 它包含在Microsoft Local Administrator Password Solution (LAPS)中。"
    compliance:
      - cis: ["18.2.2"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PwdExpirationProtectionEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PwdExpirationProtectionEnabled -> 1'

  - id: 15678
    title: "確保「啟用本機管理員密碼管理」設定為「已啟用」。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：已啟用。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Enable Local Admin Password Management. 注意: 此群組原則路徑預設情況下不存在。需要一個額外的群組原則模板 (AdmPwd.admx/adml) - 它包含在微軟本地管理員密碼解決方案 (LAPS) 中。"
    compliance:
      - cis: ["18.2.3"]
      - cis_csc: ["5.2", "5.4"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> AdmPwdEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> AdmPwdEnabled -> 1'

  - id: 15679
    title: "確保“密碼設定：密碼複雜度”設定為“啟用：大字母+小字母+數字+特殊字元”。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：啟用：大字母+小字母+數字+特殊字元。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "若要透過 GP 設定推薦的配置，請將以下使用者介面路徑設為「啟用」，並將密碼複雜性選項配置為大寫字母+小寫字母+數字+特殊字元: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings。注意：此群組原則路徑預設情況下不存在。需要其他的群組原則範本 (AdmPwd.admx/adml) - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.2.4"]
      - cis_csc: ["5.2"]
      - pci_dss: ["8.2.3"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordComplexity'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordComplexity -> 4'

  - id: 15680
    title: "確保“密碼設定：密碼長度”設定為“啟用：15 或更多”。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為： 啟用：15 或更多。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "若要透過群組原則 (GP) 建立建議的配置，請將以下 UI 路徑設定為「啟用」，並將密碼長度選項配置為 15 或更多: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings。注意: 此群組原則路徑預設不存在，需要另外安裝一個群組原則模板 (AdmPwd.admx/adml) - 此模板包含在 Microsoft 本機管理員密碼解決方案 (LAPS) 中。"
    compliance:
      - cis: ["18.2.5"]
      - cis_csc: ["5.2"]
      - pci_dss: ["8.2.3"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordLength'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordLength -> n:^(\d+) compare >= 15'

  - id: 15681
    title: "確保「密碼設定：密碼期限（天）」設定為「啟用：30 或更少」。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為： 啟用：30 或更少。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」，並將密碼年齡（天）選項配置為30或更少：Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings。注意：此組策略路徑預設情況下不存在。需要一個額外的組策略模板(AdmPwd.admx/adml) - 這包含在Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.2.6"]
      - pci_dss: ["8.2.4"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordAgeDays'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordAgeDays -> n:^(\d+) compare <= 30'

  - id: 15682
    title: "確保「在網路登入時對本機帳戶套用 UAC 限制」設定為「啟用」。"
    description: "此設定控製本機帳戶是否可用於透過網路登入進行遠端管理（例如，NET USE、連線至 C$ 等）。當在多個系統上配置相同的帳戶和密碼時，本機帳戶面臨憑證被盜的高風險。啟用此策略可顯著降低該風險。啟用：將 UAC 令牌過濾套用至網路登入的本機帳戶。停用管理員等強大群組中的成員資格，並從產生的存取權杖中刪除強大的權限。這會將 LocalAccountTokenFilterPolicy 註冊表值配置為 0。停用：透過將LocalAccountTokenFilterPolicy 註冊表值配置為1，允許本機帳戶在透過網路登入進行身份驗證時擁有完全管理權限。和其他攻擊」憑證竊取技術的檔案。有關 LocalAccountTokenFilterPolicy 的詳細資訊，請參閱 Microsoft 知識庫文章 951016：Windows Vista 中使用者帳戶控制和遠端限制的說明。此設定的建議狀態為：已啟用。"
    rationale: "當在多個系統上配置相同的帳戶和密碼時，本機帳戶面臨憑證被盜的高風險。確保啟用此策略可以顯著降低該風險。"
    remediation: "若要通過 GP 設定推薦的配置，請將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Apply UAC restrictions to local accounts on network logons。注意：此組策略路徑預設情況下並不存在。需要額外的組策略模板 (SecGuide.admx/adml)。"
    compliance:
      - cis: ["18.3.1"]
      - cis_csc: ["5.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> LocalAccountTokenFilterPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> LocalAccountTokenFilterPolicy -> 0'

  - id: 15683
    title: "確保「配置 SMB v1 用戶端驅動程式」設定為「啟用：停用驅動程式」。"
    description: "此設定配置伺服器訊息區塊版本 1 (SMBv1) 用戶端驅動程式服務 (MRxSmb10) 的啟動類型，建議停用該啟動類型。此設定的建議狀態為： 啟用：停用驅動程式（建議）。注意：在任何情況下，都不要將此整體設定配置為“停用”，因為這樣做會完全刪除基礎註冊表項，從而導致嚴重問題。"
    rationale: "自 2016 年 9 月以來，Microsoft 強烈鼓勵禁用 SMBv1，並不再在現代網路中使用，因為它是一個已有 30 年歷史的設計，比 SMBv2 和 SMBv3 等較新的設計更容易受到攻擊。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」: Disable driver (recommended): Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 client driver. 注意: 根據預設情況，此群組策略路徑不存在。需要額外的群組策略模板 (SecGuide.admx/adml)。"
    compliance:
      - cis: ["18.3.2"]
      - cis_csc: ["4.8"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10 -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10 -> Start -> 4'

  - id: 15684
    title: "確保「配置 SMB v1 伺服器」設定為「停用」。"
    description: "此設定配置伺服器訊息區塊版本 1 (SMBv1) 協定的伺服器端處理。此設定的建議狀態是：停用。"
    rationale: "自 2016 年 9 月以來，Microsoft 強烈鼓勵禁用 SMBv1，並不再在現代網路中使用，因為它是一個已有 30 年歷史的設計，比 SMBv2 和 SMBv3 等較新的設計更容易受到攻擊。"
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 server. 注意: 這個群組原則路徑預設情況下不存在。需要額外的群組原則模板 (SecGuide.admx/adml)。"
    compliance:
      - cis: ["18.3.3"]
      - cis_csc: ["4.8"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters -> SMB1'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters -> SMB1 -> 0'

  - id: 15685
    title: "確保「啟用結構化異常處理覆蓋保護 (SEHOP)」設定為「啟用」。"
    description: "Windows 包括對結構化異常處理覆蓋保護 (SEHOP) 的支援。我們建議啟用此功能以提高電腦的安全性設定檔。此設定的建議狀態為：已啟用。"
    rationale: "此功能旨在阻止使用結構化異常處理程序 (SEH) 覆蓋技術的漏洞利用。這種保護機制是在運作時提供的。因此，它有助於保護應用程序，無論它們是否使用最新的改進（例如 /SAFESEH 選項）進行編譯。"
    remediation: "要通過組策略設置推薦配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Enable Structured Exception Handling Overwrite Protection (SEHOP)。注意：此組策略路徑預設情況下不存在。需要額外的組策略模板 (SecGuide.admx/adml)。"
    compliance:
      - cis: ["18.3.4"]
      - cis_csc: ["10.5"]
      - pci_dss: ["6.2"]
      - nist_800_53: ["SI.2", "SA.11", "SI.4"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["A1.2", "CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel -> DisableExceptionChainValidation'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel -> DisableExceptionChainValidation -> 0'

  - id: 15686
    title: "確保「限制管理員安裝列印驅動程式」設定為「啟用」。"
    description: "此策略設定控制非管理員使用者是否可以在系統上安裝列印驅動程式。此設定的建議狀態為：已啟用。注意：2021 年 8 月 10 日，Microsoft 宣布了“指向和列印預設行為變更”，該變更修改了預設指向和列印驅動程式安裝和更新行為，以需要管理員權限。這記錄在 KB5005652 - 管理新的指向和列印預設驅動程式安裝行為 (CVE-2021-34481) 中。"
    rationale: "限制管理員安裝列印磁碟機有助於緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和其他列印背景處理程序攻擊。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設為「啟用」。Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Limits print driver installation to Administrators。注意：此群組原則路徑預設情況下不存在。需要額外的群組原則範本SecGuide.admx/adml。"
    compliance:
      - cis: ["18.3.5"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsNT\Printers\PointAndPrint'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsNT\Printers\PointAndPrint -> RestrictDriverInstallationToAdministrators'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsNT\Printers\PointAndPrint -> RestrictDriverInstallationToAdministrators -> 1'

  - id: 15687
    title: "確保“NetBT NodeType 配置”設定為“啟用：P 節點”。"
    description: "此設定決定 NetBIOS over TCP/IP (NetBT) 使用哪種方法來註冊和解析名稱。可用的方法有： B 節點（廣播）方法僅使用廣播。 P 節點（點對點）方法僅使用對名稱伺服器 (WINS) 的名稱查詢。 M節點（混合）方法先廣播，如果廣播失敗則查詢名稱伺服器（WINS）。 H 節點（混合）方法首先查詢名稱伺服器 (WINS)，如果查詢失敗則進行廣播。此設定的建議狀態為： 啟用：P 節點（建議）（點對點）。                 注意：透過 LMHOSTS 或 DNS 解析遵循這些方法。如果 NodeType 登錄值存在，它將覆寫任何 DhcpNodeType 登錄值。如果 NodeType 和 DhcpNodeType 都不存在，則如果沒有為網路配置 WINS 伺服器，則電腦使用 B 節點（廣播）；如果至少配置了一台 WINS 伺服器，則電腦使用 H 節點（混合）。"
    rationale: "為了幫助降低 NetBIOS 名稱服務 (NBT-NS) 中毒攻擊的風險，將節點類型設定為 P 節點（點對點）將阻止系統傳送 NetBIOS 廣播。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為「啟用」：P-node (recommended): Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\NetBT NodeType configuration。注意：此變更在重新啟動計算機之前不會生效。注意 #2：此組策略路徑預設不存在。需要額外的組策略模板（SecGuide.admx/adml）。"
    compliance:
      - cis: ["18.3.6"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NodeType'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NodeType -> 2'

  - id: 15688
    title: "確保“WDigest 身份驗證”設定為“停用”。"
    description: "啟用 WDigest 驗證後，Lsass.exe 會在記憶體中保留使用者明文密碼的副本，從而有被盜的風險。如果未配置此設置，則 Windows 8.1 和 Windows Server 2012 R2 中將停用 WDigest 驗證；在早期版本的 Windows 和 Windows Server 中預設啟用它。有關本機帳戶和憑證盜竊的更多資訊，請查看「緩解雜湊傳遞 (PtH) 攻擊和其他憑證盜竊技術」檔案。有關 UseLogonCredential 的詳細資訊，請參閱 Microsoft 知識庫文章 2871997：2014 年 5 月 13 日用於改進憑證保護和管理的 Microsoft 安全通報更新。"
    rationale: "防止憑證以明文形式儲存在記憶體中可以減少憑證被盜的機會。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\WDigest Authentication (disabling may require KB2871997)。注意: 此群組原則路徑預設情況下不存在。需要額外的群組原則模板 (SecGuide.admx/adml)。"
    compliance:
      - cis: ["18.3.7"]
      - cis_csc: ["3.11"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -> UseLogonCredential'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -> UseLogonCredential -> 0'

  - id: 15689
    title: "確保「MSS：(AutoAdminLogon) 啟用自動登入（不建議）」設定為「停用」。"
    description: "此設定獨立於 Windows XP 和 Windows Vista 中的歡迎畫面功能；如果停用該功能，則不會停用此設定。如果將電腦設定為自動登入，則任何能夠實際存取該電腦的人也可以存取該電腦上的所有內容，包括該電腦所連接的任何一個或多個網路。此外，如果啟用自動登入，密碼將以明文形式儲存在註冊表中，並且儲存此值的特定註冊表項可由經過驗證的使用者群組遠端讀取。有關其他資訊，請參閱 Microsoft 知識庫文章 324737：如何在 Windows 中開啟自動登入。此設定的建議狀態是：停用。"
    rationale: "如果將電腦設定為自動登入，則任何能夠實際存取該電腦的人也可以存取該電腦上的所有內容，包括該電腦連接到的一個或多個網路。此外，如果啟用自動登入，密碼將以明文儲存在註冊表中。儲存此設定的特定註冊表項可由經過驗證的使用者群組遠端讀取。因此，只有當電腦受到實體保護並且確保不受信任的使用者無法遠端查看註冊表時，此條目才適用。"
    remediation: "若要通過GP建立建議配置，將以下UI路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)。注意：此組策略路徑預設情況下不存在。需要額外的組策略模板 (MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.1"]
      - cis_csc: ["3.11"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> AutoAdminLogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> AutoAdminLogon -> 0'

  - id: 15690
    title: "確保「MSS：（DisableIPSourceRouting IPv6）IP 來源路由保護等級（防止封包欺騙）」設定為「啟用：最高保護，來源路由完全停用」。"
    description: "IP 來源路由是一種允許發送方確定資料封包在網路中應遵循的 IP 路由的機制。此設定的建議狀態為： 啟用：最高保護，來源路由完全停用。"
    rationale: "攻擊者可以使用來源路由資料包來掩蓋其身分和位置。來源路由允許發送資料包的電腦指定資料包所採用的路由。"
    remediation: "要通過GP設定建議的配置，請將以下UI路徑設定為「啟用」: 最高保護，完全禁用源路由: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing). 注意: 此群組策略路徑預設不存在。需要額外的群組策略模板(MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.2"]
      - cis_csc: ["4.8"]
      - pci_dss: ["1.3.3"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -> DisableIPSourceRouting'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -> DisableIPSourceRouting -> 2'

  - id: 15691
    title: "確保「MSS：（DisableIPSourceRouting）IP 來源路由保護等級（防止封包欺騙）」設定為「啟用：最高保護，來源路由完全停用」。"
    description: "IP 來源路由是一種允許發送方確定資料封包通過網路應採用的 IP 路由的機制。對於企業環境，建議將此設定配置為“未定義”；對於高安全性環境，建議將此設定配置為“最高保護”，以完全停用來源路由。此設定的建議狀態為： 啟用：最高保護，來源路由完全停用。"
    rationale: "攻擊者可以使用來源路由資料包來掩蓋其身分和位置。來源路由允許發送資料包的電腦指定資料包所採用的路由。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「啟用」: 最高保護，源路由完全禁用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing). 注意: 此組策略路徑預設不存在。需要一個額外的組策略模板(MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.3"]
      - cis_csc: ["4.8"]
      - pci_dss: ["1.3.3"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> DisableIPSourceRouting '
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> DisableIPSourceRouting -> 2'

  - id: 15692
    title: "確保「MSS：（停用儲存密碼）防止儲存撥號密碼」設定為「啟用」。"
    description: '當您在撥號網路中撥打電話簿或 VPN 條目時，可以使用「儲存密碼」選項，以便快取您的撥號網路密碼，並且您無需在連續撥號嘗試時輸入該密碼。為了安全起見，管理員可能希望阻止使用者快取密碼。此設定的建議狀態為：已啟用。'
    rationale: "如果用於連接到組織網路的撥號或 VPN 網路條目選取「儲存此密碼」核取方塊，則竊取行動用戶電腦的攻擊者可以自動連接到組織的網路。"
    remediation: "要透過 GP 建立建議的配置，將以下使用者介面路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(DisableSavePassword) Prevent the dial-up password from being saved. 注意: 此群組原則路徑預設不存在。需要額外的群組原則模板(MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.4"]
      - cis_csc: ["4.8"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RasMan\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RasMan\Parameters -> DisableSavePassword'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RasMan\Parameters -> DisableSavePassword -> 1'

  - id: 15693
    title: "確保「MSS：（啟用ICMPRedirect）允許 ICMP 重新導向覆蓋 OSPF 產生的路由」設定為「停用」。"
    description: "Internet 控制訊息協定 (ICMP) 重新導向會導致 IPv4 堆疊偵測主機路由。這些路由會覆寫開放最短路徑優先 (OSPF) 產生的路由。此設定的建議狀態是：停用。"
    rationale: "此行為是預期的。問題在於，ICMP 重新導向偵測路由的 10 分鐘逾時期限會暫時造成一種網路狀況，即流量將不再正確路由到受影響的主機。忽略此類 ICMP 重新導向將限制系統遭受攻擊的機會，從而影響其參與網路的能力。"
    remediation: "要通過GP設置推薦的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes. 注意: 此組策略路徑預設不存在。需要額外的組策略模板 (MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.5"]
      - cis_csc: ["4.8"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
      - nist_800_53: ["SC.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> EnableICMPRedirect'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> EnableICMPRedirect -> 0'

  - id: 15694
    title: "確保「MSS：（KeepAliveTime）以毫秒為單位發送保持活動資料包的頻率」設定為「啟用：300,000 或 5 分鐘（建議）」。"
    description: "該值控制 TCP 嘗試透過發送保持活動資料包來驗證空閒連線是否仍然完好的頻率。如果遠端電腦仍然可以存取，它就會確認保持活動資料包。此設定的建議狀態為： 啟用：300,000 或 5 分鐘（建議）。"
    rationale: "能夠連接到網路應用程式的攻擊者可以建立大量連接以導致 DoS 情況。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」：300,000 或 5 分鐘（推薦）：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds. 注意：此群組原則路徑預設不存在。需要額外的群組原則模板（MSS-legacy.admx/adml）。"
    compliance:
      - cis: ["18.4.6"]
      - cis_csc: ["4.8"]
      - nist_800_53: ["SC.5"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> KeepAliveTime'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> KeepAliveTime -> 300000'

  - id: 15695
    title: "確保「MSS：(NoNameReleaseOnDemand) 允許電腦忽略來自 WINS 伺服器以外的 NetBIOS 名稱釋放請求」設定為「啟用」。"
    description: "TCP/IP 上的 NetBIOS 是一種網路協定，它提供了一種輕鬆地將在基於 Windows 的系統上註冊的 NetBIOS 名稱解析為在這些系統上配置的 IP 位址的方法。此設定會決定電腦在收到名稱釋放請求時是否釋放其 NetBIOS 名稱。此設定的建議狀態為：已啟用。"
    rationale: "NetBT 協定設計為不使用身份驗證，因此容易受到欺騙。欺騙使傳輸看起來像是來自執行該操作的用戶以外的用戶。惡意使用者可以利用該協定未經身份驗證的性質向目標電腦發送名稱衝突資料報，這將導致電腦放棄其名稱並且不回應查詢。攻擊者可以透過網路傳送請求並查詢電腦以釋放其 NetBIOS 名稱。與可能影響應用程式的任何變更一樣，建議您在更改生產環境之前在非生產環境中測試此變更。此類攻擊的結果可能是導致目標電腦出現間歇性連線問題，甚至阻止使用網路芳鄰、網域登入、NET SEND 指令或其他 NetBIOS 名稱解析。"
    remediation: "若要透過GP建立推薦設定，將以下UI路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (NoNameReleaseOnDemand) 允許電腦忽略來自除WINS伺服器以外的NetBIOS名稱釋放要求。注意: 此群組原則路徑預設情況下不存在。需要額外的群組原則範本(MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.7"]
      - cis_csc: ["4.8"]
      - pci_dss: ["1.3.3"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NoNameReleaseOnDemand'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NoNameReleaseOnDemand -> 1'

  - id: 15696
    title: "確保「MSS：（PerformRouterDiscovery）允許 IRDP 偵測和設定預設閘道位址（可能導致 DoS）」設定為「停用」。"
    description: "此設定用於啟用或停用 Internet 路由器發現協定 (IRDP)，該協定允許系統按照 RFC 1256 中的描述基於每個介面自動偵測和設定預設閘道位址。此設定的建議狀態是：停用。"
    rationale: "控制同一網段上的電腦的攻擊者可以設定網路上的電腦來冒充路由器。然後，其他啟用了 IRDP 的電腦將嘗試透過已受感染的電腦路由其流量。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS). 注意: 這個群組原則路徑預設不存在，需要額外的群組原則模板(MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.8"]
      - cis_csc: ["4.8"]
      - nist_800_53: ["SC.5"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> PerformRouterDiscovery'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> PerformRouterDiscovery -> 0'

  - id: 15697
    title: "確保「MSS：（SafeDllSearchMode）啟用安全 DLL 搜尋模式（建議）」設定為「啟用」。"
    description: "DLL 搜尋順序可以設定為透過以下兩種方式之一搜尋正在執行的程序請求的 DLL： - 首先搜尋系統路徑中指定的資料夾，然後搜尋目前工作資料夾。 - 首先搜尋目前工作資料夾，然後搜尋系統路徑中指定的資料夾。啟用後，登錄值設定為 1。停用後，登錄值設定為 0，系統會先搜尋目前工作資料夾，然後搜尋系統路徑中指定的資料夾。應用程式將被迫先在系統路徑中搜尋 DLL。對於需要應用程式中包含的這些 DLL 的唯一版本的應用程序，此條目可能會導致效能或穩定性問題。此設定的建議狀態為：已啟用。注意：有關安全 DLL 搜尋模式如何運作的更多資訊，請存取以下連結：動態連結庫搜尋順序 - Windows 應用程式 |微軟檔案"
    rationale: "如果使用者在不知情的情況下執行與包含系統 DLL 修改版本的其他檔案封裝在一起的惡意程式碼，則惡意程式碼可能會載入這些 DLL 的自己版本，並可能增加程式碼可能造成的損害類型和程度。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended). 注意: 此群組原則路徑預設情況下不存在，需要一個額外的群組原則模板 (MSS-legacy.admx/adml)。"
    compliance:
      - cis: ["18.4.9"]
      - cis_csc: ["2.6"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager -> SafeDllSearchMode'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager -> SafeDllSearchMode -> 1'

  - id: 15698
    title: "確保「MSS：(ScreenSaverGracePeriod) 螢幕保護程式寬限期到期之前的時間（以秒為單位，建議為 0）」設定為「啟用：5 秒或更少」。"
    description: "當啟用螢幕保護程式鎖定時，Windows 在啟動螢幕保護程式和控制台實際自動鎖定之間有一個寬限期。此設定的建議狀態為： 啟用：5 秒或更少。"
    rationale: "螢幕保護程式鎖定生效之前允許使用者移動的預設寬限期為五秒。如果您保留預設的寬限期配置，您的電腦很容易受到其他人的潛在攻擊，這些人可能會在鎖定生效之前接近控制台並嘗試登入電腦。可以在註冊表中輸入條目來調整寬限期的長度。"
    remediation: "若要通過GP設置推薦配置，請將以下UI路徑設置為「啟用」： 5秒或更少: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (ScreenSaverGracePeriod) 螢幕保護程式寬限期到期前的時間（建議為0秒）。 注意：此組策略路徑預設情況下不存在。需要額外的組策略模板（MSS-legacy.admx/adml）。"
    compliance:
      - cis: ["18.4.10"]
      - cis_csc: ["4.3"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScreenSaverGracePeriod'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScreenSaverGracePeriod -> n:^(\d+) compare <= 5'

  - id: 15699
    title: "確保「MSS：（TcpMaxDataRetransmissions IPv6）未確認資料重傳次數」設定為「啟用：3」。"
    description: "此設定控制在連線中止之前 TCP 重新傳輸單一資料段（非連線段）的次數。連接上每次連續重傳，重傳逾時都會加倍。當響應恢復時它會重置。基本逾時值由測量的連線往返時間動態決定。此設定的建議狀態為：啟用：3。"
    rationale: "如果惡意使用者從未針對目標電腦傳輸的資料發送任何確認訊息，則可能會耗盡目標電腦的資源。"
    remediation: "要透過 GP 設定建議的配置，請將以下 UI 路徑設為「啟用」: 3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted. 注意：此群組原則路徑預設不存在。需要額外的群組原則範本（MSS-legacy.admx/adml）。"
    compliance:
      - cis: ["18.4.11"]
      - nist_800_53: ["SC.5"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> TcpMaxDataRetransmissions'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> TcpMaxDataRetransmissions -> 3'

  - id: 15700
    title: "確保「MSS：(TcpMaxDataRetransmissions)未確認資料重傳次數」設定為「啟用：3」。"
    description: "此設定控制在連線中止之前 TCP 重新傳輸單一資料段（非連線段）的次數。連接上每次連續重傳，重傳逾時都會加倍。當響應恢復時它會重置。基本逾時值由測量的連線往返時間動態決定。此設定的建議狀態為：啟用：3。"
    rationale: "如果惡意使用者從未針對目標電腦傳輸的資料發送任何確認訊息，則可能會耗盡目標電腦的資源。"
    remediation: "要通過GP建立推薦的配置，請將以下UI路徑設置為「啟用」：3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions)未確認資料重新傳輸的次數。注意：此群組策略路徑預設情況下不存在。需要額外的群組策略模板（MSS-legacy.admx/adml）。"
    compliance:
      - cis: ["18.4.12"]
      - cis_csc: ["4.8"]
      - nist_800_53: ["SC.5"]
      - pci_dss: ["1.3.3"]
      - tsc: ["A1.1", "CC6.1", "CC7.2"]
    references:
      - https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> TcpMaxDataRetransmissions'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> TcpMaxDataRetransmissions -> 3'

  - id: 15701
    title: "確保「MSS：（警告等級）系統將產生警告的安全事件日誌的百分比閾值」設定為「啟用：90% 或更低」。"
    description: "當日誌達到使用者定義的閾值時，此設定可以在安全事件日誌中產生安全審核。此設定的建議狀態為： 啟用：90% 或更低。注意：如果日誌設定配置為根據需要覆蓋事件或覆蓋 x 天之前的事件，則不會產生此事件。"
    rationale: "如果安全日誌達到其容量的 90%，且電腦尚未配置為根據需要覆蓋事件，則較新的事件將不會寫入日誌。如果日誌已達到其容量，且電腦已設定為在無法再將事件記錄到安全日誌時關閉，則電腦將關閉並且無法再提供網路服務。"
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設定為「啟用」：90%或以下：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning. 注意：此群組原則路徑預設情況下不存在。需要額外的群組原則模板（MSS-legacy.admx/adml）。"
    compliance:
      - cis: ["18.4.13"]
      - pci_dss: ["10.7"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security'
      - 'not r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security -> WarningLevel'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security -> WarningLevel -> n:^(\d+) compare <= 90'

  - id: 15702
    title: "確保「配置 DNS over HTTPS (DoH) 名稱解析」設定為「啟用：允許 DoH」或更高層級。"
    description: "此設定決定系統是否使用基於 HTTPS (DoH) 的 DNS。 DNS over HTTPS (DoH) 是一種透過安全超文字傳輸協定 (HTTPS) 執行遠端網域名稱系統 (DNS) 解析的協定。有關基於 HTTPS (DoH) 的 DNS 的更多資訊，請存取：Windows Server 2022 上基於 HTTPS (DoH) 的安全 DNS 客戶端 |微軟檔案。此設定的建議狀態為： 啟用：允許 DoH。將此設定配置為已啟用：要求 DoH 也符合基準。"
    rationale: "DNS over HTTPS (DoH) 有助於防止 DNS 欺騙。欺騙使傳輸看起來像是來自執行該操作的用戶以外的用戶。它還可以幫助防止中間人 (MitM) 攻擊，因為中間的會話是加密的。"
    remediation: "要通過GP建立推薦的配置，請將以下 UI 路徑設置為「啟用」：允許 DoH （設置為 已啟用：要求 DoH 也符合基準）：Computer Configuration\\Policies\\Administrative Templates\\Network\\DNS Client\\Configure DNS over HTTPS (DoH) name resolution。 注意：此組策略路徑預設可能不存在。它由組策略模板 DnsClient.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 21H2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.5.4.1"]
      - cis_csc: ["3.10"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> DoHPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> DoHPolicy -> r:^2$|^3$'

  - id: 15703
    title: "確保“關閉多播名稱解析”設定為“啟用”。"
    description: "LLMNR 是輔助名稱解析協定。使用 LLMNR，可以透過單一子網路上的本機網路連結使用多重播放將查詢從用戶端電腦傳送到相同子網路上也啟用了 LLMNR 的另一台用戶端電腦。 LLMNR 不需要 DNS 伺服器或 DNS 用戶端配置，並在無法進行常規 DNS 名稱解析的情況下提供名稱解析。此設定的建議狀態為：已啟用。"
    rationale: "攻擊者可以在網路上偵聽這些 LLMNR (UDP/5355) 或 NBT-NS (UDP/137) 廣播並對其做出回應，欺騙主機認為它知道所請求系統的位置。注意：要完全緩解本機名稱解析中毒，除了此設定之外，還應將每個已安裝 NIC 的屬性設為「停用 TCP/IP 上的 NetBIOS」（在 NIC 屬性的 WINS 標籤上）。不幸的是，沒有全域設定可以自動套用於所有 NIC 來實現此目的 - 它是針對每個 NIC 的設置，隨不同的 NIC 硬體安裝而變化。"
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\DNS Client\\Turn off multicast name resolution。注意: 此群組原則路徑預設可能不存在。它是由群組原則模板 DnsClient.admx/adml 提供，此模板包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 系統管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.5.4.2"]
      - cis_csc: ["4.8"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableMulticast'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableMulticast -> 0'

  - id: 15704
    title: "確保“啟用字型提供者”設定為“停用”。"
    description: "此策略設定是否允許 Windows 從線上字型提供者下載字型和字型目錄資料。此設定的建議狀態是：停用。"
    rationale: "在企業管理的環境中，IT 部門應該管理系統配置的更改，以確保所有變更都經過測試和批准。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Network\\Fonts\\Enable Font Providers。注意：此群組原則路徑預設情況下可能不存在，它由群組原則模板 GroupPolicy.admx/adml 提供，此模板包含在 Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.5.5.1"]
      - cis_csc: ["16.5"]
      - pci_dss: ["1.3.5"]
      - tsc: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableFontProviders'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableFontProviders -> 0'

  - id: 15705
    title: "確保「啟用不安全的來賓登入」設定為「停用」。"
    description: "此政策設定確定 SMB 用戶端是否允許不安全的來賓登入 SMB 伺服器。此設定的建議狀態是：停用。"
    rationale: "檔案伺服器使用不安全的來賓登入來允許對共用資料夾進行未經身份驗證的存取。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Lanman Workstation\\Enable insecure guest logons。注意：此群組策略路徑可能預設不存在。它由群組策略模板LanmanWorkstation.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1511 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.5.8.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation -> AllowInsecureGuestAuth'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation -> AllowInsecureGuestAuth -> 0'

  - id: 15706
    title: "確保「開啟映射器 I/O (LLTDIO) 驅動程式」設定為「停用」。"
    description: "此策略設定更改映射器 I/O 網路協定驅動程式的操作行為。 LLTDIO 允許電腦發現其所連接的網路的拓撲。它還允許電腦發起服務品質請求，例如頻寬估計和網路健康分析。此設定的建議狀態是：停用。"
    rationale: "為了幫助防止可能發現和連接到未經授權的設備，應停用此設定以防止響應網路拓撲發現的網路流量。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Mapper I/O (LLTDIO) driver. 注意: 此群組原則路徑由群組原則模板 LinkLayerTopologyDiscovery.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.5.9.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableLLTDIO'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableLLTDIO -> 0'

  - id: 15707
    title: "確保「開啟響應器 (RSPNDR) 驅動程式」設定為「停用」。"
    description: "此策略設定更改響應程式網路協定驅動程式的操作行為。響應程序允許電腦參與鏈路層拓撲發現請求，以便可以在網路上發現並定位它。它還允許電腦參與服務品質活動，例如頻寬估計和網路健康分析。此設定的建議狀態是：停用。"
    rationale: "為了幫助防止可能發現和連接到未經授權的設備，應停用此設定以防止響應網路拓撲發現的網路流量。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Responder (RSPNDR) driver. 注意: 此群組原則路徑是由 Group Policy 模板 LinkLayerTopologyDiscovery.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.5.9.2"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableRspndr'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableRspndr -> 0'

  - id: 15708
    title: "確保「關閉 Microsoft 對等網路服務」設定為「啟用」。"
    description: "對等名稱解析協定 (PNRP) 允許將名稱分散式解析為 IPv6 位址和連接埠號碼。該協定在雲端環境中運行。雲端是一組可以使用相同 IPv6 範圍相互通訊的對等電腦。點對點協定允許 RTC、協作、內容分發和分散式處理領域的應用程式。此設定的建議狀態為：已啟用。"
    rationale: "此設定增強了環境的安全性並降低了與對等網路相關的整體風險暴露。"
    remediation: "若要透過 GP 建立推薦配置，請將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Network\\Microsoft Peer-to-Peer Networking Services\\Turn off Microsoft Peer-to-Peer Networking Services。注意：此群組原則路徑是由群組原則模板 P2P- pnrp.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.5.10.2"]
      - cis_csc: ["4.8"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet -> Disabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet -> Disabled -> 1'

  - id: 15709
    title: "確保「禁止在 DNS 網域網路上安裝和設定橋接器」設定為「已啟用」。"
    description: "您可以使用此程序來控制使用者安裝和設定網橋的能力。此設定的建議狀態為：已啟用。"
    rationale: "網路橋接設定（如果啟用）允許使用者建立第 2 層媒體存取控制 (MAC) 橋接，使他們能夠將兩個或多個實體網段連接在一起。因此，網橋允許連接到兩個不同網路的電腦在這些網路之間共用資料。在企業管理的環境中，需要將網路流量控制為僅經過授權的路徑，讓使用者建立網橋會增加橋接網路的風險和攻擊面。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Prohibit installation and configuration of Network Bridge on your DNS domain network. 注意：此群組原則路徑由群組原則模板 NetworkConnections.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.5.11.2"]
      - cis_csc: ["12.2"]
      - pci_dss: ["1.3.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_AllowNetBridge_NLA'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_AllowNetBridge_NLA -> 0'

  - id: 15710
    title: "確保「禁止在 DNS 網域網路上使用 Internet 連線共用」設定為「已啟用」。"
    description: "雖然此「舊」設定傳統上適用於 Windows 2000、Windows XP 和 Server 2003 中的 Internet 連線共用 (ICS) 使用，但此設定現在新套用於 Windows 10 和 Server 2016 中的行動熱點功能。設定為：啟用。"
    rationale: "非管理員不應開啟行動熱點功能並開啟其與附近行動裝置的網路連線。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Prohibit use of Internet Connection Sharing on your DNS domain network. 注意: 此組策略路徑由組策略模板NetworkConnections.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.5.11.3"]
      - pci_dss: ["1.3.5"]
      - tsc: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_ShowSharedAccessUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_ShowSharedAccessUI -> 0'

  - id: 15711
    title: "確保「設定網路位置時要求網域使用者提升權限」設定為「已啟用」。"
    description: "此策略設定決定在設定網路位置時是否要求網域使用者提升權限。此設定的建議狀態為：已啟用。"
    rationale: "允許一般使用者設定網路位置會增加風險和攻擊面。"
    remediation: "要透過 GP 建立建議的配置, 將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Require domain users to elevate when setting a network's location. 註: 此群組原則路徑預設可能不存在。它是由群組原則模板 NetworkConnections.admx/adml 提供，該模板包含在 Microsoft Windows 7 & Server 2008 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.5.11.4"]
      - cis_csc: ["5.4"]
      - pci_dss: ["1.3.5"]
      - tsc: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_StdDomainUserSetLocation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_StdDomainUserSetLocation -> 1'

  - id: 15712
    title: 確保設置加固的 UNC 路徑為已啟用，且為所有 NETLOGON 和 SYSVOL 共用設置“需要相互身份驗證”和“需要完整性”
    description: '此策略設定配置對 UNC 路徑的安全存取。此設定的建議狀態為：啟用，並為所有 NETLOGON 和 SYSVOL 共用設定「需要相互驗證」和「需要完整性」。注意：如果環境僅包含 Windows 8.0 / Server 2012（非 R2）或更高版本的系統，則也可以（選用）將「隱私權」設定設為啟用 SMB 加密。但是，使用 SMB 加密將使舊作業系統完全無法存取目標共用路徑，因此請謹慎使用此附加選項並進行徹底測試。'
    rationale: "2015 年 2 月，作為 MS15-011 / MSKB 3000483 安全性更新的一部分，Microsoft 發布了一種新的控制機制來減輕群組原則中的安全風險。此機制需要安裝新的安全性更新，還需要將特定的群組原則設定部署到 Windows Vista / Server 2008（非 R2）或更高版本的網域中的所有電腦（未啟用啟用此功能的相關安全性修補程式）針對Server 2003 發布）。安全性更新也提供了新的群組原則範本 (NetworkProvider.admx/adml)。新 GPO 範本就位後，以下是修復群組原則安全風險的最低要求： \\\\*\\NETLOGON RequireMutualAuthentication=1, RequireIntegrity=1 \\\\*\\SYSVOL RequireMutualAuthentication=1, RequireIntegrity=1 注意：將設定套用到客戶端電腦後，可能需要重新啟動才能存取上述路徑。有關部署此安全性設定的其他指南可從此處的 Microsoft Premier Field Engineering (PFE) 平台 TechNet 部落格取得：MS15-011 和 MS15-014 部署指南。"
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」，並至少配置以下路徑： \\\\*\\NETLOGON RequireMutualAuthentication=1, RequireIntegrity=1 \\\\*\\SYSVOL RequireMutualAuthentication=1, RequireIntegrity=1 Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Provider\\Hardened UNC Paths。注意：預設情況下，該群組原則路徑不存在，需要額外的群組原則模板 (NetworkProvider.admx/adml)。"
    compliance:
      - cis: ["18.5.14.1"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\NETLOGON'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\SYSVOL'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\NETLOGON -> r:RequireMutualAuthentication=1, RequireIntegrity=1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\SYSVOL -> r:RequireMutualAuthentication=1, RequireIntegrity=1'

  - id: 15713
    title: "停用 IPv6（確保 TCPIP6 參數「DisabledComponents」設定為「0xff (255)」）。"
    description: "Internet 協定版本 6 (IPv6) 是電腦用來透過 Internet 以及家庭和企業網路交換資訊的一組協定。與 IPv4 相比，IPv6 允許分配更多的 IP 位址。較舊的網路、主機和作業系統可能本身不支援 IPv6。此設定的建議狀態為：DisabledComponents - 0xff (255)"
    rationale: "由於絕大多數私人企業管理的網路不需要使用 IPv6（因為它們可以存取私有 IPv4 位址），因此停用 IPv6 元件可以消除可能的攻擊面，而該攻擊面也更難監控流量。因此，我們建議在不需要時將 IPv6 設定為停用狀態。"
    remediation: "為了設立推薦的配置，請將以下的登錄值設為0xff (255) (DWORD): HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters:DisabledComponents. 注意：此更改在重新啟動計算機之前不會生效。 注意#2：儘管Microsoft沒有提供配置此登錄值的ADMX模板，但CIS Benchmark Remediation Kit中提供了一個自定義.ADM模板（Disable-IPv6-Components-KB929852.adm），以促進其配置。 但請注意，僅僅關閉ADM模板中的群組策略設定並不會「撤銷」已應用的更改。 相反，必須應用相反的設置以將登錄值更改為相反的狀態。"
    compliance:
      - cis: ["18.5.19.2.1"]
      - cis_csc: ["4.8"]
      - pci_dss: ["2.2.2"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> DisabledComponents'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> DisabledComponents -> 255'

  - id: 15714
    title: "確保「使用 Windows Connect Now 設定無線設定」設定為「停用」。"
    description: "此策略設定允許使用 Windows Connect Now (WCN) 設定無線設定。 WCN Registrar 支援透過 Windows 可攜式裝置 API (WPD) 和 USB 隨身碟透過內建 802.11 Wi-Fi 發現和設定乙太網路 (UPnP) 裝置。還可以使用其他選項來允許透過特定媒體進行發現和配置。此設定的建議狀態是：停用。"
    rationale: "此設定增強了環境的安全性，並降低了與使用者配置無線設定相關的整體風險。"
    remediation: "要透過 GP 建立推薦的配置，請將以下使用者介面路徑設為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Configuration of wireless settings using Windows Connect Now。注意：此群組原則路徑由群組原則範本 WindowsConnectNow.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.5.20.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> EnableRegistrars'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableUPnPRegistrar'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableInBand802DOT11Registrar'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableFlashConfigRegistrar'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableWPDRegistrar'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> EnableRegistrars -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableUPnPRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableInBand802DOT11Registrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableFlashConfigRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableWPDRegistrar -> 0'

  - id: 15715
    title: "確保「禁止存取 Windows Connect Now 精靈」設定為「啟用」。"
    description: "此策略設定禁止存取 Windows Connect Now (WCN) 精靈。此設定的建議狀態為：已啟用。"
    rationale: "允許標準使用者存取 Windows Connect Now 精靈會增加風險和攻擊面。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Prohibit access of the Windows Connect Now wizards。注意: 此群組原則路徑預設可能不存在。它由群組原則模板WindowsConnectNow.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.5.20.2"]
      - cis_csc: ["15.4", "15.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI -> DisableWcnUi'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI -> DisableWcnUi -> 1'

  - id: 15716
    title: "確保「最小化同時連接到 Internet 或 Windows 網域的數量」設定為「啟用：3 = 在乙太網路上封鎖 Wi-Fi」。"
    description: "此政策設定可阻止電腦同時建立多個與 Internet 或 Windows 網域的連線。此設定的建議狀態為： 啟用：3 = 在乙太網路上封鎖 Wi-Fi。"
    rationale: "防止橋接網路連接有助於防止使用者在不知情的情況下允許流量在內部和外部網路之間路由，從而導致敏感內部資料暴露的風險。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」：3 = Prevent Wi-Fi when on Ethernet: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connection Manager\\Minimize the number of simultaneous connections to the Internet or a Windows Domain. 注意：此群組原則路徑預設可能不存在。它由 WCM.admx/adml 群組原則範本提供，該範本包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理範本中。從 Windows 10 版本 1903 管理範本開始，更新了新的 Minimize Policy Options 子設置。"
    compliance:
      - cis: ["18.5.21.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fMinimizeConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fMinimizeConnections -> 3'

  - id: 15717
    title: "確保「連接到經過網域驗證的網路時禁止連線到非網域網路」設定為「已啟用」。"
    description: "此策略設定可防止電腦同時連接到基於網域的網路和非基於網域的網路。此設定的建議狀態為：已啟用。"
    rationale: "潛在的擔憂是用戶會在不知情的情況下允許網路流量在不安全的公共網路和企業管理的網路之間流動。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connection Manager\\Prohibit connection to non-domain networks when connected to domain authenticated network。注意：此群組政策路徑預設情況下可能不存在。它由包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理模板（或更新版本）中的群組政策模板 WCM.admx/adml 提供。"
    compliance:
      - cis: ["18.5.21.2"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fBlockNonDomain'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fBlockNonDomain -> 1'

  - id: 15718
    title: "確保「允許 Windows 自動連接到建議的開放熱點、聯絡人共享的網路以及提供付費服務的熱點」設定為「停用」。"
    description: 'This policy setting determines whether users can enable the following WLAN settings: Connect to suggested open hotspots, Connect to networks shared by my contacts, and Enable paid services. - Connect to suggested open hotspots enables Windows to automatically connect users to open hotspots it knows about by crowdsourcing networks that other people using Windows have connected to. - Connect to networks shared by my contacts enables Windows to automatically connect to networks that the user''s contacts have shared with them, and enables users on this device to share networks with their contacts. - Enable paid services enables Windows to temporarily connect to open hotspots to determine if paid services are available. The recommended state for this setting is: Disabled. Note: These features are also known by the name "Wi-Fi Sense".'
    rationale: "自動連接到開放熱點或網路可能會將系統引入惡意網路。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Network\\WLAN Service\\WLAN Settings\\Allow Windows to automatically connect to suggested open hotspots, to networks shared by contacts, and to hotspots offering paid services. 注意：此群組原則路徑預設可能不存在。它由群組原則模板 wlansvc.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 1511 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.5.23.2.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config -> AutoConnectAllowedOEM'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config -> AutoConnectAllowedOEM -> 0'

  - id: 15719
    title: "確保「允許列印後台處理程序接受客戶端連線」設定為「停用」。"
    description: "此策略設定控制列印後台處理程序服務是否接受客戶端連線。此設定的建議狀態是：停用。注意：必須重新啟動背景列印程式服務才能使此原則的變更生效。"
    rationale: "停用 Print Spooler 服務接受用戶端連線的功能可以減輕針對 PrintNightmare 漏洞 (CVE-2021-34527) 的遠端攻擊和其他遠端 Print Spooler 攻擊。但是，此建議並不能減輕對 Print Spooler 服務的本地攻擊。"
    remediation: "要通過 GP 建立即使配置，將以下用戶界面路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Allow Print Spooler to accept client connections。注意: 此組策略路徑由組策略模板 printing2.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers -> RegisterSpoolerRemoteRpcEndPoint'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers -> RegisterSpoolerRemoteRpcEndPoint -> 2'

  - id: 15720
    title: "確保「指向和列印限制：為新連線安裝驅動程式時」設定為「啟用：顯示警告和提升提示」。"
    description: "此政策設定控制當使用者使用指向和列印建立新的印表機連線時電腦是否顯示警告和安全性提升提示。此設定的建議狀態為： 啟用：顯示警告和提升提示。注意：2021 年 8 月 10 日，Microsoft 宣布了“指向和列印預設行為變更”，該變更修改了預設指向和列印驅動程式安裝和更新行為，以需要管理員權限。這記錄在 KB5005652 - 管理新的指向和列印預設驅動程式安裝行為 (CVE-2021-34481) 中。此變更會覆寫所有「指向和列印」群組原則設置，並確保只有管理員才能使用「指向和列印」從列印伺服器安裝印表機驅動程式。"
    rationale: "啟用 Windows 使用者帳戶控制 (UAC) 來安裝新的列印驅動程式可以協助緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和其他列印背景處理程序攻擊。儘管指向和列印預設驅動程式安裝行為會覆蓋此設置，但將其配置為在行為相反時作為後備措施非常重要。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」: Show warning and elevation prompt: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Point and Print Restrictions: When installing drivers for a new connection. 注意：此組策略路徑由組策略模板 Printing.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.6.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers\PointAndPrint'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers\PointAndPrint -> NoWarningNoElevationOnInstall'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers\PointAndPrint -> NoWarningNoElevationOnInstall -> 0'

  - id: 15721
    title: "確保「指向和列印限制：更新現有連線的驅動程式時」設定為「啟用：顯示警告和提升提示」。"
    description: "此政策設定控制當使用者使用「指向和列印」為現有連線更新驅動程式時，電腦是否顯示警告和安全性提升提示。此設定的建議狀態為： 啟用：顯示警告和提升提示。注意：2021 年 8 月 10 日，Microsoft 宣布了“指向和列印預設行為變更”，該變更修改了預設指向和列印驅動程式安裝和更新行為，以需要管理員權限。這記錄在 KB5005652 - 管理新的指向和列印預設驅動程式安裝行為 (CVE-2021-34481) 中。此變更會覆寫所有「指向和列印」群組原則設置，並確保只有管理員才能使用「指向和列印」從列印伺服器安裝印表機驅動程式。"
    rationale: "啟用 Windows 使用者帳戶控制 (UAC) 來更新現有列印驅動程式有助於緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和其他列印背景處理程序攻擊。儘管指向和列印預設驅動程式安裝行為會覆蓋此設置，但將其配置為在行為相反時作為後備措施非常重要。"
    remediation: "若要透過 GP 建立推薦的設定，將以下使用者介面路徑設為「啟用」：顯示警告和提升提示：Computer Configuration\\Policies\\Administrative Templates\\Printers\\Point and Print Restrictions：當更新既有連線的驅動程式時。注意：此群組原則路徑是由群組原則範本 Printing.admx/adml 提供，此範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers\PointAndPrint'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers\PointAndPrint -> UpdatePromptSettings'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsNT\Printers\PointAndPrint -> UpdatePromptSettings -> 0'

  - id: 15722
    title: "確保「關閉網路使用通知」設定為「啟用」。"
    description: "此策略設定可阻止應用程式使用網路傳送更新磁貼、磁貼徽章、Toast 或原始通知的通知。此政策設定關閉 Windows 和 Windows 推播通知服務 (WNS) 之間的連線。此策略設定也會阻止應用程式輪詢應用程式服務來更新磁貼。此設定的建議狀態為：已啟用。"
    rationale: "Windows 推播通知服務 (WNS) 是一種從雲端/Internet 接收第 3 方通知和更新的機制。在高安全性環境中，應防止外部系統（尤其是組織外部託管的系統）對安全工作站產生影響。"
    remediation: "要通過 GP 建立建議的配置，請將以下用戶界面路徑設定為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Start Menu and Taskbar\\Turn off notifications network usage. 注意: 此群組原則路徑預設可能不存在。它由群組原則範本 WPN.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 & Server 2012 (non-R2) 行政範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.7.1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications -> NoCloudApplicationNotification'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications -> NoCloudApplicationNotification -> 1'

  - id: 15723
    title: "確保「在程序建立事件中包含指令列」設定為「啟用」。"
    description: "此政策設定控制在建立新程序時是否將程序建立指令列文字記錄在安全性審核事件中。此設定的建議狀態為：已啟用。注意：早於 Windows 8.1 的工作站作業系統最初不支援此設定控制的此功能。然而，2015 年 2 月，微軟透過更新 KB3004375 在 Windows 7 和 Windows 8.0 中加入了對該功能的支援。因此，在那些較舊的作業系統上設定此設定也很重要。"
    rationale: "在對攻擊事件進行取證調查時，捕獲事件日誌中的程序指令列資訊非常有價值。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Audit Process Creation\\Include command line in process creation events。 注意：該組策略路徑可能預設不存在。它由組策略模板AuditSettings.admx/adml提供，該模板包含在Microsoft Windows 8.1和Server 2012 R2的管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.3.1"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit -> ProcessCreationIncludeCmdLine_Enabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit -> ProcessCreationIncludeCmdLine_Enabled -> 1'

  - id: 15724
    title: "確保「加密 Oracle 修復」設定為「啟用：強制更新用戶端」。"
    description: "某些應用程式（例如遠端桌面連線）所使用的某些版本的 CredSSP 協定容易受到針對用戶端的加密預言機攻擊。此策略控制與易受攻擊的用戶端和伺服器的相容性，並允許您設定加密預言機漏洞所需的保護等級。此設定的建議狀態為： 啟用：強制更新客戶端。"
    rationale: "此設定對於緩解 CredSSP 加密 Oracle 漏洞非常重要，Microsoft 於 2018 年 3 月 13 日在 CVE-2018-0886 中發布了該漏洞的資訊 | CredSSP 遠端程式碼執行漏洞。從 Windows Vista 開始的所有 Windows 版本均受此漏洞影響，並且只要至少在 2018 年 5 月（或之後）之前已修補過更新檔，則將與此建議相容。"
    remediation: "若要通過GP設置推薦配置, 請設置以下UI路徑為「啟用」: Force Updated Clients: Computer Configuration\\Policies\\Administrative Templates\\System\\Credentials Delegation\\Encryption Oracle Remediation. 注意: 此組策略路徑預設可能不存在。它由組策略模板CredSsp.admx/adml提供, 該模板包含在Microsoft Windows 10版本1803管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.4.1"]
      - cis_csc: ["7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters -> AllowEncryptionOracle'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters -> AllowEncryptionOracle -> 0'

  - id: 15725
    title: "確保「遠端主機允許委派不可匯出的憑證」設定為「已啟用」。"
    description: "遠端主機允許委派不可匯出的憑證。使用憑證委派時，裝置會提供遠端主機可匯出版本的憑證。這使用戶面臨遠端主機上的攻擊者竊取憑證的風險。受限管理模式和 Windows Defender Remote Credential Guard 功能是幫助防範此風險的兩個選項。此設定的建議狀態為：已啟用。注意：有關 Windows Defender Remote Credential Guard 及其與受限管理模式的比較的更多詳細資訊，請存取此連結：使用 Windows Defender Remote Credential Guard 保護遠端桌面憑證 (Windows 10) |微軟檔案"
    rationale: "受限管理模式旨在透過確保可重複使用的憑證不會儲存在可能受到損害的遠端裝置的記憶體中來幫助保護管理員帳戶。 Windows Defender Remote Credential Guard 透過將 Kerberos 請求重新導向回請求連接的設備，幫助你透過遠端桌面連線保護你的憑證。應該啟用並支援這兩個功能，因為它們可以減少憑證被盜的機會。"
    remediation: "要通過GP建立建議配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Credentials Delegation\\Remote host allows delegation of non-exportable credentials. 注意: 這個組策略路徑預設可能不存在。它是由組策略模板CredSsp.admx/adml提供的，該模板包含在Microsoft Windows 10 Release 1703管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.4.2"]
      - cis_csc: ["10.5"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation -> AllowProtectedCreds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation -> AllowProtectedCreds -> 1'

  - id: 15726
    title: "確保「開啟基於虛擬化的安全性」設定為「已啟用」。"
    description: "此策略設定指定是否啟用基於虛擬化的安全性。基於虛擬化的安全性使用 Windows Hypervisor 來提供安全服務的支援。此設定的建議狀態為：已啟用。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "Kerberos、NTLM 和憑證管理員透過使用基於虛擬化的安全性來隔離機密。先前版本的 Windows 將機密儲存在本機安全機構 (LSA) 中。在 Windows 10 之前，LSA 將作業系統使用的機密儲存在其程序記憶體中。啟用 Windows Defender Credential Guard 後，作業系統中的 LSA 程序會與一個稱為隔離 LSA 程序的新元件進行通訊，該元件儲存和保護這些機密。隔離 LSA 程序儲存的資料受到基於虛擬化的安全性的保護，且作業系統的其餘部分無法存取。"
    remediation: "透過 GP 設定建議的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security。注意: 此群組原則路徑預設可能不存在。它由群組原則範本 DeviceGuard.admx/adml 提供，此範本包含在 Microsoft Windows 10 RTM (發行 1507) 行政範本中（或更新版本）。"
    compliance:
      - cis: ["18.8.5.1"]
      - cis_csc: ["10.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> EnableVirtualizationBasedSecurity'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> EnableVirtualizationBasedSecurity -> 1'

  - id: 15727
    title: "確保「開啟基於虛擬化的安全性：選擇平台安全等級」設定為「安全啟動和 DMA 保護」。"
    description: "此策略設定指定是否啟用基於虛擬化的安全性。基於虛擬化的安全性使用 Windows Hypervisor 來提供安全服務的支援。此設定的建議狀態是：安全啟動和 DMA 保護。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "安全啟動有助於降低引導程式攻擊的風險，並與 DMA 保護結合使用，有助於保護資料免於從記憶體中刮取。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Secure Boot 和 DMA Protection: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Select Platform Security Level. 注意: 此群組政策路徑預設可能不存在。它由包含在 Microsoft Windows 10 RTM (Release 1507) 管理模板（或更新版本）中的群組政策模板 DeviceGuard.admx/adml 提供。"
    compliance:
      - cis: ["18.8.5.2"]
      - cis_csc: ["10.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> RequirePlatformSecurityFeatures'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> RequirePlatformSecurityFeatures -> 3'

  - id: 15728
    title: "確保「開啟基於虛擬化的安全性：基於虛擬化的程式碼完整性保護」設定為「透過 UEFI 鎖定啟用」。"
    description: "此設定啟用基於虛擬化的核心模式程式碼完整性保護。啟用此功能後，將強制執行核心模式記憶體保護，並且程式碼完整性驗證路徑將受到基於虛擬化的安全功能的保護。此設定的建議狀態為：已啟用並具有 UEFI 鎖定。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "「使用 UEFI 鎖定啟用」選項可確保無法遠端停用基於虛擬化的程式碼完整性保護。"
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」並鎖定 UEFI：Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Virtualization Based Protection of Code Integrity。注意：此群組策略路徑可能預設不存在。它是由包含在 Microsoft Windows 10 RTM（版本 1507）管理模板（或更新版本）中的群組策略模板 DeviceGuard.admx/adml 提供的。"
    compliance:
      - cis: ["18.8.5.3"]
      - cis_csc: ["5.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HypervisorEnforcedCodeIntegrity'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HypervisorEnforcedCodeIntegrity -> 1'

  - id: 15729
    title: "確保「開啟基於虛擬化的安全性：需要 UEFI 記憶體屬性表」設定為「True（選取）」。"
    description: "此選項僅在具有 UEFI 韌體支援記憶體屬性表的裝置上啟用基於虛擬化的程式碼完整性保護。沒有 UEFI 記憶體屬性表的裝置可能具有與基於虛擬化的程式碼完整性保護不相容的韌體，這在某些情況下可能會導致當機或資料遺失或與某些插件卡不相容。如果未設定此選項，則應測試目標裝置以確保相容性。此設定的建議狀態是：True（選取）。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "此設定將有助於防止在不相容的系統上啟用此控件，從而導致當機或資料遺失。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 TRUE: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Require UEFI Memory Attributes Table. 注意: 該組策略路徑可能預設不存在，它由組策略範本 DeviceGuard.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1703 行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.5.4"]
      - cis_csc: ["10.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HVCIMATRequired'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HVCIMATRequired -> 1'

  - id: 15730
    title: "確保「開啟基於虛擬化的安全性：Credential Guard 設定」設定為「透過 UEFI 鎖啟用」。"
    description: '此設定可讓使用者開啟具有基於虛擬化的安全性的 Credential Guard，以協助保護憑證。 「透過 UEFI 鎖定啟用」選項可確保無法遠端停用 Credential Guard。為了停用該功能，您必須將群組原則設為“停用”，並從每台電腦（具有實際存在的使用者）中刪除安全功能，以便清除 UEFI 中保留的配置。此設定的建議狀態為：已啟用並具有 UEFI 鎖定。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。'
    rationale: "“啟用 UEFI 鎖定”選項可確保無法遠端停用 Credential Guard。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為「啟用」與UEFI鎖: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Credential Guard Configuration. 注意: 這個組策略路徑在預設情況下可能不存在。它是由組策略模板DeviceGuard.admx/adml提供的，該模板包含在Microsoft Windows 10 Release 1511 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.8.5.5"]
      - cis_csc: ["10.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> LsaCfgFlags'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> LsaCfgFlags -> 1'

  - id: 15731
    title: "確保「開啟基於虛擬化的安全性：安全啟動配置」設定為「已啟用」。"
    description: "安全啟動可保護基於虛擬化的安全環境免受裝置韌體中漏洞的利用。此設定的建議狀態為：已啟用。注意：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "安全啟動改變了 Windows 啟動方式，以使用英特爾可信任執行技術 (TXT) 和執行階段 BIOS 彈性功能，以防止韌體漏洞影響基於 Windows 虛擬化的安全環境的安全性。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Secure Launch Configuration。注意：此群組原則路徑預設情況下可能不存在。它由群組原則模板 DeviceGuard.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 1809 & Server 2019 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.8.5.6"]
      - cis_csc: ["10.5"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> ConfigureSystemGuardLaunch'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> ConfigureSystemGuardLaunch -> 1'

  - id: 15732
    title: "確保「阻止從 Internet 檢索裝置元資料」設定為「啟用」。"
    description: "此策略設定可讓您阻止 Windows 從 Internet 擷取裝置元資料。此設定的建議狀態為：已啟用。注意：這不會阻止基本硬體驅動程式的安裝，但會阻止關聯的第 3 方實用軟體在 SYSTEM 帳戶的上下文中自動安裝。"
    rationale: "軟體安裝應由授權系統管理員而非標準使用者進行。允許在 SYSTEM 帳戶上下文中自動安裝第 3 方軟體可能會導致透過後門或安裝軟體錯誤進行未經授權的存取。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Installation\\Prevent device metadata retrieval from the Internet. 注意：此群組策略路徑由群組策略模板DeviceInstallation.admx/adml提供，該模板包含在Microsoft Windows 7 & Server 2008 R2管理模板中，或包含在群組策略模板DeviceSetup.admx/adml中的Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Device Metadata'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Device Metadata -> PreventDeviceMetadataFromNetwork'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Device Metadata -> PreventDeviceMetadataFromNetwork -> 1'

  - id: 15733
    title: "確保「引導啟動驅動程式初始化策略」設定為「啟用：良好、未知和不良但關鍵」。"
    description: "此策略設定可讓您指定根據早期啟動反惡意軟體啟動驅動程式確定的分類來初始化哪些啟動啟動驅動程式。早期啟動反惡意軟體引導啟動驅動程式可以為每個引導啟動驅動程式傳回以下分類： - 良好：驅動程式已簽署且未被竄改。 - 壞：驅動程式已被識別為惡意軟體。建議您不要允許初始化已知的不良驅動程式。 - 不良，但啟動所需：驅動程式已被識別為惡意軟體，但如果不載入此驅動程式，電腦將無法成功啟動。 - 未知：此驅動程式尚未經過您的惡意軟體偵測應用程式的證明，並且尚未由 Early Launch Antimalware 啟動驅動程式分類。如果啟用此策略設置，您將能夠選擇下次啟動電腦時要初始化的引導啟動驅動程式。如果您的惡意軟體偵測應用程式不包含早期啟動反惡意軟體啟動驅動程式，或者您的早期啟動反惡意軟體啟動驅動程式已停用，則此設定無效，並且所有啟動驅動程式都會被初始化。此設定的建議狀態為： 啟用：良好、未知和不良但關鍵。"
    rationale: "此策略設定有助於減少已感染系統的惡意軟體的影響。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設定為「啟用」：良好、未知和不良但至關重要：Computer Configuration\\Policies\\Administrative Templates\\System\\Early Launch Antimalware\\Boot-Start Driver Initialization Policy 。注意：此群組原則路徑預設可能不存在。它由包含在 Microsoft Windows 8.0 及 Server 2012（非 R2）管理模板（或更新版本）中的群組原則模板 EarlyLaunchAM.admx/adml 提供。"
    compliance:
      - cis: ["18.8.14.1"]
      - cis_csc: ["10.5"]
      - pci_dss: ["5.1.1"]
      - nist_800_53: ["SI.3"]
      - tsc: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch -> DriverLoadPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch -> DriverLoadPolicy -> 3'

  - id: 15734
    title: "確保「配置註冊表策略處理：不在定期後台處理期間套用」設定為「啟用：FALSE」。"
    description: '「定期後台處理期間不套用」選項可防止系統在電腦使用時在背景更新受影響的策略。停用背景更新後，政策變更將在下次使用者登入或系統重新啟動後生效。此設定的建議狀態為： 已啟用：FALSE（未選取）。'
    rationale: "與等到下一次使用者登入或系統重新啟動相比，將此選項設為 false（未選取）將確保網域原則變更更快生效。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為「啟用」，然後將Do not apply during periodic background processing選項設置為FALSE（未勾選）：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Configure registry policy processing。注意：此組策略路徑可能預設不存在，它由組策略模板GroupPolicy.admx/adml提供，該模板包含在Microsoft Windows 8.0＆Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.21.2"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> 0'

  - id: 15735
    title: "確保「配置註冊表策略處理：即使群組原則物件未變更也進行處理」設定為「啟用：TRUE」。"
    description: '「即使群組原則物件未變更也進行處理」選項會更新並重新套用策略，即使策略未變更也是如此。此設定的建議狀態為： 啟用：TRUE（選取）。'
    rationale: "將此選項設為 true（選取）將確保可能已在本機配置的未經授權的變更強制再次符合基於網域的群組原則設定。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為「啟用」，然後將即使群組策略物件未更改也進行處理選項設置為TRUE（已勾選）：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Configure registry policy processing。注意：此群組策略路徑可能不會預設存在。 它由Group Policy模板GroupPolicy.admx/adml提供，此模板包含在Microsoft Windows 8.0和Server 2012（非R2）的管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.21.3"]
      - pci_dss: ["11.5.1"]
      - tsc: ["PI1.4", "PI1.5", "CC6.1", "CC6.8", "CC7.2", "CC7.3", "CC7.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> 0'

  - id: 15736
    title: "確保“在此裝置上繼續體驗”設定為“已停用”。"
    description: "此策略設定是否允許 Windows 裝置參與跨裝置體驗（繼續體驗）。此設定的建議狀態是：停用。"
    rationale: "跨裝置體驗是指系統可以存取應用程式並向其他裝置發送訊息。在企業管理的環境中，只有受信任的系統才應該在網路內進行通訊。應禁止存取任何其他系統。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Continue experiences on this device. 注意：此群組原則路徑可能預設不存在。它是由群組原則範本GroupPolicy.admx/adml提供，該範本包含在Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.8.21.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableCdp'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableCdp -> 0'

  - id: 15737
    title: "確保「關閉群組原則後台刷新」設定為「停用」。"
    description: "此策略設定可防止在電腦使用時更新群組原則。此策略設定適用於電腦、使用者和網域控制站的群組原則。此設定的建議狀態是：停用。"
    rationale: "與等到下次使用者登入或系統重新啟動相比，此設定可確保群組原則變更更快生效。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Turn off background refresh of Group Policy. 注意: 此組織策略路徑由隨附於所有版本的 Microsoft Windows 管理模板中包含的組織策略模板 GroupPolicy.admx/adml 提供。"
    compliance:
      - cis: ["18.8.21.5"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableBkGndGroupPolicy'

  - id: 15738
    title: "確保「關閉對商店的存取」設定為「已啟用」。"
    description: "此策略設定指定是否使用儲存服務來尋找應用程式以開啟具有未處理的檔案類型或協定關聯的檔案。當使用者開啟與電腦上的任何應用程式不關聯的檔案類型或協定時，使用者可以選擇選擇本機應用程式或使用應用程式商店服務來尋找應用程式。此設定的建議狀態為：已啟用。"
    rationale: "Store 服務是 Windows 內建的零售商店，主要供消費者使用。在企業管理的環境中，IT 部門應該管理所有應用程式的安裝，以降低安裝易受攻擊的軟體的風險。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off access to the Store。注意：此群組原則路徑可能預設不存在。它是由群組原則範本 ICM.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.22.1.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoUseStoreOpenWith'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoUseStoreOpenWith -> 1'

  - id: 15739
    title: "請確保「關閉透過 HTTP 下載列印驅動程式」設定為「啟用」。"
    description: "此原則設定控制電腦是否可以透過 HTTP 下載列印驅動程式套件。若要設定 HTTP 列印，可能需要透過 HTTP 下載標準作業系統安裝中不可用的印表機驅動程式。此設定的建議狀態為：已啟用。"
    rationale: "使用者可能會下載包含惡意程式碼的驅動程式。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off downloading of print drivers over HTTP。注意：此群組原則路徑由群組原則模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.8.22.1.2"]
      - cis_csc: ["2.5"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableWebPnPDownload'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableWebPnPDownload -> 1'

  - id: 15740
    title: "確保「關閉手寫個人化資料共享」設定為「啟用」。"
    description: "此設定會關閉手寫辨識個人化工具的資料共用。手寫辨識個人化工具使平板電腦使用者能夠透過提供書寫範例來使手寫辨識適應自己的書寫風格。該工具可以選擇與 Microsoft 共用使用者書寫範例，以改善未來版本的 Windows 中的手寫識別。該工具會產生報表並透過安全連線將其傳輸給 Microsoft。此設定的建議狀態為：已啟用。"
    rationale: "一個人的筆跡是個人識別資訊 (PII)，尤其是當涉及到您的簽名時。因此，在許多環境中，未經使用者明確批准而自動將 PII 上傳到網站是不可接受的。"
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting personalization data sharing。注意：此群組政策路徑預設可能不存在。這是由群組政策模板 ShapeCollector.admx/adml 提供，該模板包含在 Microsoft Windows 7 和 Server 2008 R2 管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.8.22.1.3"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC -> PreventHandwritingDataSharing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC -> PreventHandwritingDataSharing -> 1'

  - id: 15741
    title: "確保「關閉手寫辨識錯誤報告」設定為「啟用」。"
    description: "關閉手寫辨識錯誤報告工具。手寫識別錯誤報告工具使用戶能夠報告在 Tablet PC 輸入面板中遇到的錯誤。該工具會產生錯誤報告並透過安全連線將其傳輸給 Microsoft。 Microsoft 使用這些錯誤報告來改進未來版本的 Windows 中的手寫辨識。此設定的建議狀態為：已啟用。"
    rationale: "一個人的筆跡是個人識別資訊 (PII)，尤其是當涉及到您的簽名時。因此，在許多環境中，未經使用者明確批准而自動將 PII 上傳到網站是不可接受的。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting recognition error reporting。注意：此群組原則路徑由 Group Policy 模板 InkWatson.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.8.22.1.4"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports -> PreventHandwritingErrorReports'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports -> PreventHandwritingErrorReports -> 1'

  - id: 15742
    title: "確保「如果 URL 連線引用 Microsoft.com，則關閉 Internet 連線精靈」設定為「啟用」。"
    description: "此政策設定指定 Internet 連線精靈是否可以連線至 Microsoft 以下載 Internet 服務提供者 (ISP) 的清單。此設定的建議狀態為：已啟用。"
    rationale: "在企業管理的環境中，我們希望降低使用者在不知情的情況下暴露敏感資料的風險。"
    remediation: "要通過 GP 建立推薦的配置，請將以下用戶介面路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com. 注意：此群組政策路徑由包含在所有版本的 Microsoft Windows 管理模板中的群組政策模板 ICM.admx/adml 提供。"
    compliance:
      - cis: ["18.8.22.1.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard -> ExitOnMSICW'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard -> ExitOnMSICW -> 1'

  - id: 15743
    title: "確保「關閉 Web 發佈和線上訂購精靈的 Internet 下載」設定為「啟用」。"
    description: "此策略設定控制 Windows 是否下載 Web 發佈和線上訂購精靈的提供者清單。此設定的建議狀態為：已啟用。"
    rationale: "儘管風險很小，但啟用此設定將降低用戶在不知情的情況下透過此功能下載惡意內容的可能性。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet download for Web publishing and online ordering wizards。 注意: 此組策略路徑由組策略模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.8.22.1.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoWebServices'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoWebServices -> 1'

  - id: 15744
    title: "確保「關閉透過 HTTP 的列印」設定為「啟用」。"
    description: "此原則設定可讓您停用用戶端電腦透過 HTTP 列印的功能，從而允許電腦列印到 Intranet 和 Internet 上的印表機。此設定的建議狀態為：已啟用。注意：此控制會影響透過 HTTP 和 HTTPS 進行的列印。"
    rationale: "透過此功能透過 HTTP 傳輸的資訊不受保護，並且可能被惡意使用者攔截。因此，它不經常在企業託管環境中使用。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off printing over HTTP. 注意：此組策略路徑由組策略模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.8.22.1.7"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableHTTPPrinting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableHTTPPrinting -> 1'

  - id: 15745
    title: "確保「如果 URL 連線引用 Microsoft.com，則關閉註冊」設定為「啟用」。"
    description: "此政策設定指定 Windows 註冊精靈是否連接到 Microsoft.com 進行線上註冊。此設定的建議狀態為：已啟用。"
    rationale: "企業管理環境中的使用者不應註冊自己的 Windows 副本，並在此過程中提供自己的 PII。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Registration if URL connection is referring to Microsoft.com. 注意: 這條群組原則路徑由群組原則範本 ICM.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.8.22.1.8"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control -> NoRegistration'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control -> NoRegistration -> 1'

  - id: 15746
    title: "確保「關閉搜尋伴侶內容檔案更新」設定為「啟用」。"
    description: "此策略設定指定Search Companion 是否應在本機和 Internet 搜尋期間自動下載內容更新。此設定的建議狀態為：已啟用。"
    rationale: "用戶可能會因為搜尋的主題而在不知不覺中洩露敏感訊息，這種風險很小。這種風險非常低，因為即使啟用此設置，用戶仍然必須向所需的搜尋引擎提交搜尋查詢才能執行搜尋。"
    remediation: "要透過GP建立建議的配置，將以下用戶介面路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Search Companion content file updates. 注意：此群組原則路徑由群組原則模板ICM.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.8.22.1.9"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion -> DisableContentFileUpdates'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion -> DisableContentFileUpdates -> 1'

  - id: 15747
    title: 確保將「關閉 '訂購列印' 圖片任務」設置為已啟用
    description: '此策略設定指定「線上訂購列印」任務是否可從 Windows 資料夾中的圖片任務中取得。線上訂購印刷品嚮導用於下載提供者清單並允許用戶線上訂購印刷品。此設定的建議狀態為：已啟用。'
    rationale: "在企業管理的環境中，我們希望降低使用者在不知情的情況下暴露敏感資料的風險。"
    remediation: "若要透過 GP 確立建議的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Order Prints\" picture task. 注意: 此群組原則路徑由群組原則範本 ICM.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.8.22.1.10"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoOnlinePrintsWizard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoOnlinePrintsWizard -> 1'

  - id: 15748
    title: '確保將檔案和資料夾的「發布到Web」關閉任務 設定為「啟用」'
    description: "此政策設定指定「將此檔案發佈到Web」、「將此資料夾發佈到Web」和「將所選項目發佈到Web」任務是否可從Windows 資料夾中的「資料和資料夾任務」中取得。 Web 發布精靈用於下載提供者清單並允許使用者將內容發佈到 Web。此設定的建議狀態為：已啟用。"
    rationale: "使用者可以向組織控制以外的公共服務發布機密或敏感資訊。"
    remediation: "透過 GP 建立推薦的設定，將以下使用者介面路徑設為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Publish to Web\" task for files and folders. 注意：此群組原則路徑由包含在所有版本的 Microsoft Windows 管理模板中的 ICM.admx/adml 群組原則模板提供。"
    compliance:
      - cis: ["18.8.22.1.11"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoPublishingWizard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoPublishingWizard -> 1'

  - id: 15749
    title: "確保「關閉 Windows Messenger 客戶體驗改善計畫」設定為「啟用」。"
    description: "此策略設定指定 Windows 客戶體驗改善計畫是否可以收集有關 Windows 使用方式的匿名資訊。 Microsoft 使用透過 Windows 客戶體驗改進計劃收集的資訊來改進最常用的功能並偵測缺陷，以便更快地修正它們。啟用此設定將減少 Microsoft 為此目的收集的資料量。此設定的建議狀態為：已啟用。"
    rationale: "大型企業託管環境可能不希望 Microsoft 從託管客戶端電腦收集資訊。"
    remediation: "要透過GP建立建議的設定，將以下使用者介面路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the Windows Messenger Customer Experience Improvement Program. 注意：此群組原則路徑由群組原則範本ICM.admx/adml提供，該範本包含在所有版本的Microsoft Windows行政範本中。"
    compliance:
      - cis: ["18.8.22.1.12"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client -> CEIP'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client -> CEIP -> 2'

  - id: 15750
    title: "確保「關閉 Windows 客戶體驗改善計畫」設定為「啟用」。"
    description: "此策略設定指定 Windows Messenger 是否可以收集有關如何使用 Windows Messenger 軟體和服務的匿名資訊。 Microsoft 使用透過 Windows 客戶體驗改善計畫收集的資訊來偵測軟體缺陷，以便可以更快地修正這些缺陷，啟用此設定將減少 Microsoft 為此目的收集的資料量。此設定的建議狀態為：已啟用。"
    rationale: "大型企業託管環境可能不希望 Microsoft 從託管客戶端電腦收集資訊。"
    remediation: "要透過GP設定推薦的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Customer Experience Improvement Program。注意：此組策略路徑由Group Policy模板ICM.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.8.22.1.13"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows -> CEIPEnable'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows -> CEIPEnable -> 0'

  - id: 15751
    title: "確保「關閉 Windows 錯誤報告」設定為「啟用」。"
    description: "此策略設定控制是否向 Microsoft 報告錯誤。錯誤報告用於報告有關發生故障或停止回應的系統或應用程式的資訊，並用於提高產品品質。此設定的建議狀態為：已啟用。"
    rationale: "如果 Windows 錯誤發生在安全的企業管理環境中，則應將錯誤直接回報給 IT 人員以進行故障排除和修復。直接向 Microsoft 報告這些錯誤對公司沒有任何好處，並且存在在不知情的情況下暴露敏感資料作為錯誤的一部分的風險。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Error Reporting。注意：此群組原則路徑由所有版本的 Microsoft Windows 行政模板隨附的群組原則模板 ICM.admx/adml 提供。"
    compliance:
      - cis: ["18.8.22.1.14"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> Disabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> Disabled -> 1'

  - id: 15752
    title: "確保「支援使用憑證進行裝置驗證」設定為「啟用：自動」。"
    description: "此策略設定可讓您設定對 Kerberos 的支持，以嘗試使用裝置的憑證對網域進行驗證。支援使用憑證進行裝置驗證將需要連接到裝置帳戶網域中支援電腦帳戶憑證驗證的 DC。此設定的建議狀態為：啟用：自動。"
    rationale: "強烈建議使用憑證進行更強大的裝置身份驗證，而不是標準的使用者名稱和密碼身份驗證。將此設定為「自動」將允許盡可能使用基於憑證的身份驗證。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「啟用」：自動：Computer Configuration\\Policies\\Administrative Templates\\System\\Kerberos\\Support device authentication using certificate。注意：預設情況下，這個組策略路徑可能不存在。它由組策略模板Kerberos.admx/adml提供，該模板包含在Microsoft Windows 10 RTM（發布1507）管理模板（或更高版本）中。"
    compliance:
      - cis: ["18.8.25.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitBehavior -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitEnabled -> 1'

  - id: 15753
    title: "確保「與核心 DMA 保護不相容的外部裝置的列舉策略」設定為「啟用：阻止全部」。"
    description: "此策略旨在針對支援 DMA 的外部裝置提供額外的安全性。它允許對與 DMA 重新映射/裝置記憶體隔離和沙箱不相容的外部支援 DMA 的裝置的列舉進行更多控制。此設定的建議狀態為：啟用：全部封鎖。注意：此策略不適用於 1394、PCMCIA 或 ExpressCard 設備。此保護也僅適用於 Windows 10 R1803 或更高版本，也需要 UEFI BIOS 才能發揮作用。注意 #2：有關此功能的更多資訊，請存取此鏈接：Thunderbolt™ 3 的內核 DMA 保護 (Windows 10) |微軟檔案。"
    rationale: "裝置記憶體沙箱允許作業系統利用裝置的 I/O 記憶體管理單元 (IOMMU) 來阻止週邊裝置進行未經允許的 I/O 或記憶體存取。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」：Block All: Computer Configuration\\Policies\\Administrative Templates\\System\\Kernel DMA Protection\\Enumeration policy for external devices incompatible with Kernel DMA Protection。注意：此群組策略路徑預設可能不存在。它由群組策略範本 DmaGuard.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1809 & Server 2019 Administrative Templates (或更新版本) 中。"
    compliance:
      - cis: ["18.8.26.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection -> DeviceEnumerationPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection -> DeviceEnumerationPolicy -> 0'

  - id: 15754
    title: "確保「禁止將使用者輸入方法複製到系統帳戶進行登入」設定為「已啟用」。"
    description: "此策略可防止將使用者輸入法自動複製到系統帳戶以在登入畫面上使用。使用者只能使用系統帳戶中啟用的一組輸入法。此設定的建議狀態為：已啟用。"
    rationale: "這是增加系統帳戶安全性的一種方法。"
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Locale Services\\Disallow copying of user input methods to the system account for sign-in。注意：此組策略路徑預設情況下可能不存在。它由組策略模板Globalization.admx/adml提供，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更高版本）中。"
    compliance:
      - cis: ["18.8.27.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International -> BlockUserInputMethodsForSignIn'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International -> BlockUserInputMethodsForSignIn -> 1'

  - id: 15755
    title: "確保「阻止使用者在登入時顯示帳戶詳細資料」設定為「已啟用」。"
    description: "此策略可阻止使用者在登入畫面上顯示帳戶詳細資訊（電子郵件地址或使用者名稱）。此設定的建議狀態為：已啟用。"
    rationale: "有權存取控制台的攻擊者（例如，具有實體存取權限的人或能夠透過遠端桌面服務連接到工作站的人）可以查看最後登入伺服器的使用者的名稱。然後，攻擊者可以嘗試猜測密碼、使用字典或使用暴力攻擊來嘗試登入。"
    remediation: "要透過 GP 建立推薦配置，將以下的 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Block user from showing account details on sign-in。注意：此群組原則路徑預設可能不存在。它由群組原則範本 Logon.admx/adml 提供，該範本包含於 Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (或更新版本)。"
    compliance:
      - cis: ["18.8.28.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockUserFromShowingAccountDetailsOnSignin'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockUserFromShowingAccountDetailsOnSignin -> 1'

  - id: 15756
    title: "確保“不顯示網路選擇 UI”設定為“啟用”。"
    description: "此策略設定可讓你控制是否任何人都可以與登入畫面上的可用網頁 UI 互動。此設定的建議狀態為：已啟用。"
    rationale: "未經授權的使用者可以將電腦與網路斷開連接，或者可以在不登入 Windows 的情況下將電腦連接到其他可用網路。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Do not display network selection UI。注意：此群組原則路徑預設可能不存在。它是由 Microsoft Windows 8.1 和 Server 2012 R2 管理模板（或更新版本）中包含的群組原則模板 Logon.admx/adml 提供的。"
    compliance:
      - cis: ["18.8.28.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontDisplayNetworkSelectionUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontDisplayNetworkSelectionUI -> 1'

  - id: 15757
    title: "確保「不列舉已加入網域的電腦上的已連線使用者」設定為「已啟用」。"
    description: "此政策設定可防止在加入網域的電腦上列舉已連線的使用者。此設定的建議狀態為：已啟用。"
    rationale: "惡意使用者可以使用此功能來收集其他使用者的帳戶名，然後該資訊可以與其他類型的攻擊結合使用，例如猜測密碼或社交工程。此對策的價值很小，因為具有網域憑證的使用者可以使用其他方法收集相同的帳戶資訊。"
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Do not enumerate connected users on domain-joined computers. 注意: 此群組策略路徑預設可能不存在。它由包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板中的群組策略模板Logon.admx/adml提供（或更新版本）。"
    compliance:
      - cis: ["18.8.28.3"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontEnumerateConnectedUsers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontEnumerateConnectedUsers -> 1'

  - id: 15758
    title: "確保「列舉加入網域的電腦上的本機使用者」設定為「停用」。"
    description: "此策略設定允許在加入網域的電腦上列舉本機使用者。此設定的建議狀態是：停用。"
    rationale: "惡意使用者可以使用此功能來收集其他使用者的帳戶名，然後該資訊可以與其他類型的攻擊結合使用，例如猜測密碼或社交工程。此對策的價值很小，因為具有網域憑證的使用者可以使用其他方法收集相同的帳戶資訊。"
    remediation: "要透過 GP 設定建議的配置，將以下的 UI 路徑設為「停用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Enumerate local users on domain-joined computers。注意：此群組原則路徑預設情況下可能不存在。它由群組原則範本 Logon.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理範本中（或更新版本）。"
    compliance:
      - cis: ["18.8.28.4"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnumerateLocalUsers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnumerateLocalUsers -> 0'

  - id: 15759
    title: "確保「關閉鎖定畫面上的應用程式通知」設定為「啟用」。"
    description: "此策略設定可讓您阻止應用程式通知出現在鎖定畫面上。此設定的建議狀態為：已啟用。"
    rationale: "應用程式通知可能會顯示敏感的業務或個人資料。"
    remediation: "若要透過GP設定建議的配置，請將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn off app notifications on the lock screen. 注意: 此群組原則路徑預設可能不存在。它由群組原則模板Logon.admx/adml提供，此模板包含於Microsoft Windows 8.0 & Server 2012 (非R2) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.28.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DisableLockScreenAppNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DisableLockScreenAppNotifications -> 1'

  - id: 15760
    title: "確保「關閉圖片密碼登入」設定為「啟用」。"
    description: "此政策設定可讓您控制網域使用者是否可以使用圖片密碼登入。此設定的建議狀態為：已啟用。注意：如果允許圖片密碼功能，則使用時使用者的網域密碼會快取在系統保管庫中。"
    rationale: "圖片密碼無需輸入複雜密碼。在共享工作環境中，只要有人觀察螢幕上的手勢，進行簡單的肩衝浪，就可以讓該人無需知道複雜的密碼即可存取系統。帶有影像的垂直監視器螢幕在遠處比水平擊鍵更清晰，從而增加了成功觀察滑鼠手勢的可能性。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn off picture password sign-in。注意：此組策略路徑可能並非預設存在。它是由組策略模板CredentialProviders.admx/adml提供的，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.28.6"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockDomainPicturePassword'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockDomainPicturePassword -> 1'

  - id: 15761
    title: "確保「開啟便捷 PIN 登入」設定為「停用」。"
    description: "此政策設定可讓您控制網域使用者是否可以使用便利 PIN 登入。在 Windows 10 中，便利 PIN 被具有更強安全性的 Passport 取代。若要為網域使用者設定 Passport，請使用電腦設定\\管理範本\\Windows 元件\\Microsoft Passport for Work 下的原則。注意：使用此功能時，使用者的網域密碼將快取在系統保管庫中。此設定的建議狀態是：停用。"
    rationale: "PIN 碼是由比密碼少得多的字元創建的，因此在大多數情況下，PIN 碼的穩健性遠不如密碼。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn on convenience PIN sign-in。注意: 此群組原則路徑預設可能不存在。它由群組原則模板CredentialProviders.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012 (非R2)管理模板中（或更新版本）。注意#2: 在舊版Microsoft Windows管理模板中，此設定最初名為Turn on PIN sign-in，但從Windows 10 Release 1511管理模板開始改名。"
    compliance:
      - cis: ["18.8.28.7"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowDomainPINLogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowDomainPINLogon -> 0'

  - id: 15762
    title: "確保「允許跨裝置同步剪貼簿」設定為「停用」。"
    description: "此設定決定剪貼簿內容是否可以跨裝置同步。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，剪貼簿資料應保留在系統本地，而不是跨裝置同步，因為它可能包含必須包含在本地的非常敏感的資訊。"
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\OS Policies\\Allow Clipboard synchronization across devices。注意：此群組原則路徑預設狀況下可能不存在。它由隨Microsoft Windows 10 Release 1809 & Server 2019 Administrative Templates（或更新版本）一起提供的群組原則範本OSPolicy.admx/adml提供。"
    compliance:
      - cis: ["18.8.31.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowCrossDeviceClipboard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowCrossDeviceClipboard -> 0'

  - id: 15763
    title: "確保「允許上傳使用者活動」設定為「停用」。"
    description: "此策略設定確定是否可以將已發佈的使用者活動上傳到雲端。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\OS Policies\\Allow upload of User Activities。注意: 此組策略路徑預設可能不存在。它由組策略模板OSPolicy.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1803管理模板(或更新版本)中。"
    compliance:
      - cis: ["18.8.31.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> UploadUserActivities'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> UploadUserActivities -> 0'

  - id: 15764
    title: "確保「在連接待機期間允許網路連線（使用電池）」設定為「停用」。"
    description: "此策略設定可讓您控制現代具有待機功能的系統上待機時的網路連線狀態。此設定的建議狀態是：停用。"
    rationale: "停用此設定可確保電腦在無人看管、使用電池且處於睡眠狀態時無法透過 WLAN 網路存取。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Allow network connectivity during connected-standby (on battery)。注意：此群組原則路徑可能預設不存在。它由群組原則範本 Power.admx/adml 提供，該範本隨附於 Microsoft Windows 10 Release 1607 & Server 2016 行政模板（或更新版本）。"
    compliance:
      - cis: ["18.8.34.6.1"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex -> 0'

  - id: 15765
    title: "確保「在連接待機（插入）期間允許網路連線」設定為「停用」。"
    description: "此策略設定可讓您控制現代具有待機功能的系統上待機時的網路連線狀態。此設定的建議狀態是：停用。"
    rationale: "停用此設定可確保攻擊者在無人看管、接通電源並處於睡眠狀態時無法透過 WLAN 網路存取電腦。"
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Allow network connectivity during connected-standby (plugged in)。注意：此群組策略路徑預設可能不存在。這是由群組策略模板 Power.admx/adml 提供的，該模板包含在 Microsoft Windows 10 Release 1607 和 Server 2016 管理模板（或更高版本）中。"
    compliance:
      - cis: ["18.8.34.6.2"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex -> 0'

  - id: 15766
    title: "確保「電腦喚醒時需要密碼（使用電池）」設定為「啟用」。"
    description: "指定當系統從睡眠狀態恢復時是否提示使用者輸入密碼。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可確保將無人值守的電腦從睡眠狀態喚醒的任何人都必須提供登入憑證才能存取系統。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Require a password when a computer wakes (on battery)。注意: 此群組原則路徑預設可能不存在。它是由 Group Policy 範本 Power.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 行政範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.8.34.6.5"]
      - cis_csc: ["4.3"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> 1'

  - id: 15767
    title: "確保“電腦喚醒（插入電源）時需要密碼”設定為“啟用”。"
    description: "指定當系統從睡眠狀態恢復時是否提示使用者輸入密碼。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可確保將無人值守的電腦從睡眠狀態喚醒的任何人都必須提供登入憑證才能存取系統。"
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Require a password when a computer wakes (plugged in)。注意: 此群組原則路徑預設可能不存在。它是由群組原則模板 Power.admx/adml 提供的，該模板包含在 Microsoft Windows 8.0 及 Server 2012 (非 R2) 管理模板中 (或更新版本)。"
    compliance:
      - cis: ["18.8.34.6.6"]
      - cis_csc: ["4.3"]
      - pci_dss: ["8.2"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> 1'

  - id: 15768
    title: "確保「配置提供遠端協助」設定為「停用」。"
    description: "此策略設定可讓您開啟或關閉此電腦上的提供（未經請求的）遠端協助。服務台和支援人員將無法主動提供協助，但他們仍可回應使用者的協助要求。此設定的建議狀態是：停用。"
    rationale: "用戶可能會被欺騙並接受惡意用戶主動提供的遠端協助。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Assistance\\Configure Offer Remote Assistance. 注意：此組策略路徑預設可能不存在。它由組策略模板RemoteAssistance.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.8.36.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowUnsolicited'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowUnsolicited -> 0'

  - id: 15769
    title: "確保「配置請求的遠端協助」設定為「停用」。"
    description: "此策略設定可讓您開啟或關閉此電腦上的請求（請求）遠端協助。此設定的建議狀態是：停用。"
    rationale: "流氓管理員可能會獲得對其他使用者桌面會話的存取權限，但他們無法在未經使用者許可的情況下連接到使用者的電腦或控制該電腦。當專家嘗試連線時，使用者仍然可以選擇拒絕連線或授予專家僅查看權限。使用者必須明確點擊「是」按鈕才能允許專家遠端控制工作站。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Assistance\\Configure Solicited Remote Assistance。注意：此群組原則路徑預設可能不存在。它由群組原則模板RemoteAssistance.admx/adml提供，該模板隨微軟Windows 8.0和Server 2012（非R2）管理模板（或更新版本）一起包含。"
    compliance:
      - cis: ["18.8.36.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowToGetHelp'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowToGetHelp -> 0'

  - id: 15770
    title: "確保「啟用 RPC 端點映射器用戶端身份驗證」設定為「已啟用」。"
    description: "此策略設定控制 RPC 用戶端在進行的呼叫包含身份驗證資訊時是否使用端點映射器服務進行身份驗證。執行 Windows NT4（所有 Service Pack）的電腦上的端點映射器服務無法處理以此方式提供的驗證資訊。如果將此原則設定套用至信任網域 DC，則可能會導致單向林信任出現特定問題（請參閱 Microsoft KB3073942），因此我們不建議將其套用至網域控制站。注意：此策略只有在系統重新啟動後才會生效。此設定的建議狀態為：已啟用。"
    rationale: "對 RPC 服務的匿名存取可能會導致資訊意外洩露給未經身份驗證的使用者。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Enable RPC Endpoint Mapper Client Authentication。注意: 此群組原則路徑預設可能不存在。它是由群組原則模板RPC.admx/adml提供，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.37.1"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> EnableAuthEpResolution'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> EnableAuthEpResolution -> 1'

  - id: 15771
    title: "確保「限制未經驗證的 RPC 用戶端」設定為「啟用：已驗證」。"
    description: 'This policy setting controls how the RPC server runtime handles unauthenticated RPC clients connecting to RPC servers. This policy setting impacts all RPC applications. In a domain environment this policy setting should be used with caution as it can impact a wide range of functionality including group policy processing itself. Reverting a change to this policy setting can require manual intervention on each affected machine. This policy setting should never be applied to a Domain Controller. A client will be considered an authenticated client if it uses a named pipe to communicate with the server or if it uses RPC Security. RPC Interfaces that have specifically requested to be accessible by unauthenticated clients may be exempt from this restriction, depending on the selected value for this policy setting. -- "None" allows all RPC clients to connect to RPC Servers running on the machine on which the policy setting is applied. -- "Authenticated" allows only authenticated RPC Clients (per the definition above) to connect to RPC Servers running on the machine on which the policy setting is applied. Exemptions are granted to interfaces that have requested them. -- "Authenticated without exceptions" allows only authenticated RPC Clients (per the definition above) to connect to RPC Servers running on the machine on which the policy setting is applied. No exceptions are allowed. This value has the potential to cause serious problems and is not recommended.'' Note: This policy setting will not be applied until the system is rebooted. The recommended state for this setting is: Enabled: Authenticated.'
    rationale: "未經身份驗證的 RPC 通訊可能會造成安全漏洞。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設為「啟用」：Authenticated: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Restrict Unauthenticated RPC clients。注意：此群組原則路徑可能預設不存在。它是由群組原則範本 RPC.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）的管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.37.2"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> RestrictRemoteClients'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> RestrictRemoteClients -> 1'

  - id: 15772
    title: "確保「Microsoft 支援診斷工具：開啟與支援提供者的 MSDT 互動通訊」設定為「停用」。"
    description: "此策略設定配置 Microsoft 支援診斷工具 (MSDT) 與支援提供者的互動式通訊。 MSDT 收集診斷資料以供支援專業人員進行分析。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Microsoft Support Diagnostic Tool\\Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider. 注意：此群組原則路徑預設可能不存在，它由群組原則範本MSDT.admx/adml提供，該範本包含在Microsoft Windows 8.0 & Server 2012（非R2）管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.8.48.5.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy -> DisableQueryRemoteServer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy -> DisableQueryRemoteServer -> 0'

  - id: 15773
    title: "確保“啟用/停用 PerfTrack”設定為“停用”。"
    description: "此策略設定指定是啟用還是停用回應事件追蹤。此設定的建議狀態是：停用。"
    rationale: "啟用後，給定事件的聚合資料將傳輸給 Microsoft。此選項可以限制特定使用者的此功能、設定同意等級以及指定可以傳送錯誤報告的特定程式。但是，強烈建議集中限制執行 PerfTrack 的能力，以限制未經授權或不必要的使用、資料外洩或無意通訊的可能性。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Windows Performance PerfTrack\\Enable/Disable PerfTrack。注意: 此組策略路徑預設可能不存在。它由組策略模板PerformancePerftrack.admx/adml提供，該模板包含在Microsoft Windows 7 & Server 2008 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.8.48.11.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> 0'

  - id: 15774
    title: "確保“關閉廣告 ID”設定為“啟用”。"
    description: "此策略設定會關閉廣告 ID，防止應用程式使用該 ID 來實現跨應用程式的體驗。此設定的建議狀態為：已啟用。"
    rationale: "出於廣告目的追蹤用戶活動，即使是匿名的，也可能涉及隱私問題。在企業管理的環境中，應用程式不應需要或要求追蹤目標廣告。"
    remediation: "若要通過 GP 建立建議配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\User Profiles\\Turn off the advertising ID. 注意: 此群組原則路徑預設可能不存在。它由群組原則模板 UserProfiles.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理模板中 (或更新版本)。"
    compliance:
      - cis: ["18.8.50.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo -> DisabledByGroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo -> DisabledByGroupPolicy -> 1'

  - id: 15775
    title: "確保「啟用 Windows NTP 用戶端」設定為「已啟用」。"
    description: "此原則設定指定是否啟用 Windows NTP 用戶端。啟用 Windows NTP 用戶端可讓您的電腦將其電腦時鐘與其他 NTP 伺服器同步。如果您決定使用第三方時間提供者，您可能需要停用此服務。此設定的建議狀態為：已啟用。"
    rationale: "可靠且準確的時間記錄對於許多服務和安全要求非常重要，包括但不限於分散式應用程式、身份驗證服務、多用戶資料庫和日誌記錄服務。使用 NTP 用戶端（具有安全操作）可確保功能準確性，並且是審查安全相關事件時的焦點。"
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Client。注意：此群組原則路徑由群組原則模板 W32Time.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.8.53.1.1"]
      - cis_csc: ["8.4"]
      - pci_dss: ["10.4"]
      - nist_800_53: ["AU.8"]
      - tsc: ["CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient -> Enabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient -> Enabled -> 1'

  - id: 15776
    title: "確保「啟用 Windows NTP 伺服器」設定為「停用」。"
    description: "此原則設定可讓您指定是否啟用 Windows NTP 伺服器。此設定的建議狀態是：停用。"
    rationale: "由於 Kerberos 驗證時間戳記的敏感度以及確保準確的安全性日誌記錄，正確的時間同步配置在企業託管環境中至關重要。"
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Server。注意：此群組原則路徑是由群組原則範本 W32Time.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.8.53.1.2"]
      - cis_csc: ["8.4"]
      - pci_dss: ["10.4"]
      - nist_800_53: ["AU.8"]
      - tsc: ["CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer -> Enabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer -> Enabled -> 0'

  - id: 15777
    title: "確保「允許 Windows 應用程式在使用者之間共用應用程式資料」設定為「停用」。"
    description: "管理 Windows 應用程式在已安裝應用程式的使用者之間共用資料的能力。資料透過 SharedLocal 資料夾共享。此資料夾可透過 Windows.Storage API 存取。此設定的建議狀態是：停用。"
    rationale: "系統的使用者可能會意外地與同一系統上的其他使用者共享敏感資料。"
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App Package Deployment\\Allow a Windows app to share application data between users. 注意：此群組策略路徑預設可能不存在。它由群組策略模板AppxPackageManager.admx/adml提供，該模板包含在Microsoft Windows 10 RTM（Release 1507）管理模板中（或更高版本）。"
    compliance:
      - cis: ["18.9.4.1"]
      - cis_csc: ["3.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager -> AllowSharedLocalAppData'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager -> AllowSharedLocalAppData -> 0'

  - id: 15778
    title: "確保「阻止非管理員使用者安裝封裝的 Windows 應用程式」設定為「已啟用」。"
    description: "此設定管理非管理員使用者安裝 Windows 應用程式套件的能力。此設定的建議狀態為：已啟用。"
    rationale: "在企業管理環境中，應用程式安裝應由 IT 人員而非最終使用者集中管理。"
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App Package Deployment\\Prevent non-admin users from installing packaged Windows apps。注意：此群組策略路徑預設可能不存在。由群組策略範本AppxPackageManager.admx/adml提供，此範本包含在Microsoft Windows 10 Release 2004 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.4.2"]
      - cis_csc: ["2.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Appx'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Appx -> BlockNonAdminUserInstall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Appx -> BlockNonAdminUserInstall -> 1'

  - id: 15779
    title: "確保「在系統鎖定時讓 Windows 應用程式透過語音啟動」設定為「啟用：強制拒絕」。"
    description: "此策略設定指定在系統鎖定時是否可以透過語音（應用程式和 Cortana）啟動 Windows 應用程式。此設定的建議狀態為：啟用：強制拒絕。"
    rationale: "當設備鎖定時，不應允許存取任何電腦資源。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」：Force Deny: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App Privacy\\Let Windows apps activate with voice while the system is locked. 注意：此群組原則路徑可能預設不存在，它由群組原則範本 AppPrivacy.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1903 行政範本（或更新）中。"
    compliance:
      - cis: ["18.9.5.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy -> LetAppsActivateWithVoiceAboveLock'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy -> LetAppsActivateWithVoiceAboveLock -> 2'

  - id: 15780
    title: "確保「允許 Microsoft 帳戶可選」設定為「已啟用」。"
    description: "透過此策略設置，您可以控制 Microsoft 帳戶對於需要帳戶登入的 Windows 應用程式商店應用程式是否是可選的。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可讓組織在存取 Windows 應用程式商店應用程式時使用其企業使用者帳戶，而不是使用其 Microsoft 帳戶。這使組織可以更好地控制相關憑證。 Microsoft 帳戶無法集中管理，因此無法對其應用程式企業憑證安全性策略，這可能會使使用 Microsoft 帳戶存取的任何資訊面臨風險。"
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App runtime\\Allow Microsoft accounts to be optional。註：此群組策略路徑預設可能不存在。它由群組策略模板 AppXRuntime.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.6.1"]
      - cis_csc: ["5.6"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> MSAOptional'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> MSAOptional -> 1'

  - id: 15781
    title: "確保“阻止透過託管內容的 Windows 執行時間 API 存取啟動通用 Windows 應用程式。”設定為“啟用”。"
    description: "此原則設定控制是否可以啟動直接從 Web 內容存取 Windows 執行時間 API 的 Microsoft Store 應用程式。此設定的建議狀態為：已啟用。"
    rationale: "透過直接存取 Windows API 來阻止來自網路的應用程式可以防止惡意應用程式在系統上運行。只有系統管理員才能安裝經過批准的應用程式。"
    remediation: "要通過GP設置建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App runtime\\Block launching Universal Windows apps with Windows Runtime API access from hosted content. 注意: 應用此設置後可能需要重新啟動。 注意#2: 此組策略路徑可能預設不存在。它由組策略模板AppXRuntime.admx/adml提供，該模板包含在Microsoft Windows 10 RTM（版本1507）的管理模板中（或更新版本）。 注意#3: 在較舊的Microsoft Windows管理模板中，此設置最初名為Block launching Windows Store apps with Windows Runtime API access from hosted content.，但從Windows 10 Release 1803管理模板開始，它被重命名。"
    compliance:
      - cis: ["18.9.6.2"]
      - cis_csc: ["2.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> BlockHostedAppAccessWinRT'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> BlockHostedAppAccessWinRT -> 1'

  - id: 15782
    title: "確保“禁止非磁碟區設備自動播放”設定為“啟用”。"
    description: "此政策設定不允許 MTP 裝置（例如相機或手機）自動播放。此設定的建議狀態為：已啟用。"
    rationale: "攻擊者可以利用此功能啟動程式來損壞客戶端電腦或電腦上的資料。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Disallow Autoplay for non-volume devices。注意：此群組策略路徑可能預設不存在。它由群組策略模板AutoPlay.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.9.8.1"]
      - cis_csc: ["10.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoAutoplayfornonVolume'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoAutoplayfornonVolume -> 1'

  - id: 15783
    title: "確保「設定自動運行的預設行為」設定為「啟用：不執行任何自動運行指令」。"
    description: "此策略設定設定自動運行指令的預設行為。自動運行指令通常儲存在 autorun.inf 檔案中。他們經常啟動安裝程式或其他例程。此設定的建議狀態為： 啟用：不執行任何自動執行指令。"
    rationale: "在 Windows Vista 之前，當插入包含自動執行指令的媒體時，系統將自動執行該程序，無需使用者乾預。這會產生主要的安全性問題，因為程式碼可能會在使用者不知情的情況下執行。從 Windows Vista 開始，預設行為是提示使用者是否要執行自動執行指令。自動執行指令在「自動播放」對話方塊中表示為處理程序。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為「啟用」：Do not execute any autorun commands: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Set the default behavior for AutoRun. 注意：此群組原則路徑預設可能不存在。它由包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中的群組原則模板AutoPlay.admx/adml提供。"
    compliance:
      - cis: ["18.9.8.2"]
      - cis_csc: ["10.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoAutorun'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoAutorun -> 1'

  - id: 15784
    title: "確保「關閉自動播放」設定為「啟用：所有磁碟機」。"
    description: "一旦您將媒體插入驅動器，自動播放就會開始從驅動器讀取內容，這會導致程式或音訊媒體的安裝檔案立即啟動。攻擊者可以利用此功能啟動程式來損壞電腦或電腦上的資料。預設情況下，某些可移動磁碟機類型（例如磁碟機和網路磁碟機）上的自動播放功能處於停用狀態，但 CD-ROM 磁碟機上則不會。注意：您無法使用此策略設定在預設情況下停用自動播放的電腦磁碟機（例如磁碟機和網路磁碟機）上啟用自動播放。此設定的建議狀態為： 啟用：所有磁碟機。"
    rationale: "攻擊者可以利用此功能啟動程式來損壞客戶端電腦或電腦上的資料。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為「啟用」: All drives: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Turn off Autoplay. 注意: 此群組原則路徑由群組原則模板 AutoPlay.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.8.3"]
      - cis_csc: ["10.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoDriveTypeAutoRun'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoDriveTypeAutoRun -> 255'

  - id: 15785
    title: "確保「配置增強型反欺騙」設定為「啟用」。"
    description: "此策略設定是否為支援增強型反欺騙的裝置配置增強型反欺騙。此設定的建議狀態為：已啟用。"
    rationale: "企業託管環境現在支援更廣泛的行動設備，提高這些設備的安全性將有助於防止網路上未經授權的存取。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Biometrics\\Facial Features\\Configure enhanced anti-spoofing. 注意: 這條組策略路徑預設可能不存在。它是由組策略模板Biometrics.admx/adml提供的，該模板包含在Microsoft Windows 10 Release 1511行政模板（或更新版本）中。注意#2: 在Windows 10 Release 1511和Windows 10 Release 1607 & Server 2016行政模板中，此設置最初命名為Use enhanced anti-spoofing when available。從Windows 10 Release 1703行政模板開始，它被重新命名為Configure enhanced anti-spoofing。"
    compliance:
      - cis: ["18.9.10.1.1"]
      - cis_csc: ["10.5"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures -> EnhancedAntiSpoofing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures -> EnhancedAntiSpoofing -> 1'

  - id: 15786
    title: "確保“允許使用相機”設定為“停用”。"
    description: "此策略設定控制是否允許在電腦上使用相機設備。此設定的建議狀態是：停用。"
    rationale: "高安全環境中的攝影機可能會帶來嚴重的隱私和資料外洩風險 - 應停用它們以幫助減輕該風險。"
    remediation: "要通過 GP 設定推薦配置，請將以下使用者介面路徑設為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Camera\\Allow Use of Camera。注意: 此群組原則路徑可能預設不存在，它是由包含在 Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (或更新版本) 的群組原則範本 Camera.admx/adml 提供的。"
    compliance:
      - cis: ["18.9.12.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera -> AllowCamera'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera -> AllowCamera -> 0'

  - id: 15787
    title: "確保「關閉雲端消費者帳戶狀態內容」設定為「已啟用」。"
    description: "此策略設定決定是否在所有 Windows 體驗中允許雲端消費者帳戶狀態內容。此設定的建議狀態為：已啟用。"
    rationale: "在企業管理環境中使用消費者帳戶並不是良好的安全實踐，因為它可能導致資料外洩。"
    remediation: "要通過 GP 確立推薦配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Cloud Content\\Turn off cloud consumer account state content。注意：此群組策略路徑可能預設不存在。它由群組策略模板 CloudContent.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 21H2 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.14.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableConsumerAccountStateContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableConsumerAccountStateContent -> 1'

  - id: 15788
    title: "確保「關閉雲端最佳化內容」設定為「啟用」。"
    description: "此策略設定會關閉所有 Windows 體驗中的雲端最佳化內容。此設定的建議狀態為：已啟用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "要透過 GP 建立建議的配置，將以下使用者介面路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Cloud Content\\Turn off cloud optimized content. 注意: 此群組策略路徑預設可能不存在，它由群組策略範本 CloudContent.admx/adml 提供，該範本包含在 Microsoft Windows 10 20H2 版 (或更新版本) 的管理範本中。"
    compliance:
      - cis: ["18.9.14.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableCloudOptimizedContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableCloudOptimizedContent -> 1'

  - id: 15789
    title: "確保「關閉 Microsoft 消費者體驗」設定為「啟用」。"
    description: "此策略設定會關閉可協助消費者充分利用其裝置和 Microsoft 帳戶的體驗。此設定的建議狀態為：已啟用。注意：根據 Microsoft TechNet，此政策設定僅適用於 Windows 10 企業版和 Windows 10 教育版。"
    rationale: "在企業託管環境中靜默安裝應用程式並不是良好的安全實踐 - 特別是當應用程式將資料發送回第三方時。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Cloud Content\\Turn off Microsoft consumer experiences. 注意: 此群組原則路徑預設可能不存在。它由群組原則範本CloudContent.admx/adml提供，該範本包含在Microsoft Windows 10 Release 1511 Administrative Templates (或更新版本)中。"
    compliance:
      - cis: ["18.9.14.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableWindowsConsumerFeatures'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableWindowsConsumerFeatures -> 1'

  - id: 15790
    title: "確保“需要配對引腳”設定為“啟用：首次”或“啟用：始終”。"
    description: "此策略設定控制與無線顯示設備配對是否需要 PIN。此設定的建議狀態為：啟用：首次或啟用：始終。"
    rationale: "如果未配置或停用此設置，則將無線顯示裝置與系統配對時不需要 PIN，從而增加未經授權使用的風險。"
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設置為「啟用」: First Time 或「啟用」: Always: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Connect\\Require pin for pairing。注意：此群組原則路徑預設可能不存在。它由群組原則範本 WirelessDisplay.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1607 & Server 2016 管理範本中（或更新版本）。新的 Choose one of the following actions 子選項於 Windows 10 Release 1809 管理範本中添加。在舊範本中選擇「啟用」相當於在新範本中選擇「啟用」: First Time。"
    compliance:
      - cis: ["18.9.15.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Connect'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Connect -> RequirePinForPairing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Connect -> RequirePinForPairing -> r:^1$|^2$'

  - id: 15791
    title: "確保“不顯示密碼顯示按鈕”設定為“啟用”。"
    description: "此策略設定允許你配置密碼顯示按鈕在密碼輸入使用者體驗中的顯示。此設定的建議狀態為：已啟用。"
    rationale: "當輸入長而複雜的密碼時，尤其是使用觸控螢幕時，這是一個有用的功能。潛在的風險是其他人可能會在偷偷觀察您的螢幕時看到您的密碼。"
    remediation: "若要透過GP建立建議的設定，將以下UI路徑設為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Do not display the password reveal button. 注意：此群組原則路徑預設可能不存在。它是由群組原則模板CredUI.admx/adml提供的，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.16.1"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI -> DisablePasswordReveal'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI -> DisablePasswordReveal -> 1'

  - id: 15792
    title: "確保「列舉提升時的管理員帳號」設定為「停用」。"
    description: "此策略設定控制當使用者嘗試提升正在執行的應用程式時是否顯示管理員帳戶。此設定的建議狀態是：停用。"
    rationale: "用戶可以看到管理員帳戶列表，這使得登入控制台會話的惡意用戶更容易嘗試破解這些帳戶的密碼。"
    remediation: "要通過 GP 設置推薦的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Enumerate administrator accounts on elevation. 注意：此組策略路徑由組策略模板 CredUI.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.9.16.2"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI -> EnumerateAdministrators'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI -> EnumerateAdministrators -> 0'

  - id: 15793
    title: "確保「防止對本機帳戶使用安全性問題」設定為「啟用」。"
    description: "此政策設定控制是否可以使用安全性問題來重設本機帳戶​​密碼。安全性問題功能不適用於網域帳戶，僅適用於工作站上的本機帳戶。此設定的建議狀態為：已啟用。"
    rationale: "使用者可以透過觀察使用者的社群媒體帳戶來設定易於猜測或偵查的安全問題，從而使惡意行為者更容易更改本機使用者帳戶密碼並以該使用者帳戶存取電腦。"
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Prevent the use of security questions for local accounts。注意：此組策略路徑預設可能不存在。它由包含在Microsoft Windows 10 Release 1903管理模板（或更新版本）中的組策略模板CredUI.admx/adml提供。"
    compliance:
      - cis: ["18.9.16.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> NoLocalPasswordResetQuestions'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> NoLocalPasswordResetQuestions -> 1'

  - id: 15794
    title: "確保「允許診斷資料」設定為「啟用：診斷資料關閉（不建議）」或「啟用：傳送所需的診斷資料」。"
    description: "此策略設定決定向 Microsoft 報告的診斷和使用資料量： - 值為 (0) 診斷資料關閉（不建議）。使用該值，設備不會發送任何診斷資料。僅企業版、教育版和伺服器版支援此值。如果您選擇此設置，您組織中的設備仍然是安全的。 - 值 (1) 發送所需的診斷資料。這是保持 Windows 安全性、最新並按預期運行所需的最少診斷資料。使用此值會停用「設定」應用程式中的可選診斷資料控制項。 - 值 (3)發送可選診斷資料。收集額外的診斷資料可幫助我們檢測、診斷和修復問題，以及改善產品。當您選擇傳送可選診斷資料時，將始終包含所需的診斷資料。可選的診斷資料還可以包括診斷日誌檔案和故障轉儲。使用限制轉儲收集和限制診斷日誌收集策略可以更精細地控制發送的可選診斷資料。 Windows 遙測設定適用於 Windows 作業系統和一些第一方應用程式。此設定不適用於在 Windows 10/11 上執行的第三方應用程式。此設定的建議狀態為： 啟用：診斷資料關閉（不建議）或啟用：傳送所需的診斷資料。注意：如果您的組織依賴 Windows 更新，建議的最低設定是「必需的診斷資料」。由於診斷資料關閉時不會收集 Windows 更新資訊，因此不會發送有關更新失敗的重要資訊。 Microsoft 使用此資訊來修復這些故障的原因並提高更新的品質。注意#2：配置診斷資料選擇加入設定使用者介面群組原則可用於防止最終使用者變更其資料收集設定。注意 #3：增強型診斷資料設定在 Windows 11 和 Windows Server 2022 上不可用，已被替換為可以控制發送的可選診斷資料量的政策。有關這些設定的更多資訊，請存取使用群組策略和 MDM 管理診斷資料"
    rationale: "將任何資料發送給第三方供應商都是出於安全考慮，並且只能根據需要進行。"
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設定為「啟用」: Diagnostic data off (not recommended) 或 「啟用」: Send required diagnostic data: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Allow Diagnostic Data。注意：此群組原則路徑可能預設不存在。它由群組原則範本 DataCollection.admx/adml 提供，該範本包含在 Microsoft Windows 11 Release 21H2 Administrative Templates（或更新版本）中。注意#2：在較早的 Microsoft Windows Administrative Templates 中，此設定最初被命名為 Allow Telemetry，但從 Windows 11 Release 21H2 Administrative Templates 開始，它被重命名為 Allow Diagnostic Data。"
    compliance:
      - cis: ["18.9.17.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> AllowTelemetry'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> AllowTelemetry -> r:^0$|^1$'

  - id: 15795
    title: "確保「為連線的使用者體驗和遙測服務配置經過驗證的代理程式使用」設定為「啟用：停用經過驗證的代理程式使用」。"
    description: "此策略設定控制連接使用者體驗和遙測服務是否可以自動使用經過驗證的代理程式將資料傳回 Microsoft。此設定的建議狀態為： 啟用：停用經過驗證的代理程式使用。"
    rationale: "將任何資料發送給第三方供應商都是出於安全考慮，並且只能根據需要進行。"
    remediation: "若要透過GP建立建議的配置，請將以下設定路徑設為「啟用」：Disable Authenticated Proxy usage: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Configure Authenticated Proxy usage for the Connected User Experience and Telemetry service. 注意：此群組原則路徑可能預設不存在。 它由群組原則範本DataCollection.admx/adml提供，該範本包含在Microsoft Windows 10 Release 1703管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.17.2"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableEnterpriseAuthProxy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableEnterpriseAuthProxy -> 1'

  - id: 15796
    title: "確保「停用 OneSettings 下載」設定為「啟用」。"
    description: "此策略設定控制 Windows 是否嘗試連接 OneSettings 服務以下載設定設定。此設定的建議狀態為：已啟用。"
    rationale: "將資料傳送給第三方供應商是一個安全問題，只能根據需要進行。"
    remediation: "要透過 GP 建立建議的設定，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Disable OneSettings Downloads。注意：此群組策略路徑可能預設不存在。它是由群組策略模板 DataCollection.admx/adml 提供的，該模板包含在 Microsoft Windows 10 Release 21H2 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.17.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableOneSettingsDownloads'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableOneSettingsDownloads -> 1'

  - id: 15797
    title: "確保「不顯示回饋通知」設定為「啟用」。"
    description: "此策略設定允許組織阻止其裝置顯示來自 Microsoft 的回饋問題。此設定的建議狀態為：已啟用。"
    rationale: "使用者不應在企業管理環境中向第三方供應商發送任何回饋。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Do not show feedback notifications。注意：此群組策略路徑可能預設不存在，它由群組策略模板 FeedbackNotifications.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 1511 行政模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.17.4"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DoNotShowFeedbackNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DoNotShowFeedbackNotifications -> 1'

  - id: 15798
    title: "確保「啟用 OneSettings 審核」設定為「已啟用」。"
    description: "此策略設定控制 Windows 是否會嘗試與 OneSettings 服務連線至操作事件日誌。此設定的建議狀態為：已啟用。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過 GP 建立建議的配置，請將以下界面路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Enable OneSettings Auditing。注意：此組策略路徑可能預設不存在。它由組策略範本 DataCollection.admx/adml 提供，該範本包含在 Microsoft Windows 10 發佈 21H2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.17.5"]
      - cis_csc: ["8.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> EnableOneSettingsAuditing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> EnableOneSettingsAuditing -> 1'

  - id: 15799
    title: "確保“限制診斷日誌收集”設定為“啟用”。"
    description: "此策略設定控制當需要更多資訊來解決設備上的問題時是否收集其他診斷日誌。此設定的建議狀態為：已啟用。注意：僅當設備配置為傳送可選診斷資料時，才會傳送診斷日誌。診斷資料受到限制，建議將允許診斷資料設定為啟用：診斷資料關閉（不建議）或啟用：發送所需的診斷資料以僅發送基本資訊。"
    rationale: "將資料傳送給第三方供應商是一個安全問題，只能根據需要進行。"
    remediation: "要透過GP建立推薦的配置，請將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Limit Diagnostic Log Collection. 注意: 此群組原則路徑預設情況下可能不存在。它由包含在Microsoft Windows 10 Release 21H2管理模板（或更新版本）中的群組原則模板DataCollection.admx/adml提供。"
    compliance:
      - cis: ["18.9.17.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDiagnosticLogCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDiagnosticLogCollection -> 1'

  - id: 15800
    title: "確保“限制轉儲收集”設定為“啟用”。"
    description: "當需要更多資訊來解決問題時，此策略設定限制可以收集的轉儲類型。此設定的建議狀態為：已啟用。注意：僅當設備配置為發送可選診斷資料時才會發送轉儲。建議限制診斷資料 確保允許診斷資料設定為啟用：診斷資料關閉（不建議）或啟用：發送所需的診斷資料以僅發送基本資訊。"
    rationale: "將資料傳送給第三方供應商是一個安全問題，只能根據需要進行。"
    remediation: "若要透過 GP 建立建議的配置，請將以下使用者介面路徑設置為「啟用」。Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Limit Dump Collection。注意：此群組政策路徑可能預設不存在，它由 Microsoft Windows 10 Release 21H2 管理模板（或更新版本）中包含的群組政策模板 DataCollection.admx/adml 提供。"
    compliance:
      - cis: ["18.9.17.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDumpCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDumpCollection -> 1'

  - id: 15801
    title: "確保「切換使用者對 Insider 版本的控制」設定為「停用」。"
    description: '此策略設定決定使用者是否可以存取 Windows 更新進階選項中的 Insider 建置控制項。這些控制項位於「取得 Insider 版本」下，使用戶能夠使其裝置可用於下載和安裝 Windows 預覽軟體。此設定的建議狀態是：停用。注意：此政策設定僅適用於執行Windows 10 專業版或Windows 10 企業版（版本1703 之前）的裝置。 ”）。我們已在基準測試中保留此設置，以確保環境中任何較舊版本的 Windows 10 仍然執行。'
    rationale: "在企業管理的環境中允許實驗性功能可能存在風險，因為這可能會為系統帶來錯誤和安全漏洞，使攻擊者更容易獲得存取權限。通常最好只使用生產就緒的版本。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Toggle user control over Insider builds. 注意: 此群組原則路徑可能預設不存在。它由 Group Policy 範本 AllowBuildPreview.admx/adml 提供，該範本包含在 Microsoft Windows 10 RTM（1507 版）管理範本（或更新的版本）中。"
    compliance:
      - cis: ["18.9.17.8"]
      - cis_csc: ["2.5"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds -> AllowBuildPreview'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds -> AllowBuildPreview -> 0'

  - id: 15802
    title: "確保「下載模式」未設定為「啟用：Internet」。"
    description: "此策略設定指定傳遞最佳化下載 Windows 更新、應用程式和應用程式更新時可以使用的下載方法。支援以下方法： - 0 = 僅 HTTP，無對等互連。 - 1 = HTTP 與同一 NAT 後面的對等互​​連混合。 - 2 = HTTP 與跨私有群組的對等互連混合。預設情況下，對等互連發生在相同 Active Directory 網站（如果存在）或相同網域中的裝置上。選擇此選項後，對等互連將跨 NAT。若要建立自訂群組，請將群組 ID 與模式 2 結合使用。 - 99 = 簡單下載模式，無對等互連。 Delivery Optimization 僅使用 HTTP 下載，不會嘗試聯絡 Delivery Optimization 雲端服務。 - 100 = 旁路模式。不要使用交付最佳化，而應使用 BITS。此設定的建議狀態是任何值，除了：啟用：Internet (3)。注意：除 Enterprise、Enterprise LTSB 或 Education 之外的所有 SKU 上的預設為「已啟用」：Internet (3)，因此在其他 SKU 上，請務必將其設定為不同的值。"
    rationale: "出於隱私考慮和安全風險，更新只能直接從 Microsoft 下載，或從內部網路上的受信任機器下載，該機器從受信任的來源接收更新並獲得網路管理員的批准。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為除「啟用」以外的任何值：Internet (3): Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Delivery Optimization\\Download Mode。注意：此群組策略路徑預設可能不存在。它由群組策略模板DeliveryOptimization.admx/adml提供，該模板包含在Microsoft Windows 10 RTM（發布1507）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.18.1"]
      - cis_csc: ["7.3"]
      - pci_dss: ["6.2"]
      - nist_800_53: ["SI.2", "SA.11", "SI.4"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["A1.2", "CC6.8"]
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization -> DODownloadMode -> r:^3$'

  - id: 15803
    title: "確保“應用程式：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要透過 GP 建立推薦的配置，請設定以下使用者介面路徑為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Application\\Control Event Log behavior when the log file reaches its maximum size。注意：此群組原則路徑由群組原則範本 EventLog.admx/adml 提供，並包含在所有版本的 Microsoft Windows 管理範本中。注意#2：在較舊的 Microsoft Windows 管理範本中，此設置最初名為「保留舊事件」，但從 Windows 8.0 和 Server 2012（非 R2）管理範本開始被重新命名。"
    compliance:
      - cis: ["18.9.27.1.1"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> Retention -> 0'

  - id: 15804
    title: "確保「應用程式：指定最大日誌檔案大小 (KB)」設定為「啟用：32,768 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為「啟用」：32,768 或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Application\\Specify the maximum log file size (KB)。注意：此群組原則路徑由群組原則模板 EventLog.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。注意 #2：在舊版 Microsoft Windows 管理模板中，此設置最初名為 Maximum Log Size (KB)，但從 Windows 8.0 和 Server 2012 (非 R2) 管理模板開始重新命名。"
    compliance:
      - cis: ["18.9.27.1.2"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> MaxSize -> n:^(\d+) compare >= 32768'

  - id: 15805
    title: "確保“安全性：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Security\\Control Event Log behavior when the log file reaches its maximum size. 注意：此群組原則路徑由群組原則模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows Administrative Templates中。 注意＃2：在較舊的Microsoft Windows Administrative Templates中，此設置最初名為Retain old events，但從Windows 8.0及Server 2012（非R2）Administrative Templates開始，此設置被重新命名。"
    compliance:
      - cis: ["18.9.27.2.1"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> Retention -> 0'

  - id: 15806
    title: "確保「安全性：指定最大日誌檔案大小 (KB)」設定為「啟用：196,608 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：196,608 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」：196,608或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Security\\Specify the maximum log file size (KB)。注意：此組策略路徑由所有版本的Microsoft Windows管理模板中包含的組策略模板EventLog.admx/adml提供。注意#2：在較早的Microsoft Windows管理模板中，此設置最初被命名為Maximum Log Size (KB)，但從Windows 8.0和Server 2012（非R2）管理模板開始被重新命名。"
    compliance:
      - cis: ["18.9.27.2.2"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> MaxSize -> n:^(\d+) compare >= 196608'

  - id: 15807
    title: "確保“設定：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Setup\\Control Event Log behavior when the log file reaches its maximum size. 注意：此群組原則路徑由包含在所有版本 Microsoft Windows 管理範本中的群組原則範本 EventLog.admx/adml 提供。 注意＃2：在舊版 Microsoft Windows 管理範本中，此設定最初被命名為保留舊事件，但從 Windows 8.0 和 Server 2012（非 R2) 管理範本開始更名。"
    compliance:
      - cis: ["18.9.27.3.1"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> Retention -> 0'

  - id: 15808
    title: "確保「設定：指定最大日誌檔案大小 (KB)」設定為「啟用：32,768 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為「啟用」：32,768或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Setup\\Specify the maximum log file size (KB)。注意：此群組策略路徑是由群組策略範本EventLog.admx/adml提供，該範本包含在所有版本的Microsoft Windows管理範本中。注意#2：在較舊的Microsoft Windows管理範本中，此設置最初被命名為Maximum Log Size (KB)，但從Windows 8.0 & Server 2012（非R2）管理範本開始被重命名。"
    compliance:
      - cis: ["18.9.27.3.2"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> MaxSize -> n:^(\d+) compare >= 32768'

  - id: 15809
    title: "確保“系統：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    remediation: "要透過 GP 建立建議的配置，請將以下介面路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\System\\Control Event Log behavior when the log file reaches its maximum size。注意：此群組原則路徑是由群組原則範本 EventLog.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows Administration Templates 中。注意 #2：在舊版的 Microsoft Windows Administration Templates 中，此設置最初名為 Retain old events，但從 Windows 8.0 和 Server 2012（非 R2）Administration Templates 開始更名。"
    compliance:
      - cis: ["18.9.27.4.1"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> Retention -> 0'

  - id: 15810
    title: "確保「系統：指定最大日誌檔案大小 (KB)」設定為「啟用：32,768 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因"
    remediation: "若要通過GP建立推薦配置，設置以下UI路徑為「啟用」：32,768或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\System\\Specify the maximum log file size (KB). 注意：此組策略路徑由組策略模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。 注意#2：在較早的Microsoft Windows管理模板中，這一設置最初被命名為Maximum Log Size (KB)，但自Windows 8.0和Server 2012（非R2版）管理模板以來，該設置被重新命名。"
    compliance:
      - cis: ["18.9.27.4.2"]
      - cis_csc: ["8.3"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> MaxSize -> n:^(\d+) compare >= 32768'

  - id: 15811
    title: "確保「關閉資源管理器的資料執行保護」設定為「停用」。"
    description: "停用資料執行保護可以允許某些舊插件應用程式在不終止資源管理器的情況下運作。此設定的建議狀態是：停用。注意：某些舊版插件應用程式和其他軟體可能無法與資料執行保護一起運行，並且需要為該特定插件/軟體定義例外。"
    rationale: "資料執行保護是 Explorer 支援的重要安全功能，有助於限制某些類型惡意軟體的影響。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off Data Execution Prevention for Explorer. 注意: 此群組原則路徑預設可能不存在。它由群組原則範本 Explorer.admx/adml 提供，此範本包含在 Microsoft Windows 7 & Server 2008 R2 管理範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.31.2"]
      - cis_csc: ["10.5"]
      - pci_dss: ["10.6.1"]
      - nist_800_53: ["AU.6"]
      - gpg13: ["4.12"]
      - gdpr_IV: [35.7.d]
      - hipaa: ["164.312.b"]
      - tsc: ["CC6.1", "CC6.8", "CC7.2", "CC7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoDataExecutionPrevention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoDataExecutionPrevention -> 0'

  - id: 15812
    title: "確保「關閉損壞時的堆終止」設定為「停用」。"
    description: "如果損壞時沒有堆終止，舊插件應用程式可能會在檔案總管會話損壞時繼續執行。確保腐敗堆終止處於活動狀態可以防止這種情況發生。此設定的建議狀態是：停用。"
    rationale: "允許應用程式在其會話損壞後繼續運行會增加系統的風險狀況。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off heap termination on corruption。注意：此群組策略路徑由群組策略模板 Explorer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.31.3"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoHeapTerminationOnCorruption'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoHeapTerminationOnCorruption -> 0'

  - id: 15813
    title: "確保“關閉 shell 協定保護模式”設定為“停用”。"
    description: "此策略設定可讓您配置 shell 協定可以具有的功能量。當使用該協定的全部功能時，應用程式可以開啟資料夾並啟動檔案。保護模式減少了該協定的功能，允許應用程式僅開啟一組有限的資料夾。當處於保護模式時，應用程式無法使用此協定開啟檔案。建議將此協定保留在保護模式下，以提高 Windows 的安全性。此設定的建議狀態是：停用。"
    rationale: "將檔案和資料夾的開啟限制在有限的範圍內可以減少系統的攻擊面。"
    remediation: "若要透過GP建立建議的配置，請設置以下UI路徑為已「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off shell protocol protected mode。 注意：此群組原則路徑由群組原則模板WindowsExplorer.admx/adml提供，此模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.31.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> PreXPSP2ShellProtocolBehavior'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> PreXPSP2ShellProtocolBehavior -> 0'

  - id: 15814
    title: "確保「阻止電腦加入家庭群組」設定為「啟用」。"
    description: "預設情況下，使用者可以將其電腦新增至家庭網路上的家庭群組。此設定的建議狀態為：已啟用。注意：家庭群組功能在從Windows 7 到Windows 10 Release 1709 的所有Windows 工作站版本中均可用。 1709（或更早版本）工作站，那麼此設定對於在這些系統上停用家庭群組仍然很重要。"
    rationale: "雖然加入網域的電腦上的資源無法與家庭群組共用，但來自加入網域的電腦的資訊可能會洩漏到家庭群組中的其他電腦。"
    remediation: "若要透過 GP 建立建議的設定，將以下 UI 路徑設定為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\HomeGroup\\Prevent the computer from joining a homegroup. 注意: 此群組原則路徑預設可能不存在。它由 Group Policy 模板 Sharing.admx/adml 提供，該模板隨 Microsoft Windows 7 和 Server 2008 R2 管理模板（或更新版本）一起提供。"
    compliance:
      - cis: ["18.9.36.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HomeGroup'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HomeGroup -> DisableHomeGroup'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HomeGroup -> DisableHomeGroup -> 1'

  - id: 15815
    title: "確保“關閉位置”設定為“啟用”。"
    description: "此策略設定關閉電腦的位置功能。此設定的建議狀態為：已啟用。"
    rationale: "此設定會影響位置功能（例如 GPS 或其他位置追蹤）。從安全角度來看，在大多數情況下向軟體透露您的位置並不是一個好主意，但也有合法用途，例如地圖軟體。但是，它們不應該在高安全性環境中使用。"
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Location and Sensors\\Turn off location. 注意: 這個群組原則路徑預設可能不存在。它是由包含在 Microsoft Windows 7 及 Server 2008 R2 管理範本（或更高版本）中的群組原則範本 Sensors.admx/adml 提供的。"
    compliance:
      - cis: ["18.9.41.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableLocation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableLocation -> 1'

  - id: 15816
    title: "確保「允許訊息服務雲端同步」設定為「停用」。"
    description: "此策略設定允許將蜂窩短信備份和還原到 Microsoft 的雲端服務。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，永遠不應將資料傳送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Messaging\\Allow Message Service Cloud Sync。注意：此群組原則路徑預設可能不存在。它由群組原則模板Messaging.admx/adml提供，該模板包含在 Microsoft Windows 10 1709 發行版管理模板（或更高版本）中。"
    compliance:
      - cis: ["18.9.45.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging -> AllowMessageSync'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging -> AllowMessageSync -> 0'

  - id: 15817
    title: "確保「封鎖所有消費者 Microsoft 帳戶使用者驗證」設定為「已啟用」。"
    description: "此設定會決定裝置上的應用程式和服務是否可以透過 Windows OnlineID 和 WebAccountManager API 使用新的消費者 Microsoft 帳戶驗證。此設定的建議狀態為：已啟用。"
    rationale: "想要有效實施身分識別管理策略並對其電腦上使用的帳戶保持嚴格控制的組織可能會希望阻止 Microsoft 帳戶。組織可能還需要封鎖 Microsoft 帳戶，以滿足適用於其資訊系統的合規性標準的要求。"
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft accounts\\Block all consumer Microsoft account user authentication。注意：此群組原則路徑預設情況下可能不存在。它由 Group Policy 模板 MSAPolicy.admx/adml 提供，該模板包含於 Microsoft Windows 10 Release 1703 Administrative Templates (或更新版本)中。"
    compliance:
      - cis: ["18.9.46.1"]
      - cis_csc: ["5.3"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftAccount'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftAccount -> DisableUserAuth'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftAccount -> DisableUserAuth -> 1'

  - id: 15818
    title: "確保「配置本機設定覆蓋以向 Microsoft MAPS 報告」設定為「停用」。"
    description: "此原則設定為加入 Microsoft Active Protection Service (MAPS) 的設定配置本機覆蓋，Microsoft 將其重新命名為 Windows Defender 防毒雲端保護服務，然後再命名為 Microsoft Defender 防毒雲保護服務。此設定只能透過群組原則進行設定。此設定的建議狀態是：停用。"
    rationale: "應在企業託管環境中集中決定是否參與 Microsoft MAPS / Microsoft Defender 防毒雲保護服務以進行惡意軟體報告，以便其中的所有電腦在這方面表現一致。將此設定配置為「停用」可確保決策保持集中管理。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\MAPS\\Configure local setting override for reporting to Microsoft MAPS。注意：此群組原則路徑預設可能不存在。它由Group Policy模板WindowsDefender.admx/adml提供，該模板包含在Microsoft Windows 8.1和Server 2012 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.4.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> LocalSettingOverrideSpynetReporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> LocalSettingOverrideSpynetReporting -> 0'

  - id: 15819
    title: "確保“加入 Microsoft MAPS”設定為“停用”。"
    description: "此原則設定可讓你加入 Microsoft Active Protection Service (MAPS)，Microsoft 將其重新命名為 Windows Defender 防毒雲端保護服務，然後再命名為 Microsoft Defender 防毒雲端保護服務。 Microsoft MAPS / Microsoft Defender 防毒雲端保護服務是一個線上社群，可協助您選擇如何應對潛在威脅。該社群還幫助阻止新的惡意軟體感染的傳播。您可以選擇發送有關檢測到的軟體的基本或附加資訊。其他資訊可協助 Microsoft 建立新定義並協助其保護您的電腦。可能的選項有： - (0x0) 停用（預設） - (0x1) 基本會員資格- (0x2) 高級會員資格基本會員資格將向Microsoft 發送有關已檢測到的軟體的基本訊息，包括該軟體來自您應用或執行的操作的位置。除了基本資訊之外，高級會員資格還會向 Microsoft 發送有關惡意軟體、間諜軟體和潛在有害軟體的更多資訊，包括軟體檔案的位置、軟體的運作方式以及它如何影響您的電腦。此設定的建議狀態是：停用。"
    rationale: "如果刪除了有害軟體，將傳送的訊息可能包括電腦上偵測到的項目的位置等資訊。資訊將自動收集和發送。在某些情況下，個人資訊可能會無意中傳送給 Microsoft。但是，Microsoft 聲明不會使用此資訊來識別您的身分或與您聯絡。出於高安全環境中的隱私原因，最好完全阻止這些資料提交。"
    remediation: "要透過GP設定建議的配置，將以下UI路徑設為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\MAPS\\Join Microsoft MAPS。注意：此群組原則路徑預設可能不存在。它由Group Policy模板WindowsDefender.admx/adml提供，此模板包含在Microsoft Windows 8.1和Server 2012 R2行政模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.4.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> SpynetReporting'

  - id: 15820
    title: "確保“配置攻擊面減少規則”設定為“啟用”。"
    description: "此策略設定控制攻擊面減少 (ASR) 規則的狀態。此設定的建議狀態為：已啟用。"
    rationale: "減少攻擊面有助於防止尋求漏洞的惡意軟體通常使用的操作和應用程式來感染電腦。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Microsoft Defender Exploit Guard\\Attack Surface Reduction\\Configure Attack Surface Reduction rules。注意：此群組策略路徑可能不會預設存在。它是由群組策略範本 WindowsDefender.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1709 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.5.1.1"]
      - cis_csc: ["10.5"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR -> ExploitGuard_ASR_Rules'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR -> ExploitGuard_ASR_Rules -> 1'

  - id: 15821
    title: "確保配置「配置攻擊面減少規則：設定每個 ASR 規則的狀態」。"
    description: "此策略設定設定攻擊面減少規則。此設定的建議狀態為： 26190899-1602-49e8-8b27-eb1d0a1ce869 - 1（阻止 Office 通訊應用程式建立子程序） 3b576869-a4ec-4529-8536-b80a7769e89-a4ec-4529-8536-b80a7769e89-a4ec-4529-8536-b80a776 -fd9a-4556-801d-275e5ffc04cc - 1（阻止執行可能混淆的腳本） 75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84 - 1（阻止Office 應用程序將代碼注入其他程序） 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c - 1（阻止AdAdobe Reader 建立子程序） 92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b - 1（阻止來自Office 巨集的Win32 API 呼叫） 9e6c4e1f-7d60-472f-baef1 調用） 9e6c4e1f-7d60-472f-ba1a-性竊取憑證權限子系統(lsass.exe)) b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 - 1（阻止從USB 運行的不受信任和未簽署的程序） be9ba2d9-53ea-4ccdc-84e5-91bdc-8465-91bdc（封鎖來自電子郵件用戶端和Webmail 的可執行內容) d3e037e1-3eb8-44c8-a917-57927947596d - 1（阻止JavaScript 或VBScript 啟動下載的可執行內容） d4f940ab-401b-4efc-dcd15f3885應用程式建立子程序） e6db77e5-3df2-4cf1-b95a -636979351e5b - 1（透過WMI事件訂閱阻止持續性）注意：有關ASR規則的更多資訊可以在以下連結中找到：使用攻擊面減少規則來防止惡意軟體感染|微軟檔案"
    rationale: "減少攻擊面有助於防止尋求漏洞的惡意軟體通常使用的操作和應用程式來感染電腦。"
    remediation: "要透過 GP 建立建議的配置，請設定以下 UI 路徑，使 26190899-1602-49e8-8b27-eb1d0a1ce869, 3b576869-a4ec-4529-8536-b80a7769e899, 5beb7efe-fd9a-4556-801d-275e5ffc04cc, 75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84, 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c, 92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b, 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2, b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4, be9ba2d9-53ea-4cdc-84e5-9b1eeee46550, d3e037e1-3eb8-44c8-a917-57927947596d, d4f940ab-401b-4efc-aadc-ad5f3c50688a 和 e6db77e5-3df2-4cf1-b95a-636979351e5b 的值都設定為 1: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Microsoft Defender Exploit Guard\\Attack Surface Reduction\\Configure Attack Surface Reduction rules: Set the state for each ASR rule. 注意：此組群策略路徑預設可能不存在。它是由群組策略模板 WindowsDefender.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 1709 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.5.1.2"]
      - cis_csc: ["10.5"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D4F940AB-401B-4EFC-AADC-AD5F3C50688A'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 3B576869-A4EC-4529-8536-B80A7769E899'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D3E037E1-3EB8-44C8-A917-57927947596D'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 26190899-1602-49E8-8B27-eB1D0A1CE869'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 9E6C4E1F-7D60-472F-bA1A-A39EF669E4B2'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D4F940AB-401B-4EFC-AADC-AD5F3C50688A -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 3B576869-A4EC-4529-8536-B80A7769E899 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D3E037E1-3EB8-44C8-A917-57927947596D -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 26190899-1602-49E8-8B27-eB1D0A1CE869 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 9E6C4E1F-7D60-472F-bA1A-A39EF669E4B2 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4 -> 1'

  - id: 15822
    title: "確保「防止使用者和應用程式存取危險網站」設定為「啟用：封鎖」。"
    description: "此策略設定控制 Microsoft Defender Exploit Guard 網路保護。此設定的建議狀態為：啟用：阻止。"
    rationale: "此設定可以幫助防止員工使用任何應用程式存取可能託管網路釣魚詐騙、漏洞託管網站和 Internet 上其他惡意內容的危險網域。"
    remediation: "若要透過 GP 設定推薦的配置，請將以下 UI 路徑設為「啟用」：Block: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender Antivirus\\Windows Defender Exploit Guard\\Network Protection\\Prevent users and apps from accessing dangerous websites. 注意：此群組原則路徑預設可能不存在。它由群組原則模板 WindowsDefender.admx/adml 提供，包含在 Microsoft Windows 10 Release 1709 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.5.3.1"]
      - cis_csc: ["9.3", "10.5"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection -> EnableNetworkProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection -> EnableNetworkProtection -> 1'

  - id: 15823
    title: "確保“啟用檔案雜湊計算功能”設定為“已啟用”。"
    description: "此設定決定是否為 Microsoft Defender 掃描的檔案計算雜湊值。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為監視可疑和已知的惡意活動。檔案雜湊是檢測檔案更改的可靠方法，並且可以通過跳過自上次掃描並確定為安全以來未更改的檔案來加快掃描過程。更改的檔案雜湊也可能導致額外的審查。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設定為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\MpEngine\\Enable file hash computation feature。注意：此群組原則路徑預設情況下可能不存在。它由群組原則範本 WindowsDefender.admx/adml 提供，該範本隨附在 Microsoft Windows 10 Release 1709 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.6.1"]
      - cis_csc: ["10.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine -> EnableFileHashComputation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine -> EnableFileHashComputation -> 1'

  - id: 15824
    title: "確保「掃描所有下載的檔案和附件」設定為「啟用」。"
    description: "此策略設定配置掃描所有下載的檔案和附件。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    remediation: "要透過 GP 設定建議的配置，請將以下 UI 路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Scan all downloaded files and attachments. 注意: 這個群組原則路徑可能預設不存在。它是由 Group Policy 模板 WindowsDefender.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 & Server 2012 R2 行政模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.9.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableIOAVProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableIOAVProtection -> 0'

  - id: 15825
    title: "確保“關閉即時保護”設定為“停用”。"
    description: "此策略設定為已知惡意軟體偵測配置即時保護提示。當惡意軟體或可能不需要的軟體嘗試自行安裝或在您的電腦上執行時，Microsoft Defender 防毒軟體會向您發出警報。此設定的建議狀態是：停用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Turn off real-time protection。注意：此組策略路徑可能預設不存在。它是由組策略模板 WindowsDefender.admx/adml 提供的，該模板包含在 Microsoft Windows 8.1 & Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.9.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableRealtimeMonitoring'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableRealtimeMonitoring -> 0'

  - id: 15826
    title: "確保「開啟行為監控」設定為「已啟用」。"
    description: "此策略設定允許你設定 Microsoft Defender 防毒的行為監視。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    remediation: "若要透過GP設置建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Turn on behavior monitoring。注意：此群組原則路徑可能預設不存在。它是由群組原則範本 WindowsDefender.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 及 Server 2012 R2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.9.3"]
      - cis_csc: ["10.7"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableBehaviorMonitoring'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableBehaviorMonitoring -> 0'

  - id: 15827
    title: "確保“開啟腳本掃描”設定為“已啟用”。"
    description: "此策略設定允許開啟/關閉腳本掃描。腳本掃描會攔截腳本，然後在它們在系統上執行之前對其進行掃描。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Turn on script scanning。注意：此群組原則路徑預設情況下可能不存在。它由Group Policy模板WindowsDefender.admx/adml提供，該模板包含在Microsoft Windows 10 Release 21H2 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.9.4"]
      - cis_csc: ["10.7"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableScriptScanning'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableScriptScanning -> 0'

  - id: 15828
    title: "確保「配置 Watson 事件」設定為「停用」。"
    description: "此策略設定可讓您設定是否傳送 Watson 事件。此設定的建議狀態是：停用。"
    rationale: "Watson 事件是當程式或服務當機或失敗時發送給 Microsoft 的報告，包括自動提交的可能性。阻止發送此資訊有助於減少隱私問題。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Reporting\\Configure Watson events. 注意：此組策略路徑預設可能不存在。它由組策略模板 WindowsDefender.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.11.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting -> DisableGenericRePorts'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting -> DisableGenericRePorts -> 1'

  - id: 15829
    title: "確保「掃描可移動磁碟機」設定為「已啟用」。"
    description: "此策略設定可讓您管理在執行完整掃描時是否掃描可移動磁碟機（例如 USB 隨身碟）內容中的惡意軟體和不需要的軟體。此設定的建議狀態為：已啟用。"
    rationale: "確保任何現有的可移動磁碟機始終包含在任何類型的掃描中非常重要，因為可移動磁碟機更有可能包含從外部非託管電腦引入企業託管環境的惡意軟體。"
    remediation: "要通過 GP 建立推薦配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Scan\\Scan removable drives。注意: 此群組原則路徑預設情況下可能不存在。它由群組原則模板 WindowsDefender.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 和 Server 2012 R2 (或更新版本) 的管理模板中。"
    compliance:
      - cis: ["18.9.47.12.1"]
      - cis_csc: ["10.4"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableRemovableDriveScanning'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableRemovableDriveScanning -> 0'

  - id: 15830
    title: "確保「開啟電子郵件掃描」設定為「啟用」。"
    description: "此策略設定可讓您設定電子郵件掃描。啟用電子郵件掃描時，引擎將根據特定格式解析郵箱和郵件檔案，以分析郵件正文和附件。目前支援多種電子郵件格式，例如：pst (Outlook)、dbx、mbx、mime (Outlook Express)、binhex (Mac)。此設定的建議狀態為：已啟用。"
    rationale: "應使用 Microsoft Defender Antivirus 等防毒解決方案掃描傳入電子郵件，因為電子郵件附件是惡意軟體滲透電腦的常用攻擊媒介。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Scan\\Turn on e-mail scanning。注意：此群組原則路徑可能預設不存在，這是由群組原則範本WindowsDefender.admx/adml提供，該範本包含在Microsoft Windows 8.1和Server 2012 R2管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.47.12.2"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableEmailScanning'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableEmailScanning -> 0'

  - id: 15831
    title: "確保「配置潛在有害應用程式偵測」設定為「啟用：阻止」。"
    description: "此策略設定控制對潛在有害應用程式 (PUA) 的檢測和操作，這些應用程式是偷偷摸摸的不需要的應用程式捆綁程式或其捆綁的應用程序，可以傳播廣告軟體或惡意軟體。此設定的建議狀態為：啟用：阻止。有關詳細資訊，請參閱此連結：使用 Microsoft Defender 防毒軟體阻止可能不需要的應用程式 |微軟檔案"
    rationale: "潛在不必要的應用程式可能會增加網路被惡意軟體感染的風險，導致惡意軟體感染更難以識別，並且可能浪費 IT 資源來清理應用程式。應阻止它們安裝。"
    remediation: "要通過 GP 建立建議的配置, 將以下 UI 路徑設定為「啟用」：Block: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Configure detection for potentially unwanted applications. 注意：此群組原則路徑由 Group Policy 模版 WindowsDefender.admx/adml 提供, 該模版包含在 Microsoft Windows 10 Release 1809 & Server 2019 行政模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.47.15"]
      - cis_csc: ["2.5", "10.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> PUAProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> PUAProtection -> 1'

  - id: 15832
    title: "確保“關閉 Microsoft Defender 防毒”設定為“停用”。"
    description: "此策略設定會關閉 Microsoft Defender 防毒軟體。如果設定配置為“已停用”，Microsoft Defender 防毒軟體將運行並掃描電腦是否存在惡意軟體和其他可能不需要的軟體。此設定的建議狀態是：停用。"
    rationale: "確保最新的、更新的防毒產品掃描每台電腦是否有惡意檔案活動非常重要。 Microsoft 在 Microsoft Defender 防毒軟體中提供了開箱即用的有效解決方案。選擇購買信譽良好的第三方防毒解決方案的組織可以選擇免除此建議，而不是商業替代方案。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Turn off Microsoft Defender AntiVirus。注意：此群組原則路徑由群組原則範本WindowsDefender.admx/adml提供，此範本包含在所有版本的Microsoft Windows管理範本中。注意#2：在較舊的Microsoft Windows管理範本中，此設置最初名為Turn off Windows Defender，但從Windows 10 Release 1703管理範本開始，更名為Windows Defender Antivirus。從Windows 10 Release 2004管理範本開始再次更名為Turn off Microsoft Defender Antivirus。"
    compliance:
      - cis: ["18.9.47.16"]
      - cis_csc: ["10.6"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> DisableAntiSpyware'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> DisableAntiSpyware -> 0'

  - id: 15833
    title: "確保「在任務欄上啟用新聞和興趣」設定為「停用」。"
    description: "此策略設定指定裝置上是否允許新聞和興趣功能。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，Windows 工作列上的新聞和興趣等應用程式和功能應被視為可能的安全風險，因為資料可能會被傳送回第三方（例如 Microsoft）。此外，該應用程式可能會在提要中顯示不適當的新聞和興趣。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\News and interests\\Enable news and interests on the taskbar. 注意:此組策略路徑可能預設不存在。它由組策略模板Feeds.admx/adml提供，該模板包含在Microsoft Windows 10 Release 21H1管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.57.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds -> EnableFeeds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds -> EnableFeeds -> 0'

  - id: 15834
    title: "確保「阻止使用 OneDrive 進行檔案儲存」設定為「已啟用」。"
    description: "此策略設定可讓你阻止應用程式和功能使用下一代同步客戶端處理 OneDrive 上的檔案。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可防止使用者意外（或故意）使用新一代同步用戶端將機密或敏感的公司資訊上傳至 OneDrive 雲端服務。注意：此安全性問題適用於安裝在工作站上的任何基於雲端的檔案儲存應用程序，而不僅僅是 Windows 隨附的應用程式。"
    remediation: "要透過群組政策(GP)建立推薦的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\OneDrive\\Prevent the usage of OneDrive for file storage。注意：此群組政策路徑預設可能不存在。它由群組政策模板SkyDrive.admx/adml提供，該模板包含在Microsoft Windows 8.1和Server 2012 R2管理模板中（或更新版本）。然而，我們強烈建議僅使用包含在Microsoft Windows 10 Release 1607和Server 2016管理模板中的版本（或更新版本）。模板的舊版本在不同的模板檔案中對OneDrive和SkyDrive有衝突的設置，直到上述版本中才得到正確清理。注意#2：在舊的Microsoft Windows管理模板中，此設置被命名為Prevent the usage of SkyDrive for file storage，但從Windows 10 RTM（Release 1507）管理模板開始被重新命名。"
    compliance:
      - cis: ["18.9.58.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive -> DisableFileSyncNGSC'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive -> DisableFileSyncNGSC -> 1'

  - id: 15835
    title: "確保「關閉推播安裝服務」設定為「啟用」。"
    description: "此策略設定控制使用者是否可以從在其他裝置或 Web 上執行的 Microsoft Store 應用程式將應用程式推送到裝置。此設定的建議狀態為：已啟用。"
    rationale: "在高安全性的託管環境中，應用程式安裝應由 IT 人員而不是最終使用者集中管理。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Push to Install\\Turn off Push To Install service。注意：此群組政策路徑預設情況下可能不存在。它由Group Policy模板PushToInstall.admx/adml提供，該模板包括在Microsoft Windows 10 Release 1709 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.64.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PushToInstall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PushToInstall -> DisablePushToInstall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PushToInstall -> DisablePushToInstall -> 1'

  - id: 15836
    title: "確保“不允許儲存密碼”設定為“啟用”。"
    description: "此政策設定有助於防止遠端桌面用戶端在電腦上保存密碼。此設定的建議狀態為：已啟用。注意：如果此政策設定之前配置為“已停用”或“未配置”，則遠端桌面用戶端第一次與任何伺服器斷開連接時，先前儲存的任何密碼都將被刪除。"
    rationale: "能夠實際存取電腦的攻擊者可能能夠破壞保存密碼的保護。危害使用者帳戶並連接到其電腦的攻擊者可以使用已儲存的密碼來存取其他主機。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Connection Client\\Do not allow passwords to be saved。注意：此組策略路徑由組策略模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.65.2.2"]
      - pci_dss: ["12.3.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DisablePasswordSaving'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DisablePasswordSaving -> 1'

  - id: 15837
    title: "確保「允許使用者使用遠端桌面服務進行遠端連線」設定為「停用」。"
    description: "此策略設定可讓您使用遠端桌面服務配置對電腦的遠端存取。此設定的建議狀態是：停用。"
    rationale: "任何具有「允許透過遠端桌面服務登入」使用者權限的帳戶都可以登入電腦的遠端控制台。如果您不限制需要登入電腦控制台的合法使用者的存取權限，則未經授權的使用者可能會下載並執行惡意程式碼以提升其權限。"
    remediation: "若要透過 GP 建立推薦配置，將以下 UI 路徑設為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Connections\\Allow users to connect remotely by using Remote Desktop Services. 注意: 這個群組原則路徑由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。注意 #2: 在較舊的 Microsoft Windows Administrative Templates 中，此設置最初名為 Allow users to connect remotely using Terminal Services，但在 Windows 7 & Server 2008 R2 Administrative Templates 中被重命名為 Allow users to connect remotely using Remote Desktop Services。最終，它從 Windows 8.0 & Server 2012 (非 R2) Administrative Templates 開始再次被重命名為 Allow users to connect remotely by using Remote Desktop Services。"
    compliance:
      - cis: ["18.9.65.3.2.1"]
      - pci_dss: ["7.2"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDenyTSConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDenyTSConnections -> 1'

  - id: 15838
    title: "確保「允許 UI 自動化重新導向」設定為「停用」。"
    description: "此策略設定確定在本機電腦上執行的使用者介面 (UI) 自動化用戶端應用程式是否可以存取伺服器上的 UI 元素。 UI 自動化使程式可以存取大多數 UI 元素，從而允許使用需要與 UI 互動才能正常工作的輔助技術產品，例如放大鏡和講述人。 UI 資訊還允許自動化測試腳本與 UI 互動。例如，本機電腦「講述人」和「放大鏡」用戶端可用於與遠端會話中開啟的網頁上的 UI 進行互動。此設定的建議狀態是：停用。注意：遠端桌面會話目前不支援 UI 自動化重新導向。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 UI 自動化重新導向，並且目前不支持，但減少惡意活動發生的意外途徑的數量是有意義的。"
    remediation: "要透過GP建立建議的設定，將以下UI路徑設定為「停用」: Computer Configuration\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Allow UI Automation redirection。注意：此群組原則路徑預設可能不存在。它是由群組原則範本TerminalServer.admx/adml提供，該範本包含在Microsoft Windows 10 Release 21H2管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.65.3.3.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> EnableUiaRedirection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> EnableUiaRedirection -> 0'

  - id: 15839
    title: "確保「不允許 COM 連接埠重新導向」設定為「啟用」。"
    description: "此原則設定指定是否阻止在遠端桌面服務工作階段中將資料從遠端電腦重新導向至用戶端 COM 連接埠。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 COM 連接埠重新導向，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow COM port redirection. 注: 此組策略路徑由包含在所有版本Microsoft Windows管理模板中的組策略模板TerminalServer.admx/adml提供。"
    compliance:
      - cis: ["18.9.65.3.3.2"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCcm'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCcm -> 1'

  - id: 15840
    title: "確保“不允許驅動器重新導向”設定為“已啟用”。"
    description: "此策略設定阻止使用者將其用戶端電腦上的本機磁碟機共用給他們存取的遠端桌面伺服器。對應的驅動器以以下格式顯示在Windows 資源管理器的會話資料夾樹中： \\\\TSClient\\<driveletter>$ 如果共用本機磁碟機，則它們很容易受到想要利用其上儲存的資料的入侵者的攻擊。此設定的建議狀態為：已啟用。"
    rationale: "資料可以從使用者的遠端桌面服務會話轉發到使用者的本機計算機，而無需任何直接的使用者互動。已存在於受感染伺服器上的惡意軟體將在遠端桌面會話期間對使用者的本機電腦進行直接且隱密的磁碟存取。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow drive redirection. 注意：此群組原則路徑是由 Group Policy 模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.65.3.3.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCdm'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCdm -> 1'

  - id: 15841
    title: "確保“不允許位置重新導向”設定為“已啟用”。"
    description: "此策略設定控制在遠端桌面服務工作階段中將位置資料重新導向至遠端電腦。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要位置資料重新導向，因此減少惡意活動發生的意外途徑的數量是有意義的。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為「啟用」: Computer Configuration\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow location redirection. 注意: 此群組策略路徑預設可能不存在。它由群組策略模板 TerminalServer.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 21H2 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.65.3.3.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLocationRedir'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLocationRedir -> 1'

  - id: 15842
    title: "確保“不允許 LPT 連接埠重新導向”設定為“啟用”。"
    description: "此策略設定指定是否阻止在遠端桌面服務工作階段期間將資料重新導向至用戶端 LPT 連接埠。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 LPT 連接埠重新導向，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow LPT port redirection。注意：此群組原則路徑由群組原則範本TerminalServer.admx/adml提供，該範本包含在所有版本的Microsoft Windows行政範本中。"
    compliance:
      - cis: ["18.9.65.3.3.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLPT'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLPT -> 1'

  - id: 15843
    title: "確保「不允許支援的即插即用裝置重新導向」設定為「已啟用」。"
    description: "此策略設定可讓您控制將受支援的即插即用裝置（例如 Windows 可攜式裝置）重新導向至遠端桌面服務工作階段中的遠端電腦。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中對即插即用裝置重新導向的需求非常少，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow supported Plug and Play device redirection. 注意: 此群組原則路徑由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.65.3.3.6"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisablePNPRedir'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisablePNPRedir -> 1'

  - id: 15844
    title: "確保「連線時始終提示輸入密碼」設定為「啟用」。"
    description: "此原則設定指定遠端桌面服務是否始終在連線時提示用戶端電腦輸入密碼。您可以使用此原則設定強制要求登入遠端桌面服務的使用者輸入密碼，即使他們已經在遠端桌面連線用戶端中提供了密碼。此設定的建議狀態為：已啟用。"
    rationale: "使用者在建立新的遠端桌面連線捷徑時可以選擇儲存其使用者名稱和密碼。如果執行遠端桌面服務的伺服器允許使用此功能的使用者登入伺服器但不輸入密碼，則獲得使用者電腦實體存取權限的攻擊者可能會連接到遠端桌面伺服器透過遠端桌面連線捷徑，即使他們可能不知道用戶的密碼。"
    remediation: "要透過 GP 設定建議的配置, 將以下的使用者介面路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Always prompt for password upon connection. 注意: 此群組原則路徑由群組原則範本 TerminalServer.admx/adml 提供, 該範本包含在所有版本的 Microsoft Windows 管理範本中。注意 #2: 在 Microsoft Windows Vista 管理範本中, 這個設定被稱為 Always prompt client for password upon connection, 但從 Windows Server 2008 (非 R2) 管理範本開始, 它被重新命名。"
    compliance:
      - cis: ["18.9.65.3.9.1"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fPromptForPassword'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fPromptForPassword -> 1'

  - id: 15845
    title: "確保“需要安全 RPC 通訊”設定為“啟用”。"
    description: "此策略設定可讓您指定遠端桌面服務是需要與所有用戶端進行安全遠端程序呼叫 (RPC) 通訊還是允許不安全的通訊。您可以使用此策略設定僅允許經過驗證和加密的請求來增強與用戶端的 RPC 通訊的安全性。此設定的建議狀態為：已啟用。"
    rationale: "允許不安全的 RPC 通訊可能會使伺服器遭受中間人攻擊和資料外洩攻擊。"
    remediation: "要通過GP建立推薦的配置，請將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require secure RPC communication. 注意: 此組策略路徑由組策略模板TerminalServer.admx/adml提供，這些模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.65.3.9.2"]
      - pci_dss: ["8.2.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fEncryptRPCTraffic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fEncryptRPCTraffic -> 1'

  - id: 15846
    title: "確保「需要對遠端 (RDP) 連線使用特定安全層」設定為「啟用：SSL」。"
    description: "此原則設定指定是否需要使用特定安全層來保護遠端桌面協定 (RDP) 連線期間用戶端和 RD 會話主機伺服器之間的通訊。此設定的建議狀態為：啟用：SSL。注意：儘管此設定被標記為 SSL，但它實際上強制執行傳輸層安全性 (TLS) 版本 1.0，而不是較舊的（安全性較低）SSL 協定。"
    rationale: "本機遠端桌面協定 (RDP) 加密現在被視為弱協定，因此首選對用戶端和 RD 會話主機伺服器之間的所有 RDP 通訊強制使用更強的傳輸層安全性 (TLS) 加密。"
    remediation: "建立建議的設定透過 GP，將以下的 UI 路徑設定為「啟用」：SSL: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require use of specific security layer for remote (RDP) connections. 注意：此群組原則路徑由 Group Policy 模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.65.3.9.3"]
      - cis_csc: ["3.10"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> SecurityLayer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> SecurityLayer -> 2'

  - id: 15847
    title: "確保「要求使用網路層級身份驗證對遠端連線進行使用者身份驗證」設定為「已啟用」。"
    description: "透過此策略設置，您可以指定是否需要使用網路層級身份驗證對 RD 會話主機伺服器的遠端連線進行使用者驗證。此設定的建議狀態為：已啟用。"
    rationale: "要求在遠端連線過程中儘早進行使用者身份驗證可增強安全性。"
    remediation: "若要通過 GP 設定推薦的配置，請將以下的 UI 路徑設定為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require user authentication for remote connections by using Network Level Authentication. 注意: 此群組原則路徑是由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。 注意#2: 在 Microsoft Windows Vista 管理模板中，該設置最初名為 Require user authentication using RDP 6.0 for remote connections，但從 Windows Server 2008 (non-R2) 管理模板開始，它已被重新命名。"
    compliance:
      - cis: ["18.9.65.3.9.4"]
      - cis_csc: ["3.10"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> UserAuthentication'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> UserAuthentication -> 1'

  - id: 15848
    title: "確保「設定用戶端連線加密等級」設定為「啟用：高等級」。"
    description: "此策略設定指定是否需要使用特定的加密等級來保護遠端桌面協定 (RDP) 連線期間用戶端電腦和 RD 會話主機伺服器之間的通訊。此策略僅在您使用本機 RDP 加密時適用。但是，不建議使用本機 RDP 加密（而不是 SSL 加密）。此策略不適用於 SSL 加密。此設定的建議狀態為： 啟用：高等級。"
    rationale: "如果允許使用低階加密的遠端桌面用戶端連接，則攻擊者更有可能解密任何捕獲的遠端桌面服務網路流量。"
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」：High Level: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Set client connection encryption level。注意：此組策略路徑由組策略模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.65.3.9.5"]
      - cis_csc: ["3.10"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MinEncryptionLevel'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MinEncryptionLevel -> 3'

  - id: 15849
    title: "確保「為活動但空閒的遠端桌面服務會話設定時間限制」設定為「啟用：15 分鐘或更短，但不是從不 (0)」。"
    description: "此策略設定可讓您指定活動遠端桌面服務工作階段在自動中斷連線之前可以空閒（無需使用者輸入）的最長時間。此設定的建議狀態為： 已啟用：15 分鐘或更短，但非從不 (0)。"
    rationale: "此設定有助於防止活動的遠端桌面會話在不使用時長時間佔用計算機，從而防止大量不活動的會話消耗計算資源。此外，如果使用者的密碼已更改但舊會話仍在運行，則舊的、被遺忘的遠端桌面會話仍然處於活動狀態，可能會導緻密碼鎖定。對於限制連接使用者數量的系統（例如，預設管理模式下的伺服器 - 僅 2 個會話），其他使用者的舊但仍處於活動狀態的會話可能會阻止其他使用者連接，從而導致有效的拒絕服務。"
    remediation: "要透過GP設置建議的配置，將以下UI路徑設置為「啟用」：15分鐘或更短，但不能選擇“從不（0）”：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for active but idle Remote Desktop Services sessions。注意：此群組原則路徑由群組原則範本TerminalServer.admx/adml提供，該範本包含在所有版本的Microsoft Windows管理範本中。注意#2：在舊版Microsoft Windows管理範本中，此設置名為Set time limit for active but idle Terminal Services sessions，但從Windows 7和Server 2008 R2管理範本開始更名。"
    compliance:
      - cis: ["18.9.65.3.10.1"]
      - pci_dss: ["8.1.8"]
      - tsc: ["CC6.1"]
    references:
      - https://workbench.cisecurity.org/benchmarks/766
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime -> n:^(\d+) compare <= 900000'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime -> n:^(\d+) compare != 0'

  - id: 15850
    title: "確保「設定斷開連線的會話的時間限制」設定為「啟用：1 分鐘」。"
    description: "此策略設定可讓您設定斷開連線的遠端桌面服務工作階段的時間限制。此設定的建議狀態為： 啟用：1 分鐘。"
    rationale: "此設定有助於防止活動的遠端桌面會話在不使用時長時間佔用計算機，從而防止大量已斷開連接但仍處於活動狀態的會話消耗計算資源。此外，如果使用者的密碼已更改但舊會話仍在運行，則舊的、被遺忘的遠端桌面會話仍然處於活動狀態，可能會導緻密碼鎖定。對於限制連接使用者數量的系統（例如，預設管理模式下的伺服器 - 僅 2 個會話），其他使用者的舊但仍處於活動狀態的會話可能會阻止其他使用者連接，從而導致有效的拒絕服務。此設定對於確保正確終止斷開連線的會話非常重要。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為「啟用」：1 分鐘：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for disconnected sessions. 注意：此組策略路徑由包含在所有版本的 Microsoft Windows 管理模板中的組策略模板 TerminalServer.admx/adml 提供。"
    compliance:
      - cis: ["18.9.65.3.10.2"]
      - pci_dss: ["8.1"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxDisconnectionTime'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxDisconnectionTime -> 60000'

  - id: 15851
    title: "確保「退出時不刪除臨時資料夾」設定為「停用」。"
    description: "此策略設定指定遠端桌面服務是否在登出時保留使用者的每個會話暫存資料夾。此設定的建議狀態是：停用。"
    rationale: "敏感資訊可能包含在臨時資料夾內，並且對登入系統的其他管理員可見。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Temporary Folders\\Do not delete temp folders upon exit. 注意: 此組策略路徑是由組策略範本 TerminalServer.admx/adml 提供，包含在所有版本的 Microsoft Windows Administrative Templates 中。 注意#2: 在舊版本的 Microsoft Windows Administrative Templates 中，此設定名為 Do not delete temp folder upon exit，但從 Windows 8.0 和 Server 2012 (非 R2) Administrative Templates 開始已重新命名。"
    compliance:
      - cis: ["18.9.65.3.11.1"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DeleteTempDirsOnExit'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DeleteTempDirsOnExit -> 1'

  - id: 15852
    title: "確保“阻止下載附件”設定為“啟用”。"
    description: "此策略設定可阻止使用者將附件（檔案附件）從 RSS 來源下載到使用者的電腦。此設定的建議狀態為：已啟用。"
    rationale: "允許透過 RSS 來源下載附件可能會引入可能具有惡意目的的檔案。"
    remediation: "若要通過 GP 設定推薦的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\RSS Feeds\\Prevent downloading of enclosures. 注意：此群組原則路徑由群組原則模板 InetRes.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 系統管理模板中。注意 #2：在較舊的 Microsoft Windows 系統管理模板中，此設置稱為關閉附件下載，但從 Windows 8.0 & Server 2012 (非 R2) 系統管理模板開始，它已被重命名。"
    compliance:
      - cis: ["18.9.66.1"]
      - cis_csc: ["9.4"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds -> DisableEnclosureDownload'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds -> DisableEnclosureDownload -> 1'

  - id: 15853
    title: "確保「允許雲端搜尋」設定為「啟用：停用雲端搜尋」。"
    description: "此策略設定允許搜尋和 Cortana 搜尋 OneDrive 和 SharePoint 等雲端來源。此設定的建議狀態為： 已啟用：停用 Cloud Search。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為 Enabled（已啟用）：Disable Cloud Search: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow Cloud Search。注意：此群組原則路徑預設可能不存在。它由群組原則模板 Search.admx/adml 提供，該模板包含在 Microsoft Windows 10 版本 1709 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.67.2"]
      - cis_csc: ["4.8"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCloudSearch'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCloudSearch -> 0'

  - id: 15854
    title: "確保“允許 Cortana”設定為“停用”。"
    description: "此策略設定指定裝置上是否允許 Cortana。此設定的建議狀態是：停用。"
    rationale: "如果啟用 Cortana，敏感資訊可能會包含在搜尋記錄中並傳送給 Microsoft。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow Cortana。注意：此群組原則路徑預設可能不存在。它是由Group Policy範本Search.admx/adml提供，該範本包含在Microsoft Windows 10 RTM（發布版本1507）管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.67.3"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCortana'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCortana -> 0'

  - id: 15855
    title: "確保「允許 Cortana 在鎖定畫面上方」設定為「停用」。"
    description: "此策略設定決定使用者在系統鎖定時是否可以使用語音與 Cortana 互動。此設定的建議狀態是：停用。"
    rationale: "當設備鎖定時，不應允許存取任何電腦資源。"
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow Cortana above lock screen. 注意: 此群組原則路徑預設可能不存在。它是由與 Microsoft Windows 10 發行版 1607 與 Server 2016 管理範本（或更新版本）一起包含的群組原則範本 Search.admx/adml 提供的。"
    compliance:
      - cis: ["18.9.67.4"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCortanaAboveLock'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCortanaAboveLock -> 0'

  - id: 15856
    title: "確保“允許加密檔案索引”設定為“停用”。"
    description: "此策略設定控制是否允許對加密項目建立索引。更改此設定後，索引將完全重建。索引位置必須使用全磁碟區加密（例如 BitLocker 磁碟機加密或非 Microsoft 解決方案），以維護加密檔案的安全性。此設定的建議狀態是：停用。"
    rationale: "建立索引並允許用戶搜尋加密檔案可能會洩露加密檔案中儲存的機密資料。"
    remediation: "若要透過 GP 設定建議的配置，將以下 UI 路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow indexing of encrypted files。注意：此群組原則路徑由所有版本的 Microsoft Windows 行政模板中包含的群組原則模板 Search.admx/adml 提供。"
    compliance:
      - cis: ["18.9.67.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowIndexingEncryptedStoresOrItems'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowIndexingEncryptedStoresOrItems -> 0'

  - id: 15857
    title: "確保「允許搜尋和 Cortana 使用位置」設定為「停用」。"
    description: "此策略設定指定搜尋和 Cortana 是否可以提供位置感知搜尋和 Cortana 結果。此設定的建議狀態是：停用。"
    rationale: "在企業託管環境中，無需允許 Cortana 和搜尋存取位置資料。組織可能不希望共享此資訊。"
    remediation: "要通過 GP 設置推薦的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow search and Cortana to use location. 注意: 此群組策略路徑預設情況下可能不存在。它由 Group Policy 模板 Search.admx/adml 提供，該模板包含在 Microsoft Windows 10 RTM（釋出 1507）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.67.6"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowSearchToUseLocation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowSearchToUseLocation -> 0'

  - id: 15858
    title: "確保「關閉 KMS 用戶端線上 AVS 驗證」設定為「啟用」。"
    description: "金鑰管理服務 (KMS) 是一種 Microsoft 授權啟動方法，需要設定本機伺服器來儲存軟體授權。 KMS 伺服器本身需要連接到 Microsoft 來啟動 KMS 服務，但後續的網路用戶端可以透過 KMS 伺服器啟動 Microsoft Windows 作業系統和/或其 Microsoft Office，而不是直接連接到 Microsoft。此政策設定可讓您選擇不自動向 Microsoft 傳送 KMS 用戶端啟動資料。此設定的建議狀態為：已啟用。"
    rationale: "儘管 KMS 授權方法不需要 KMS 用戶端連線到 Microsoft，但它們仍然會自動向 Microsoft 發送 KMS 用戶端啟動狀態資料。阻止發送此資訊有助於減少高安全環境中的隱私問題。"
    remediation: "要透過 GP 建立建議的配置, 請將以下 UI 路徑設為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Software Protection Platform\\Turn off KMS Client Online AVS Validation. 注意: 此群組政策路徑預設可能不存在。它是由包含在 Microsoft Windows 10 RTM (Release 1507) 管理模板 (或更新版本) 中的群組政策模板 AVSValidationGP.admx/adml 提供的。"
    compliance:
      - cis: ["18.9.72.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform -> NoGenTicket'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform -> NoGenTicket -> 1'

  - id: 15859
    title: "確保「停用 Microsoft Store 中的所有應用程式」設定為「已停用」。"
    description: "此設定配置從 Microsoft Store 預先安裝或下載的所有應用程式的啟動。此設定的建議狀態是：停用。注意：此政策設定僅適用於 Windows 10 企業版和 Windows 10 教育版。注意#2：此設定的名稱和“啟用/禁用”值的措辭不正確- 從邏輯上講，標題意味著將其配置為“啟用”將禁用Microsoft Store 中的所有應用程序，將其配置為“停用」將啟用Microsoft Store 中的所有應用程式商店。事實恰恰相反（並且與 GPME 幫助文字一致）。這是 Microsoft 在管理範本中的邏輯措詞錯誤。"
    rationale: "Store 服務是 Windows 內建的零售商店，主要供消費者使用。在企業管理的環境中，IT 部門應該管理所有應用程式的安裝，以降低安裝易受攻擊的軟體的風險。"
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為「已停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Store\\Disable all apps from Microsoft Store。注意：此群組策略路徑預設可能不存在。它是由群組策略模板WindowsStore.admx/adml提供，該模板隨Microsoft Windows 10 Release 1511 Administrative Templates（或更新版本）一起包含。注意#2：在較早的Microsoft Windows管理模板中，此設置最初命名為Disable all apps from Windows Store，但從Windows 10 Release 1803管理模板開始已更名。"
    compliance:
      - cis: ["18.9.75.1"]
      - cis_csc: ["2.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> DisableStoreApps'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> DisableStoreApps -> 1'

  - id: 15860
    title: "確保「僅顯示 Microsoft Store 中的私人商店」設定為「已啟用」。"
    description: "此政策設定拒絕存取 Microsoft Store 中的零售目錄，但顯示私人商店。此設定的建議狀態為：已啟用。"
    rationale: "允許私人商店將允許組織控制使用者有權添加到系統的應用程式。這將有助於確保未經批准的惡意應用程式不會在系統上運行。"
    remediation: "若要透過GP建立推薦的配置，請將以下UI路徑設置為「已啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Store\\Only display the private store within the Microsoft Store。 注意：此群組原則路徑預設可能不存在。此路徑由隨附Windows 10 Release 1607（或更新版本）的管理模板WindowsStore.admx/adml提供。注意#2：在較舊的Microsoft Windows管理模板中，這個設置最初命名為Only display the private store within the Windows Store app，但從Windows 10 Release 1803管理模板開始重新命名。"
    compliance:
      - cis: ["18.9.75.2"]
      - cis_csc: ["2.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> RequirePrivateStoreOnly'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> RequirePrivateStoreOnly -> 1'

  - id: 15861
    title: "確保「關閉自動下載和​​安裝更新」設定為「停用」。"
    description: "此設定啟用或停用 Microsoft Store 應用程式更新的自動下載和​​安裝。此設定的建議狀態是：停用。"
    rationale: "正確修補系統有助於防範 0day 漏洞。"
    remediation: "若要透過 GP 建立建議的配置，請將以下使用者界面路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Store\\Turn off Automatic Download and Install of updates。注意：此群組原則路徑可能預設不存在。它由群組原則範本 WinStoreUI.admx/adml 提供，該範本隨 Microsoft Windows 8.1 和 Server 2012 R2 管理範本一起提供，或由群組原則範本 WindowsStore.admx/adml 提供，該範本隨 Microsoft Windows 10 發行版 1511 管理範本（或更高版本）一起提供。"
    compliance:
      - cis: ["18.9.75.3"]
      - cis_csc: ["7.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> AutoDownload'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> AutoDownload -> 4'

  - id: 15862
    title: "確保「關閉更新至最新版本 Windows 的提議」設定為「已啟用」。"
    description: "啟用或停用 Microsoft Store 更新至最新版本 Windows 的優惠。此設定的建議狀態為：已啟用。"
    rationale: "計劃外的作業系統升級可能會導致更多可預防的支援電話。 IT 部門應管理和批准所有升級和更新。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Store\\Turn off the offer to update to the latest version of Windows。 注意：此群組原則路徑預設可能不存在。它由群組原則範本 WinStoreUI.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理範本中，或者由群組原則範本 WindowsStore.admx/adml 提供，該範本包含在 Microsoft Windows 10 版本 1511 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.75.4"]
      - cis_csc: ["7.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> DisableOSUpgrade'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> DisableOSUpgrade -> 1'

  - id: 15863
    title: "確保“關閉商店應用程式”設定為“啟用”。"
    description: "此設定拒絕或允許存取商店應用程式。此設定的建議狀態為：已啟用。注意：根據 Microsoft TechNet 和 MSKB 3135657，此原則設定不適用於企業版和教育版以外的任何 Windows 10 版本。"
    rationale: "僅應安裝 IT 部門批准的應用程式。允許用戶安裝第三方應用程式可能會導致錯過修補程式和潛在的零日漏洞。"
    remediation: "若要透過GP建立建議的配置，請將下列UI路徑設定為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Store\\Turn off the Store application。注意：此组策略路径默认可能不存在，它由组策略模板WinStoreUI.admx/adml提供，该模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板中，或由组策略模板WindowsStore.admx/adml提供，该模板包含在Microsoft Windows 10 Release 1511管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.75.5"]
      - cis_csc: ["2.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    references:
      - https://docs.microsoft.com/en-us/windows/client-management/group-policies-for-enterprise-and-education-editions
      - https://support.microsoft.com/en-us/help/3135657/can-t-disable-windows-store-in-windows-10-pro-through-group-policy
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> RemoveWindowsStore'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsStore -> RemoveWindowsStore -> 1'

  - id: 15864
    title: "確保“允許小部件”設定為“禁用”。"
    description: "此策略設定指定裝置上是否允許小工具功能。小部件功能提供天氣、新聞、體育、股票、交通和娛樂等資訊（不包括所有清單）。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，Windows 工作列上的小部件等應用程式和功能應被視為可能的安全風險，因為資料可能會被傳送回第三方（例如 Microsoft）。"
    remediation: "要通過 GP 建立推薦配置，請將以下 UI 路徑設定為「已停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Widgets\\Allow Widgets。注意：此群組原則路徑預設情況下可能不存在。它由包含在 Microsoft Windows 10 21H2 版管理範本（或更新版本）中的群組原則模板 NewsAndInterests.admx/adml 提供。"
    compliance:
      - cis: ["18.9.81.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Dsh'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Dsh -> AllowNewsAndInterests'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Dsh -> AllowNewsAndInterests -> 0'

  - id: 15865
    title: "確保「設定 Windows Defender SmartScreen」設定為「啟用：警告並防止繞過」。"
    description: "此策略設定可讓你管理 Windows Defender SmartScreen 的行為。 Windows Defender SmartScreen 在執行從 Internet 下載的無法識別的程式之前向使用者發出警告，從而幫助確保電腦更安全。一些有關啟用此功能的 PC 上運行的檔案和程式的資訊將發送給 Microsoft。此設定的建議狀態為： 啟用：警告並防止繞過。"
    rationale: "Windows Defender SmartScreen 在執行從 Internet 下載的無法識別的程式之前向使用者發出警告，從而幫助確保電腦更安全。但是，由於一些有關 PC 上運行的檔案和程式的資訊會發送給 Microsoft，因此一些組織可能更願意停用它。"
    remediation: "要通過GP設置推薦的配置，將以下UI路徑設置為「已啟用」：警告並防止繞過: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Explorer\\Configure Windows Defender SmartScreen。注意：此組策略路徑預設可能不存在。它由組策略模板WindowsExplorer.admx/adml提供，該模板包含在Microsoft Windows 8.0 和 Server 2012（非R2）管理模板中（或更新版本）。注意#2：在較舊的Microsoft Windows管理模板中，此設置最初名為配置Windows SmartScreen，但從Windows 10 1703版管理模板開始，它被重新命名。"
    compliance:
      - cis: ["18.9.85.1.1"]
      - cis_csc: ["10.5"]
      - pci_dss: ["2.2.4"]
      - nist_800_53: ["CM.1"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableSmartScreen'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> ShellSmartScreenLevel'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableSmartScreen -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> ShellSmartScreenLevel -> Block'

  - id: 15866
    title: "確保「配置 Windows Defender SmartScreen」設定為「啟用」。"
    description: "此設定可讓您決定是否開啟 SmartScreen 篩選器。 SmartScreen 篩選器提供警告訊息，協助保護您的員工免受潛在的網路釣魚詐騙和惡意軟體的侵害。此設定的建議狀態為：已啟用。"
    rationale: "SmartScreen 具有重要用途，因為它有助於警告使用者可能存在惡意網站和檔案。允許用戶關閉此設定可能會使瀏覽器更容易受到攻擊。"
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Microsoft Edge\\Configure Windows Defender SmartScreen。注意：此群組政策路徑預設可能不存在。它由群組政策模板MicrosoftEdge.admx/adml提供，此模板包含在Microsoft Windows 10 RTM（發布1507）管理模板（或更新版本）中。注意#2：在Microsoft Windows 10 RTM（發布1507）管理模板中，此設置最初名為「允許您配置SmartScreen」。在Microsoft Windows 10發布1511管理模板中，它被重命名為「關閉SmartScreen篩選器」。在Microsoft Windows 10發布1607和Server 2016管理模板中，它再次被重命名為「配置SmartScreen篩選器」。最終，它在Windows 10發布1703管理模板中被命名為「配置Windows Defender SmartScreen」。"
    compliance:
      - cis: ["18.9.85.2.1"]
      - cis_csc: ["10.5"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter -> EnabledV9'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter -> EnabledV9 -> 1'

  - id: 15867
    title: "確保「防止繞過網站的 Windows Defender SmartScreen 提示」設定為「已啟用」。"
    description: "透過此設置，您可以決定員工是否可以覆寫潛在惡意網站的 SmartScreen 篩選器警告。此設定的建議狀態為：已啟用。"
    rationale: "如果網站可能存在惡意，SmartScreen 將向員工發出警告。啟用此設定可防止繞過這些警告。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為「已啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Microsoft Edge\\Prevent bypassing Windows Defender SmartScreen prompts for sites。注意：此群組策略路徑可能預設不存在。它由群組策略模板MicrosoftEdge.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1511 Administrative Templates（或更新版本）中。注意 #2：在Microsoft Windows 10 Release 1511 Administrative Templates中，此設置最初名為Don't allow SmartScreen Filter warning overrides。在Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates中，此設置更名為Prevent bypassing SmartScreen prompts for sites。最後，從Windows 10 Release 1703 Administrative Templates開始，它被更名為Prevent bypassing Windows Defender SmartScreen prompts for sites。"
    compliance:
      - cis: ["18.9.85.2.2"]
      - cis_csc: ["10.5"]
      - pci_dss: ["2.2.3"]
      - nist_800_53: ["CM.1"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter -> PreventOverride'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftEdge\PhishingFilter -> PreventOverride -> 1'

  - id: 15868
    title: "確保「啟用或停用 Windows 遊戲錄製和廣播」設定為「停用」。"
    description: "此設定啟用或停用 Windows 遊戲錄製和廣播功能。此設定的建議狀態是：停用。"
    rationale: "如果允許此設置，使用者可以記錄會話資訊並將其廣播到外部站點，這既存在意外將敏感公司資料（在螢幕上）暴露在公司外部的風險，也存在隱私問題。"
    remediation: "要透過GP建立推薦的配置，將以下UI路徑設置為已禁用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Game Recording and Broadcasting\\Enables or disables Windows Game Recording and Broadcasting. 注意：此組策略路徑可能預設不存在。它由組策略模板GameDVR.admx/adml提供，該模板隨附於Microsoft Windows 10 RTM (Release 1507)管理模板（或更高版本）。"
    compliance:
      - cis: ["18.9.87.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\GameDVR'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\GameDVR -> AllowGameDVR'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\GameDVR -> AllowGameDVR -> 0'

  - id: 15869
    title: "確保「允許 Windows Ink 工作區中建議的應用程式」設定為「停用」。"
    description: "此原則設定決定是否允許 Windows Ink Workspace 中建議的應用程式。此設定的建議狀態是：停用。"
    rationale: "此 Microsoft 功能旨在收集資料並根據收集的資料建議應用程式。停用此設定將有助於確保您的資料不會與任何第三方共用。"
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Ink Workspace\\Allow suggested apps in Windows Ink Workspace. 注意：此群組原則路徑預設可能不存在。它由群組原則範本 WindowsInkWorkspace.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1607 和 Server 2016 行政範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.89.1"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace -> 0'

  - id: 15870
    title: "確保「允許 Windows Ink 工作區」設定為「啟用：打開，但不允許存取上述鎖定」或「停用」但不是「啟用：開啟」。"
    description: "此策略設定決定是否允許在鎖定畫面上方顯示 Windows Ink 項目。此設定的建議狀態為： 啟用：打開，但禁止存取以上鎖定或停用。"
    rationale: "不建議在系統鎖定時允許存取任何應用程式。如果允許此功能，則只有在使用者使用正確的憑證進行身份驗證後才可以存取它。"
    remediation: "若要透過GP建立建議的配置，將以下使用者介面路徑設置為已啟用：開啟，但不允許在鎖定畫面上使用 或已停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Ink Workspace\\Allow Windows Ink Workspace。注意：此群組原則路徑可能預設不存在。它由群組原則模板WindowsInkWorkspace.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.89.2"]
      - pci_dss: ["8.6"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowWindowsInkWorkspace'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowWindowsInkWorkspace -> r:^0$|^1$'

  - id: 15871
    title: "確保「允許使用者控制安裝」設定為「停用」。"
    description: "此設定控制是否允許使用者更改通常僅系統管理員可用的安裝選項。 Windows Installer 的安全功能通常會阻止使用者變更通常為系統管理員保留的安裝選項，例如指定檔案的安裝目錄。如果 Windows Installer 偵測到安裝套件允許使用者變更受保護的選項，它將停止安裝並顯示一則訊息。只有當安裝程式在特權安全上下文中執行時，這些安全功能才會起作用，在特權安全性上下文中，安裝程式有權存取使用者拒絕的目錄。此設定的建議狀態是：停用。"
    rationale: "在企業管理的環境中，只有具有管理權限的 IT 人員才能在系統上安裝或變更軟體。允許使用者對安裝進行任何控制可能會帶來未經批准的軟體被安裝或從系統中刪除的風險，這可能會導致系統容易受到損害。"
    remediation: "要通過群組原則 (GP) 設定推薦配置，請將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Allow user control over installs。注意：此群組原則路徑由隨所有版本的 Microsoft Windows Administrative Templates 附帶的群組原則範本 MSI.admx/adml 提供。注意 #2：在較舊的 Microsoft Windows Administrative Templates 中，此設置名為 Enable user control over installs，但從 Windows 8.0 和 Server 2012 (非 R2) Administrative Templates 開始改名。"
    compliance:
      - cis: ["18.9.90.1"]
      - cis_csc: ["2.5"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> EnableUserControl'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> EnableUserControl -> 0'

  - id: 15872
    title: "確保「始終使用提升的權限安裝」設定為「停用」。"
    description: "此設定控制 Windows Installer 在系統上安裝任何程式時是否應使用系統權限。注意：此設定同時出現在「電腦設定」和「使用者設定」資料夾中。若要使此設定生效，您必須在兩個資料夾中啟用該設定。注意：如果啟用，熟練用戶可以利用此設定授予的權限來更改其權限並獲得對受限檔案和資料夾的永久存取權限。請注意，不保證此設定的使用者配置版本的安全性。此設定的建議狀態是：停用。"
    rationale: "權限有限的使用者可以透過建立 Windows Installer 安裝套件來利用此功能，該安裝套件會建立屬於本機內建管理員群組的新本機帳戶、將其目前帳戶新增至本機內建管理員群組、安裝惡意軟體，或進行其他未經授權的活動。"
    remediation: "若要透過 GP 設定建議的設定，請將以下 UI 路徑設為停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Always install with elevated privileges. 注意: 此群組原則路徑由 Group Policy 模板 MSI.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.90.2"]
      - cis_csc: ["5.4"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> AlwaysInstallElevated'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> AlwaysInstallElevated -> 0'

  - id: 15873
    title: "確保「封鎖 Windows Installer 腳本的 Internet Explorer 安全性提示」設定為「停用」。"
    description: "此策略設定控制是否允許基於 Web 的程式在電腦上安裝軟體而不通知使用者。此設定的建議狀態是：停用。"
    rationale: "抑制系統警告可能會帶來安全風險並增加系統的攻擊面。"
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為“禁用”：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Prevent Internet Explorer security prompt for Windows Installer scripts。注意：此組策略路徑由所有版本的 Microsoft Windows 管理模板包含的組策略模板 MSI.admx/adml 提供。注意 #2：在較舊的 Microsoft Windows 管理模板中，此設置最初名為 Disable IE security prompt for Windows Installer scripts，但從 Windows 8.0 和 Server 2012 (非 R2) 管理模板開始重命名。"
    compliance:
      - cis: ["18.9.90.3"]
      - cis_csc: ["2.5"]
      - pci_dss: ["2.2.5"]
      - tsc: ["CC6.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> SafeForScripting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> SafeForScripting -> 0'

  - id: 15874
    title: "確保「重新啟動後自動登入並鎖定最後一個互動式使用者」設定為「停用」。"
    description: "此策略設定控制 Windows 更新重新啟動系統後裝置是否自動登入最後一個互動式使用者。此設定的建議狀態是：停用。"
    rationale: "停用此功能將防止快取使用者憑證和未經授權使用設備，並確保使用者知道重新啟動。"
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Logon Options\\Sign-in and lock last interactive user automatically after a restart. 注意: 此群組原則路徑預設可能不存在。它由含有 Microsoft Windows 8.1 & Server 2012 R2 Administrative Templates (或更新版本) 的群組原則範本 WinLogon.admx/adml 提供。注意 #2: 在較舊的 Microsoft Windows 行政範本中，此設定最初命名為 Sign-in last interactive user automatically after a system-initiated restart，但從 Windows 10 Release 1903 行政範本開始被重新命名。"
    compliance:
      - cis: ["18.9.91.1"]
      - pci_dss: ["8.6"]
      - tsc: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableAutomaticRestartSignOn'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableAutomaticRestartSignOn -> 1'

  - id: 15875
    title: "確保「開啟 PowerShell 腳本區塊日誌記錄」設定為「已啟用」。"
    description: "此原則設定允許將所有 PowerShell 腳本輸入記錄到應用程式和服務日誌\\Microsoft\\Windows\\PowerShell\\操作事件日誌通道。此設定的建議狀態為：已啟用。注意：如果啟用了腳本區塊呼叫啟動/停止事件的日誌記錄（選取選項方塊），PowerShell 將在呼叫指令、腳本區塊、函數或腳本啟動或停止時記錄其他事件。啟用此選項會產生大量事件日誌。 CIS 有意選擇不推薦此選項，因為它會產生大量事件。如果組織選擇啟用可選設定（選取），這也符合基準。"
    rationale: "在對 PowerShell 攻擊事件進行取證調查以確定發生的情況時，PowerShell 腳本輸入的日誌非常有價值。"
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Script Block Logging。注意：此群組原則路徑可能預設不存在。它由Group Policy模版PowerShellExecutionPolicy.admx/adml提供，該模版包含在Microsoft Windows 10 RTM（Version 1507）或更新的管理模版中。"
    compliance:
      - cis: ["18.9.100.1"]
      - cis_csc: ["8.8"]
      - pci_dss: ["12.3.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging -> EnableScriptBlockLogging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging -> EnableScriptBlockLogging -> 1'

  - id: 15876
    title: "確保「開啟 PowerShell 轉錄」設定為「停用」。"
    description: "此策略設定可讓您將 Windows PowerShell 指令的輸入和輸出擷取到基於文字的記錄中。此設定的建議狀態是：停用。"
    rationale: "如果啟用此設置，則存在密碼可能以純文字形式儲存在 PowerShell_transcript 輸出檔案中的風險。"
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Transcription。注意：此群組原則路徑預設可能不存在。它由Group Policy模板PowerShellExecutionPolicy.admx/adml提供，該模板包含在Microsoft Windows 10 RTM（發布1507）管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.9.100.2"]
      - pci_dss: ["12.3.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription -> EnableTranscripting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription -> EnableTranscripting -> 0'

  - id: 15877
    title: "確保“允許基本身份驗證”設定為“禁用”。"
    description: "此原則設定可讓您管理 Windows 遠端管理 (WinRM) 用戶端是否使用基本驗證。此設定的建議狀態是：停用。注意：使用 Microsoft 的 Exchange Online 服務 (Office 365) 的用戶端將需要對此建議的例外，以將此設定設為「已啟用」。 Exchange Online 使用基於 HTTPS 的基本驗證，因此 Exchange Online 驗證流量仍將被安全地加密。"
    rationale: "基本身份驗證不如 WinRM 中提供的其他身份驗證方法可靠，因為包括密碼在內的憑證以純文字形式傳輸。能夠捕獲執行 WinRM 的網路上的資料包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    remediation: "要透過GP設置建議的配置，將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Allow Basic authentication. 注意: 此群組原則路徑由群組原則模板WindowsRemoteManagement.admx/adml提供，該模板包含在所有版本的Microsoft Windows行政模板中。"
    compliance:
      - cis: ["18.9.102.1.1"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowBasic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowBasic -> 0'

  - id: 15878
    title: "確保「允許未加密的流量」設定為「停用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 用戶端是否透過網路傳送和接收未加密的訊息。此設定的建議狀態是：停用。"
    rationale: "對 WinRM 網路流量進行加密可降低攻擊者在 WinRM 訊息透過網路傳輸時查看或修改 WinRM 訊息的風險。"
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為「停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Allow unencrypted traffic。注意: 此群組原則路徑由群組原則模板WindowsRemoteManagement.admx/adml提供，該模板包含在所有版本的Microsoft Windows行政模板中。"
    compliance:
      - cis: ["18.9.102.1.2"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowUnencryptedTraffic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowUnencryptedTraffic -> 0'

  - id: 15879
    title: "確保「禁止摘要式身份驗證」設定為「啟用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 用戶端是否不使用摘要式驗證。此設定的建議狀態為：已啟用。"
    rationale: "摘要式驗證的穩健性不如 WinRM 中可用的其他驗證方法，能夠擷取執行 WinRM 的網路上的封包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    remediation: "若要透過GP建立建議的設定，請將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Disallow Digest authentication. 注意: 這個群組策略路徑是由群組策略範本WindowsRemoteManagement.admx/adml提供，該範本包含在所有版本的Microsoft Windows管理範本中。"
    compliance:
      - cis: ["18.9.102.1.3"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowDigest'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowDigest -> 0'

  - id: 15880
    title: "確保“允許基本身份驗證”設定為“禁用”。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否接受來自遠端用戶端的基本驗證。此設定的建議狀態是：停用。"
    rationale: "基本身份驗證不如 WinRM 中提供的其他身份驗證方法可靠，因為包括密碼在內的憑證以純文字形式傳輸。能夠捕獲執行 WinRM 的網路上的資料包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    remediation: "若要透過 GP 建立推薦設定，將以下 UI 路徑設為已停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow Basic authentication. 注意：此群組原則路徑由群組原則範本 WindowsRemoteManagement.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.102.2.1"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowBasic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowBasic -> 0'

  - id: 15881
    title: "確保「允許透過 WinRM 進行遠端伺服器管理」設定為「停用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否會自動在網路上偵聽預設 HTTP 連接埠上的 HTTP 傳輸要求。此設定的建議狀態是：停用。"
    rationale: "任何功能都是潛在的攻擊途徑，那些啟用入站網路連線的功能尤其危險。僅在受信任的網路上啟用 Windows 遠端管理 (WinRM) 服務，並在可行時採用 IPsec 等其他控制措施。"
    remediation: "如要透過 GP 建立建議的配置，請將以下 UI 路徑設為「已停用」：Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow remote server management through WinRM。注意：此群組原則路徑由群組原則模板 WindowsRemoteManagement.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。注意 #2：在較舊的 Microsoft Windows 管理模板中，此設定最初名為 Allow automatic configuration of listeners，但自 Windows 8.0 和 Server 2012（非 R2）管理模板開始，此設定已被重新命名。"
    compliance:
      - cis: ["18.9.102.2.2"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowAutoConfig'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowAutoConfig -> 0'

  - id: 15882
    title: "確保「允許未加密的流量」設定為「停用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否透過網路傳送和接收未加密的訊息。此設定的建議狀態是：停用。"
    rationale: "對 WinRM 網路流量進行加密可降低攻擊者在 WinRM 訊息透過網路傳輸時查看或修改 WinRM 訊息的風險。"
    remediation: "要透過 GP 設定建議的配置，請將以下 UI 路徑設置為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow unencrypted traffic. 注意: 此群組原則路徑是由 Group Policy 範本 WindowsRemoteManagement.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.102.2.3"]
      - cis_csc: ["3.10"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowUnencryptedTraffic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowUnencryptedTraffic -> 0'

  - id: 15883
    title: "確保「禁止 WinRM 儲存 RunAs 憑證」設定為「啟用」。"
    description: "透過此策略設置，您可以管理 Windows 遠端管理 (WinRM) 服務是否允許儲存任何外掛程式的運行身分憑證。此設定的建議狀態為：已啟用。注意：如果啟用然後停用此策略設置，則先前為 RunAsPassword 配置的任何值都需要重置。"
    rationale: "儘管儲存 RunAs 憑證的功能是一項方便的功能，但它會稍微增加帳戶外洩的風險。例如，如果您在無人看管幾分鐘之前忘記鎖定桌面，其他人不僅可以存取您電腦的桌面，還可以存取您透過 WinRM 使用快取的 RunAs 憑證管理的任何主機。"
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Disallow WinRM from storing RunAs credentials. 注意：此組策略路徑可能預設不存在。它由包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中的組策略模板WindowsRemoteManagement.admx/adml提供。"
    compliance:
      - cis: ["18.9.102.2.4"]
      - pci_dss: ["12.3.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> DisableRunAs'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> DisableRunAs -> 1'

  - id: 15884
    title: "確保「允許遠端 Shell 存取」設定為「停用」。"
    description: "此策略設定可讓您管理對所有支援的 shell 的遠端存取配置以執行腳本和指令。此設定的建議狀態是：停用。注意：此設定的 GPME 幫助文字措辭不正確，這意味著將其配置為「啟用」將拒絕新的遠端 Shell 連接，將其設為「停用」將允許遠端 Shell 連接。事實恰恰相反（並且與設定的標題一致）。這是 Microsoft 在管理範本中的措詞錯誤。"
    rationale: "任何功能都是潛在的攻擊途徑，那些啟用入站網路連線的功能尤其危險。僅在受信任的網路上啟用 Windows Remote Shell，並在可行時採用 IPsec 等其他控制措施。"
    remediation: "要透過群組原則建立建議的配置，將以下 UI 路徑設置為已停用：Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Shell\\Allow Remote Shell Access。注意：該群組原則路徑由包含在所有版本的 Microsoft Windows 管理範本中的 Group Policy 模板 WindowsRemoteShell.admx/adml 提供。"
    compliance:
      - cis: ["18.9.103.1"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS -> AllowRemoteShellAccess'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS -> AllowRemoteShellAccess -> 0'

  - id: 15885
    title: "確保「允許與 Windows Sandbox 共用剪貼簿」設定為「停用」。"
    description: '此策略設定啟用或停用與 Windows 沙箱的剪貼簿共用。此設定的建議狀態是：停用。注意：Windows 沙盒功能首次在 Windows 10 R1903 中引入，允許在主機內執行臨時的「全新安裝」Windows 虛擬實例，表面上的目的是在不更改主機的情況下測試應用程式。'
    rationale: "停用複製和貼上可減少 Windows 沙箱暴露的攻擊面以及可能將不受信任的應用程式暴露給內部網路的情況。"
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設置為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Sandbox\\Allow clipboard sharing with Windows Sandbox. 注意: 此群組原則路徑可能不會預設存在。此設置由群組原則模板WindowsSandbox.admx/adml提供，該模板包含在Microsoft Windows 10 Release 21H2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.104.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Sandbox'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Sandbox -> AllowClipboardRedirection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Sandbox -> AllowClipboardRedirection -> 0'

  - id: 15886
    title: "確保「允許在 Windows Sandbox 中連網」設定為「停用」。"
    description: '此策略設定啟用或停用 Windows Sandbox 中的網路。網路是透過在主機上建立虛擬交換器並透過虛擬網路介面卡 (NIC) 將 Windows Sandbox 連接到它來實現的。此設定的建議狀態是：停用。注意：Windows 沙盒功能首次在 Windows 10 R1903 中引入，允許在主機內執行臨時的「全新安裝」Windows 虛擬實例，表面上的目的是在不更改主機的情況下測試應用程式。'
    rationale: "停用網路存取可減少 Windows 沙箱暴露的攻擊面以及不可信應用程式對內部網路的暴露。注意：根據 Microsoft 的說法，在 Windows Sandbox 中啟用網路可能會將不受信任的應用程式暴露給內部網路。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Sandbox\\Allow networking in Windows Sandbox。注意：此群組原則路徑可能預設不存在。它由包括在 Microsoft Windows 10 Release 21H2 管理模板（或更新版本）中的群組原則模板 WindowsSandbox.admx/adml 提供。"
    compliance:
      - cis: ["18.9.104.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Sandbox'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Sandbox -> AllowNetworking'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Sandbox -> AllowNetworking -> 0'

  - id: 15887
    title: "確保「阻止使用者修改設定」設定為「啟用」。"
    description: "此策略設定可阻止使用者變更 Windows 安全性設定中的漏洞保護設定區域。此設定的建議狀態為：已啟用。"
    rationale: "只有經過授權的 IT 人員才能夠更改漏洞保護設置，以確保組織的特定配置不會被修改。"
    remediation: "若要通過 GP 設定建議配置，請將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Security\\App and browser protection\\Prevent users from modifying settings。注意：此群組原則路徑預設可能不存在。它由群組原則模板 WindowsDefenderSecurityCenter.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 1709 (或更新版本) 的管理模板中。"
    compliance:
      - cis: ["18.9.105.2.1"]
      - cis_csc: ["10.5"]
      - pci_dss: ["7.1"]
      - tsc: ["CC6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection -> DisallowExploitProtectionOverride'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection -> DisallowExploitProtectionOverride -> 1'

  - id: 15888
    title: "確保「對於已排程的自動更新安裝，登入使用者不會自動重新啟動」設定為「停用」。"
    description: "此政策設定指定自動更新將等待登入電腦的使用者重新啟動電腦以完成計劃的安裝。此設定的建議狀態是：停用。注意：此設定僅在您設定自動更新以執行計劃的更新安裝時適用。如果將“配置自動更新”設定配置為“已停用”，則此設定無效。"
    rationale: "某些安全性更新需要重新啟動電腦才能完成安裝。如果電腦無法自動重新啟動，則最新更新將無法完全安裝，並且在重新啟動之前不會將新更新下載到電腦。如果沒有自動重新啟動功能，沒有安全意識的使用者可能會選擇無限期延遲重啟，從而使電腦處於不太安全的狀態。"
    remediation: "若要通過GP建立建議的配置，將以下界面路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Legacy Policies\\No auto-restart with logged on users for scheduled automatic updates installations. 注意: 該組策略路徑由包含在所有版本Microsoft Windows管理模板中的WindowsUpdate.admx/adml提供. 注意2: 在舊版Microsoft Windows管理模板中，此設置最初被命名為 No auto-restart for scheduled Automatic Updates installations，但從Windows 7和Server 2008 R2管理模板開始被重命名."
    compliance:
      - cis: ["18.9.108.1.1"]
      - cis_csc: ["7.3"]
      - pci_dss: ["6.2"]
      - nist_800_53: ["SI.2", "SA.11", "SI.4"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["A1.2", "CC6.8"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoRebootWithLoggedOnUsers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoRebootWithLoggedOnUsers -> 0'

  - id: 15889
    title: "確保“配置自動更新”設定為“啟用”。"
    description: '此政策設定指定您環境中的電腦是否將從 Windows Update 或 WSUS 接收安全更新。如果將此原則設定配置為“啟用”，作業系統將識別網路連線何時可用，然後使用網路連線搜尋 Windows 更新或指定的 Intranet 網站以取得適用於它們的更新。將此策略設定配置為「啟用」後，在「設定自動更新屬性」對話方塊中選擇以下三個選項之一以指定服務的工作方式： 2 - 通知下載和自動安裝（下載任何更新之前通知） 3 - 自動下載並通知安裝（自動下載更新並在準備好安裝時通知。）（預設） 4 - 自動下載並安排安裝（自動下載更新並按照下面指定的時間表安裝。）） 5 -允許本地管理員選擇設定（將上述選擇的決定權留給本機管理員（不建議））此設定的建議狀態為：啟用。注意：子設定「配置自動更新：」有 4 個可能的值 - 所有這些值都有效，具體取決於特定的組織需求，但如果可行，我們建議使用值 4 - 自動下載並安排安裝。此建議不是評分要求。注意#2：使用第 3 方解決方案進行修補的組織可以選擇免除此建議，而是將其配置為“停用”，以便本機 Windows 更新機制不會幹擾第 3 方修補過程。'
    rationale: "儘管每個版本的Windows在發布前都經過了徹底的測試，但在產品發貨後仍有可能發現問題。配置自動更新設定可以幫助您確保環境中的電腦始終安裝最新的關鍵作業系統更新和服務包。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為「啟用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage end user experience\\Configure Automatic Updates。注意：該組策略路徑由組策略模板WindowsUpdate.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.108.2.1"]
      - cis_csc: ["7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoUpdate'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoUpdate -> 0'

  - id: 15890
    title: "確保“配置自動更新：計劃安裝日”設定為“0 - 每天”。"
    description: "此政策設定指定環境中的電腦何時從 Windows Update 或 WSUS 接收安全性更新。此設定的建議狀態是：0 - 每天。注意：只有在建議「設定自動更新」中選擇 4 - 自動下載並排程安裝時，此設定才適用。如果選擇任何其他選項，則不會產生任何影響。"
    rationale: "儘管每個版本的Windows在發布前都經過了徹底的測試，但在產品發貨後仍有可能發現問題。配置自動更新設定可以幫助您確保環境中的電腦始終安裝最新的關鍵作業系統更新和服務包。"
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為0 - 每天: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage end user experience\\Configure Automatic Updates: Scheduled install day. 注意: 此組策略路徑由組策略模板WindowsUpdate.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.108.2.2"]
      - cis_csc: ["7.3"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoUpdate -> 4'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> ScheduledInstallDay -> 0'

  - id: 15891
    title: 確保「Remove access to 'Pause updates' feature」設定為「啟用」
    description: '此策略刪除了對「暫停更新」功能的存取。此設定的建議狀態為：已啟用。'
    rationale: "為了確保安全性和系統更新的應用，系統管理員應控制何時對系統套用更新。"
    remediation: "若要通過 GP 設置建議的配置，將以下 UI 路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage end user experience\\Remove access to \"Pause updates\" feature。注意：此群組原則路徑可能預設不存在。它由包含在 Microsoft Windows 10 Release 1809 & Server 2019 Administrative Templates (或更新版本) 中的群組原則範本 WindowsUpdate.admx/adml 提供。"
    compliance:
      - cis: ["18.9.108.2.3"]
      - cis_csc: ["7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> SetDisablePauseUXAccess'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> SetDisablePauseUXAccess -> 1'

  - id: 15892
    title: "確保「管理預覽版本」設定為「停用」。"
    description: "此策略設定管理在發布更新之前接收哪些更新。開發頻道：非常適合高技術用戶。開發管道中的內部人員將從我們活躍的開發分支接收開發週期中最早的版本。這些版本與特定的 Windows 10 版本不符。 Beta 頻道：非常適合想要了解即將推出的 Windows 10 功能的功能探索者。您的回饋在這裡尤其重要，因為它將幫助我們的工程師確保在主要版本發布之前解決關鍵問題。發布預覽頻道（預設）：發布預覽頻道中的內部人員可以在即將發布的 Windows 10 發佈到全世界之前存取該版本。這些版本由 Microsoft 支援。我們建議公司在組織內廣泛部署之前，透過發布預覽頻道預覽和驗證即將發布的 Windows 10 版本。此設定的建議狀態是：停用。注意：預覽版本註冊需要遙測等級設定為 2 或更高，並且您的網域在 insider.windows.com 上註冊。有關預覽版本的更多資訊，請參閱：https://aka.ms/wipforbiz"
    rationale: "在企業管理的環境中允許實驗性功能可能存在風險，因為這可能會為系統帶來錯誤和安全漏洞，使攻擊者更容易獲得存取權限。通常最好只使用生產就緒的版本。"
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設定為「停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage updates offered from Windows Update\\Manage preview builds。注意：此群組政策路徑預設可能不存在。它是由群組政策範本 WindowsUpdate.admx/adml 提供，此範本包含在 Microsoft Windows 10 Release 1709 管理範本（或更新版本)中。"
    compliance:
      - cis: ["18.9.108.4.1"]
      - cis_csc: ["2.5"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate'
      - 'not r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> ManagePreviewBuildsPolicyValue'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> ManagePreviewBuildsPolicyValue -> 1'

  - id: 15893
    title: "確保「收到預覽版本和功能更新時選擇」設定為「啟用：180 天或更多天」。"
    description: '此策略設定決定何時接收預覽版本或功能更新。延遲更新 這使裝置能夠將您的頻道可用的下一個功能更新推遲最多 14 天（對於所有預發布頻道）和最多 365 天（對於半年頻道）。或者，如果裝置正在從半年頻道進行更新，則可以指定裝置要移至和/或保留的版本，直到政策更新或裝置達到服務終止為止。注意：如果您設定了這兩個策略，則指定的版本將優先，並且延遲將不會生效。請參閱 Windows 版本資訊頁面以了解作業系統版本資訊。暫停更新 若要防止按計劃時間收到功能更新，您可以暫時暫停功能更新。暫停將在指定開始日期後 35 天內有效，或直到清除該欄位為止（仍將提供品質更新）。注意：如果「允許診斷資料」（以前稱為「允許遙測」）策略設定為 0，則此策略將無效。注意#2：從 Windows 10 R1607 開始，Microsoft 引入了一種名為「雙重掃描」的新 Windows 更新 (WU) 用戶端行為，著眼於基於雲端的更新管理。在某些情況下，此雙重掃描功能可能會幹擾來自 Windows Server 更新服務 (WSUS) 的 Windows 更新和/或手動 WU 更新。如果您在環境中使用 WSUS，則可能需要將上述設定設為「未設定」或設定「不允許更新延遲策略導致對 Windows 更新進行掃描」（在 Windows 10 版本 1709 管理範本中新增），以便防止雙重掃描功能幹擾。有關雙重掃描的更多資訊，請存取以下鏈接： - 揭秘“雙重掃描” - WSUS 產品團隊博客- 改進1607 上的雙重掃描- WSUS 產品團隊博客注意#3：在Windows 10 R1703 之前，無法識別超過180天的值由作業系統。從 Windows 10 R1703 開始，您可以延遲的最大天數為 365 天。'
    rationale: "在生產環境中，最好只使用經過嚴格測試的公開可用的軟體和功能。"
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為啟用：180天或更長時間：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage updates offered from Windows Update\\Windows Update for Business\\Select when Preview Builds and Feature Updates are received。注意：此群組策略路徑可能預設不存在。它由群組策略模板WindowsUpdate.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (或更新版本) 中。注意#2：在較舊的Microsoft Windows管理模板中，此設置最初被命名為Select when Feature Updates are received，但從Windows 10 Release 1709 Administrative Templates開始，它被重命名為Select when Preview Builds and Feature Updates are received。"
    compliance:
      - cis: ["18.9.108.4.2"]
      - cis_csc: ["2.5", "7.3"]
      - pci_dss: ["4.1"]
      - hipaa: ["164.312.a.2.IV", "164.312.e.1", "164.312.e.2.I", "164.312.e.2.II"]
      - nist_800_53: ["SC.8"]
      - tsc: ["CC6.1", "CC6.7", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferFeatureUpdates'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferFeatureUpdates -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> n:^(\d+) compare >= 180'

  - id: 15894
    title: "確保「選擇何時收到品質更新」設定為「啟用：0 天」。"
    description: '此設定控制何時接收品質更新。此設定的建議狀態為：啟用：0 天。注意：如果「允許診斷資料」（以前稱為「允許遙測」）策略設定為 0，則此策略將無效。注意#2：從 Windows 10 R1607 開始，Microsoft 引入了一種名為「雙重掃描」的新 Windows 更新 (WU) 用戶端行為，著眼於基於雲端的更新管理。在某些情況下，此雙重掃描功能可能會幹擾來自 Windows Server 更新服務 (WSUS) 的 Windows 更新和/或手動 WU 更新。如果您在環境中使用 WSUS，則可能需要將上述設定設為「未設定」或設定「不允許更新延遲策略導致對 Windows 更新進行掃描」（在 Windows 10 版本 1709 管理範本中新增），以便防止雙重掃描功能幹擾。有關雙重掃描的更多資訊，請存取以下鏈接： - 揭秘“雙重掃描” - WSUS 產品團隊博客 - 改進 1607 上的雙重掃描 - WSUS 產品團隊博客'
    rationale: "品質更新可能包含重要的錯誤修復和/或安全更新檔，應盡快安裝。"
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為已啟用：0 天：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Windows Update for Business\\Select when Quality Updates are received 注意：此群組原則路徑預設不存在。需要更新的群組原則範本 (WindowsUpdate.admx/adml) - 包含於 Microsoft Windows 10 Release 1607 & Server 2016 管理範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.108.4.3"]
      - cis_csc: ["7.3"]
      - pci_dss: ["6.2"]
      - nist_800_53: ["SI.2", "SA.11", "SI.4"]
      - gpg_13: ["4.3"]
      - gdpr_IV: ["35.7.d"]
      - hipaa: ["164.312.b"]
      - tsc: ["A1.2", "CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferQualityUpdates -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferQualityUpdatesPeriodInDays -> 0'
