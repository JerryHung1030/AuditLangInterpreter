# Security Configuration Assessment
# CIS Checks for Windows 2016
# Copyright (C) 2015, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# Center for Internet Security Benchmark for Microsoft Windows Server 2016 v2.0.0 - 04-14-2023

policy:
  id: "cis_win2016"
  file: "cis_win2016.yml"
  name: "CIS Microsoft Windows Server 2016 v2.0.0"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for Microsoft Windows Server 2016."
  disclaimer: "Please note that the rules provide accurate results for Windows Server 2016 Operating Systems with the System language set to English. The SCA policy will work with other languages but the results will be less accurate due to some of the rules that depend on the System language."
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check that the Windows platform is Windows Server 2016"
  description: "Requirements for running the CIS benchmark under Windows Server 2016"
  condition: all
  rules:
    - 'r:HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion -> ProductName -> r:^Windows Server 2016'

checks:
  ###############################################
  # 1 Account Policies
  ###############################################
  # 1.1 Password Policy
  ###############################################
  # 1.1.1 (L1) Ensure 'Enforce password history' is set to '24 or more password(s)'. (Automated) - Not Implemented

  # 1.1.2 (L1) Ensure 'Maximum password age' is set to '365 or fewer days, but not 0'. (Automated)
  - id: 16000
    title: "確保“密碼最長期限”設定為“365 天或更少，但不是 0”。"
    description: "此原則設定定義使用者在密碼過期之前可以使用其密碼的時間。此策略設定的值範圍為 0 到 999 天。如果將該值設為 0，則密碼永遠不會過期。由於攻擊者可以破解密碼，因此更改密碼的頻率越高，攻擊者使用破解密碼的機會就越少。但是，該值設定得越低，由於使用者必須更改密碼或忘記當前密碼，因此向幫助台支援呼叫增加的可能性就越大。此設定的建議狀態為 365 天或更少，但不是 0。作為其預設行為。如果在另一個 GPO 中配置這些設置，它們只會影響接收該 GPO 的電腦上的本機使用者帳戶。但是，可以使用密碼設定物件(PSO) 定義特定網域使用者和/或群組的預設密碼原則和帳戶鎖定原則規則的自訂例外，這些物件與群組原則完全獨立，並且最容易使用Active Directory 管理中心進行配置。"
    rationale: "密碼存在的時間越長，受到暴力攻擊、攻擊者獲得有關用戶的一般知識或用戶共享密碼的破壞的可能性就越大。將密碼最長期限設定配置為 0，以便使用者永遠不需要更改其密碼，這是一個主要的安全風險，因為只要有效使用者俱有授權存取權限，惡意使用者就可以使用受損的密碼。"
    impact: "If the Maximum password age setting is too low, users are required to change their passwords very often. Such a configuration can reduce security in the organization, because users might write their passwords in an insecure location or lose them. If the value for this policy setting is too high, the level of security within an organization is reduced because it allows potential attackers more time in which to discover user passwords or to use compromised accounts."
    remediation: "要通過GP設立推薦配置，將以下UI路徑設置為365天或更少，但不能為0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Maximum password age."
    references:
      - "https://www.cisecurity.org/white-papers/cis-password-policy-guide/"
    compliance:
      - cis: ["1.1.2"]
      - cis_csc_v8: ["5.2"]
      - cis_csc_v7: ["16.10"]
      - cmmc_v2.0: ["IA.L2-3.5.7"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge -> 0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge -> n:^(\d+) compare <= 365'

  # 1.1.3 (L1) Ensure 'Minimum password age' is set to '1 or more day(s)'. (Automated) - Not Implemented
  # 1.1.4 (L1) Ensure 'Minimum password length' is set to '14 or more character(s)'. (Automated) - Not Implemented
  # 1.1.5 (L1) Ensure 'Password must meet complexity requirements' is set to 'Enabled'. (Automated) - Not Implemented
  # 1.1.6 (L1) Ensure 'Store passwords using reversible encryption' is set to 'Disabled'. (Automated) - Not Implemented
  ##############################################
  # 1.2 Account Lockout Policy
  ##############################################
  # 1.2.1 (L1) Ensure 'Account lockout duration' is set to '15 or more minute(s)'. (Automated) - Not Implemented
  # 1.2.2 (L1) Ensure 'Account lockout threshold' is set to '5 or fewer invalid logon attempt(s), but not 0'. (Automated) - Not Implemented
  # 1.2.3 (L1) Ensure 'Allow Administrator account lockout' is set to 'Enabled'. (Manual) - Not Implemented
  # 1.2.4 (L1) Ensure 'Reset account lockout counter after' is set to '15 or more minute(s)'. (Automated) - Not Implemented
  #################################
  # 2 Local Policies
  #################################
  # 2.1 Audit Policy
  #################################
  # 2.2 User Rights Assignment
  #################################
  # 2.2.1 (L1) Ensure 'Access Credential Manager as a trusted caller' is set to 'No One'. (Automated) - Not Implemented
  # 2.2.2 (L1) Ensure 'Access this computer from the network' is set to 'Administrators, Authenticated Users, ENTERPRISE DOMAIN CONTROLLERS' (DC only). (Automated) - Not Implemented
  # 2.2.3 (L1) Ensure 'Access this computer from the network' is set to 'Administrators, Authenticated Users' (MS only). (Automated) - Not Implemented
  # 2.2.4 (L1) Ensure 'Act as part of the operating system' is set to 'No One'. (Automated) - Not Implemented
  # 2.2.5 (L1) Ensure 'Add workstations to domain' is set to 'Administrators' (DC only). (Automated) - Not Implemented
  # 2.2.6 (L1) Ensure 'Adjust memory quotas for a process' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE'. (Automated) - Not Implemented
  # 2.2.7 (L1) Ensure 'Allow log on locally' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.8 (L1) Ensure 'Allow log on through Remote Desktop Services' is set to 'Administrators' (DC only). (Automated) - Not Implemented
  # 2.2.9 (L1) Ensure 'Allow log on through Remote Desktop Services' is set to 'Administrators, Remote Desktop Users' (MS only). (Automated) - Not Implemented
  # 2.2.10 (L1) Ensure 'Back up files and directories' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.11 (L1) Ensure 'Change the system time' is set to 'Administrators, LOCAL SERVICE'. (Automated) - Not Implemented
  # 2.2.12 (L1) Ensure 'Change the time zone' is set to 'Administrators, LOCAL SERVICE'. (Automated) - Not Implemented
  # 2.2.13 (L1) Ensure 'Create a pagefile' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.14 (L1) Ensure 'Create a token object' is set to 'No One'. (Automated) - Not Implemented
  # 2.2.15 (L1) Ensure 'Create global objects' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE'. (Automated) - Not Implemented
  # 2.2.16 (L1) Ensure 'Create permanent shared objects' is set to 'No One'. (Automated) - Not Implemented
  # 2.2.17 (L1) Ensure 'Create symbolic links' is set to 'Administrators' (DC only). (Automated) - Not Implemented
  # 2.2.18 (L1) Ensure 'Create symbolic links' is set to 'Administrators, NT VIRTUAL MACHINE\Virtual Machines' (MS only). (Automated) - Not Implemented
  # 2.2.19 (L1) Ensure 'Debug programs' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.20 (L1) Ensure 'Deny access to this computer from the network' to include 'Guests' (DC only). (Automated) - Not Implemented
  # 2.2.21 (L1) Ensure 'Deny access to this computer from the network' to include 'Guests, Local account and member of Administrators group' (MS only). (Automated) - Not Implemented
  # 2.2.22 (L1) Ensure 'Deny log on as a batch job' to include 'Guests'. (Automated) - Not Implemented
  # 2.2.23 (L1) Ensure 'Deny log on as a service' to include 'Guests'. (Automated) - Not Implemented
  # 2.2.24 (L1) Ensure 'Deny log on locally' to include 'Guests'. (Automated) - Not Implemented
  # 2.2.25 (L1) Ensure 'Deny log on through Remote Desktop Services' to include 'Guests' (DC only). (Automated) - Not Implemented
  # 2.2.26 (L1) Ensure 'Deny log on through Remote Desktop Services' is set to 'Guests, Local account' (MS only). (Automated) - Not Implemented
  # 2.2.27 (L1) Ensure 'Enable computer and user accounts to be trusted for delegation' is set to 'Administrators' (DC only). (Automated) - Not Implemented
  # 2.2.28 (L1) Ensure 'Enable computer and user accounts to be trusted for delegation' is set to 'No One' (MS only). (Automated) - Not Implemented
  # 2.2.29 (L1) Ensure 'Force shutdown from a remote system' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.30 (L1) Ensure 'Generate security audits' is set to 'LOCAL SERVICE, NETWORK SERVICE'. (Automated) - Not Implemented
  # 2.2.31 (L1) Ensure 'Impersonate a client after authentication' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE' (DC only). (Automated) - Not Implemented
  # 2.2.33 (L1) Ensure 'Increase scheduling priority' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.34 (L1) Ensure 'Load and unload device drivers' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.35 (L1) Ensure 'Lock pages in memory' is set to 'No One'. (Automated) - Not Implemented
  # 2.2.36 (L2) Ensure 'Log on as a batch job' is set to 'Administrators' (DC Only). (Automated) - Not Implemented
  # 2.2.38 (L1) Ensure 'Manage auditing and security log' is set to 'Administrators' (MS only). (Automated) - Not Implemented
  # 2.2.39 (L1) Ensure 'Modify an object label' is set to 'No One'. (Automated) - Not Implemented
  # 2.2.40 (L1) Ensure 'Modify firmware environment values' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.41 (L1) Ensure 'Perform volume maintenance tasks' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.42 (L1) Ensure 'Profile single process' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.43 (L1) Ensure 'Profile system performance' is set to 'Administrators, NT SERVICE\WdiServiceHost'. (Automated) - Not Implemented
  # 2.2.44 (L1) Ensure 'Replace a process level token' is set to 'LOCAL SERVICE, NETWORK SERVICE'. (Automated) - Not Implemented
  # 2.2.45 (L1) Ensure 'Restore files and directories' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.46 (L1) Ensure 'Shut down the system' is set to 'Administrators'. (Automated) - Not Implemented
  # 2.2.47 (L1) Ensure 'Synchronize directory service data' is set to 'No One' (DC only). (Automated) - Not Implemented
  # 2.2.48 (L1) Ensure 'Take ownership of files or other objects' is set to 'Administrators'. (Automated) - Not Implemented

  #######################################
  # 2.3 Security Options
  #######################################
  # 2.3.1 Accounts
  #######################################
  # 2.3.1.1 (L1) Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'. (Automated)
  - id: 16001
    title: "確保「帳戶：封鎖 Microsoft 帳戶」設定為「使用者無法新增或使用 Microsoft 帳戶登入」。"
    description: "此策略設定阻止使用者在此電腦上新增新的 Microsoft 帳戶。此設定的建議狀態為：使用者無法新增或使用 Microsoft 帳戶登入。"
    rationale: "想要有效實施身分識別管理策略並嚴格控制用於登入其電腦的帳戶的組織可能會希望阻止 Microsoft 帳戶。組織可能還需要封鎖 Microsoft 帳戶，以滿足適用於其資訊系統的合規性標準的要求。"
    impact: "Users will not be able to log onto the computer with their Microsoft account."
    remediation: "若要透過 GP 設定建議配置，請將以下 UI 路徑設置為 Users can't add or log on with Microsoft accounts：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Block Microsoft accounts."
    compliance:
      - cis: ["2.3.1.1"]
      - cis_csc_v7: ["16.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> NoConnectedUser'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> NoConnectedUser -> 3'

  # 2.3.1.2 (L1) Ensure 'Accounts: Guest account status' is set to 'Disabled' (MS only). (Automated)
  - id: 16002
    title: "確保「帳戶：來賓帳戶狀態」設定為「停用」（僅限 MS）。"
    description: "此政策設定決定是啟用還是停用來賓帳戶。來賓帳戶允許未經身份驗證的網路使用者存取系統。此設定的建議狀態是：停用。注意：當透過群組原則套用於網域控制器組織單位時，此設定不會產生任何影響，因為網域控制站沒有本機帳戶資料庫。它可以透過群組原則在網域層級進行配置，類似於帳戶鎖定和密碼原則設定。"
    rationale: "預設來賓帳戶允許未經身份驗證的網路使用者以來賓身份登入，無需密碼。這些未經授權的使用者可以透過網路存取來賓帳戶可存取的任何資源。此功能意味著任何具有允許存取來賓帳戶、來賓群組或所有人群組權限的網路共享都可以透過網路進行存取，這可能會導致資料外洩或損壞。"
    impact: "All network users will need to authenticate before they can access shared resources. If you disable the Guest account and the Network Access: Sharing and Security Model option is set to Guest Only, network logons, such as those performed by the Microsoft Network Server (SMB Service), will fail. This policy setting should have little impact on most organizations because it is the default setting in Microsoft Windows 2000, Windows XP, and Windows Server™ 2003."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Guest account status."
    compliance:
     - cis: ["2.3.1.2"]
     - cis_csc_v8: ["4.7"]
     - cis_csc_v7: ["16.8"]
     - iso_27001-2013: ["A.9.2.1"]
     - pci_dss_v3.2.1: ["2.1", "2.1.1"]
     - pci_dss_v4.0: ["2.2.2", "2.3.1"]
     - soc_2: ["CC6.3"]
    condition: any
    rules:
      - 'c:net user guest -> r:Account active\s+No'
      - 'c:net user guest -> r:The user name could not be found.'

  # 2.3.1.3 (L1) Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'. (Automated)
  - id: 16003
    title: "確保「帳戶：限製本機帳戶僅使用空白密碼進行控制台登入」設定為「啟用」。"
    description: "此政策設定決定是否可以使用不受密碼保護的本機帳戶從實體電腦控制台以外的位置登入。如果啟用此政策設置，密碼為空的本機帳戶將無法從遠端用戶端電腦登入網路。此類帳戶只能透過電腦鍵盤登入。此設定的建議狀態為：已啟用。"
    rationale: "空白密碼對電腦安全構成嚴重威脅，應透過組織政策和適當的技術措施來禁止。事實上，Active Directory 網域的預設設定需要至少七個字元的複雜密碼。但是，如果能夠建立新帳戶的使用者繞過基於網域的密碼策略，他們可能會建立具有空白密碼的帳戶。例如，使用者可以建立一台獨立計算機，建立一個或多個密碼為空的帳戶，然後將該計算機加入網域。密碼為空的本機帳戶仍然可以使用。任何知道這些不受保護的帳戶之一的名稱的人都可以使用它進行登入。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦的配置，將以下用戶界面路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Accounts: Limit local account use of blank passwords to console logon only."
    compliance:
      - cis: ["2.3.1.3"]
      - cis_csc_v8: ["5.2"]
      - cis_csc_v7: ["4.4"]
      - cmmc_v2.0: ["IA.L2-3.5.7"]
      - iso_27001-2013: ["A.9.4.3"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LimitBlankPasswordUse'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LimitBlankPasswordUse -> 1'

  # 2.3.1.4 (L1) Configure 'Accounts: Rename administrator account'. (Automated) - Not Implemented
  # 2.3.1.5 (L1) Configure 'Accounts: Rename guest account'. (Automated) - Not Implemented
  #############################
  # 2.3.2 Audit
  #############################
  # 2.3.2.1 (L1) Ensure 'Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings' is set to 'Enabled' (Automated)
  - id: 16004
    title: "確保「審核：強制審核原則子類別設定（Windows Vista 或更高版本）覆蓋審核原則類別設定」設定為「啟用」。"
    description: "此政策設定允許管理員啟用 Windows Vista 中提供的更精確的審核功能。 Windows Server 2003 Active Directory 中可用的稽核原則設定尚不包含用於管理新稽核子類別的設定。為了正確應用此基準中規定的審核策略，審核：強制審核原則子類別設定（Windows Vista 或更高版本）覆蓋審核原則類別設定設定需要設定為啟用。此設定的建議狀態為：已啟用。重要提示：對於可能產生大量流量的審核設定要非常謹慎。例如，如果您對所有權限使用子類別啟用成功或失敗審核，則產生的大量審核事件可能會導致很難在安全性日誌中找到其他類型的項目。這種配置也可能對系統效能產生重大影響。"
    rationale: "在 Windows Vista 中引入審核子類別之前，很難在每個系統或每個使用者層級追蹤事件。較大的事件類別產生了太多的事件，需要審計的關鍵資訊很難找到。"
    impact: None - this is the default behavior.
    remediation: "為了通過GP建立建議的配置，請將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings."
    references:
      - "https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing#to-ensure-that-advanced-audit-policy-configuration-settings-are-not-overwritten"
    compliance:
      - cis: ["2.3.2.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.2", "6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_4.0: ["9.4.5", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> SCENoApplyLegacyAuditPolicy'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> SCENoApplyLegacyAuditPolicy -> 1'

  # 2.3.2.2 (L1) Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'. (Automated)
  - id: 16005
    title: "確保「審核：如果無法記錄安全審核，則立即關閉系統」設定為「停用」。"
    description: "此策略設定確定系統在無法記錄安全事件時是否關閉。可信任電腦系統評估標準 (TCSEC)-C2 和通用標準認證要求在審核系統無法記錄可審核事件的情況下防止可審核事件發生。 Microsoft 選擇透過在審核系統發生故障時停止系統並顯示停止訊息來滿足此要求。啟用此政策設定後，如果因任何原因無法記錄安全審核，系統將關閉。如果啟用審核：如果無法記錄安全審核，則立即關閉系統設置，則可能會發生意外的系統故障。管理負擔可能會很大，特別是如果您還將安全日誌的保留方法配置為「不覆蓋事件」（手動清除日誌）。此配置會導致否認威脅（備份操作員可能否認他們備份或恢復資料）成為拒絕服務 (DoS) 漏洞，因為如果伺服器因登入事件和其他安全問題而不堪重負，則可能會被迫關閉寫入安全性日誌的事件。此外，由於關閉不正常，可能會對作業系統、應用程式或資料造成不可挽回的損壞。儘管 NTFS 檔案系統在電腦非正常關機時保證其完整性，但它不能保證每個應用程式的每個資料檔案在電腦重新啟動時仍處於可用形式。此設定的建議狀態是：停用。"
    rationale: "如果電腦無法將事件記錄到安全性日誌中，則在發生安全事件後可能無法查看關鍵證據或重要的故障排除資訊。此外，攻擊者可能會產生大量安全性日誌事件來故意強制電腦關閉。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立建議的配置，請將以下使用者介面路徑設置為 Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Audit: Shut down system immediately if unable to log security audits."
    compliance:
      - cis: ["2.3.2.2"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> CrashOnAuditFail'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> CrashOnAuditFail -> 0'

  ###########################
  # 2.3.3 DCOM
  ###########################
  # 2.3.4 Devices
  ###########################
  # 2.3.4.1 (L1) Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators'. (Automated)
  - id: 16006
    title: "確保“設備：允許格式化和彈出可移動媒體”設定為“管理員”。"
    description: "此策略設定決定允許誰格式化和彈出可移動 NTFS 媒體。您可以使用此策略設定來防止未經授權的使用者刪除一台電腦上的資料，以便在他們擁有本機管理員權限的另一台電腦上存取該資料。此設定的建議狀態為：管理員。"
    rationale: "使用者可以將可移動磁碟上的資料移到他們具有管理權限的另一台電腦上。然後，使用者可以取得任何檔案的所有權，授予自己完全控制權，並檢視或修改任何檔案。大多數可移動儲存裝置將透過按機械按鈕彈出媒體，這一事實削弱了此策略設定的優勢。"
    impact: "None - this is the default behavior."
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設定為 Administrators：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Devices: Allowed to format and eject removable media."
    compliance:
      - cis: ["2.3.4.1"]
      - cis_csc_v7: ["13.7"]
      - iso_27001-2013: ["A.8.3.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> AllocateDASD'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> AllocateDASD -> 0'

  # 2.3.4.2 (L1) Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'. (Automated)
  - id: 16007
    title: "確保「裝置：阻止使用者安裝印表機驅動程式」設定為「啟用」。"
    description: "若要讓電腦列印到共用印表機，必須在本機電腦上安裝此共用印表機的驅動程式。此安全性設定決定誰可以在連接到共用印表機時安裝印表機驅動程式。此設定的建議狀態為：已啟用。注意：此設定不會影響新增本機印表機的功能。此設定不會影響管理員。"
    rationale: "在某些組織中，允許使用者在自己的工作站上安裝印表機驅動程式可能是合適的。但是，您應該只允許管理員而不是使用者在伺服器上執行此操作，因為在伺服器上安裝印表機驅動程式可能會無意中導致電腦變得不太穩定。惡意使用者可能會故意安裝不適當的印表機驅動程式來損壞計算機，或者使用者可能會意外安裝偽裝成印表機驅動程式的惡意軟體。攻擊者可以將特洛伊木馬程式偽裝成印表機驅動程式。該程式可能對使用者來說似乎必須使用它來列印，但這樣的程式可能會在您的電腦網路上釋放惡意程式碼。"
    impact: "None - this is the default behavior."
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Devices: Prevent users from installing printer drivers."
    compliance:
      - cis: ["2.3.4.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers -> AddPrinterDrivers'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers -> AddPrinterDrivers -> 1'

  ###########################
  # 2.3.5 Domain controller
  ###########################
  # 2.3.5.1 (L1) Ensure 'Domain controller: Allow server operators to schedule tasks' is set to 'Disabled' (DC only). (Automated)
  - id: 16008
    title: "確保「網域控制器：允許伺服器操作員排程任務」設定為「停用」（僅限 DC）。"
    description: "此策略設定決定是否允許伺服器操作員群組的成員透過 AT 計畫工具提交作業。對於大多數組織來說，此策略設定配置的影響應該很小。使用者（包括伺服器操作員群組中的使用者）仍然能夠透過任務規劃程式精靈建立作業，但這些作業將在使用者設定作業時進行驗證的帳戶上下文中執行。注意：可以修改 AT 服務帳戶以選擇其他帳戶而非本機系統帳戶。若要變更帳戶，請開啟“系統工具”，按一下“排程任務”，然後按一下“附件資料夾”。然後點選「進階」功能表上的「AT 服務帳戶」。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，伺服器操作員透過 AT 服務建立的作業將在執行該服務的帳戶的上下文中執行。預設情況下，這是本機系統帳戶。如果啟用此策略設置，伺服器操作員可以執行 SYSTEM 能夠執行但他們通常無法執行的任務，例如將其帳戶新增至本機管理員群組。"
    impact: "None - this is the default behavior. Note that users (including those in the Server Operators group) are still able to create jobs by means of the Task Scheduler Wizard. However, those jobs will run in the context of the account that the user authenticates with when setting up the job."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為已禁用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: Allow server operators to schedule tasks."
    compliance:
      - cis: ["2.3.5.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> SubmitControl'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> SubmitControl -> 0'

  # 2.3.5.2 (L1) Ensure 'Domain controller: Allow vulnerable Netlogon secure channel connections' is set to 'Not Configured' (DC Only). (Automated)
  - id: 16009
    title: "確保「網域控制站：允許易受攻擊的 Netlogon 安全通道連線」設定為「未設定」（僅限 DC）。"
    description: "此安全性設定決定網域控制站是否繞過指定電腦帳戶的 Netlogon 安全通道連線的安全 RPC。部署後，應透過在網域控制站 OU 上啟用該策略，將該原則套用至林中的所有網域控制站。設定「建立易受攻擊的連線」清單（允許清單）後： - 給予允許權限，網域控制站將允許帳號使用 Netlogon 安全通道，而無需安全 RPC。 - 給予拒絕權限，網域控制站將要求帳戶使用具有安全性 RPC 的 Netlogon 安全通道，這與預設值相同（不是必需的）。注意：來自 Microsoft 的警告 - 啟用此策略將暴露您加入網域的設備，並可能使您的 Active Directory 林面臨風險。在部署更新時，應將此策略用作第三方設備的臨時措施。一旦第 3 方裝置更新為支援使用具有 Netlogon 安全通道的安全性 RPC，該帳戶應從「建立易受攻擊的連線」清單中刪除。為了更了解設定帳戶以允許使用易受攻擊的 Netlogon 安全通道連線的風險，請存取如何管理與 CVE-2020-1472 相關的 Netlogon 安全通道連線的變更。此設定的建議狀態為：未配置。"
    rationale: "啟用此原則將暴露您加入網域的設備，並可能使您的 Active Directory 林面臨安全性風險。強烈建議不要使用此設定（即完全未配置），以免增加風險。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設為未配置：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: Allow vulnerable Netlogon secure channel connections."
    references:
      - "https://go.microsoft.com/fwlink/?linkid=2133485"
    compliance:
      - cis: ["2.3.5.2"]
    condition: none
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters -> VulnerableChannelAllowList'

  # 2.3.5.3 (L1) Ensure 'Domain controller: LDAP server channel binding token requirements' is set to 'Always' (DC Only). (Automated)
  - id: 16010
    title: "確保「網域控制站：LDAP 伺服器通道綁定令牌要求」設定為「始終」（僅限 DC）。"
    description: "此設定決定 LDAP 伺服器（網域控制站）是否強制驗證透過 SSL/TLS（即 LDAPS）傳送的 LDAP 綁定請求中接收的通道綁定令牌 (CBT)。此設定的建議狀態是：始終。注意：所有 LDAP 用戶端必須具有 CVC-2017-8563 安全性更新才能與啟用此設定的網域控制站相容。有關此設定的更多資訊，請存取：MSKB 4520412：2020 Windows 的 LDAP 通道綁定和 LDAP 簽章要求。"
    rationale: 'Requiring Channel Binding Tokens (CBT) can prevent an attacker who is able to capture users'' authentication credentials (e.g. OAuth tokens, session identifiers, etc.) from reusing those credentials in another TLS session. This also helps to increase protection against "man-in-the-middle" attacks using LDAP authentication over SSL/TLS (LDAPS).'
    impact: "All LDAP clients must provide channel binding information over SSL/TLS (i.e. LDAPS). The LDAP server (Domain Controller) rejects authentication requests from clients that do not do so. Clients must have the CVC-2017-8563 security update to support this feature, and may have compatibility issues with this setting without the security update. This may also mean that LDAP authentication requests over SSL/TLS that previously worked may stop working until the security update is installed. When first deploying this setting, you may initially want to only set it to the alternate setting of When supported (instead of Always) on all Domain Controllers. This alternate, interim setting enables support for LDAP client channel binding but does not require it. Then set one DC that is not currently being targeted by LDAP clients to Always, and test each of the critical LDAP clients against that DC (and remediating as necessary), before deploying Always to the rest of the DCs. We also recommend using the new Event ID 3039 on your Domain Controllers (added with the March 2020 security update) to help locate clients that do not use Channel Binding Tokens (CBT) in their LDAPS connections. This new Event ID requires increasing the logging level of the 16 LDAP Interface Events portion of the NTDS service diagnostics to a value of 2 (Basic). For more information, please see Table 2: CBT events at this link: MSKB 4520412: 2020 LDAP channel binding and LDAP signing requirements for Windows Older OSes such as Windows XP, Windows Server 2003, Windows Vista and Windows Server 2008 (non-R2), will first require patches for Microsoft Security Advisory 973811, as well as all associated fixes, in order to be compatible with domain controllers that have this setting deployed. Note: Only Always is actually considered compliant to the CIS benchmark."
    remediation: "要通過群組策略建立推薦配置，將以下 UI 路徑設置為「總是」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: LDAP server channel binding token requirements 注意：此群組策略路徑需要安裝 2020 年 3 月（或之後）的 Windows 安全更新。隨著該更新，Microsoft 將此設置添加到內建的操作系統安全模板中。"
    compliance:
      - cis: ["2.3.5.3"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["16.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters -> LdapEnforceChannelBinding'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters -> LdapEnforceChannelBinding -> 2'

  # 2.3.5.4 (L1) Ensure 'Domain controller: LDAP server signing requirements' is set to 'Require signing' (DC only). (Automated)
  - id: 16011
    title: "確保「網域控制器：LDAP 伺服器簽章要求」設定為「需要簽章」（僅限 DC）。"
    description: "此政策設定決定輕型目錄存取協定 (LDAP) 伺服器是否需要 LDAP 用戶端協商資料簽章。此設定的建議狀態是：需要簽名。注意：網域成員電腦必須將網路安全：LDAP 簽章要求（規則 2.3.11.8）設定為協商簽章或更高。如果不是，一旦在網域控制站上配置了上述要求簽章值，他們將無法進行身份驗證。幸運的是，協商簽章是客戶端配置中的預設設定。注意 #2：此策略設定對 LDAP 簡單綁定 (ldap_simple_bind) 或透過 SSL 的 LDAP 簡單綁定 (ldap_simple_bind_s) 沒有任何影響。 Windows XP Professional 隨附的 Microsoft LDAP 用戶端不使用 LDAP 簡單綁定或透過 SSL 的 LDAP 簡單綁定來與網域控制站通訊。注意#3：在啟用此設定之前，您應先確保沒有用戶端（包括基於伺服器的應用程式）配置為透過未簽署的 LDAP 與 Active Directory 進行驗證，因為變更此設定將破壞這些應用程式。此類應用程式應先重新配置為使用簽署 LDAP、安全性 LDAP (LDAPS) 或 IPsec 保護的連線。有關如何確定是否透過未簽署的 LDAP 存取您的 DC（以及這些存取來自何處）的詳細資訊，請參閱此 Microsoft TechNet 部落格文章：識別明文 LDAP 綁定到您的 DC - 實用 Windows 安全性。"
    rationale: "未簽署的網路流量容易受到中間人攻擊。在此類攻擊中，入侵者捕獲伺服器和客戶端之間的資料包，修改它們，然後將它們轉發到客戶端。對於 LDAP 伺服器，攻擊者可能會導致用戶端根據 LDAP 目錄中的錯誤記錄做出決策。為了降低組織網路遭受此類入侵的風險，您可以實施強大的實體安全措施來保護網路基礎架構。此外，您還可以實施 Internet 協定安全性 (IPsec) 驗證標頭模式 (AH)，該模式對 IP 流量執行相互驗證和封包完整性，使所有類型的中間人攻擊變得極為困難。此外，允許使用常規的、未簽署的 LDAP 允許透過網路以明文形式接收憑證，這很容易導致帳戶密碼被網路上的其他系統攔截。"
    impact: "Unless TLS/SSL is being used, the LDAP data signing option must be negotiated. Clients that do not support LDAP signing will be unable to run LDAP queries against the Domain Controllers. All Windows 2000-based computers in your organization that are managed from Windows Server 2003-based or Windows XP-based computers and that use Windows NT Challenge/Response (NTLM) authentication must have Windows 2000 Service Pack 3 (SP3) installed. Alternatively, these clients must have a registry change. For information about this registry change, see Microsoft Knowledge Base article 325465: Windows 2000 domain controllers require SP3 or later when using Windows Server 2003 administration tools. Also, some non-Microsoft operating systems do not support LDAP signing. If you enable this policy setting, client computers that use those operating systems may be unable to access domain resources."
    remediation: "要透過 GP 確立建議的配置，將以下 UI 路徑設置為要求簽名：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: LDAP server signing requirements."
    compliance:
      - cis: ["2.3.5.4"]
      - cis_csc_v8: ["3.10"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters -> LDAPServerIntegrity'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters -> LDAPServerIntegrity -> 2'

  # 2.3.5.5 (L1) Ensure 'Domain controller: Refuse machine account password changes' is set to 'Disabled' (DC only). (Automated)
  - id: 16012
    title: "確保「網域控制器：拒絕電腦帳戶密碼變更」設定為「停用」（僅限 DC）。"
    description: "此安全性設定決定網域控制站是否拒絕成員電腦變更電腦帳戶密碼的請求。此設定的建議狀態是：停用。注意：電腦帳戶密碼過期可能會導致出現一些問題，特別是當電腦恢復到先前的時間點狀態時，這在虛擬機器中很常見。根據還原的時間，儲存在電腦上的舊電腦帳戶密碼可能不再被網域控制器識別，因此電腦失去了網域信任。這也可能會破壞非持續性 VDI 實施以及具有不允許對作業系統磁碟區進行永久更改的寫入過濾器的裝置。某些組織可能會選擇免除此建議，並在這些情況下停用電腦帳戶密碼過期。"
    rationale: "如果在網域中的所有網域控制站上啟用此原則設置，網域成員將無法變更其電腦帳戶密碼，並且這些密碼將更容易受到攻擊。"
    impact: "None - this is the default behavior."
    remediation: "要依據GP建立建議的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain controller: Refuse machine account password changes."
    compliance:
      - cis: ["2.3.5.5"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RefusePasswordChange'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RefusePasswordChange -> 0'

  ########################
  # 2.3.6 Domain member
  ########################
  # 2.3.6.1 (L1) Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'. (Automated)
  - id: 16013
    title: "確保「網域成員：對安全通道資料進行數位加密或簽署（始終）」設定為「啟用」。"
    description: "此政策設定決定是否必須對網域成員發起的所有安全通道流量進行簽署或加密。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    impact: "None - this is the default behavior. However, only Windows NT 4.0 with Service Pack 6a (SP6a) and subsequent versions of the Windows operating system support digital encryption and signing of the secure channel. Windows 98 Second Edition clients do not support it unless they have Dsclient installed. Therefore, you cannot enable the Domain member: Digitally encrypt or sign secure channel data (always) setting on Domain Controllers that support Windows 98 clients as members of the domain. Potential impacts can include the following: - The ability to create or delete trust relationships with clients running versions of Windows earlier than Windows NT 4.0 with SP6a will be disabled. - Logons from clients running versions of Windows earlier than Windows NT 4.0 with SP6a will be disabled. - The ability to authenticate other domains' users from a Domain Controller running a version of Windows earlier than Windows NT 4.0 with SP6a in a trusted domain will be disabled. You can enable this policy setting after you eliminate all Windows 9x clients from the domain and upgrade all Windows NT 4.0 servers and Domain Controllers from trusted/trusting domains to Windows NT 4.0 with SP6a."
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally encrypt or sign secure channel data (always)."
    compliance:
      - cis: ["2.3.6.1"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["14.4"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireSignOrSeal'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireSignOrSeal -> 1'

  # 2.3.6.2 (L1) Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'. (Automated)
  - id: 16014
    title: "確保「網域成員：對安全通道資料進行數位加密（如果可能）」設定為「啟用」。"
    description: "此政策設定決定網域成員是否應嘗試為其發起的所有安全通道流量協商加密。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    impact: "None - this is the default behavior. However, only Windows NT 4.0 Service Pack 6a (SP6a) and subsequent versions of the Windows operating system support digital encryption and signing of the secure channel. Windows 98 Second Edition clients do not support it unless they have Dsclient installed."
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設定為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally encrypt secure channel data (when possible)."
    compliance:
      - cis: ["2.3.6.2"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["14.4"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SealSecureChannel'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SealSecureChannel -> 1'

  # 2.3.6.3 (L1) Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'. (Automated)
  - id: 16015
    title: "確保「網域成員：對安全通道資料進行數位簽章（如果可能）」設定為「啟用」。"
    description: "此政策設定決定網域成員是否應嘗試協商其發起的所有安全通道流量是否必須進行數位簽章。數位簽章可保護流量不被任何在網路中擷取資料的人修改。此設定的建議狀態為：已啟用。"
    rationale: "當電腦加入網域時，就會建立一個電腦帳戶。加入網域後，電腦每次重新啟動時都會使用該帳戶的密碼為其網域建立與網域控制站的安全通道。在安全通道上發送的請求經過身份驗證，密碼等敏感資訊經過加密，但通道未經過完整性檢查，並且並非所有資訊都經過加密。在支援的情況下，安全通道的數位加密和簽名是一個好主意。當網域憑證傳送到網域控制站時，安全通道會對其進行保護。"
    impact: "None - this is the default behavior. However, only Windows NT 4.0 with Service Pack 6a (SP6a) and subsequent versions of the Windows operating system support digital encryption and signing of the secure channel. Windows 98 Second Edition clients do not support it unless they have Dsclient installed."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Digitally sign secure channel data (when possible)."
    compliance:
      - cis: ["2.3.6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SignSecureChannel'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> SignSecureChannel -> 1'

  # 2.3.6.4 (L1) Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'. (Automated)
  - id: 16016
    title: "確保「網域成員：停用電腦帳戶密碼變更」設定為「停用」。"
    description: "此原則設定確定網域成員是否可以定期變更其電腦帳戶密碼。無法自動變更其帳戶密碼的電腦可能容易受到攻擊，因為攻擊者可能能夠確定系統網域帳戶的密碼。此設定的建議狀態是：停用。注意：電腦帳戶密碼過期可能會導致出現一些問題，特別是當電腦恢復到先前的時間點狀態時，這在虛擬機器中很常見。根據還原的時間，儲存在電腦上的舊電腦帳戶密碼可能不再被網域控制器識別，因此電腦失去了網域信任。這也可能會破壞非持續性 VDI 實施以及具有不允許對作業系統磁碟區進行永久更改的寫入過濾器的裝置。某些組織可能會選擇免除此建議，並在這些情況下停用電腦帳戶密碼過期。"
    rationale: "屬於某個網域的基於 Windows Server 2003 的電腦的預設設定是自動要求它們每 30 天變更其帳戶的密碼。如果停用此原則設置，執行 Windows Server 2003 的電腦將保留與其電腦帳戶相同的密碼。不再能夠自動更改其帳戶密碼的電腦面臨來自攻擊者的風險，攻擊者可以確定電腦網域帳戶的密碼。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立推薦配置，將以下 UI 路徑設置為停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Disable machine account password changes."
    compliance:
      - cis: ["2.3.6.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> DisablePasswordChange'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> DisablePasswordChange -> 0'

  # 2.3.6.5 (L1) Ensure 'Domain member: Maximum machine account password age' is set to '30 or fewer days, but not 0'. (Automated)
  - id: 16017
    title: "確保「網域成員：機器帳戶密碼最長期限」設定為「30 天或更少，但不是 0」。"
    description: "此政策設定確定電腦帳戶密碼的最長允許期限。預設情況下，網域成員每 30 天自動變更一次網域密碼。此設定的建議狀態是：30 天或更少，但不是 0。注意#2：電腦帳戶密碼過期可能會導致出現一些問題，特別是當電腦恢復到先前的時間點狀態時，這在虛擬機器中很常見。根據還原的時間，儲存在電腦上的舊電腦帳戶密碼可能不再被網域控制器識別，因此電腦失去了網域信任。這也可能會破壞非持續性 VDI 實施以及具有不允許對作業系統磁碟區進行永久更改的寫入過濾器的裝置。某些組織可能會選擇免除此建議，並在這些情況下停用電腦帳戶密碼過期。"
    rationale: "在基於 Active Directory 的網域中，每台電腦都像每個使用者一樣都有一個帳戶和密碼。預設情況下，網域成員每 30 天自動變更其網域密碼。如果顯著增加此間隔，或將其設為 0，以便電腦不再更改其密碼，攻擊者將有更多時間進行暴力攻擊來猜測電腦帳戶的密碼。"
    impact: "None - this is the default behavior."
    remediation: "若要透過群組原則建立建議的配置，請將以下UI路徑設定為30天或更少，但不要設為0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Maximum machine account password age."
    compliance:
      - cis: ["2.3.6.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge -> 0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> MaximumPasswordAge -> n:^(\d+) compare <= 30'

  # 2.3.6.6 (L1) Ensure 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'. (Automated)
  - id: 16018
    title: "確保「網域成員：需要強（Windows 2000 或更高版本）會話金鑰」設定為「啟用」。"
    description: "啟用此策略設定後，只能使用能夠使用強（128 位元）會話金鑰加密安全通道資料的網域控制站建立安全通道。要啟用此策略設置，網域中的所有網域控制站都必須能夠使用強密鑰加密安全通道資料，這意味著所有網域控制站必須運行 Microsoft Windows 2000 或更高版本。此設定的建議狀態為：已啟用。"
    rationale: "Windows 2000 中用於在網域控制站和成員電腦之間建立安全通道通訊的會話金鑰比以前的 Microsoft 作業系統中的會話金鑰強大得多。只要有可能，您就應該利用這些更強大的會話金鑰來幫助保護安全通道通訊免受試圖劫持網路會話和竊聽的攻擊。 （竊聽是一種駭客行為，其中網路資料在傳輸過程中被讀取或更改。資料可以被修改以隱藏或更改發送者，或被重新導向。）。"
    impact: "None - this is the default behavior. However, computers will not be able to join Windows NT 4.0 domains, and trusts between Active Directory domains and Windows NT-style domains may not work properly. Also, Domain Controllers with this setting configured will not allow older pre-Windows 2000 clients (that that do not support this policy setting) to join the domain."
    remediation: "要透過 GP 建立建議的配置，將以下路徑設定為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Domain member: Require strong (Windows 2000 or later) session key."
    compliance:
      - cis: ["2.3.6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireStrongKey'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters -> RequireStrongKey -> 1'

  ##########################
  # 2.3.7 Interactive logon
  ##########################
  # 2.3.7.1 (L1) Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'. (Automated)
  - id: 16019
    title: "確保「互動式登入：不顯示最後的使用者名稱」設定為「啟用」。"
    description: "此政策設定決定最後登入組織中用戶端電腦的使用者的帳戶名稱是否將顯示在每台電腦各自的 Windows 登入畫面中。啟用此策略設定可防止入侵者從組織中的桌上型電腦或筆記型電腦的螢幕上直觀地收集帳戶名稱。此設定的建議狀態為：已啟用。"
    rationale: "有權存取控制台的攻擊者（例如，具有實體存取權限的人或能夠透過遠端桌面服務連接到伺服器的人）可以查看最後登入伺服器的使用者的名稱。然後，攻擊者可以嘗試猜測密碼、使用字典或使用暴力攻擊來嘗試登入。"
    impact: "The name of the last user to successfully log on will not be displayed in the Windows logon screen."
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Do not display last user name 注意：在較新版本的Microsoft Windows Server中，從Windows Server 2019開始，此設置重命名為Interactive logon: Don't display last signed-in."
    compliance:
      - cis: ["2.3.7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DontDisplayLastUserName'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DontDisplayLastUserName -> 1'

  # 2.3.7.2 (L1) Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'. (Automated)
  - id: 16020
    title: "確保“互動式登入：不需要 CTRL+ALT+DEL”設定為“停用”。"
    description: "此政策設定確定使用者在登入之前是否必須按 CTRL+ALT+DEL。此設定的建議狀態是：停用。"
    rationale: "Microsoft 開發此功能是為了讓有某些身體缺陷的使用者更輕鬆地登入執行 Windows 的電腦。如果使用者不需要按 CTRL+ALT+DEL，他們很容易受到試圖攔截其密碼的攻擊。如果在登入前需要按 CTRL+ALT+DEL，則使用者密碼將透過可信任路徑進行傳遞。攻擊者可以安裝看起來像標準 Windows 登入對話方塊的特洛伊木馬程式並捕獲使用者的密碼。然後，攻擊者就可以使用該使用者擁有的任何權限等級登入受感染的帳戶。"
    impact: "Users must press CTRL+ALT+DEL before they log on to Windows unless they use a smart card for Windows logon. A smart card is a tamper-proof device that stores security information."
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設置為 Disabled：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Do not require CTRL+ALT+DEL."
    compliance:
      - cis: ["2.3.7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DisableCAD'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> DisableCAD -> 0'

  # 2.3.7.3 (L1) Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'. (Automated)
  - id: 16021
    title: "確保「互動式登入：電腦不活動限制」設定為「900 秒或更少，但不是 0」。"
    description: "Windows 會注意到登入工作階段的不活動狀態，如果不活動時間超過不活動限制，則螢幕保護程式將執行，鎖定工作階段。此設定的建議狀態是：900 秒或更少，但不是 0。"
    rationale: "如果使用者離開時忘記鎖定計算機，則路人可能會劫持計算機。"
    impact: "The screen saver will automatically activate when the computer has been unattended for the amount of time specified. The impact should be minimal since the screen saver is enabled by default."
    remediation: "要透過群組原則建立推薦的配置，將以下 UI 路徑設定為 900 秒或更少，但不能為 0：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Machine inactivity limit."
    compliance:
      - cis: ["2.3.7.3"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs'
      - 'not r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs -> 0'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> InactivityTimeoutSecs -> n:^(\d+) compare <= 900'

  # 2.3.7.4 (L1) Configure 'Interactive logon: Message text for users attempting to log on'. (Automated) - Not Implemented
  # 2.3.7.5 (L1) Configure 'Interactive logon: Message title for users attempting to log on'. (Automated) - Not Implemented

  # 2.3.7.6 (L2) Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)' (MS only) (Automated)
  - id: 16022
    title: "確保「互動式登入：先前登入快取的次數（如果網域控制站不可用）」設定為「4 次或更少的登入」（僅限 MS）。"
    description: "此策略設定決定使用者是否可以使用快取的帳戶資訊登入 Windows 網域。網域帳戶的登入資訊可以快取在本機，以便即使無法聯繫網域控制器，使用者也可以登入。此策略設定決定在本機快取其登入資訊的唯一使用者的數量。如果該值設為 0，則停用登入快取功能。能夠存取伺服器檔案系統的攻擊者可以找到此快取資訊並使用暴力攻擊來確定使用者密碼。此設定的建議狀態為：4 次或更少的登入。"
    rationale: "分配給此策略設定的數字表示電腦將在本機快取其登入資訊的使用者數量。如果該數字設定為 4，則電腦快取 4 個使用者的登入資訊。當第 5 個使用者登入電腦時，伺服器將覆蓋最舊的快取登入工作階段。存取電腦控制台的使用者的登入憑證將會快取在該電腦上。能夠存取電腦檔案系統的攻擊者可以找到此快取資訊並使用暴力攻擊來嘗試確定使用者密碼。為了減輕此類攻擊，Windows 會對資訊進行加密並隱藏其實體位置。"
    impact: "Users will be unable to log on to any computers if there is no Domain Controller available to authenticate them. Organizations may want to configure this value to 2 for end-user computers, especially for mobile users. A configuration value of 2 means that the user's logon information will still be in the cache, even if a member of the IT department has recently logged on to their computer to perform system maintenance. This method allows users to log on to their computers when they are not connected to the organization's network."
    remediation: "要通過GP設置推薦配置，請將以下UI路徑設置為4次或更少的登入次數：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Number of previous logons to cache (in case domain controller is not available)."
    compliance:
      - cis: ["2.3.7.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> CachedLogonsCount'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> CachedLogonsCount -> n:^(\d+) compare <= 4'

  # 2.3.7.7 (L1) Ensure 'Interactive logon: Prompt user to change password before expiration' is set to 'between 5 and 14 days'. (Automated)
  - id: 16023
    title: "確保「互動式登入：提示使用者在過期前更改密碼」設定為「5 到 14 天之間」。"
    description: "此策略設定確定提前多久警告使用者其密碼將過期。建議您將此原則設定配置為至少 5 天但不超過 14 天，以便在使用者密碼過期時充分警告使用者。此設定的建議狀態為：5 到 14 天之間。"
    rationale: "建議將使用者密碼配置為定期過期。需要警告使用者他們的密碼即將過期，否則當密碼過期時，他們可能會無意中被鎖定在電腦之外。這種情況可能會導致本地存取網路的使用者感到困惑，或使用戶無法透過撥接或虛擬私人網路 (VPN) 連線存取組織的網路。"
    impact: "Users will see a dialog box prompt to change their password each time that they log on to the domain when their password is configured to expire between 5 and 14 days."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為5至14天之間的值: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Prompt user to change password before expiration."
    compliance:
      - cis: ["2.3.7.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> PasswordExpiryWarning'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> PasswordExpiryWarning -> n:^(\d+) compare >= 5 && n:^(\d+) compare <= 14'

  # 2.3.7.8 (L1) Ensure 'Interactive logon: Require Domain Controller Authentication to unlock workstation' is set to 'Enabled' (MS only). (Automated)
  - id: 16024
    title: "確保「互動式登入：需要網域控制器驗證才能解鎖工作站」設定為「已啟用」（僅限 MS）。"
    description: "解鎖鎖定的電腦需要登入資訊。對於網域帳戶，此安全性設定決定是否需要聯絡網域控制站來解鎖電腦。此設定的建議狀態為：已啟用。"
    rationale: "預設情況下，電腦會在記憶體中快取所有經過本機驗證的使用者的憑證。電腦使用這些快取的憑證來驗證任何嘗試解鎖控制台的人。使用快取憑證時，在對帳戶進行身份驗證後，不會考慮或套用最近對帳戶進行的任何變更（例如使用者權限指派、帳戶鎖定或帳戶已停用）。使用者權限不會更新，並且（更重要的是）禁用的帳戶仍然能夠解鎖電腦的控制台。"
    impact: "When the console on a computer is locked, either by a user or automatically by a screen saver time-out, the console can only be unlocked if a Domain Controller is available to re-authenticate the domain account that is being used to unlock the computer. If no Domain Controller is available, the user cannot unlock the computer."
    remediation: "要通過GP實施建議的配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Require Domain Controller Authentication to unlock workstation."
    compliance:
      - cis: ["2.3.7.8"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ForceUnlockLogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ForceUnlockLogon -> 1'

  # 2.3.7.9 (L1) Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher. (Automated)
  - id: 16025
    title: "確保「互動式登入：智慧卡刪除行為」設定為「鎖定工作站」或更高版本。"
    description: "此策略設定確定從智慧卡讀卡機中取出登入使用者的智慧卡時會發生什麼情況。此設定的建議狀態為：鎖定工作站。如果遠端桌面服務工作階段也符合基準，請將此設定配置為強制登出或中斷連線。"
    rationale: "使用者有時會在離開工作站時忘記鎖定工作站，從而導致惡意使用者有可能存取他們的電腦。如果使用智慧卡進行身份驗證，當卡片被移除時，電腦應自動鎖定自身，以確保只有擁有智慧卡的使用者才能使用這些憑證存取資源。"
    impact: "If you select Lock Workstation, the workstation is locked when the smart card is removed, allowing users to leave the area, take their smart card with them, and still maintain a protected session. If you select Force Logoff, users are automatically logged off when their smart card is removed. If you select Disconnect if a Remote Desktop Services session, removal of the smart card disconnects the session without logging the users off. This allows the user to insert the smart card and resume the session later, or at another smart card reader-equipped computer, without having to log on again. If the session is local, this policy will function identically to Lock Workstation. Enforcing this setting on computers used by people who must log onto multiple computers in order to perform their duties could be frustrating and lower productivity. For example, if network administrators are limited to a single account but need to log into several computers simultaneously in order to effectively manage the network enforcing this setting will limit them to logging onto one computer at a time. For these reasons it is recommended that this setting only be enforced on workstations used for purposes commonly associated with typical users such as document creation and email."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為鎖定工作站（或者，如果適用於您的環境，則設置為強制註銷或如果是遠端桌面服務會話則設置為斷開連接）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Interactive logon: Smart card removal behavior."
    compliance:
      - cis: ["2.3.7.9"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScRemoveOption'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScRemoveOption -> r:^1$|^2$|^3$'

  ###############################################
  # 2.3.8 Microsoft network client
  ###############################################
  # 2.3.8.1 (L1) Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'. (Automated)
  - id: 16026
    title: "確保「Microsoft 網路用戶端：對通訊進行數位簽署（始終）」設定為「啟用」。"
    description: '此政策設定確定 SMB 用戶端元件是否需要封包簽署。注意：當基於 Windows Vista 的電腦啟用此原則設定並且它們連接到遠端伺服器上的檔案或列印共用時，該設定與其配套設定 Microsoft 網路伺服器同步非常重要：對通訊進行數位簽署（始終）那些伺服器。有關這些設定的詳細資訊，請參閱威脅和對策指南第 5 章中的“Microsoft 網路用戶端和伺服器 - 數位簽章通訊（四個相關設定）”部分。此設定的建議狀態為 - 已啟用。'
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    impact: "The Microsoft network client will not communicate with a Microsoft network server unless that server agrees to perform SMB packet signing. The Windows 2000 Server, Windows 2000 Professional, Windows Server 2003, Windows XP Professional and Windows Vista implementations of the SMB file and print sharing protocol support mutual authentication, which prevents session hijacking attacks and supports message authentication to prevent man-in-the-middle attacks. SMB signing provides this authentication by placing a digital signature into each SMB, which is then verified by both the client and the server. Implementation of SMB signing may negatively affect performance, because each packet needs to be signed and verified. If these settings are enabled on a server that is performing multiple roles, such as a small business server that is serving as a Domain Controller, file server, print server, and application server performance may be substantially slowed. Additionally, if you configure computers to ignore all unsigned SMB communications, older applications and operating systems will not be able to connect. However, if you completely disable all SMB signing, computers will be vulnerable to session hijacking attacks. When SMB signing policies are enabled on Domain Controllers running Windows Server 2003 and member computers running Windows Vista SP1 or Windows Server 2008 group policy processing will fail. A hotfix is available from Microsoft that resolves this issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy settings are not applied on member computers that are running Windows Server 2008 or Windows Vista SP1 when certain SMB signing policies are enabled."
    remediation: "要通過 GP 建立推薦配置，請將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Digitally sign communications (always)."
    compliance:
      - cis: ["2.3.8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature -> 1'

  # 2.3.8.2 (L1) Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'. (Automated)
  - id: 16027
    title: "確保「Microsoft 網路用戶端：對通訊進行數位簽章（如果伺服器同意）」設定為「啟用」。"
    description: "此政策設定決定 SMB 用戶端是否嘗試協商 SMB 封包簽章。注意：在網路上的 SMB 用戶端上啟用此原則設定可以使它們完全有效地與環境中的所有用戶端和伺服器進行封包簽署。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    impact: "None - this is the default behavior. The Windows 2000 Server, Windows 2000 Professional, Windows Server 2003, Windows XP Professional and Windows Vista implementations of the SMB file and print sharing protocol support mutual authentication, which prevents session hijacking attacks and supports message authentication to prevent man-in-the-middle attacks. SMB signing provides this authentication by placing a digital signature into each SMB, which is then verified by both the client and the server. Implementation of SMB signing may negatively affect performance, because each packet needs to be signed and verified. If these settings are enabled on a server that is performing multiple roles, such as a small business server that is serving as a Domain Controller, file server, print server, and application server performance may be substantially slowed. Additionally, if you configure computers to ignore all unsigned SMB communications, older applications and operating systems will not be able to connect. However, if you completely disable all SMB signing, computers will be vulnerable to session hijacking attacks. When SMB signing policies are enabled on Domain Controllers running Windows Server 2003 and member computers running Windows Vista SP1 or Windows Server 2008 group policy processing will fail. A hotfix is available from Microsoft that resolves this issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy settings are not applied on member computers that are running Windows Server 2008 or Windows Vista SP1 when certain SMB signing policies are enabled."
    remediation: "要透過群組原則建立推薦的配置，將以下使用者介面路徑設定為「已啟用」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Digitally sign communications (if server agrees)."
    compliance:
      - cis: ["2.3.8.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature -> 1'

  # 2.3.8.3 (L1) Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'. (Automated)
  - id: 16028
    title: "確保「Microsoft 網路用戶端：將未加密的密碼傳送至第三方 SMB 伺服器」設定為「停用」。"
    description: "此政策設定確定 SMB 重新導向程式是否在驗證期間向不支援密碼加密的第三方 SMB 伺服器傳送純文字密碼。建議您停用此策略設置，除非有充分的業務案例來啟用它。如果啟用此策略設置，將允許在網路上使用未加密的密碼。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，伺服器可以透過網路將明文密碼傳輸到提供 SMB 服務的其他計算機，這是一個重大的安全風險。這些其他電腦可能不會使用 Windows Server 2003 中包含的任何 SMB 安全機制。"
    impact: "None - this is the default behavior. Some very old applications and operating systems such as MS-DOS, Windows for Workgroups 3.11, and Windows 95a may not be able to communicate with the servers in your organization by means of the SMB protocol."
    remediation: "要通過 GP 設定推薦的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network client: Send unencrypted password to third-party SMB servers."
    compliance:
      - cis: ["2.3.8.3"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["16.4"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnablePlainTextPassword'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnablePlainTextPassword -> 1'

  ############################################
  # 2.3.9 Microsoft network server
  ############################################
  # 2.3.9.1 (L1) Ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s)'. (Automated)
  - id: 16029
    title: "確保「Microsoft 網路伺服器：掛起會話之前所需的空閒時間量」設定為「15 分鐘或更少」。"
    description: "此策略設定可讓您指定在 SMB 會話因不活動而暫停會話之前必須經過的連續空閒時間量。管理員可以使用此策略設定來控制電腦何時掛起不活動的 SMB 會話。如果用戶端活動恢復，會話將自動重新建立。最大值為99999，即超過69天；實際上，該值會停用該設定。此設定的建議狀態是：15 分鐘或更少。"
    rationale: "每個 SMB 會話都會消耗伺服器資源，大量空會話會降低伺服器速度或可能導致伺服器失敗。攻擊者可以重複建立 SMB 會話，直到伺服器的 SMB 服務變得緩慢或無回應。"
    impact: "There will be little impact because SMB sessions will be re-established automatically if the client resumes activity."
    remediation: "要通過GP設置建議的配置，將以下UI路徑設置為15分鐘或更少：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Amount of idle time required before suspending session."
    compliance:
      - cis: ["2.3.9.1"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect -> 0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> AutoDisconnect -> n:^(\d+) compare <= 15'

  # 2.3.9.2 (L1) Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'. (Automated)
  - id: 16030
    title: "確保「Microsoft 網路伺服器：對通訊進行數位簽章（始終）」設定為「啟用」。"
    description: "此策略設定確定 SMB 伺服器元件是否需要封包簽署。在混合式環境中啟用此策略設定可防止下游用戶端將工作站用作網路伺服器。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    impact: "The Microsoft network server will not communicate with a Microsoft network client unless that client agrees to perform SMB packet signing. The Windows 2000 Server, Windows 2000 Professional, Windows Server 2003, Windows XP Professional and Windows Vista implementations of the SMB file and print sharing protocol support mutual authentication, which prevents session hijacking attacks and supports message authentication to prevent man-in-the-middle attacks. SMB signing provides this authentication by placing a digital signature into each SMB, which is then verified by both the client and the server. Implementation of SMB signing may negatively affect performance, because each packet needs to be signed and verified. If these settings are enabled on a server that is performing multiple roles, such as a small business server that is serving as a Domain Controller, file server, print server, and application server performance may be substantially slowed. Additionally, if you configure computers to ignore all unsigned SMB communications, older applications and operating systems will not be able to connect. However, if you completely disable all SMB signing, computers will be vulnerable to session hijacking attacks. When SMB signing policies are enabled on Domain Controllers running Windows Server 2003 and member computers running Windows Vista SP1 or Windows Server 2008 group policy processing will fail. A hotfix is available from Microsoft that resolves this issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy settings are not applied on member computers that are running Windows Server 2008 or Windows Vista SP1 when certain SMB signing policies are enabled."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Digitally sign communications (always)."
    compliance:
      - cis: ["2.3.9.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> RequireSecuritySignature -> 1'

  # 2.3.9.3 (L1) Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'. (Automated)
  - id: 16031
    title: "確保「Microsoft 網路伺服器：對通訊進行數位簽章（如果用戶端同意）」設定為「啟用」。"
    description: "此原則設定決定 SMB 伺服器是否將與請求它的用戶端協商 SMB 封包簽章。如果用戶端沒有發出簽章請求，且未啟用 Microsoft 網路伺服器：數位簽章通訊（始終）設置，則無需簽章即可允許連線。注意：在網路上的 SMB 用戶端上啟用此原則設置，使其能夠完全有效地與環境中的所有用戶端和伺服器進行封包簽署。此設定的建議狀態為：已啟用。"
    rationale: "會話劫持使用的工具允許與客戶端或伺服器存取相同網路的攻擊者中斷、結束或竊取正在進行的會話。攻擊者可能會攔截和修改未簽署的 SMB 封包，然後修改流量並轉送它，以便伺服器可能執行不需要的操作。或者，攻擊者可以在合法身份驗證後冒充伺服器或用戶端，並獲得對資料的未經授權的存取。 SMB 是許多 Windows 作業系統都支援的資源共享協定。它是 NetBIOS 和許多其他協定的基礎。 SMB 簽章對使用者和託管資料的伺服器進行身份驗證。如果任何一方未能通過身份驗證過程，則不會進行資料傳輸。"
    impact: "The Microsoft network server will negotiate SMB packet signing as requested by the client. That is, if packet signing has been enabled on the client, packet signing will be negotiated. The Windows 2000 Server, Windows 2000 Professional, Windows Server 2003, Windows XP Professional and Windows Vista implementations of the SMB file and print sharing protocol support mutual authentication, which prevents session hijacking attacks and supports message authentication to prevent man-in-the-middle attacks. SMB signing provides this authentication by placing a digital signature into each SMB, which is then verified by both the client and the server. Implementation of SMB signing may negatively affect performance, because each packet needs to be signed and verified. If these settings are enabled on a server that is performing multiple roles, such as a small business server that is serving as a Domain Controller, file server, print server, and application server performance may be substantially slowed. Additionally, if you configure computers to ignore all unsigned SMB communications, older applications and operating systems will not be able to connect. However, if you completely disable all SMB signing, computers will be vulnerable to session hijacking attacks. When SMB signing policies are enabled on Domain Controllers running Windows Server 2003 and member computers running Windows Vista SP1 or Windows Server 2008 group policy processing will fail. A hotfix is available from Microsoft that resolves this issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy settings are not applied on member computers that are running Windows Server 2008 or Windows Vista SP1 when certain SMB signing policies are enabled."
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為已啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Digitally sign communications (if client agrees)."
    compliance:
      - cis: ["2.3.9.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableSecuritySignature -> 1'

  # 2.3.9.4 (L1) Ensure 'Microsoft network server: Disconnect clients when logon hours expire' is set to 'Enabled'. (Automated)
  - id: 16032
    title: "確保「Microsoft 網路伺服器：登入時間到期時中斷用戶端連線」設定為「啟用」。"
    description: "此安全性設定決定是否在使用者帳戶的有效登入時間之外斷開連接到本機的使用者。此設定會影響伺服器訊息區塊 (SMB) 元件。如果啟用此策略設置，您還應該啟用網路安全：登入時間到期時強制登出（規則 2.3.11.6）。如果您的組織為使用者配置登入時間，則需要此政策設定來確保它們有效。此設定的建議狀態為：已啟用。"
    rationale: "如果您的組織為使用者配置登入時間，則啟用此策略設定是有意義的。否則，在登入時間之外不應存取網路資源的使用者實際上可能能夠透過在允許的時間內建立的會話繼續使用這些資源。"
    impact: "None - this is the default behavior. If logon hours are not used in your organization, this policy setting will have no impact. If logon hours are used, existing user sessions will be forcibly terminated when their logon hours expire."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Disconnect clients when logon hours expire."
    compliance:
      - cis: ["2.3.9.4"]
      - cis_csc_v8: ["5.6"]
      - cis_csc_v7: ["16.13"]
      - nist_sp_800-53: ["AC-2(1)"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableForcedLogOff'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> EnableForcedLogOff -> 1'

  # 2.3.9.5 (L1) Ensure 'Microsoft network server: Server SPN target name validation level' is set to 'Accept if provided by client' or higher (MS only). (Automated)
  - id: 16033
    title: "確保「Microsoft 網路伺服器：伺服器 SPN 目標名稱驗證等級」設定為「如果用戶端提供則接受」或更高（僅限 MS）。"
    description: "此政策設定控制具有共用資料夾或印表機的電腦（伺服器）在用戶端電腦使用伺服器訊息區塊 (SMB) 協定建立會話時提供的服務主體名稱 (SPN) 上執行的驗證等級。伺服器訊息區塊 (SMB) 協定為檔案和列印共用以及其他網路操作（例如遠端 Windows 管理）提供了基礎。 SMB 協定支援在 SMB 用戶端提供的驗證 blob 內驗證 SMB 伺服器服務主體名稱 (SPN)，以防止針對 SMB 伺服器的一類攻擊（稱為 SMB 中繼攻擊）。此設定將影響 SMB1 和 SMB2。此設定的建議狀態為：如果客戶端提供，則接受。將此設定配置為客戶端必需也符合基準。注意：自MS KB3161561 安全性修補程式發布以來，當與UNC 路徑增強（即規則18.5.14.1）同時使用時，此設定可能會在網域控制站上導致嚴重問題（例如複製問題、群組原則編輯問題和藍屏當機）。因此，CIS 建議不要在網域控制站上部署此設定。"
    rationale: "電腦的身份可以被欺騙以獲取對網路資源的未經授權的存取。"
    impact: "All Windows operating systems support both a client-side SMB component and a server-side SMB component. This setting affects the server SMB behavior, and its implementation should be carefully evaluated and tested to prevent disruptions to file and print serving capabilities. If configured to Accept if provided by client, the SMB server will accept and validate the SPN provided by the SMB client and allow a session to be established if it matches the SMB server's list of SPN's for itself. If the SPN does NOT match, the session request for that SMB client will be denied. If configured to Required from client, the SMB client MUST send a SPN name in session setup, and the SPN name provided MUST match the SMB server that is being requested to establish a connection. If no SPN is provided by client, or the SPN provided does not match, the session is denied."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為接受（如果由客戶提供）（配置為客戶要求的也符合基準）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Microsoft network server: Server SPN target name validation level."
    compliance:
      - cis: ["2.3.9.5"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters -> SMBServerNameHardeningLevel'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> SMBServerNameHardeningLevel -> n:^(\d+) compare >= 1'

  ##################################
  # 2.3.10 Network access
  ##################################
  # 2.3.10.1 (L1) Ensure 'Network access: Allow anonymous SID/Name translation' is set to 'Disabled'. (Automated)
  - id: 16034
    title: "確保「網路存取：允許匿名 SID/名稱轉換」設定為「停用」。"
    description: "此策略設定確定匿名使用者是否可以要求另一個使用者的安全識別碼 (SID) 屬性，或使用 SID 取得其對應的使用者名稱。此設定的建議狀態是：停用。"
    rationale: "如果啟用此策略設置，則具有本機存取權限的使用者可以使用眾所周知的管理員 SID 來了解內建管理員帳戶的真實名稱，即使該帳戶已重新命名。然後，該人可以使用該帳號名稱發動密碼猜測攻擊。"
    impact: "None - this is the default behavior."
    remediation: "要透過群組原則建立建議的配置，將以下使用者介面路徑設為停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Allow anonymous SID/Name translation."
    compliance:
      - cis: ["2.3.10.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> TurnOffAnonymousBlock'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> TurnOffAnonymousBlock -> 0'

  # 2.3.10.2 (L1) Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled' (MS only). (Automated)
  - id: 16035
    title: "確保「網路存取：不允許匿名列舉 SAM 帳戶」設定為「啟用」（僅限 MS）。"
    description: "此政策設定控制匿名使用者列舉安全帳戶管理員 (SAM) 中的帳戶的能力。如果啟用此策略設置，具有匿名連接的使用者將無法列舉您環境中的系統上的網域帳戶使用者名稱。此策略設定還允許對匿名連線進行其他限制。此設定的建議狀態為：已啟用。注意：此策略對網域控制站沒有影響。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱並使用該資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者以獲取密碼或某種形式的安全資訊。）。"
    impact: "None - this is the default behavior. It will be impossible to establish trusts with Windows NT 4.0-based domains. Also, client computers that run older versions of the Windows operating system such as Windows NT 3.51 and Windows 95 will experience problems when they try to use resources on the server."
    remediation: "要透過 GP 設定推薦的配置，將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow anonymous enumeration of SAM accounts."
    compliance:
      - cis: ["2.3.10.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymousSAM'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymousSAM -> 1'

  # 2.3.10.3 (L1) Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts and shares' is set to 'Enabled' (MS only). (Automated)
  - id: 16036
    title: "確保「網路存取：不允許匿名列舉 SAM 帳戶和共用」設定為「啟用」（僅限 MS）。"
    description: "此政策設定控制匿名使用者列舉 SAM 帳戶和共享的能力。如果啟用此策略設置，匿名使用者將無法列舉環境中系統上的網域帳戶使用者名稱和網路共用名稱。此設定的建議狀態為：已啟用。注意：此策略對網域控制站沒有影響。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱和共享資源，並使用這些資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者以獲取密碼或某種形式的安全資訊。）。"
    impact: "It will be impossible to establish trusts with Windows NT 4.0-based domains. Also, client computers that run older versions of the Windows operating system such as Windows NT 3.51 and Windows 95 will experience problems when they try to use resources on the server. Users who access file and print servers anonymously will be unable to list the shared network resources on those servers; the users will have to authenticate before they can view the lists of shared folders and printers. However, even with this policy setting enabled, anonymous users will have access to resources with permissions that explicitly include the built-in group, ANONYMOUS LOGON."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow anonymous enumeration of SAM accounts and shares."
    compliance:
      - cis: ["2.3.10.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymous '
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RestrictAnonymous -> 1'

  # 2.3.10.4 (L2) Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'. (Automated)
  - id: 16037
    title: "確保「網路存取：不允許儲存網路驗證的密碼和憑證」設定為「啟用」。"
    description: "此原則設定確定憑證管理員（以前稱為儲存的使用者名稱和密碼）是否會儲存密碼或憑證以供日後在取得網域驗證時使用。此設定的建議狀態為：已啟用。注意：對此設定的變更只有在 Windows 重新啟動後才會生效。"
    rationale: "使用者登入電腦後可以存取快取的密碼。儘管此資訊聽起來很明顯，但如果使用者在不知情的情況下執行讀取密碼並將其轉發給另一個未經授權的使用者的惡意程式碼，則可能會出現問題。"
    impact: "Credential Manager will not store passwords and credentials on the computer. Users will be forced to enter passwords whenever they log on to their Passport account or other network resources that aren't accessible to their domain account. Testing has shown that clients running Windows Vista or Windows Server 2008 will be unable to connect to Distributed File System (DFS) shares in untrusted domains. Enabling this setting also makes it impossible to specify alternate credentials for scheduled tasks, this can cause a variety of problems. For example, some third-party backup products will no longer work. This policy setting should have no impact on users who access network resources that are configured to allow access with their Active Directory-based domain account."
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Do not allow storage of passwords and credentials for network authentication."
    compliance:
      - cis: ["2.3.10.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> DisableDomainCreds'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> DisableDomainCreds -> 1'

  # 2.3.10.5 (L1) Ensure 'Network access: Let Everyone permissions apply to anonymous users' is set to 'Disabled'. (Automated)
  - id: 16038
    title: "確保「網路存取：讓每個人權限套用至匿名使用者」設定為「停用」。"
    description: "此策略設定決定為電腦的匿名連線指派哪些附加權限。此設定的建議狀態是：停用。"
    rationale: "未經授權的使用者可以匿名列出帳戶名稱和共享資源，並使用這些資訊嘗試猜測密碼、執行社會工程攻擊或發動 DoS 攻擊。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP設置推薦的配置，請將以下UI路徑設置為已禁用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Let Everyone permissions apply to anonymous users."
    compliance:
      - cis: ["2.3.10.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> EveryoneIncludesAnonymous'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> EveryoneIncludesAnonymous -> 0'

  # 2.3.10.6 (L1) Configure 'Network access: Named Pipes that can be accessed anonymously' (DC only). (Automated)
  - id: 16039
    title: "設定「網路存取：可以匿名存取的命名管道」（僅限 DC）。"
    description: "此策略設定決定哪些通訊會話或管道將具有允許匿名存取的屬性和權限。此設定的建議狀態為：LSARPC、NETLOGON、SAMR 和（啟用舊電腦瀏覽器服務時）BROWSER。注意：擁有遠端桌面授權角色服務的遠端桌面服務角色的成員伺服器將需要對此建議的特殊例外，以允許匿名存取 HydraLSPipe 和 TermServLicensing 命名管道。"
    rationale: "限制可以匿名存取的命名管道將減少系統的攻擊面。"
    impact: "Null session access over named pipes will be disabled unless they are included, and applications that rely on this feature or on unauthenticated access to named pipes will no longer function. The BROWSER named pipe may need to be added to this list if the Computer Browser service is needed for supporting legacy components. The Computer Browser service is disabled by default."
    remediation: "若要透過GP建立建議的配置，請配置以下UI路徑: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Named Pipes that can be accessed anonymously."
    compliance:
      - cis: ["2.3.10.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> EveryoneIncludesAnonymous'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionPipes -> r:LSARPC && r:NETLOGON && r:SAMR'

  # 2.3.10.7 (L1) Configure 'Network access: Named Pipes that can be accessed anonymously' (MS only). (Automated) - Not Implemented

  # 2.3.10.8 (L1) Configure 'Network access: Remotely accessible registry paths' is configured. (Automated)
  - id: 16040
    title: "設定「網路存取：遠端存取註冊表路徑」已配置。"
    description: "This policy setting determines which registry paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the winreg registry key. Note: This setting does not exist in Windows XP. There was a setting with that name in Windows XP, but it is called \"Network access: Remotely accessible registry paths and sub-paths\" in Windows Server 2003, Windows Vista, and Windows Server 2008 (non-R2). Note #2: When you configure this setting you specify a list of one or more objects. The delimiter used when entering the list is a line feed or carriage return, that is, type the first object on the list, press the Enter button, type the next object, press Enter again, etc. The setting value is stored as a comma-delimited list in group policy security templates. It is also rendered as a comma-delimited list in Group Policy Editor's display pane and the Resultant Set of Policy console. It is recorded in the registry as a line-feed delimited list in a REG_MULTI_SZ value. The recommended state for this setting is: System\\CurrentControlSet\\Control\\ProductOptions System\\CurrentControlSet\\Control\\Server Applications Software\\Microsoft\\Windows NT\\CurrentVersion."
    rationale: "註冊表是一個包含電腦配置資訊的資料庫，其中許多資訊都是敏感資訊。攻擊者可以使用此資訊來促進未經授權的活動。為了降低此類攻擊的風險，在整個註冊表中分配了適當的 ACL，以幫助防止未經授權的使用者存取。"
    impact: "None - this is the default behavior. However, if you remove the default registry paths from the list of accessible ones, remote management tools such as the Microsoft Baseline Security Analyzer and Microsoft Systems Management Server could fail, as they require remote access to the registry to properly monitor and manage computers. Note: If you want to allow remote access, you must also enable the Remote Registry service."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為：System\\CurrentControlSet\\Control\\ProductOptions System\\CurrentControlSet\\Control\\Server Applications Software\\Microsoft\\Windows NT\\CurrentVersion Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Remotely accessible registry paths."
    compliance:
      - cis: ["2.3.10.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths -> Machine -> r:System\\CurrentControlSet\\Control\\ProductOptions|System\\CurrentControlSet\\Control\\Server Applications|Software\\Microsoft\\Windows NT\\CurrentVersion'

  # 2.3.10.9 (L1) Configure 'Network access: Remotely accessible registry paths and sub-paths' is configured. (Automated)
  - id: 16041
    title: "設定「網路存取：遠端存取登錄路徑和子路徑」已配置。"
    description: "This policy setting determines which registry paths and sub-paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the winreg registry key. Note: In Windows XP this setting is called \"Network access: Remotely accessible registry paths,\" the setting with that same name in Windows Vista, Windows Server 2008 (non-R2), and Windows Server 2003 does not exist in Windows XP. Note #2: When you configure this setting you specify a list of one or more objects. The delimiter used when entering the list is a line feed or carriage return, that is, type the first object on the list, press the Enter button, type the next object, press Enter again, etc. The setting value is stored as a comma-delimited list in group policy security templates. It is also rendered as a comma-delimited list in Group Policy Editor's display pane and the Resultant Set of Policy console. It is recorded in the registry as a line-feed delimited list in a REG_MULTI_SZ value. The recommended state for this setting is: System\\CurrentControlSet\\Control\\Print\\Printers System\\CurrentControlSet\\Services\\Eventlog Software\\Microsoft\\OLAP Server Software\\Microsoft\\Windows NT\\CurrentVersion\\Print Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows System\\CurrentControlSet\\Control\\ContentIndex System\\CurrentControlSet\\Control\\Terminal Server System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib System\\CurrentControlSet\\Services\\SysmonLog The recommended state for servers that hold the Active Directory Certificate Services Role with Certification Authority Role Service includes the above list and: System\\CurrentControlSet\\Services\\CertSvc The recommended state for servers that have the WINS Server Feature installed includes the above list and: System\\CurrentControlSet\\Services\\WINS."
    rationale: "註冊表包含敏感的電腦配置訊息，攻擊者可能會利用這些資訊來進行未經授權的活動。事實上，在整個註冊表中分配的預設 ACL 具有相當大的限制性，有助於保護註冊表免遭未經授權的用戶存取，從而降低了此類攻擊的風險。"
    impact: "None - this is the default behavior. However, if you remove the default registry paths from the list of accessible ones, remote management tools such as the Microsoft Baseline Security Analyzer and Microsoft Systems Management Server could fail, as they require remote access to the registry to properly monitor and manage computers. Note: If you want to allow remote access, you must also enable the Remote Registry service."
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設定為： System\\CurrentControlSet\\Control\\Print\\Printers System\\CurrentControlSet\\Services\\Eventlog Software\\Microsoft\\OLAP Server Software\\Microsoft\\Windows NT\\CurrentVersion\\Print Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows System\\CurrentControlSet\\Control\\ContentIndex System\\CurrentControlSet\\Control\\Terminal Server System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib System\\CurrentControlSet\\Services\\SysmonLog Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Remotely accessible registry paths and sub-paths 當伺服器擁有Active Directory憑證服務角色和憑證頒發機構角色服務時，上述列表還應包括：System\\CurrentControlSet\\Services\\CertSvc。當伺服器安裝了WINS伺服器功能時，上述列表還應包括：System\\CurrentControlSet\\Services\\WINS。"
    compliance:
      - cis: ["2.3.10.9"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths -> Machine -> r:Software\\Microsoft\\Windows NT\\CurrentVersion\\Print|Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows|System\\CurrentControlSet\\Control\\Print\\Printers|System\\CurrentControlSet\\Services\\Eventlog|Software\\Microsoft\\OLAP Server|System\\CurrentControlSet\\Control\\ContentIndex|System\\CurrentControlSet\\Control\\Terminal Server|System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig|System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration|Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib|System\\CurrentControlSet\\Services\\SysmonLog|System\\CurrentControlSet\\Services\\CertSvc|System\\CurrentControlSet\\Services\\WINS'

  # 2.3.10.10 (L1) Ensure 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled'. (Automated)
  - id: 16042
    title: "確保「網路存取：限制對命名管道和共享的匿名存取」設定為「啟用」。"
    description: "啟用後，此策略設定將匿名存取權限限制為僅對網路存取：可以匿名存取的命名管道和網路存取：可以匿名存取的共用設定中指定的共用和管道。此策略設定透過在 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters 註冊表項中新增值為 1 的 RestrictNullSessAccess 來控制對電腦上共用的空會話存取。此登錄值可開啟或關閉空會話共用，以控制伺服器服務是否限制未經驗證的用戶端對命名資源的存取。此設定的建議狀態為：已啟用。"
    rationale: "空會話是一個弱點，可以透過環境中電腦上的共用（包括預設共用）來利用。"
    impact: "None - this is the default behavior. If you choose to enable this setting and are supporting Windows NT 4.0 domains, you should check if any of the named pipes are required to maintain trust relationships between the domains, and then add the pipe to the Network access: Named pipes that can be accessed anonymously list: - COMNAP: SNA session access - COMNODE: SNA session access - SQL\\QUERY: SQL instance access - SPOOLSS: Spooler service - LLSRPC: License Logging service - NETLOGON: Net Logon service - LSARPC: LSA access - SAMR: Remote access to SAM objects - BROWSER: Computer Browser service Previous to the release of Windows Server 2003 with Service Pack 1 (SP1) these named pipes were allowed anonymous access by default, but with the increased hardening in Windows Server 2003 with SP1 these pipes must be explicitly added if needed."
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Restrict anonymous access to Named Pipes and Shares."
    compliance:
      - cis: ["2.3.10.10"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RestrictNullSessAccess'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> RestrictNullSessAccess -> 1'

  # 2.3.10.11 (L1) Ensure 'Network access: Restrict clients allowed to make remote calls to SAM' is set to 'Administrators: Remote Access: Allow' (MS only). (Automated)
  - id: 16043
    title: "確保「網路存取：限制允許遠端呼叫 SAM 的用戶端」設定為「管理員：遠端存取：允許」（僅限 MS）。"
    description: '此政策設定可讓您限制與 SAM 的遠端 RPC 連線。此設定的建議狀態是：管理員：遠端存取：允許。注意：需要 Windows 10 R1607、Server 2016 或更高版本的作業系統才能在群組原則中存取和設定此值。注意 #2：此設定最初僅在 Windows Server 2016 及更高版本上受支持，然後透過 2017 年 3 月的安全性修補程式將對其的支援新增至 Windows Server 2008 R2 及更高版本中。注意#3：如果您的組織正在使用 Azure 進階威脅防護 (APT)，則需要將服務帳戶「AATP 服務」新增至建議設定。有關新增「AATP 服務」帳戶的詳細資訊，請參閱配置 SAM-R 以在 Microsoft Defender for Identity | 中啟用橫向移動路徑檢測。微軟檔案。'
    rationale: "確保未經授權的使用者無法匿名列出本地帳戶名稱或群組並使用這些資訊嘗試猜測密碼或執行社會工程攻擊。 （社會工程攻擊試圖以某種方式欺騙使用者以獲取密碼或某種形式的安全資訊。）。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設置為 Administrators: Remote Access: Allow: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Restrict clients allowed to make remote calls to SAM."
    compliance:
      - cis: ["2.3.10.11"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> restrictremotesam'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> restrictremotesam -> O:BAG:BAD:(A;;RC;;;BA)'

  # 2.3.10.12 (L1) Ensure 'Network access: Shares that can be accessed anonymously' is set to 'None'. (Automated)
  - id: 16044
    title: "確保「網路存取：可以匿名存取的共用」設定為「無」。"
    description: "此策略設定確定匿名使用者可以存取哪些網路共用。此策略設定的預設配置影響不大，因為所有使用者都必須經過身份驗證才能存取伺服器上的共用資源。此設定的建議狀態為：<空白>（即無）。"
    rationale: "在此設定中允許任何值都是非常危險的。任何網路使用者都可以存取列出的任何共享，這可能會導致敏感資料的暴露或損壞。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設置為 <空白>（即無）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Shares that can be accessed anonymously."
    compliance:
      - cis: ["2.3.10.12"]
      - cis_csc_v7: ["14.6"]
      - iso_27001-2013: ["A.9.1.1"]
    condition: any
    rules:
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionShares'
      - 'not r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters -> NullSessionShares -> r:\.'

  # 2.3.10.13 (L1) Ensure 'Network access: Sharing and security model for local accounts' is set to 'Classic - local users authenticate as themselves'. (Automated)
  - id: 16045
    title: "確保「網路存取：本機帳戶的共用和安全模型」設定為「經典 - 本機使用者以自己的身分進行驗證」。"
    description: "此政策設定決定如何對使用本機帳戶的網路登入進行驗證。經典選項允許精確控制對資源的存取，包括為不同使用者指派對相同資源的不同類型的存取權限。僅訪客選項可讓您平等對待所有使用者。在這種情況下，所有使用者都以訪客身份進行身份驗證，只是為了獲得對給定資源的相同存取等級。此設定的建議狀態是：經典 - 本機使用者以自己的身分進行身份驗證。注意：此設定不會影響使用 Telnet 或遠端桌面服務（以前稱為終端機服務）等服務遠端執行的互動式登入。"
    rationale: "使用僅限來賓模型，任何可以透過網路對您的電腦進行身份驗證的使用者都會以來賓權限進行身份驗證，這可能意味著他們將沒有對該電腦上的共用資源的寫入存取權限。儘管此限制確實提高了安全性，但它使授權使用者存取這些電腦上的共用資源變得更加困難，因為這些資源上的 ACL 必須包括來賓帳戶的存取控制條目 (ACE)。對於經典模型，本機帳戶應該受到密碼保護。否則，如果啟用了來賓存取，則任何人都可以使用這些使用者帳戶來存取共用系統資源。"
    impact: "None - this is the default configuration for domain-joined computers."
    remediation: "要通過GP建立推薦設定，將以下UI路徑設置為經典 - 本地用戶以自己身份驗證: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network access: Sharing and security model for local accounts."
    compliance:
      - cis: ["2.3.10.13"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> ForceGuest'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> ForceGuest -> 0'

  # 2.3.11.1 (L1) Ensure 'Network security: Allow Local System to use computer identity for NTLM' is set to 'Enabled'. (Automated)
  - id: 16046
    title: "確保「網路安全：允許本機系統使用 NTLM 的電腦標識」設定為「已啟用」。"
    description: "此政策設定決定在還原至 NTLM 驗證時使用協商的本機系統服務是否可以使用電腦識別。至少 Windows 7 或 Windows Server 2008 R2 支援此原則。此設定的建議狀態為：已啟用。"
    rationale: "連接到執行早於 Windows Vista 或 Windows Server 2008（非 R2）的 Windows 版本的電腦時，作為本機系統執行並使用還原為 NTLM 的 SPNEGO（協商）的服務將使用電腦識別。在 Windows 7 中，如果您要連線到執行 Windows Server 2008 或 Windows Vista 的計算機，則系統服務將使用電腦識別或 NULL 工作階段。當與 NULL 會話連線時，系統會建立一個系統產生的會話金鑰，該金鑰不提供任何保護，但允許應用程式對資料進行簽署和加密而不會出現錯誤。當與電腦身分連接時，支援簽章和加密以提供資料保護。"
    impact: "Services running as Local System that use Negotiate when reverting to NTLM authentication will use the computer identity. This might cause some authentication requests between Windows operating systems to fail and log an error."
    remediation: "要透過 GP 建立建議的配置，請將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Allow Local System to use computer identity for NTLM."
    compliance:
      - cis: ["2.3.11.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> UseMachineId'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> UseMachineId -> 1'

  # 2.3.11.2 (L1) Ensure 'Network security: Allow LocalSystem NULL session fallback' is set to 'Disabled'. (Automated)
  - id: 16047
    title: "確保「網路安全：允許 LocalSystem NULL 會話回退」設定為「停用」。"
    description: "此政策設定決定與 LocalSystem 一起使用時是否允許 NTLM 回退到 NULL 會話。此設定的建議狀態是：停用。"
    rationale: "NULL 會話的安全性較低，因為根據定義它們未經身份驗證。"
    impact: "Any applications that require NULL sessions for LocalSystem will not work as designed."
    remediation: "要透過 GP 建立建議的配置，請將以下使用者介面路徑設定為停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Allow LocalSystem NULL session fallback."
    compliance:
      - cis: ["2.3.11.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> allownullsessionfallback'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> allownullsessionfallback -> 0'

  # 2.3.11.3 (L1) Ensure 'Network Security: Allow PKU2U authentication requests to this computer to use online identities' is set to 'Disabled'. (Automated)
  - id: 16048
    title: "確保「網路安全：允許對此電腦的 PKU2U 身份驗證請求使用線上身分」設定為「停用」。"
    description: "此設定確定線上身份是否能夠對此電腦進行身份驗證。 Windows 7 和 Windows Server 2008 R2 中引入的基於公鑰加密的使用者到使用者 (PKU2U) 協定是作為安全性支援提供者 (SSP) 實現的。 SSP 支援點對點身份驗證，特別是透過名為 HomeGroup 的 Windows 7 媒體和檔案共用功能，該功能允許在非網域成員的電腦之間進行共用。在 PKU2U 中，協商身份驗證包引入了新的擴充 Spnego.dll。在先前版本的 Windows 中，Negotiate 決定要使用 Kerberos 還是 NTLM 進行驗證。 Negotiate 的擴充 SSP Negoexts.dll 被 Windows 視為驗證協定，支援包括 PKU2U 在內的 Microsoft SSP。當電腦設定為使用線上 ID 接受驗證請求時，Negoexts.dll 會呼叫用於登入的電腦上的 PKU2U SSP。 PKU2U SSP 取得本機憑證並在對等電腦之間交換原則。在對等電腦上進行驗證後，元資料中的憑證將傳送至登入對等方進行驗證，並將使用者的憑證與安全性權杖相關聯，然後登入程序完成。此設定的建議狀態是：停用。"
    rationale: "PKU2U 協定是一種點對點身份驗證協定 - 身份驗證應在大多數託管網路中集中管理。"
    impact: "None - this is the default configuration for domain-joined computers."
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network Security: Allow PKU2U authentication requests to this computer to use online identities."
    compliance:
      - cis: ["2.3.11.3"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u -> AllowOnlineID'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\pku2u -> AllowOnlineID -> 0'

  # 2.3.11.4 (L1) Ensure 'Network security: Configure encryption types allowed for Kerberos' is set to 'AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types' (Automated)
  - id: 16049
    title: "確保「網路安全：設定 Kerberos 允許的加密類型」設定為「AES128_HMAC_SHA1、AES256_HMAC_SHA1、未來加密類型」。"
    description: "此策略設定可讓您設定允許 Kerberos 使用的加密類型。此設定的建議狀態為：AES128_HMAC_SHA1、AES256_HMAC_SHA1、未來加密類型。注意：某些舊版應用程式和作業系統可能仍需要 RC4_HMAC_MD5 - 我們建議您在您的環境中進行測試並驗證是否可以安全刪除它。"
    rationale: "每種加密演算法的強度各不相同，選擇更強的演算法將降低妥協的風險，但是當電腦嘗試使用不支援它們的系統進行身份驗證時，這樣做可能會導致問題。"
    impact: "If not selected, the encryption type will not be allowed. This setting may affect compatibility with client computers or services and applications. Multiple selections are permitted. Note: Some legacy applications and OSes may still require RC4_HMAC_MD5 - we recommend you test in your environment and verify whether you can safely remove it. Note #2: Windows Server 2008 (non-R2) and below allow DES for Kerberos by default, but later OS versions do not. Note #3: Some prerequisites might need to be met on Domain Controllers to support Kerberos AES 128 and 256 bit encryption types, as well as enabling support for Kerberos AES 128 and 256 bit on user accounts (in account options) for this recommendation to work correctly. Note #4: If your organization uses Azure Files, please note that Microsoft did not introduce AES 256 Kerberos encryption support for it until AD DS authentication module v0.2.2. Please see this link for more information: https://docs.microsoft.com/en-us/azure/storage/files/ storage-troubleshoot-windows-file-connection-problems#azure-files-on-premises-ad-ds-authentication-support-for-aes-256-kerberos-encryption."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Configure encryption types allowed for Kerberos."
    reference:
      - "https://docs.microsoft.com/en-us/azure/storage/files/storage-troubleshoot-windows-file-connection-problems#azure-files-on-premises-ad-ds-authentication-support-for-aes-256-kerberos-encryption"
    compliance:
      - cis: ["2.3.11.4"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["14.4"]
      - cis_csc_v7: ["18.5"]
      - cmmc_v2.0: ["AC.L2-3.1.17", "AC.L2-3.1.13", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.8", "SC.L2-3.13.15"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters -> SupportedEncryptionTypes'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters -> SupportedEncryptionTypes -> r:2147483644|2147483640'

  # 2.3.11.5 (L1) Ensure 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled'. (Automated)
  - id: 16050
    title: "確保「網路安全：下次變更密碼時不儲存 LAN Manager 雜湊值」設定為「啟用」。"
    description: "此原則設定決定更改密碼時是否儲存新密碼的 LAN Manager (LM) 雜湊值。與加密性更強的 Microsoft Windows NT 雜湊相比，LM 雜湊相對較弱且容易受到攻擊。由於 LM 雜湊值儲存在本機的安全資料庫中，因此如果資料庫受到攻擊，密碼很容易被洩露。注意：啟用此策略設定後，較舊的作業系統和某些第三方應用程式可能會失敗。另請注意，啟用此設定後，需要更改所有帳戶的密碼才能獲得適當的好處。此設定的建議狀態為：已啟用。"
    rationale: "SAM 檔案可能成為尋求存取使用者名稱和密碼雜湊值的攻擊者的目標。此類攻擊使用特殊工具來破解密碼，然後可以使用這些工具來冒充使用者並取得網路資源的存取權限。如果啟用此策略設置，將無法阻止這些類型的攻擊，但這些類型的攻擊將更難成功。"
    impact: "None - this is the default behavior. Earlier operating systems such as Windows 95, Windows 98, and Windows ME as well as some third-party applications will fail."
    remediation: "若要透過GP建立推薦的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Do not store LAN Manager hash value on next password change."
    compliance:
      - cis: ["2.3.11.5"]
      - cis_csc_v8: ["3.11"]
      - cis_csc_v7: ["16.4"]
      - cmmc_v2.0: ["AC.L2-3.1.19", "IA.L2-3.5.10", "MP.L2-3.8.1", "SC.L2-3.13.11", "SC.L2-3.13.16"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["SC-28", "SC-28(1)"]
      - pci_dss_v3.2.1: ["3.4", "3.4.1", "8.2.1"]
      - pci_dss_v4.0: ["3.1.1", "3.3.2", "3.3.3", "3.5.1", "3.5.1.2", "3.5.1.3", "8.3.2"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> NoLMHash'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> NoLMHash -> 1'

  # 2.3.11.6 (L1) Ensure 'Network security: Force logoff when logon hours expire' is set to 'Enabled'. (Manual)
  - id: 16051
    title: "確保「網路安全：登入時間到期時強制登出」設定為「啟用」。"
    description: "此政策設定決定是否在使用者帳戶的有效登入時間之外斷開連接到本機的使用者。此設定會影響伺服器訊息區塊 (SMB) 元件。如果啟用此策略設置，您也應該啟用 Microsoft 網路伺服器：登入時間到期時中斷用戶端連線（規則 2.3.9.4）。此設定的建議狀態為：已啟用。"
    rationale: "如果停用此設置，使用者可以在分配的登入時間之外保持與電腦的連接。"
    impact: "None - this is the default behavior."
    remediation: "為了通過GP建立推薦的配置，將以下UI路徑設置為啟用。Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Force logoff when logon hours expire."
    compliance:
      - cis: ["2.3.11.6"]
      - cis_csc_v8: ["5.6"]
      - cis_csc_v7: ["16.13"]
      - nist_sp_800-53: ["AC-2(1)"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -> EnableForcedLogOff -> 1'

  # 2.3.11.7 (L1) Ensure 'Network security: LAN Manager authentication level' is set to 'Send NTLMv2 response only. Refuse LM & NTLM'. (Automated)
  - id: 16052
    title: "確保「網路安全：LAN Manager 驗證等級」設定為「僅傳送 NTLMv2 回應」。拒絕 LM 和 NTLM'。"
    description: "LAN Manager (LM) 是早期 Microsoft 用戶端/伺服器軟體系列（早於 Windows NT），可讓使用者在單一網路上將個人電腦連結在一起。 LM 網路功能包括透明檔案和列印共享、使用者安全功能和網路管理工具。在 Active Directory 網域中，Kerberos 協定是預設驗證協定。但是，如果由於某種原因未協商 Kerberos 協定，Active Directory 將使用 LM、NTLM 或 NTLMv2。 LAN Manager 驗證包含LM、NTLM 和NTLM 版本2 (NTLMv2) 變體，是用於在所有Windows 用戶端執行下列操作時對其進行驗證的協定： - 加入網域- 在Active Directory 林之間進行身份驗證- 向下級域- 對不運行Windows 2000、Windows Server 2003 或Windows XP 的電腦進行身份驗證- 對不在網域中的電腦進行身份驗證網路安全：LAN Manager 驗證等級設定決定使用哪種質詢/回應身份驗證協定用於網路登入。此選擇會影響用戶端使用的身份驗證協定等級、協商的會話安全性等級以及伺服器接受的驗證等級。此設定的建議狀態是：僅傳送 NTLMv2 回應。拒絕 LM 和 NTLM。"
    rationale: "預設情況下，Windows 2000 和 Windows XP 用戶端會配置為傳送 LM 和 NTLM 驗證回應（基於 Windows 95 和基於 Windows 98 的用戶端僅傳送 LM）。 Windows Vista / Windows Server 2008（非 R2）之前的作業系統中的預設設定允許所有用戶端透過伺服器進行驗證並使用其資源。然而，這意味著 LM 回應（最弱的身份驗證回應形式）是透過網路發送的，攻擊者有可能嗅探該流量以更輕鬆地重現用戶的密碼。 Windows 95、Windows 98 和Windows NT 作業系統無法使用Kerberos 版本5 協定進行驗證。因此，在 Windows Server 2003 網域中，這些電腦預設使用 LM 和 NTLM 協定進行網路驗證。您可以使用 NTLMv2 對 Windows 95、Windows 98 和 Windows NT 實作更安全的驗證協定。對於登入過程，NTLMv2 使用安全通道來保護驗證過程。即使您對較舊的用戶端和伺服器使用 NTLMv2，但作為網域成員的基於 Windows 的用戶端和伺服器也將使用 Kerberos 驗證協定向 Windows Server 2003 或更高版本的網域控制站進行驗證。由於這些原因，強烈建議盡可能限制 LM 和 NTLM（非 v2）的使用。"
    impact: "Clients use NTLMv2 authentication only and use NTLMv2 session security if the server supports it; Domain Controllers refuse LM and NTLM (accept only NTLMv2 authentication). Clients that do not support NTLMv2 authentication will not be able to authenticate in the domain and access domain resources by using LM and NTLM."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為：僅傳送 NTLMv2 響應。拒絕 LM 和 NTLM: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: LAN Manager authentication level."
    compliance:
      - cis: ["2.3.11.7"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["18.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LmCompatibilityLevel'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa -> LmCompatibilityLevel -> 5'

  # 2.3.11.8 (L1) Ensure 'Network security: LDAP client signing requirements' is set to 'Negotiate signing' or higher. (Automated)
  - id: 16053
    title: "確保「網路安全：LDAP 用戶端簽章要求」設定為「協商簽章」或更高。"
    description: "此政策設定決定代表發出 LDAP BIND 請求的用戶端請求的資料簽章等級。注意：此策略設定對 LDAP 簡單綁定 (ldap_simple_bind) 或透過 SSL 的 LDAP 簡單綁定 (ldap_simple_bind_s) 沒有任何影響。 Windows XP Professional 隨附的 Microsoft LDAP 用戶端不使用 ldap_simple_bind 或 ldap_simple_bind_s 與網域控制站通訊。此設定的建議狀態為：協商簽名。將此設定配置為需要簽名也符合基準。"
    rationale: "未簽署的網路流量容易受到中間人攻擊，入侵者捕獲客戶端和伺服器之間的資料包，修改它們，然後將它們轉發到伺服器。對於 LDAP 伺服器，這種敏感度意味著攻擊者可能會導致伺服器根據 LDAP 查詢中的錯誤或變更的資料做出決策。為了降低網路中的這種風險，您可以實施強大的實體安全措施來保護網路基礎架構。此外，如果您需要透過 IPsec 驗證標頭對所有網路封包進行數位簽名，則可能會使所有類型的中間人攻擊變得極其困難。"
    impact: "None - this is the default behavior. However, if you choose instead to configure the server to require LDAP signatures then you must also configure the client. If you do not configure the client it will not be able to communicate with the server, which could cause many features to fail, including user authentication, Group Policy, and logon scripts, because the caller will be told that the LDAP BIND command request failed."
    remediation: "為了通過GP建立推薦配置，將以下UI路徑設置為協商簽名（配置為要求簽名也符合基準）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: LDAP client signing requirements."
    compliance:
      - cis: ["2.3.11.8"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["18.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP -> LDAPClientIntegrity'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LDAP -> LDAPClientIntegrity -> n:(\d+) compare >= 1'

  # 2.3.11.9 (L1) Ensure 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients' is set to 'Require NTLMv2 session security, Require 128-bit encryption'
  - id: 16054
    title: "確保「網路安全：基於 NTLM SSP（包括安全性 RPC）用戶端的最低會話安全性」設定為「需要 NTLMv2 會話安全性，需要 128 位元加密」。"
    description: "此原則設定決定用戶端允許使用 NTLM 安全性支援提供者 (SSP) 的應用程式執行哪些行為。 SSP 介面 (SSPI) 由需要驗證服務的應用程式使用。該設定不會修改身份驗證序列的工作方式，而是要求使用 SSPI 的應用程式中的某些行為。此設定的建議狀態是：需要 NTLMv2 會話安全性、需要 128 位元加密。注意：這些值取決於網路安全性：LAN Manager 驗證等級（規則 2.3.11.7）安全性設定值。"
    rationale: "您可以為此政策設定啟用這兩個選項，以協助保護使用 NTLM 安全性支援提供者 (NTLM SSP) 的網路流量免遭取得相同網路存取權限的攻擊者暴露或竄改。換句話說，這些選項有助於防止中間人攻擊。"
    impact: "NTLM connections will fail if NTLMv2 protocol and strong encryption (128-bit) are not both negotiated. Client applications that are enforcing these settings will be unable to communicate with older servers that do not support them."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為需要 NTLMv2 會話安全性，需要 128 位加密：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Minimum session security for NTLM SSP based (including secure RPC) clients."
    compliance:
      - cis: ["2.3.11.9"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["18.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinClientSec'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinClientSec -> 537395200'

  # 2.3.11.10 (L1) Ensure 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers' is set to 'Require NTLMv2 session security, Require 128-bit encryption' (Automated)'
  - id: 16055
    title: "確保「網路安全：基於 NTLM SSP（包括安全性 RPC）伺服器的最低會話安全性」設定為「需要 NTLMv2 會話安全性，需要 128 位元加密」。"
    description: "此原則設定決定伺服器允許使用 NTLM 安全性支援提供者 (SSP) 的應用程式執行哪些行為。 SSP 介面 (SSPI) 由需要驗證服務的應用程式使用。該設定不會修改身份驗證序列的工作方式，而是要求使用 SSPI 的應用程式中的某些行為。此設定的建議狀態是：需要 NTLMv2 會話安全性、需要 128 位元加密。注意：這些值取決於網路安全性：LAN Manager 驗證等級（規則 2.3.11.7）安全性設定值。"
    rationale: "您可以啟用此政策設定的所有選項，以協助保護使用 NTLM 安全性支援提供者 (NTLM SSP) 的網路流量免遭取得相同網路存取權限的攻擊者暴露或竄改。也就是說，這些選項有助於防止中間人攻擊。"
    impact: "NTLM connections will fail if NTLMv2 protocol and strong encryption (128-bit) are not both negotiated. Server applications that are enforcing these settings will be unable to communicate with older servers that do not support them."
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設置為需要 NTLMv2 會話安全性，需要 128 位元加密: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Network security: Minimum session security for NTLM SSP based (including secure RPC) servers."
    compliance:
      - cis: ["2.3.11.10"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["18.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinServerSec'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\MSV1_0 -> NTLMMinServerSec -> 537395200'

  # 2.3.13.1 (L1) Ensure 'Shutdown: Allow system to be shut down without having to log on' is set to 'Disabled'. (Automated)
  - id: 16056
    title: "確保「關機：允許系統無需登入即可關閉」設定為「停用」。"
    description: "此策略設定確定當使用者未登入時是否可以關閉電腦。如果啟用此策略設置，則可以在 Windows 登入畫面上使用關機指令。建議停用此策略設置，以限制具有系統憑證的使用者關閉電腦的能力。此設定的建議狀態是：停用。注意：在 Server 2008 R2 及更早版本中，此設定對遠端桌面 (RDP)/終端服務工作階段沒有影響 - 它僅影響本機控制台。但是，Microsoft 更改了 Windows Server 2012（非 R2）及更高版本中的行為，如果設定為“啟用”，則還允許 RDP 會話關閉或重新啟動伺服器。"
    rationale: "可以本地存取控制台的使用者可以關閉電腦。攻擊者還可以走到本機控制台並重新啟動伺服器，這將導致臨時 DoS 情況。攻擊者還可以關閉伺服器並使其所有應用程式和服務不可用。如同上面的描述所述，在Windows Server 2012（非R2）及更高版本中，啟用此設定的拒絕服務(DoS) 風險會顯著增加，因為即使是遠端使用者也可以從Windows Server 2012 的登入畫面關閉或重新啟動伺服器。"
    impact: "None - this is the default behavior."
    remediation: "如需通過GP建立建議的配置，請將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\Shutdown: Allow system to be shut down without having to log on."
    compliance:
      - cis: ["2.3.13.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ShutdownWithoutLogon'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ShutdownWithoutLogon -> 0'

  # 2.3.15.1 (L1) Ensure 'System objects: Require case insensitivity for non-Windows subsystems' is set to 'Enabled'. (Automated)
  - id: 16057
    title: "確保“系統物件：要求非 Windows 子系統不區分大小寫”設定為“啟用”。"
    description: "此策略設定決定是否對所有子系統強制執行不區分大小寫。 Microsoft Win32 子系統不區分大小寫。但是，核心支援其他子系統區分大小寫，例如 UNIX 的可移植作業系統介面 (POSIX)。由於 Windows 不區分大小寫（但 POSIX 子系統將支援區分大小寫），因此如果不強制執行此策略設置，則 POSIX 子系統的使用者可能會透過使用混合大小寫標記來建立與另一個檔案同名的檔案。這種情況可能會阻止使用典型 Win32 工具的另一使用者存取這些檔案，因為只有其中一個檔案可用。此設定的建議狀態為：已啟用。"
    rationale: "由於 Windows 不區分大小寫，但 POSIX 子系統支援區分大小寫，因此如果不啟用此策略設置，該子系統的使用者可能會建立與另一個檔案同名但大小寫不同的檔案。當使用者嘗試從普通 Win32 工具存取此類檔案時，這種情況可能會讓使用者感到困惑，因為只有其中一個檔案可用。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 設置推薦配置，將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System objects: Require case insensitivity for non - Windows subsystems."
    compliance:
      - cis: ["2.3.15.1"]
      - cis_csc_v8: ["4.1", "5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - hipaa: ["164.312(a)(2)(i)"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2", "8.1", "8.1.1"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "12.5.2", "2.1.1", "2.2.1"]
      - soc_2: ["CC6.1", "CC6.2", "CC6.3", "CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel -> ObCaseInsensitive'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Kernel -> ObCaseInsensitive -> 1'

  # 2.3.15.2 (L1) Ensure 'System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)' is set to 'Enabled'. (Automated)
  - id: 16058
    title: "確保「系統物件：加強內部系統物件（例如符號連結）的預設權限」設定為「啟用」。"
    description: "此策略設定決定物件的預設自主存取控制清單 (DACL) 的強度。 Active Directory 維護共享系統資源的全域列表，例如 DOS 裝置名稱、互斥體和號誌。這樣，物件就可以在程序之間定位和共享。每種類型的物件都是使用預設 DACL 建立的，該 DACL 指定誰可以存取這些物件以及授予哪些權限。此設定的建議狀態為：已啟用。"
    rationale: "此設定確定物件的預設 DACL 的強度。 Windows 維護共享電腦資源的全域列表，以便可以在程序之間定位和共享物件。每種類型的物件都是使用預設 DACL 建立的，該 DACL 指定誰可以存取這些物件以及具有哪些權限。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦配置，將以下介面路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)."
    compliance:
      - cis: ["2.3.15.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager -> ProtectionMode'
      - 'r:HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager -> ProtectionMode -> 1'

  # 2.3.17.1 (L1) Ensure 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is set to 'Enabled'. (Automated)
  - id: 16059
    title: "確保「使用者帳戶控制：內建管理員帳戶的管理員批准模式」設定為「啟用」。"
    description: "此策略設定控制內建管理員帳戶的管理員批准模式的行為。此設定的建議狀態為：已啟用。"
    rationale: 'Windows Vista 中引入的使用者帳戶控制功能試圖緩解的風險之一是惡意軟體在提升的憑證下執行，而使用者或管理員不知道其活動。這些程式的攻擊媒介是發現名為「Administrator」的帳戶的密碼，因為該使用者帳戶是為所有 Windows 安裝建立的。為了解決此風險，在 Windows Vista 或更高版本中，現在預設為內建管理員帳戶停用。在新電腦的預設安裝中，最初透過以下兩種方式之一設定對電腦具有管理控制權的帳戶： - - 如果電腦未加入網域，則您建立的第一個使用者帳戶具有與本機管理員。如果電腦加入網域，則不會建立本機管理員帳戶。如果需要本機管理員帳戶，則企業或網域管理員必須登入電腦並建立帳戶。安裝 Windows 後，可以手動啟用內建管理員帳戶，但我們強烈建議保持停用該帳戶。'
    impact: "The built-in Administrator account uses Admin Approval Mode. Users that log on using the local Administrator account will be prompted for consent whenever a program requests an elevation in privilege, just like any other user would."
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為 Enabled : Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Admin Approval Mode for the Built-in Administrator account."
    compliance:
      - cis: ["2.3.17.1"]
      - cis_csc_v7: ["4.3"]
      - iso_27001-2013: ["A.9.2.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> FilterAdministratorToken'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> FilterAdministratorToken -> 1'

  # 2.3.17.2 (L1) Ensure 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode' is set to 'Prompt for consent on the secure desktop' or higher (Automated)
  - id: 16060
    title: "確保「使用者帳戶控制：管理員批准模式下管理員的提升提示行為」設定為「在安全桌面上提示同意」或更高版本。"
    description: "此策略設定控制管理員提升提示的行為。此設定的建議狀態是：在安全桌面上提示同意。將此設定配置為在安全桌面上提示輸入憑證也符合基準。"
    rationale: "Windows Vista 中引入的 UAC 功能試圖緩解的風險之一是惡意軟體在提升的憑證下運行，而使用者或管理員不知道其活動。此設定提高了管理員對提升權限操作的認識，並允許管理員在惡意程式嘗試提升其權限時阻止該程式提升其權限。"
    impact: "When an operation (including execution of a Windows binary) requires elevation of privilege, the user is prompted on the secure desktop to select either Permit or Deny. If the user selects Permit, the operation continues with the user's highest available privilege."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為在安全桌面上提示同意或在安全桌面上提示認證: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode."
    compliance:
      - cis: ["2.3.17.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorAdmin'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorAdmin -> r:^2$'

  # 2.3.17.3 (L1) Ensure 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests'. (Automated)
  - id: 16061
    title: "確保「使用者帳號控制：標準使用者的提升提示行為」設定為「自動拒絕提升請求」。"
    description: "此策略設定控制標準使用者的提升提示的行為。此設定的建議狀態為：自動拒絕提升請求。"
    rationale: "Windows Vista 中引入的使用者帳戶控制功能試圖緩解的風險之一是惡意程式在提升的憑證下執行，而使用者或管理員不知道其活動。此設定讓使用者意識到程式需要使用提升的權限操作，並要求使用者能夠提供管理憑證才能執行該程式。"
    impact: 'When an operation requires elevation of privilege, a configurable access denied error message is displayed. An enterprise that is running desktops as standard user may choose this setting to reduce help desk calls. Note: With this setting configured as recommended, the default error message displayed when a user attempts to perform an operation or run a program requiring privilege elevation (without Administrator rights) is "This program will not run. This program is blocked by group policy. For more information, contact your system administrator." Some users who are not used to seeing this message may believe that the operation or program they attempted to run is specifically blocked by group policy, as that is what the message seems to imply. This message may therefore result in user questions as to why that specific operation/program is blocked, when in fact, the problem is that they need to perform the operation or run the program with an Administrative account (or "Run as Administrator" if it is already an Administrator account), and they are not doing that.'
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為 Automatically deny elevation requests: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Behavior of the elevation prompt for standard users."
    compliance:
      - cis: ["2.3.17.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorUser'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> ConsentPromptBehaviorUser -> 0'

  # 2.3.17.4 (L1) Ensure 'User Account Control: Detect application installations and prompt for elevation' is set to 'Enabled'. (Automated)
  - id: 16062
    title: "確保「使用者帳戶控制：偵測應用程式安裝並提示提升」設定為「啟用」。"
    description: "此策略設定控制電腦的應用程式安裝偵測的行為。此設定的建議狀態為：已啟用。"
    rationale: "某些惡意軟體在獲得運行權限後會嘗試自行安裝。例如，具有可信任應用程式外殼的惡意軟體。使用者可能已授予程式運行權限，因為該程式是受信任的，但如果隨後提示他們安裝未知組件，則這提供了另一種在軟體造成損害之前捕獲該軟體的方法。"
    impact: "When an application installation package is detected that requires elevation of privilege, the user is prompted to enter an administrative user name and password. If the user enters valid credentials, the operation continues with the applicable privilege."
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Detect application installations and prompt for elevation."
    compliance:
      - cis: ["2.3.17.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableInstallerDetection'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableInstallerDetection -> 1'

  # 2.3.17.5 (L1) Ensure 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled'. (Automated)
  - id: 16063
    title: "確保「使用者帳戶控制：僅提升安裝在安全位置的 UIAccess 應用程式」設定為「啟用」。"
    description: "此原則設定控制請求以使用者介面可存取性 (UIAccess) 完整性等級執行的應用程式是否必須駐留在檔案系統中的安全位置。安全位置僅限於以下位置：...\\Program Files\\，包括子資料夾； ...\\Windows\\system32\\; ...\\Program Files (x86)\\，包括子資料夾（適用於 64 位元版本的 Windows）。注意：Windows 會對請求以 UIAccess 完整性等級執行的任何互動式應用程式強制執行公鑰基礎架構 (PKI) 簽章檢查，無論此安全性設定的狀態為何。此設定的建議狀態為：已啟用。"
    rationale: "當應用程式的權限從標準使用者提升到管理員時，UIAccess Integrity 允許應用程式繞過使用者介面權限隔離 (UIPI) 限制。這是支援可存取性功能所必需的，例如將使用者介面傳輸為替代形式的螢幕閱讀器。使用 UIAccess 權限啟動的程序具有以下功能： - 設定前景視窗。 - 使用 SendInput 函數驅動任何應用程式視窗。 - 使用低階掛鉤、原始輸入、GetKeyState、GetAsyncKeyState 和 GetKeyboardInput 對所有完整性等級使用讀取輸入。 - 設定日記鉤。 - 使用 AttachThreadInput 將執行緒附加到更高完整性的輸入佇列。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 設置推薦配置，將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Only elevate UIAccess applications that are installed in secure locations."
    compliance:
      - cis: ["2.3.17.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableSecureUIAPaths'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableSecureUIAPaths -> 1'

  # 2.3.17.6 (L1) Ensure 'User Account Control: Run all administrators in Admin Approval Mode' is set to 'Enabled'. (Automated)
  - id: 16064
    title: "確保「使用者帳戶控制：在管理員批准模式下執行所有管理員」設定為「啟用」。"
    description: "此政策設定控制電腦的所有使用者帳戶控制 (UAC) 政策設定的行為。如果變更此策略設置，則必須重新啟動電腦。此設定的建議狀態為：已啟用。注意：如果停用此原則設置，安全中心會通知您作業系統的整體安全性已降低。"
    rationale: "這是開啟或關閉 UAC 的設定。如果停用此設置，將不會使用 UAC，且系統上不會出現任何依賴 UAC 的安全優勢和風險緩解措施。"
    impact: "None - this is the default behavior. Users and administrators will need to learn to work with UAC prompts and adjust their work habits to use least privilege operations."
    remediation: "要透過 GP 建立推薦的設定，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Run all administrators in Admin Approval Mode."
    compliance:
      - cis: ["2.3.17.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableLUA'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableLUA -> 1'

  # 2.3.17.7 (L1) Ensure 'User Account Control: Switch to the secure desktop when prompting for elevation' is set to 'Enabled'. (Automated)
  - id: 16065
    title: "確保「使用者帳戶控制：提示提升時切換到安全桌面」設定為「已啟用」。"
    description: "此策略設定控制是否在互動式使用者的桌面或安全桌面上顯示提升請求提示。此設定的建議狀態為：已啟用。"
    rationale: "標準提升提示對話方塊可能會被欺騙，這可能會導致用戶向惡意軟體洩露其密碼。安全桌面在提示提升時呈現出非常明顯的外觀，使用者桌面變暗，提升提示 UI 更加突出。這增加了習慣安全桌面的使用者識別欺騙性提升提示對話方塊而不會上當的可能性。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 設置推薦的配置，將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Switch to the secure desktop when prompting for elevation."
    compliance:
      - cis: ["2.3.17.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> PromptOnSecureDesktop'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> PromptOnSecureDesktop -> 1'

  # 2.3.17.8 (L1) Ensure 'User Account Control: Virtualize file and registry write failures to per-user locations' is set to 'Enabled'. (Automated)
  - id: 16066
    title: "確保「使用者帳戶控制：將檔案和註冊表寫入失敗虛擬化到每個使用者位置」設定為「啟用」。"
    description: "此策略設定控制應用程式寫入失敗是否會重新導向到定義的註冊表和檔案系統位置。此策略設定可緩解以管理員身分執行的應用程式並將執行時間應用程式資料寫入至： - %ProgramFiles% - %windir% - %windir%\\System32 - HKEY_LOCAL_MACHINE\\SOFTWARE 此設定的建議狀態為：啟用。"
    rationale: "此設定透過確保舊應用程式僅將資料寫入允許的位置來減少漏洞。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options\\User Account Control: Virtualize file and registry write failures to per-user locations."
    compliance:
      - cis: ["2.3.17.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableVirtualization'
      - 'r:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System -> EnableVirtualization -> 1'

  # 5.1 (L1) Ensure 'Print Spooler (Spooler)' is set to 'Disabled' (DC only). (Automated)
  - id: 16067
    title: "確保「列印後台處理程序（Spooler）」設定為「停用」（僅限 DC）。"
    description: "此服務背景列印作業並處理與印表機的互動。此設定的建議狀態是：停用。"
    rationale: "停用列印後台處理程序 (Spooler) 服務可以緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和針對該服務的其他攻擊。"
    impact: "Domain Controllers will not be able to prune published printers from Active Directory. By default, Domain Controllers prune printer objects from Active Directory if the computer that published them doesn't respond to contact requests. Domain Controllers will not be able to act as a print server, sharing printers for clients. Applications on and users logged in at Domain Controllers will not be able to print, including printing to files (such as Adobe Portable Document Format (PDF)) which uses the Print Spooler service."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為：已停用: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Print Spooler."
    references:
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527"
    compliance:
      - cis: ["5.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Spooler -> Start -> 4'

  # 5.2 (L2) Ensure 'Print Spooler (Spooler)' is set to 'Disabled' (MS only). (Automated)
  - id: 16068
    title: "確保「列印後台處理程序（Spooler）」設定為「停用」（僅限 MS）。"
    description: "此服務背景列印作業並處理與印表機的互動。此設定的建議狀態是：停用。"
    rationale: "停用列印後台處理程序 (Spooler) 服務可以緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和針對該服務的其他攻擊。"
    impact: "Member Servers will not be able to act as a print server, sharing printers for clients. Applications on and users logged in to Member Servers will not be able to print, including printing to files (such as Adobe Portable Document Format (PDF)) which uses the Print Spooler service."
    remediation: "若要透過 GP 建立建議的設定，請將以下使用者介面路徑設置為：停用：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\System Services\\Print Spooler."
    references:
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527"
    compliance:
      - cis: ["5.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Spooler -> Start -> 4'

  ###############################################
  # 9 Windows Firewall with Advanced Security
  ###############################################

  ###############################################
  # 9.1 Domain Profile
  ###############################################

  # 9.1.1 (L1) Ensure 'Windows Firewall: Domain: Firewall state' is set to 'On (recommended)'. (Automated)
  - id: 16069
    title: "確保「Windows 防火牆：網域：防火牆狀態」設定為「開啟（建議）」。"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立推薦配置，請將以下 UI 路徑設為開啟（推薦）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Firewall state."
    compliance:
      - cis: ["9.1.1"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> EnableFirewall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> EnableFirewall -> 1'

  # 9.1.2 (L1) Ensure 'Windows Firewall: Domain: Inbound connections' is set to 'Block (default)'. (Automated)
  - id: 16070
    title: "確保「Windows 防火牆：網域：入站連線」設定為「封鎖（預設）」。"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    impact: "None - this is the default behavior."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為“封鎖”（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Inbound connections."
    compliance:
      - cis: ["9.1.2"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultInboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultInboundAction -> 1'

  # 9.1.3 (L1) Ensure 'Windows Firewall: Domain: Outbound connections' is set to 'Allow (default)'. (Automated)
  - id: 16071
    title: "確保「Windows 防火牆：網域：出站連線」設定為「允許（預設）」。"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為允許 (預設值): Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Outbound connections."
    compliance:
      - cis: ["9.1.3"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultOutboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DefaultOutboundAction -> 0'

  # 9.1.4 (L1) Ensure 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No'. (Automated)
  - id: 16072
    title: "確保「Windows 防火牆：網域：設定：顯示通知」設定為「否」。"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態為：否。的訊息。"
    rationale: "防火牆通知可能很複雜，可能會讓最終用戶感到困惑，導致他們無法解決警報。"
    impact: "Windows Firewall will not display a notification when a program is blocked from receiving inbound connections."
    remediation: "要透過GP建立建議的配置，請將以下使用者介面路徑設為否：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Settings Customize\\Display a notification."
    compliance:
      - cis: ["9.1.4"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DisableNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile -> DisableNotifications -> 1'

  # 9.1.5 (L1) Ensure 'Windows Firewall: Domain: Logging: Name' is set to '%SystemRoot%\System32\logfiles\firewall\domainfw.log'. (Automated)
  - id: 16073
    title: "確保「Windows 防火牆：網域：日誌記錄：名稱」設定為「%SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log。"
    rationale: "如果未記錄 Windows 防火牆事件，管理員可能很難或不可能分析系統問題或惡意使用者的未經授權的活動。 Microsoft 將所有防火牆事件儲存為系統上的一個檔案 (pfirewall.log)。為了改善日誌記錄，請將每個防火牆設定檔（網域、私人、公用）分開到其自己的不同日誌檔案（domainfw.log、privatefw.log、publicfw.log）中，以便更好地組織和識別每個設定檔中的特定問題。"
    impact: "The log file will be stored in the specified file."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設定為 %SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Name."
    compliance:
      - cis: ["9.1.5"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFilePath'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\domainfw.log'

  # 9.1.6 (L1) Ensure 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16,384 KB or greater'. (Automated)
  - id: 16074
    title: "確保「Windows 防火牆：網域：日誌記錄：大小限制 (KB)」設定為「16,384 KB 或更大」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "The log file size will be limited to the specified size, old events will be overwritten by newer ones when the limit is reached."
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設定為 16,384 KB 或更高: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Size limit (KB)."
    compliance:
      - cis: ["9.1.6"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFileSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  # 9.1.7 (L1) Ensure 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes'. (Automated)
  - id: 16075
    title: "確保「Windows 防火牆：網域：日誌記錄：記錄丟棄的封包」設定為「是」。"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Information about dropped packets will be recorded in the firewall log file."
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設定為 Yes: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Log dropped packets."
    compliance:
      - cis: ["9.1.7"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogDroppedPackets'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogDroppedPackets -> 1'

  # 9.1.8 (L1) Ensure 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes'. (Automated)
  - id: 16076
    title: "確保「Windows 防火牆：網域：日誌記錄：記錄成功的連線」設定為「是」。"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Information about successful connections will be recorded in the firewall log file."
    remediation: "要透過群組原則(GP)設置推薦的配置, 將以下使用者介面路徑設定為「是」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Domain Profile\\Logging Customize\\Log successful connections."
    compliance:
      - cis: ["9.1.8"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogSuccessfulConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging -> LogSuccessfulConnections -> 1'

  ###############################################
  # 9.2 Private Profile
  ###############################################

  # 9.2.1 (L1) Ensure 'Windows Firewall: Private: Firewall state' is set to 'On (recommended)'. (Automated)
  - id: 16077
    title: "確保「Windows 防火牆：專用：防火牆狀態」設定為「開啟（建議）」。"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為開（建議）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Firewall state."
    compliance:
      - cis: ["9.2.1"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> EnableFirewall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> EnableFirewall -> 1'

  # 9.2.2 (L1) Ensure 'Windows Firewall: Private: Inbound connections' is set to 'Block (default)'. (Automated)
  - id: 16078
    title: "確保「Windows 防火牆：專用：入站連線」設定為「封鎖（預設）」。"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    impact: "None - this is the default behavior."
    remediation: "若要透過GP來建立建議的配置，請將以下UI路徑設定為封鎖（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Inbound connections."
    compliance:
      - cis: ["9.2.2"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultInboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultInboundAction -> 1'

  # 9.2.3 (L1) Ensure 'Windows Firewall: Private: Outbound connections' is set to 'Allow (default)'. (Automated)
  - id: 16079
    title: "確保「Windows 防火牆：專用：出站連線」設定為「允許（預設）」。"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。注意：如果將出站連線設定為“封鎖”，然後使用GPO 部署防火牆策略，則接收GPO 設定的電腦將無法接收後續的群組原則更新，除非您建立並部署使群組原則能夠正常工作的出站規則。核心網路的預先定義規則包括使群組策略發揮作用的出站規則。確保這些出站規則處於活動狀態，並在部署之前徹底測試防火牆設定檔。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立推薦的配置, 將以下UI路徑設定為允許 (預設值): Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Outbound connections."
    compliance:
      - cis: ["9.2.3"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultOutboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DefaultOutboundAction -> 0'

  # 9.2.4 (L1) Ensure 'Windows Firewall: Private: Settings: Display a notification' is set to 'No'. (Automated)
  - id: 16080
    title: "確保「Windows 防火牆：專用：設定：顯示通知」設定為「否」。"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態為：否。的訊息。"
    rationale: "防火牆通知可能很複雜，可能會讓最終用戶感到困惑，導致他們無法解決警報。"
    impact: "Windows Firewall will not display a notification when a program is blocked from receiving inbound connections."
    remediation: "為了通過GP建立建議的配置，請將以下UI路徑設置為否: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Settings Customize\\Display a notification."
    compliance:
      - cis: ["9.2.4"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DisableNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile -> DisableNotifications -> 1'

  # 9.2.5 (L1) Ensure 'Windows Firewall: Private: Logging: Name' is set to '%SystemRoot%\System32\logfiles\firewall\privatefw.log'. (Automated)
  - id: 16081
    title: "確保「Windows 防火牆：專用：日誌記錄：名稱」設定為「%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log。"
    rationale: "如果未記錄 Windows 防火牆事件，管理員可能很難或不可能分析系統問題或惡意使用者的未經授權的活動。 Microsoft 將所有防火牆事件儲存為系統上的一個檔案 (pfirewall.log)。為了改善日誌記錄，請將每個防火牆設定檔（網域、私人、公用）分開到其自己的不同日誌檔案（domainfw.log、privatefw.log、publicfw.log）中，以便更好地組織和識別每個設定檔中的特定問題。"
    impact: "The log file will be stored in the specified file."
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Name."
    compliance:
      - cis: ["9.2.5"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFilePath'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\privatefw.log'

  # 9.2.6 (L1) Ensure 'Windows Firewall: Private: Logging: Size limit (KB)' is set to '16,384 KB or greater'. (Automated)
  - id: 16082
    title: "確保「Windows 防火牆：專用：日誌記錄：大小限制 (KB)」設定為「16,384 KB 或更大」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "The log file size will be limited to the specified size, old events will be overwritten by newer ones when the limit is reached."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為16,384 KB或更高：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Size limit (KB)."
    compliance:
      - cis: ["9.2.6"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFileSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  # 9.2.7 (L1) Ensure 'Windows Firewall: Private: Logging: Log dropped packets' is set to 'Yes'. (Automated)
  - id: 16083
    title: "確保「Windows 防火牆：專用：日誌記錄：記錄丟棄的封包」設定為「是」。"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Information about dropped packets will be recorded in the firewall log file."
    remediation: "請將以下 UI 路徑設置為 是 以建立推薦配置: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Log dropped packets."
    compliance:
      - cis: ["9.2.7"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogDroppedPackets'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogDroppedPackets -> 1'

  # 9.2.8 (L1) Ensure 'Windows Firewall: Private: Logging: Log successful connections' is set to 'Yes'. (Automated)
  - id: 16084
    title: "確保「Windows 防火牆：專用：日誌記錄：記錄成功的連線」設定為「是」。"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Information about successful connections will be recorded in the firewall log file."
    remediation: "若要透過 GP 建立建議的配置，請在以下 UI 路徑中設定為是：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Private Profile\\Logging Customize\\Log successful connections."
    compliance:
      - cis: ["9.2.8"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogSuccessfulConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging -> LogSuccessfulConnections -> 1'

  ###############################################
  # 9.3 Public Profile
  ###############################################

  # 9.3.1 (L1) Ensure 'Windows Firewall: Public: Firewall state' is set to 'On (recommended)'. (Automated)
  - id: 16085
    title: "確保「Windows 防火牆：公用：防火牆狀態」設定為「開啟（建議）」。"
    description: "選擇「開啟」（建議）以使進階安全性 Windows 防火牆使用此設定檔的設定來過濾網路流量。如果選擇關閉，進階安全性 Windows 防火牆將不會使用此設定檔的任何防火牆規則或連線安全性規則。此設定的建議狀態為：開啟（建議）。"
    rationale: "如果防火牆關閉，所有流量都將能夠存取系統，並且攻擊者可能更容易遠端利用網路服務中的弱點。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為開(建議)：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Firewall state."
    compliance:
      - cis: ["9.3.1"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> EnableFirewall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> EnableFirewall -> 1'

  # 9.3.2 (L1) Ensure 'Windows Firewall: Public: Inbound connections' is set to 'Block (default)'. (Automated)
  - id: 16086
    title: "確保「Windows 防火牆：公用：入站連線」設定為「封鎖（預設）」。"
    description: "此設定決定與入站防火牆規則不符的入站連線的行為。此設定的建議狀態是：阻止（預設）。"
    rationale: "如果防火牆允許所有流量存取系統，那麼攻擊者可能更容易遠端利用網路服務中的弱點。"
    impact: "None - this is the default behavior."
    remediation: "要通過GP建立推薦的配置，請將以下UI路徑設置為阻止（預設）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Inbound connections."
    compliance:
      - cis: ["9.3.2"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultInboundAction'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultInboundAction -> 1'

  # 9.3.3 (L1) Ensure 'Windows Firewall: Public: Outbound connections' is set to 'Allow (default)'. (Automated)
  - id: 16087
    title: "確保「Windows 防火牆：公用：出站連線」設定為「允許（預設）」。"
    description: "此設定決定與出站防火牆規則不符的出站連線的行為。此設定的建議狀態是：允許（預設）。注意：如果將出站連線設定為“封鎖”，然後使用GPO 部署防火牆策略，則接收GPO 設定的電腦將無法接收後續的群組原則更新，除非您建立並部署使群組原則能夠正常工作的出站規則。核心網路的預先定義規則包括使群組策略發揮作用的出站規則。確保這些出站規則處於活動狀態，並在部署之前徹底測試防火牆設定檔。"
    rationale: "有些人認為，謹慎的做法是阻止所有出站連接，除非用戶或管理員特別批准的連接。微軟不同意這種觀點，預設阻止出站連接將迫使用戶處理大量對話方塊，提示他們授權或阻止應用程序，例如網頁瀏覽器或即時通訊軟體。此外，阻止出站流量沒有什麼價值，因為如果攻擊者破壞了系統，他們無論如何都可以重新配置防火牆。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立建議的配置，將以下介面路徑設置為允許（預設值）：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Outbound connections."
    compliance:
      - cis: ["9.3.3"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DefaultOutboundAction -> 0'

  # 9.3.4 (L1) Ensure 'Windows Firewall: Public: Settings: Display a notification' is set to 'No'. (Automated)
  - id: 16088
    title: "確保「Windows 防火牆：公用：設定：顯示通知」設定為「否」。"
    description: "選擇此選項可讓進階安全性 Windows 防火牆在程式被阻止接收入站連線時向使用者顯示通知。此設定的建議狀態是：否。"
    rationale: "當防火牆規則阻止某些類型的網路活動時，某些組織可能更願意避免警告使用者。但是，在排除涉及防火牆的網路問題時，通知會很有幫助。"
    impact: "Windows Firewall will not display a notification when a program is blocked from receiving inbound connections."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為「否」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Display a notification."
    compliance:
      - cis: ["9.3.4"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DisableNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> DisableNotifications -> 1'

  # 9.3.5 (L1) Ensure 'Windows Firewall: Public: Settings: Apply local firewall rules' is set to 'No'. (Automated)
  - id: 16089
    title: "確保「Windows 防火牆：公用：設定：套用本機防火牆規則」設定為「否」。"
    description: "此設定控制是否允許本機管理員建立與群組原則配置的防火牆規則一起套用的本機防火牆規則。此設定的建議狀態為：否。的訊息。"
    rationale: "在公共設定檔中時，每台電腦不應有特殊的本地防火牆例外。這些設定應由集中策略管理。"
    impact: "Administrators can still create firewall rules, but the rules will not be applied."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為「否」: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Apply local firewall rules."
    compliance:
      - cis: ["9.3.5"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalPolicyMerge'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalPolicyMerge -> 0'

  # 9.3.6 (L1) Ensure 'Windows Firewall: Public: Settings: Apply local connection security rules' is set to 'No'. (Automated)
  - id: 16090
    title: "確保「Windows 防火牆：公用：設定：套用本機連線安全規則」設定為「否」。"
    description: "此設定控制是否允許本機管理員建立與群組原則配置的連線安全規則一起套用的連線安全規則。此設定的建議狀態是：否。"
    rationale: "具有管理權限的使用者可能會建立防火牆規則，使系統遭受遠端攻擊。"
    impact: "Administrators can still create local connection security rules, but the rules will not be applied."
    remediation: "要透過GP建立推薦的配置，將以下UI路徑設定為 否 : Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Settings Customize\\Apply local connection security rules."
    compliance:
      - cis: ["9.3.6"]
      - cis_csc_v8: ["4.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4"]
      - pci_dss_v4.0: ["1.2.1"]
      - soc_2: ["CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalIPsecPolicyMerge'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0'

  # 9.3.7 (L1) Ensure 'Windows Firewall: Public: Logging: Name' is set to '%SystemRoot%\System32\logfiles\firewall\publicfw.log'. (Automated)
  - id: 16091
    title: "確保「Windows 防火牆：公用：日誌記錄：名稱」設定為「%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入其日誌資訊的檔案的路徑和名稱。此設定的建議狀態為：%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log。"
    rationale: "如果未記錄 Windows 防火牆事件，管理員可能很難或不可能分析系統問題或惡意使用者的未經授權的活動。 Microsoft 將所有防火牆事件儲存為系統上的一個檔案 (pfirewall.log)。為了改善日誌記錄，請將每個防火牆設定檔（網域、私人、公用）分開到其自己的不同日誌檔案（domainfw.log、privatefw.log、publicfw.log）中，以便更好地組織和識別每個設定檔中的特定問題。"
    impact: "The log file will be stored in the specified file."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Name."
    compliance:
      - cis: ["9.3.7"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFilePath'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFilePath -> r:System32\\logfiles\\firewall\\publicfw.log'

  # 9.3.8 (L1) Ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16,384 KB or greater'. (Automated)
  - id: 16092
    title: "確保「Windows 防火牆：公用：日誌記錄：大小限制 (KB)」設定為「16,384 KB 或更大」。"
    description: "使用此選項指定 Windows 防火牆將在其中寫入日誌資訊的檔案的大小限制。此設定的建議狀態為：16,384 KB 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "The log file size will be limited to the specified size, old events will be overwritten by newer ones when the limit is reached."
    remediation: "要透過GP設定推薦的配置，請將以下UI路徑設定為16,384 KB或更大: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Size limit (KB)."
    compliance:
      - cis: ["9.3.8"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFileSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogFileSize -> n:^(\d+) compare >= 16384'

  # 9.3.9 (L1) Ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes'. (Automated)
  - id: 16093
    title: "確保「Windows 防火牆：公共：日誌記錄：記錄丟棄的封包」設定為「是」。"
    description: "使用此選項記錄進階安全性 Windows 防火牆因任何原因丟棄入站資料包時的情況。日誌記錄資料包被丟棄的原因和時間。在日誌的操作列中尋找帶有單字 DROP 的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Information about dropped packets will be recorded in the firewall log file."
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設定為Yes: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Log dropped packets."
    compliance:
      - cis: ["9.3.9"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogDroppedPackets'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogDroppedPackets -> 1'

  # 9.3.10 (L1) Ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes'. (Automated)
  - id: 16094
    title: "確保「Windows 防火牆：公用：日誌記錄：記錄成功的連線」設定為「是」。"
    description: "當具有進階安全性的 Windows 防火牆允許入站連線時，請使用此選項進行記錄。日誌記錄建立連線的原因和時間。在日誌的操作列中尋找帶有“ALLOW”一詞的條目。此設定的建議狀態是：是。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Information about successful connections will be recorded in the firewall log file."
    remediation: "要透過GP設置推薦配置，請將以下UI路徑設置為是：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security\\Windows Firewall Properties\\Public Profile\\Logging Customize\\Log successful connections."
    compliance:
      - cis: ["9.3.10"]
      - cis_csc_v8: ["4.5", "8.5"]
      - cis_csc_v7: ["9.4", "11.2"]
      - cmmc_v2.0: ["AC.L1-3.1.20", "AU.L2-3.3.1", "CM.L2-3.4.7", "SC.L1-3.13.1", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7", "SC-7(5)"]
      - pci_dss_v3.2.1: ["1.1.4", "1.4", "10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["1.2.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.6", "CC7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogSuccessfulConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging -> LogSuccessfulConnections -> 1'

  ###############################################
  # 17 Advanced Audit Policy Configuration
  ###############################################

  # 17.1.1 (L1) Ensure 'Audit Credential Validation' is set to 'Success and Failure'. (Automated)
  - id: 16095
    title: "確保“審核憑證驗證”設定為“成功和失敗”。"
    description: "此子類別會報告針對使用者帳戶登入要求提交的憑證的驗證測試結果。這些事件發生在對憑證具有權威性的電腦上。對於網域帳戶，網域控制站是權威的，而對於本機帳戶，本機電腦是權威的。在網域環境中，大多數帳戶登入事件發生在對網域帳戶具有權威的網域控制站的安全性日誌中。但是，當使用本機帳戶登入時，這些事件可能會發生在組織中的其他電腦上。此子類別的活動包括： - 4774：映射帳戶用於登入。 - 4775：無法對應帳戶以進行登入。 - 4776：網域控制器嘗試驗證帳戶的憑證。 - 4777：網域控制器無法驗證帳戶的憑證。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設置為“成功和失敗”：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\\Audit Credential Validation."
    compliance:
      - cis: ["17.1.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.12"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Credential Validation" -> r:Success and Failure'

  # 17.1.2 (L1) Ensure 'Audit Kerberos Authentication Service' is set to 'Success and Failure' (DC Only). (Automated)
  - id: 16096
    title: "確保「審核 Kerberos 驗證服務」設定為「成功和失敗」（僅限 DC）。"
    description: "此子類別會報告 Kerberos 驗證 TGT 請求後產生的事件的結果。 Kerberos 是一種分散式身份驗證服務，允許代表使用者運行的用戶端向伺服器證明其身份，而無需透過網路發送資料。這有助於防止攻擊者或伺服器冒充使用者。 - 4768：請求了 Kerberos 驗證票證 (TGT)。 - 4771：Kerberos 預驗證失敗。 - 4772：Kerberos 身份驗證票證請求失敗。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過 GP 建立建議的配置, 將以下 UI 路徑設置為 成功 和 失敗: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\\Audit Kerberos Authentication Service."
    compliance:
      - cis: ["17.1.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Kerberos Authentication Service" -> r:Success and Failure'

  # 17.1.3 (L1) Ensure 'Audit Kerberos Service Ticket Operations' is set to 'Success and Failure' (DC Only). (Automated)
  - id: 16097
    title: "確保「審核 Kerberos 服務票證操作」設定為「成功和失敗」（僅限 DC）。"
    description: "此子類別會報告 Kerberos 驗證票證授予票證 (TGT) 請求產生的事件結果。 Kerberos 服務票證請求（TGS 請求）作為特定帳戶的服務使用和存取請求的一部分發生。審核這些事件將記錄帳戶請求 TGS 的 IP 位址、請求 TGS 的時間以及使用的加密類型。 - 4769：請求了 Kerberos 服務票證。 - 4770：Kerberos 服務票證已續訂。 - 4773：Kerberos 服務票證請求失敗。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設定為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\\Audit Kerberos Service Ticket Operations."
    compliance:
      - cis: ["17.1.3"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Kerberos Service Ticket Operations" -> r:Success and Failure'

  # 17.2.1 (L1) Ensure 'Audit Application Group Management' is set to 'Success and Failure'. (Automated)
  - id: 16098
    title: "確保“審核應用程式組管理”設定為“成功和失敗”。"
    description: "此原則設定可讓您審核由應用程式群組變更產生的事件，如下所示： - 建立、變更或刪除應用程式群組。 - 在應用程式群組中新增或刪除成員。應用程式群組由 Windows 授權管理器使用，它是 Microsoft 創建的一個靈活的框架，用於將基於角色的存取控制 (RBAC) 整合到應用程式中。有關 Windows 授權管理器的更多資訊，請存取 MSDN - Windows 授權管理器。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查事件時，審核此類別的事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設定為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Application Group Management."
    compliance:
      - cis: ["17.2.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Application Group Management" -> r:Success and Failure'

  # 17.2.2 (L1) Ensure 'Audit Computer Account Management' is set to include 'Success' (DC only). (Automated)
  - id: 16099
    title: "確保「審核電腦帳戶管理」設定為包含「成功」（僅限 DC）。"
    description: "此子類別報告電腦帳戶管理的每個事件，例如建立、變更、刪除、重新命名、停用或啟用電腦帳戶的時間。此子類別的事件包括： - 4741：已建立電腦帳戶。 - 4742：電腦帳戶已變更。 - 4743：電腦帳戶已刪除。此設定的建議狀態包括：成功。"
    rationale: "在調查事件時，審核此類別的事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過群組原則(GP)設置推薦的配置，設置以下用戶界面路徑以包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Computer Account Management."
    compliance:
      - cis: ["17.2.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Computer Account Management" -> r:Success'

  # 17.2.3 (L1) Ensure 'Audit Distribution Group Management' is set to include 'Success' (DC only). (Automated)
  - id: 16100
    title: "確保「審核分發組管理」設定為包含「成功」（僅限 DC）。"
    description: "此子類別會報告通訊群組管理的每個事件，例如建立、變更或刪除通訊群組的時間，或向通訊群組新增或刪除成員的時間。如果啟用此審核策略設置，管理員可以追蹤事件以偵測惡意、意外和授權的群組帳戶建立。此子類別的事件包括： - 4744：建立了停用安全的本機群組。 - 4745：停用安全的本機群組已變更。 - 4746：成員被加入到禁用安全的本機群組。 - 4747：成員已從已停用安全的本機群組中刪除。 - 4748：刪除了停用安全的本機群組。 - 4749：建立了禁用安全的全域群組。 - 4750：停用安全的全域群組已變更。 - 4751：成員被加入到禁用安全的全域群組。 - 4752：成員已從禁用安全的全域群組中刪除。 - 4753：刪除了停用安全的全域群組。 - 4759：已建立停用安全的通用群組。 - 4760：停用安全性的通用群組已變更。 - 4761：成員被加入到禁用安全的通用群組。 - 4762：成員已從禁用安全的通用群組中刪除。 - 4763：刪除了停用安全的通用群組。此設定的建議狀態包括：成功。"
    rationale: "審核這些事件可以為組織在調查事件時提供洞察力。例如，當給定的未經授權的使用者被加入到敏感通訊群組時。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為包含 Success: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Distribution Group Management."
    compliance:
      - cis: ["17.2.3"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Distribution Group Management" -> r:Success'

  # 17.2.4 (L1) Ensure 'Audit Other Account Management Events' is set to include 'Success' (DC only). (Automated)
  - id: 16101
    title: "確保「審核其他帳戶管理事件」設定為包含「成功」（僅限 DC）。"
    description: "此子類別會報告其他帳戶管理事件。此子類別的事件包括： - 4782：存取帳戶的密碼雜湊。 - 4793：呼叫了密碼原則檢查 API。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為包含成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Other Account Management Events."
    compliance:
      - cis: ["17.2.4"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Other Account Management Events" -> r:Success'

  # 17.2.5 (L1) Ensure 'Audit Security Group Management' is set to include 'Success'. (Automated)
  - id: 16102
    title: "確保「審核安全群組管理」設定為包括「成功」。"
    description: "此子類別會報告安全性群組管理的每個事件，例如何時建立、變更或刪除安全性群組，或何時向安全性群組新增或刪除成員。如果啟用此審核策略設置，管理員可以追蹤事件以偵測安全群組帳戶的惡意、意外和授權建立。此子類別的事件包括： - 4727：已建立啟用安全性的全域群組。 - 4728：成員已新增至啟用安全性的全域群組。 - 4729：成員已從啟用安全的全域群組中刪除。 - 4730：已刪除啟用安全的全域群組。 - 4731：已建立啟用安全的本機群組。 - 4732：成員已新增至啟用安全的本機群組。 - 4733：成員已從啟用安全的本機群組中刪除。 - 4734：已刪除啟用安全的本機群組。 - 4735：啟用安全的本機群組已變更。 - 4737：啟用安全的全域群組已變更。 - 4754：建立了啟用安全的通用群組。 - 4755：啟用安全的通用群組已變更。 - 4756：成員已新增至啟用安全的通用群組。 - 4757：成員已從啟用安全的通用群組中刪除。 - 4758：已刪除啟用安全的通用群組。 - 4764：群組的類型已變更。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為包含成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit Security Group Management."
    compliance:
      - cis: ["17.2.5"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.6"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1", "A.9.2.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Security Group Management" -> r:Success'

  # 17.2.6 (L1) Ensure 'Audit User Account Management' is set to 'Success and Failure'. (Automated)
  - id: 16103
    title: "確保「審核使用者帳戶管理」設定為「成功和失敗」。"
    description: "此子類別報告使用者帳戶管理的每個事件，例如建立、變更或刪除使用者帳戶的時間；使用者帳戶被重新命名、停用或啟用；或設定或更改了密碼。如果啟用此審核策略設置，管理員可以追蹤事件以偵測惡意、意外和授權的使用者帳戶建立。此子類別的事件包括： - 4720：已建立使用者帳戶。 - 4722：使用者帳戶已啟用。 - 4723：嘗試變更帳戶密碼。 - 4724：嘗試重設帳戶密碼。 - 4725：使用者帳號已停用。 - 4726：使用者帳號已刪除。 - 4738：使用者帳戶已更改。 - 4740：使用者帳號被鎖定。 - 4765：SID 歷史記錄已新增至帳戶。 - 4766：嘗試將 SID 歷史記錄新增至帳戶失敗。 - 4767：用戶帳號已解鎖。 - 4780：ACL 是在屬於管理員群組成員的帳戶上設定的。 - 4781：帳戶名稱已變更： - 4794：嘗試設定目錄服務還原模式。 - 5376：憑證管理器憑證已備份。 - 5377：憑證管理器憑證已從備份中還原。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過 GP 確立推薦的配置，將以下 UI 路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management."
    compliance:
      - cis: ["17.2.6"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"User Account Management" -> r:Success and Failure'

  # 17.3.1 (L1) Ensure 'Audit PNP Activity' is set to include 'Success'. (Automated)
  - id: 16104
    title: "確保「審核 PNP 活動」設定為包括「成功」。"
    description: "此政策設定可讓您審核即插即用偵測到外部裝置的時間。此設定的建議狀態包括：成功。注意：需要 Windows 10、Server 2016 或更高版本的作業系統才能在群組原則中存取和設定此值。"
    rationale: "啟用此設定將允許使用者在裝置插入系統時審核事件。如果插入未經批准的設備，這可以幫助提醒 IT 人員。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過GP建立建議配置，將以下UI路徑設置為包括成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Detailed Tracking\\Audit PNP Activity."
    compliance:
      - cis: ["17.3.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"PNP Activity" -> r:Success'

  # 17.3.2 (L1) Ensure 'Audit Process Creation' is set to include 'Success'. (Automated)
  - id: 16105
    title: "確保“審核流程創建”設定為包括“成功”。"
    description: "此子類別報告程序的建立以及建立該程序的程式或使用者的名稱。此子類別的事件包括： - 4688：已建立新程序。 - 4696：主令牌已指派給程序。有關此設定的最新資訊，請參閱 Microsoft 知識庫文章 947226：Windows Vista 和 Windows Server 2008 中的安全性事件說明。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為包括成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Detailed Tracking\\Audit Process Creation."
    compliance:
      - cis: ["17.3.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Process Creation" -> r:Success'

  # 17.4.1 (L1) Ensure 'Audit Directory Service Access' is set to include 'Failure' (DC only). (Automated)
  - id: 16106
    title: "確保「審核目錄服務存取」設定為包括「失敗」（僅限 DC）。"
    description: "此子類別會報告何時存取 AD DS 物件。只有具有 SACL 的物件才會產生審核事件，並且僅當以與其 SACL 匹配的方式存取它們時。這些事件與先前版本的 Windows Server 中的目錄服務存取事件類似。此子類別僅適用於網域控制站。此子類別的事件包括： - 4662：對物件執行了操作。此設定的建議狀態包括：失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過GP建立推薦的配置，將以下的UI路徑設置為包含失敗: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Access."
    compliance:
      - cis: ["17.4.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Directory Service Access" -> r:Failure'

  # 17.4.2 (L1) Ensure 'Audit Directory Service Changes' is set to include 'Success' (DC only). (Automated)
  - id: 16107
    title: "確保「審核目錄服務變更」設定為包含「成功」（僅限 DC）。"
    description: "此子類別報告 Active Directory 網域服務 (AD DS) 中物件的變更。報表的變更類型是對物件執行的建立、修改、移動和取消刪除操作。 DS 變更審核在適當的情況下指示已變更物件的已變更屬性的舊值和新值。只有具有 SACL 的物件才會產生審核事件，並且僅當以與其 SACL 匹配的方式存取它們時。由於架構中物件類別的設置，某些物件和屬性不會導致生成審核事件。此子類別僅適用於網域控制站。此子類別的事件包括： - 5136：目錄服務物件已修改。 - 5137：建立了目錄服務物件。 - 5138：目錄服務物件被取消刪除。 - 5139：目錄服務物件已移動。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立建議配置，將以下 UI 路徑設定為包含成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes."
    compliance:
      - cis: ["17.4.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Directory Service Changes" -> r:Success'

  # 17.5.1 (L1) Ensure 'Audit Account Lockout' is set to include 'Failure'. (Automated)
  - id: 16108
    title: "確保「審核帳戶鎖定」設定為包括「失敗」。"
    description: "此子類別會報告使用者帳號因登入嘗試失敗次數過多而被鎖定的情況。此子類別的事件包括： - 4625：帳戶登入失敗。此設定的建議狀態包括：失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過群組原則(GP)建立建議配置，請設定以下操作介面路徑以包含失敗事件：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Account Lockout."
    compliance:
      - cis: ["17.5.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.6"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1", "A.9.2.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Account Lockout" -> r:Failure'

  # 17.5.2 (L1) Ensure 'Audit Group Membership' is set to include 'Success'. (Automated)
  - id: 16109
    title: "確保「審核組成員資格」設定為包括「成功」。"
    description: "此原則可讓您審核使用者登入權杖中的群組成員識別資訊。此子類別中的事件是在建立登入工作階段的電腦上產生的。對於互動式登入，安全審核事件會在使用者登入的電腦上產生。對於網路登入，例如存取網路上的共用資料夾，安全性審核事件會在託管資源的電腦上產生。此設定的建議狀態包括：成功。注意：需要 Windows 10、Server 2016 或更高版本的作業系統才能在群組原則中存取和設定此值。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過 GP 建立推薦配置，請設定以下 UI 路徑以包含成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Group Membership."
    compliance:
      - cis: ["17.5.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Group Membership" -> r:Success'

  # 17.5.3 (L1) Ensure 'Audit Logoff' is set to include 'Success'. (Automated)
  - id: 16110
    title: "確保「審核註銷」設定為包括「成功」。"
    description: "此子類別會報告使用者何時從系統登出。這些事件發生在被存取的電腦上。對於互動式登入，這些事件的產生發生在登入的計算機上。如果進行網頁登入來存取共用，則會在託管所存取資源的電腦上產生這些事件。如果將此設定配置為“無審核”，則很難或不可能確定哪個使用者已存取或嘗試存取組織電腦。此子類別的活動包括： - 4634：帳戶已登出。 - 4647：用戶發起註銷。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過GP設定建議的配置，請設置以下UI路徑以包括成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Logoff."
    compliance:
      - cis: ["17.5.3"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.13"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Logoff" -> r:Success'

  # 17.5.4 (L1) Ensure 'Audit Logon' is set to 'Success and Failure'. (Automated)
  - id: 16111
    title: "確保“審核登入”設定為“成功和失敗”。"
    description: "此子類別報告使用者何時嘗試登入系統。這些事件發生在被存取的電腦上。對於互動式登入，這些事件的產生發生在登入的計算機上。如果進行網頁登入來存取共用，則會在託管所存取資源的電腦上產生這些事件。如果將此設定配置為“無審核”，則很難或不可能確定哪個使用者已存取或嘗試存取組織電腦。此子類別的活動包括： - 4624：帳戶已成功登入。 - 4625：帳號登入失敗。 - 4648：嘗試使用明確憑證登入。 - 4675：SID 已被過濾。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過 GP 建立建議配置，將以下 UI 路徑設定為 Success 和 Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Logon."
    compliance:
      - cis: ["17.5.4"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.13"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Logon" -> r:Success and Failure'

  # 17.5.5 (L1) Ensure 'Audit Other Logon/Logoff Events' is set to 'Success and Failure'. (Automated)
  - id: 16112
    title: "確保「審核其他登入/登出事件」設定為「成功和失敗」。"
    description: "此子類別會報告其他登入/登出相關事件，例如遠端桌面服務工作階段已中斷和重新連線、使用 RunAs 在不同帳戶下執行程序以及鎖定和解鎖工作站。此子類別的事件包括： - 4649：偵測到重播攻擊。 - 4778：會話已重新連接到 Window Station。 - 4779：會話已從 Window Station 中斷。 - 4800：工作站被鎖定。 - 4801：工作站已解鎖。 - 4802：螢幕保護程式被呼叫。 - 4803：螢幕保護程式被關閉。 - 5378：策略不允許請求的憑證委派。 - 5632：請求對無線網路進行身份驗證。 - 5633：請求對有線網路進行身份驗證。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過GP建立建議的配置，將以下使用者介面路徑中的成功和失敗設為：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Other Logon/Logoff Events。"
    compliance:
      - cis: ["17.5.5"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.13"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Other Logon/Logoff Events" -> r:Success and Failure'

  # 17.5.6 (L1) Ensure 'Audit Special Logon' is set to include 'Success'. (Automated)
  - id: 16113
    title: "確保「審核特殊登入」設定為包括「成功」。"
    description: "此子類別會報告何時使用特殊登入。特殊登入是具有管理員等效權限的登入，可用於將程序提升到更高層級。此子類別的事件包括： - 4964：特殊群組已指派給新登入。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過GP建立建議配置，將以下UI路徑設置為包括成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Logon/Logoff\\Audit Special Logon."
    compliance:
      - cis: ["17.5.6"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3", "16.13"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Special Logon" -> r:Success'

  # 17.6.1 (L1) Ensure 'Audit Detailed File Share' is set to include 'Failure'. (Automated)
  - id: 16114
    title: "確保“審核詳細檔案共用”設定為包括“失敗”。"
    description: "此子類別可讓您審核存取共用資料夾上的檔案和資料夾的嘗試。此子類別的事件包括： - 5145：檢查網路共用物件以查看是否可以授予客戶端所需的存取權限。此設定的建議狀態包括：失敗。"
    rationale: "審核失敗將記錄哪些未經授權的使用者嘗試（並失敗）存取此電腦上網路共用上的檔案或資料夾，這可能表示存在惡意意圖。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為包括Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit Detailed File Share."
    compliance:
      - cis: ["17.6.1"]
      - cis_csc_v8: ["3.3", "8.5"]
      - cis_csc_v7: ["6.3", "14.6"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "AC.L2-3.1.3", "AC.L2-3.1.5", "AU.L2-3.3.1", "MP.L2-3.8.2"]
      - hipaa: ["164.308(a)(3)(i)", "164.308(a)(3)(ii)(A)", "164.312(a)(1)"]
      - iso_27001-2013: ["A.12.4.1", "A.9.1.1"]
      - nist_sp_800-53: ["AC-5", "AC-6", "AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3", "7.1", "7.1.1", "7.1.2", "7.1.3"]
      - pci_dss_v4.0: ["1.3.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "7.1", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.1", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Detailed File Share" -> r:Failure'

  # 17.6.2 (L1) Ensure 'Audit File Share' is set to 'Success and Failure'. (Automated)
  - id: 16115
    title: "確保“審核檔案共用”設定為“成功和失敗”。"
    description: "此原則設定可讓您審核存取共用資料夾的嘗試。此設定的推薦狀態是：成功和失敗。注意：共用資料夾沒有系統存取控制清單 (SACL)。如果啟用此策略設置，將對系統上所有共用資料夾的存取進行審核。"
    rationale: "在企業管理的環境中，追蹤網路共享的刪除、建立、修改和存取事件非常重要。任何異常的檔案共享活動都可能有助於調查潛在的惡意活動。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立建議的配置，將以下用戶介面路徑設置為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit File Share."
    compliance:
      - cis: ["17.6.2"]
      - cis_csc_v8: ["3.3", "8.5"]
      - cis_csc_v7: ["6.3", "14.6"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "AC.L2-3.1.3", "AC.L2-3.1.5", "AU.L2-3.3.1", "MP.L2-3.8.2"]
      - hipaa: ["164.308(a)(3)(i)", "164.308(a)(3)(ii)(A)", "164.312(a)(1)"]
      - iso_27001-2013: ["A.12.4.1", "A.9.1.1"]
      - nist_sp_800-53: ["AC-5", "AC-6", "AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3", "7.1", "7.1.1", "7.1.2", "7.1.3"]
      - pci_dss_v4.0: ["1.3.1", "10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "7.1", "9.4.5"]
      - soc_2: ["CC5.2", "CC6.1", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"File Share" -> r:Success and Failure'

  # 17.6.3 (L1) Ensure 'Audit Other Object Access Events' is set to 'Success and Failure'. (Automated)
  - id: 16116
    title: "確保「審核其他物件存取事件」設定為「成功和失敗」。"
    description: "此策略設定可讓您審核由任務排程程序作業或 COM+ 物件的管理所產生的事件。對於排程程式作業，將審核以下內容： - 建立的作業。 - 作業已刪除。 - 啟用工作。 - 工作被停用。 - 工作更新。對於 COM+ 物件，將審核以下內容： - 新增的目錄物件。 - 更新了目錄物件。 - 目錄物件已刪除。此設定的推薦狀態是：成功和失敗。"
    rationale: "排程任務和 COM+ 物件的意外建立可能表示存在惡意活動。由於這些類型的操作通常數量較少，因此將它們捕獲在審核日誌中以供調查期間使用可能會很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為 Success 和 Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit Other Object Access Events."
    compliance:
      - cis: ["17.6.3"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Audit Other Object Access Events" -> r:Success and Failure'

  # 17.6.4 (L1) Ensure 'Audit Removable Storage' is set to 'Success and Failure'. (Automated)
  - id: 16117
    title: "確保“審核可移動儲存”設定為“成功和失敗”。"
    description: "此政策設定可讓您審核使用者嘗試存取可移動儲存裝置上的檔案系統物件。僅針對請求的所有類型的存取的所有物件產生安全審核事件。如果配置此策略設置，則每次帳戶存取可移動儲存空間上的檔案系統物件時都會產生審核事件。成功審核記錄成功的嘗試，失敗審核記錄不成功的嘗試。如果未配置此策略設置，則當帳戶存取可移動儲存空間上的檔案系統物件時，不會產生審核事件。此設定的推薦狀態是：成功和失敗。注意：需要 Windows 8.0、Server 2012（非 R2）或更高版本的作業系統才能在群組原則中存取和設定此值。"
    rationale: "在調查事件時，審核可移動儲存可能很有用。例如，如果某人涉嫌將敏感資訊複製到 USB 隨身碟上。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要通過 GP 建立推薦的配置，將以下路徑中的設定設為 Success 和 Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Object Access\\Audit Removable Storage."
    compliance:
      - cis: ["17.6.4"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Removable Storage" -> r:Success and Failure'

  # 17.7.1 (L1) Ensure 'Audit Audit Policy Change' is set to include 'Success'. (Automated)
  - id: 16118
    title: "確保「審核審核原則變更」設定為包括「成功」。"
    description: "此子類別會報告審核策略的更改，包括 SACL 更改。此子類別的事件包括： - 4715：物件上的審核原則 (SACL) 已變更。 - 4719：系統審核策略已變更。 - 4902：已建立每使用者審核策略表。 - 4904：嘗試註冊安全事件來源。 - 4905：嘗試取消註冊安全事件來源。 - 4906：CrashOnAuditFail 值已變更。 - 4907：物件的審核設定已更改。 - 4908：特殊群組登入表已修改。 - 4912：每用戶審核策略已更改。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過 GP 建立建議的配置，請設定以下用戶界面路徑以包括成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change."
    compliance:
      - cis: ["17.7.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["5.5", "6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.1.2", "A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Audit Policy Change" -> r:Success'

  # 17.7.2 (L1) Ensure 'Audit Authentication Policy Change' is set to include 'Success'. (Automated)
  - id: 16119
    title: "確保“審核身份驗證策略變更”設定為包括“成功”。"
    description: "此子類別會報告身份驗證策略的變更。此子類別的事件包括： - 4706：為網域建立了新的信任。 - 4707：對網域的信任被刪除。 - 4713：Kerberos 策略已變更。 - 4716：可信任域資訊被修改。 - 4717：已向帳戶授予系統安全存取權限。 - 4718：系統安全存取權限已從帳戶中刪除。 - 4739：網域策略已變更。 - 4864：偵測到名稱空間衝突。 - 4865：新增了可信林資訊條目。 - 4866：刪除了受信任的林資訊條目。 - 4867：可信林資訊條目被修改。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設置為包括 Success: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authentication Policy Change."
    compliance:
      - cis: ["17.7.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["5.5", "6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.1.2", "A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Authentication Policy Change" -> r:Success'

  # 17.7.3 (L1) Ensure 'Audit Authorization Policy Change' is set to include 'Success'. (Automated)
  - id: 16120
    title: "確保「審核授權政策變更」設定為包括「成功」。"
    description: "此子類別會報告授權策略的變更。此子類別的事件包括： - 4703：使用者權限已調整。 - 4704：已指派使用者權限。 - 4705：使用者權限被刪除。 - 4670：物件的權限已更改。 - 4911：物件的資源屬性已變更。 - 4913：物件的中央存取策略已變更。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立建議的配置，請設定以下 UI 路徑以包含成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change."
    compliance:
      - cis: ["17.7.3"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["5.5", "6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.1.2", "A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Authorization Policy Change" -> r:Success'

  # 17.7.4 (L1) Ensure 'Audit MPSSVC Rule-Level Policy Change' is set to 'Success and Failure'. (Automated)
  - id: 16121
    title: "確保「審核 MPSSVC 規則級原則變更」設定為「成功和失敗」。"
    description: "此子類別決定在變更 Microsoft 保護服務 (MPSSVC.exe) 的政策規則時作業系統是否會產生審核事件。此子類別的事件包括： - 4944：Windows 防火牆啟動時下列原則為啟用。 - 4945：Windows 防火牆啟動時列出了規則。 - 4946：對 Windows 防火牆例外清單進行了更改。新增了一條規則。 - 4947：對 Windows 防火牆例外清單進行了更改。修改了一條規則。 - 4948：Windows 防火牆例外清單已變更。刪除了一條規則。 - 4949：Windows 防火牆設定已還原為預設值。 - 4950：Windows 防火牆設定已變更。 - 4951：規則已被忽略，因為 Windows 防火牆無法辨識其主版本號。 - 4952：規則的部分內容已被忽略，因為 Windows 防火牆無法辨識其次要版本號。該規則的其他部分將得到執行。 - 4953：Windows 防火牆已忽略某個規則，因為它無法解析該規則。 - 4954：Windows 防火牆群組原則設定已變更。新設定已套用。 - 4956：Windows 防火牆已變更活動設定檔。 - 4957：Windows 防火牆未套用下列規則。 - 4958：Windows 防火牆未套用下列規則，因為該規則引用了未在此電腦上設定的項目。此設定的推薦狀態是：成功和失敗。"
    rationale: "防火牆規則的變更對於了解電腦的安全狀態以及電腦免受網路攻擊的保護程度非常重要。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為「成功」和「失敗」：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit MPSSVC Rule - Level Policy Change."
    compliance:
      - cis: ["17.7.4"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"MPSSVC Rule-Level Policy Change" -> r:Success and Failure'

  # 17.7.5 (L1) Ensure 'Audit Other Policy Change Events' is set to include 'Failure'. (Automated)
  - id: 16122
    title: "確保「審核其他策略變更事件」設定為包括「失敗」。"
    description: "此子類別包含有關EFS 資料復原代理程式變更、Windows 篩選平台篩選器中的變更、本機群組原則設定的安全性原則設定更新狀態、中央存取原則變更以及加密下一代(CNG​​) 作業的詳細故障排除事件的事件。 - 5063：嘗試了加密提供者操作。 - 5064：嘗試進行加密上下文操作。 - 5065：嘗試修改加密上下文。 - 5066：嘗試進行加密函數操作。 - 5067：嘗試修改加密函數。 - 5068：嘗試進行加密函數提供者操作。 - 5069：嘗試進行加密函數屬性操作。 - 5070：嘗試修改加密函數屬性。 - 6145：處理群組原則物件中的安全性原則時發生一個或多個錯誤。此設定的建議狀態包括：失敗。"
    rationale: "此設定可以幫助偵測應用程式的安全性設定中來自群組原則的錯誤以及與下一代加密 (CNG) 功能相關的故障事件。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "為了通過 GP 建立推薦配置，請將以下 UI 路徑設置為包括 Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Other Policy Change Events."
    compliance:
      - cis: ["17.7.5"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Other Policy Change Events" -> r:Failure'

  # 17.8.1 (L1) Ensure 'Audit Sensitive Privilege Use' is set to 'Success and Failure'. (Automated)
  - id: 16123
    title: "確保“審核敏感權限使用”設定為“成功和失敗”。"
    description: "此子類別會報告使用者帳戶或服務何時使用敏感權限。敏感權限包括以下使用者權限： - 作為作業系統的一部分 - 備份檔案和目錄 - 建立令牌物件 - 偵錯程式 - 使電腦和使用者帳戶能夠信任委派 - 產生安全審核 - - 載入和載入卸載裝置驅動程式- 管理審核和安全性日誌- 修改韌體環境值- 替換程序級令牌- 復原檔案和目錄- 取得檔案或其他物件的所有權驗證後模擬用戶端審核此子類別將建立大量事件。此子類別的事件包括： - 4672：指派給新登入的特殊權限。 - 4673：呼叫了特權服務。 - 4674：嘗試對特權物件進行操作。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 設定建議的配置，請將以下使用者介面路徑設置為成功和失敗： Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Privilege Use\\Audit Sensitive Privilege Use."
    compliance:
      - cis: ["17.8.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Sensitive Privilege Use" -> r:Success and Failure'

  # 17.9.1 (L1) Ensure 'Audit IPsec Driver' is set to 'Success and Failure'. (Automated)
  - id: 16124
    title: "確保“審核 IPsec 驅動程式”設定為“成功和失敗”。"
    description: "此子類別會報告 Internet 協定安全性 (IPsec) 驅動程式的活動。此子類別的事件包括： - 4960：IPsec 丟棄了完整性檢查失敗的入站資料包。如果此問題仍然存在，則可能表示存在網路問題或資料包在傳輸至此電腦的過程中被修改。驗證從遠端電腦發送的資料包與本電腦接收的資料包是否相同。此錯誤也可能表示與其他 IPsec 實作的互通性問題。 - 4961：IPsec 丟棄了重播檢查失敗的入站資料包。如果此問題仍然存在，則可能表示此電腦受到重播攻擊。 - 4962：IPsec 丟棄了重播檢查失敗的入站資料包。入站資料包的序號太低，無法確保它不是重播。 - 4963：IPsec 丟棄了本應受到保護的入站明文資料包。這通常是由於遠端電腦在未通知此電腦的情況下更改了其 IPsec 策略。這也可能是欺騙攻擊嘗試。 - 4965：IPsec 從遠端電腦收到一個安全參數索引 (SPI) 不正確的封包。這通常是由損壞資料包的硬體故障引起的。如果這些錯誤仍然存在，請驗證從遠端電腦發送的資料包是否與此電腦接收的資料包相同。此錯誤也可能表示與其他 IPsec 實作的互通性問題。在這種情況下，如果連線沒有受到阻礙，則可以忽略這些事件。 - 5478：IPsec 服務已成功啟動。 - 5479：IPsec 服務已成功關閉。關閉 IPsec 服務可能會使電腦面臨更大的網路攻擊風險或使電腦面臨潛在的安全風險。 - 5480：IPsec 服務無法取得電腦上網路介面的完整清單。這會帶來潛在的安全風險，因為某些網路介面可能無法獲得所套用的 IPsec 過濾器所提供的保護。使用 IP 安全監視器管理單元來診斷問題。 - 5483：IPsec 服務無法初始化 RPC 伺服器。 IPsec 服務無法啟動。 - 5484：IPsec 服務遇到嚴重故障並已關閉。關閉 IPsec 服務可能會使電腦面臨更大的網路攻擊風險或使電腦面臨潛在的安全風險。 - 5485：IPsec 服務無法處理網路介面即插即用事件上的某些 IPsec 過濾器。這會帶來潛在的安全風險，因為某些網路介面可能無法獲得所套用的 IPsec 過濾器所提供的保護。使用 IP 安全監視器管理單元來診斷問題。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為 Success 和 Failure: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit IPsec Driver."
    compliance:
      - cis: ["17.9.1"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"IPsec Driver" -> r:Success and Failure'

  # 17.9.2 (L1) Ensure 'Audit Other System Events' is set to 'Success and Failure'. (Automated)
  - id: 16125
    title: "確保“審核其他系統事件”設定為“成功和失敗”。"
    description: "此子類別會報告其他系統事件。此子類別的事件包括： - 5024：Windows 防火牆服務已成功啟動。 - 5025：Windows 防火牆服務已停止。 - 5027：Windows 防火牆服務無法從本機儲存檢索安全性原則。該服務將繼續執行當前政策。 - 5028：Windows 防火牆服務無法解析新的安全性原則。該服務將繼續執行目前執行的政策。 - 5029：Windows 防火牆服務無法初始化驅動程式。該服務將繼續執行當前政策。 - 5030：Windows 防火牆服務啟動失敗。 - 5032：Windows 防火牆無法通知使用者它阻止了應用程式接受網路上的傳入連線。 - 5033：Windows 防火牆驅動程式已成功啟動。 - 5034：Windows 防火牆驅動程式已停止。 - 5035：Windows 防火牆驅動程式無法啟動。 - 5037：Windows 防火牆驅動程式偵測到嚴重執行時錯誤。終止。 - 5058：關鍵檔案操作。 - 5059：按鍵遷移操作。此設定的推薦狀態是：成功和失敗。"
    rationale: "擷取這些審核事件可能有助於識別 Windows 防火牆何時未如預期運作。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "若要透過 GP 建立推薦的配置，設定以下使用者介面路徑為成功和失敗：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Other System Events."
    compliance:
      - cis: ["17.9.2"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Other System Events" -> r:Success and Failure'

  # 17.9.3 (L1) Ensure 'Audit Security State Change' is set to include 'Success'. (Automated)
  - id: 16126
    title: "確保“審核安全狀態變更”設定為包括“成功”。"
    description: "此子類別會報告系統安全狀態的變化，例如安全子系統何時啟動和停止。此子類別的事件包括： - 4608：Windows 正在啟動。 - 4609：Windows 正在關閉。 - 4616：系統時間已更改。 - 4621：管理員從 CrashOnAuditFail 中恢復了系統。現在將允許非管理員使用者登入。某些可審核的活動可能尚未記錄。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "為了透過 GP 建立推薦的配置，請設定以下 UI 路徑以包含成功：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Security State Change."
    compliance:
      - cis: ["17.9.3"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Security State Change" -> r:Success'

  # 17.9.4 (L1) Ensure 'Audit Security System Extension' is set to include 'Success'. (Automated)
  - id: 16127
    title: "確保“審核安全系統擴充”設定為包括“成功”。"
    description: "此子類別會報告安全子系統載入的擴充代碼（例如驗證包）。此子類別的事件包括： - 4610：本機安全機構已載入身分驗證套件。 - 4611：受信任的登入程序已向本地安全機構註冊。 - 4614：安全帳戶管理器已載入通知包。 - 4622：本地安全機構已載入安全性包。 - 4697：系統中安裝了服務。此設定的建議狀態包括：成功。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過GP建立建議的配置，請將以下UI路徑設置為包括成功: Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Security System Extension."
    compliance:
      - cis: ["17.9.4"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"Security System Extension" -> r:Success'

  # 17.9.5 (L1) Ensure 'Audit System Integrity' is set to 'Success and Failure'. (Automated)
  - id: 16128
    title: "確保“審核系統完整性”設定為“成功和失敗”。"
    description: "此子類別報告違反安全子系統完整性的行為。此子類別的事件包括： - 4612：分配用於審核訊息排隊的內部資源已耗盡，導致某些審核遺失。 - 4615：LPC 連接埠使用無效。 - 4618：發生了受監控的安全事件模式。 - 4816：RPC 在解密傳入訊息時偵測到完整性違規。 - 5038：程式碼完整性決定檔案的影像雜湊無效。檔案可能會因未經授權的修改而損壞，或者無效的雜湊值可能表示潛在的磁碟裝置錯誤。 - 5056：執行了密碼自檢。 - 5057：加密基元操作失敗。 - 5060：驗證操作失敗。 - 5061：加密操作。 - 5062：執行了核心模式加密自我檢測。此設定的推薦狀態是：成功和失敗。"
    rationale: "在調查安全事件時審核這些事件可能很有用。"
    impact: "If no audit settings are configured, or if audit settings are too lax on the computers in your organization, security incidents might not be detected or not enough evidence will be available for network forensic analysis after security incidents occur. However, if audit settings are too severe, critically important entries in the Security log may be obscured by all of the meaningless entries and computer performance and the available amount of data storage may be seriously affected. Companies that operate in certain regulated industries may have legal obligations to log certain events or activities."
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Success 和 Failure：Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit System Integrity."
    compliance:
      - cis: ["17.9.5"]
      - cis_csc_v8: ["8.5"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["AU.L2-3.3.1"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-3(1)", "AU-7"]
      - pci_dss_v3.2.1: ["10.1", "10.2.2", "10.2.4", "10.2.5", "10.3"]
      - pci_dss_v4.0: ["10.2", "10.2.1", "10.2.1.2", "10.2.1.5", "9.4.5"]
      - soc_2: ["CC5.2", "CC7.2"]
    condition: all
    rules:
      - 'c:auditpol /get /subcategory:"System Integrity" -> r:Success and Failure'

  ###############################################
  # 18 Administrative Templates (Computer)
  ###############################################
  ###############################################
  # 18.1 Control Panel
  ###############################################

  # 18.1.1.1 (L1) Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'. (Automated)
  - id: 16129
    title: "確保“防止啟用鎖定螢幕攝影機”設定為“已啟用”。"
    description: "停用「電腦設定」中的鎖定畫面攝影機切換開關，並防止在鎖定畫面上呼叫攝影機。此設定的建議狀態為：已啟用。"
    rationale: "停用鎖定螢幕攝影機可將鎖定螢幕提供的保護擴充到攝影機功能。"
    impact: "If you enable this setting, users will no longer be able to enable or disable lock screen camera access in PC Settings, and the camera cannot be invoked on the lock screen."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Personalization\\Prevent enabling lock screen camera 注意：此組策略路徑可能並非預設存在。它由組策略模板ControlPanelDisplay.admx/adml提供，該模板包含在Microsoft Windows 8.1 & Server 2012 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.1.1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenCamera'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenCamera -> 1'

  # 18.1.1.2 (L1) Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'. (Automated)
  - id: 16130
    title: "確保「阻止啟用鎖定螢幕幻燈片放映」設定為「已啟用」。"
    description: "停用「電腦設定」中的鎖定螢幕投影片設定並阻止在鎖定畫面上播放投影片。此設定的建議狀態為：已啟用。"
    rationale: "停用鎖定螢幕投影片放映可將鎖定畫面提供的保護擴及投影片放映內容。"
    impact: "If you enable this setting, users will no longer be able to modify slide show settings in PC Settings, and no slide show will ever start."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Personalization\\Prevent enabling lock screen slide show 注意: 此群組原則路徑可能預設不存在。它由群組原則模板 ControlPanelDisplay.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 & Server 2012 R2 Administrative Templates (或更新版本) 中。"
    compliance:
      - cis: ["18.1.1.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenSlideshow'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization -> NoLockScreenSlideshow -> 1'

  # 18.1.2.2 (L1) Ensure 'Allow users to enable online speech recognition services' is set to 'Disabled'. (Automated)
  - id: 16131
    title: "確保「允許使用者啟用線上語音辨識服務」設定為「停用」。"
    description: "此策略支援輸入個人化的自動學習組件，包括語音、墨跡書寫和打字。自動學習可以收集語音和手寫模式、打字歷史記錄、聯絡人和最近的日曆資訊。使用 Cortana 需要它。在墨跡書寫和打字的情況下，所收集的部分資訊可能會儲存在使用者的 OneDrive 上；一些資訊將被上傳到微軟以個性化語音。此設定的建議狀態是：停用。"
    rationale: "如果啟用此設置，敏感資訊可能會儲存在雲端或傳送給 Microsoft。"
    impact: "Automatic learning of speech, inking, and typing stops and users cannot change its value via PC Settings."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為「已禁用」: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Regional and Language Options\\Allow users to enable online speech recognition services 注意: 此群組原則路徑預設可能不存在。它是由群組原則範本 Globalization.admx/adml 提供，該範本包含在 Microsoft Windows 10 RTM（版本 1507）管理範本中（或更新版本）。 注意 #2: 在較舊的 Microsoft Windows 管理範本中，該設置最初被命名為 Allow input personalization，但從 Windows 10 R1809 和 Server 2019 管理範本開始，該設置重新命名為 Allow users to enable online speech recognition services。"
    compliance:
      - cis: ["18.1.2.2"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\InputPersonalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\InputPersonalization -> AllowInputPersonalization'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\InputPersonalization -> AllowInputPersonalization -> 0'

  # 18.1.3 (L2) Ensure 'Allow Online Tips' is set to 'Disabled'. (Automated)
  - id: 16132
    title: "確保「允許線上提示」設定為「停用」。"
    description: "此策略設定配置「設定」應用程式的線上提示和幫助的檢索。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    impact: "Settings will not contact Microsoft content services to retrieve tips and help content."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Control Panel\\Allow Online Tips 注意：此群組政策路徑可能預設不存在。它由群組政策範本ControlPanel.admx/adml提供，該範本包含在Microsoft Windows 10 Release 1709 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.1.3"]
      - cis_csc_v7: ["9.2", "9.3"]
      - iso_27001-2013: ["A.13.1.1", "A.13.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> AllowOnlineTips'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> AllowOnlineTips -> 0'

  # 18.3.1 (L1) Ensure LAPS AdmPwd GPO Extension / CSE is installed (MS only). (Automated)
  - id: 16133
    title: "確保 LAPS AdmPwd GPO 擴充功能/CSE 已安裝（僅限 MS）。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。注意：使用第三方商業軟體來管理網域成員的獨特且複雜的本地管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    impact: "No impact. When installed and registered properly, AdmPwd.dll takes no action unless given appropriate GPO commands during Group Policy refresh. It is not a memory-resident agent or service. In a disaster recovery scenario where Active Directory is not available, the local Administrator password will not be retrievable and a local password reset using a tool (such as Microsoft's Disaster and Recovery Toolset (DaRT) Recovery Image) may be necessary."
    remediation: "為了使用LAPS，需要進行一次小型的Active Directory架構更新，並且必須在每台受管理的電腦上安裝Group Policy Client Side Extension (CSE)。安裝LAPS時，必須將檔案AdmPwd.dll放置在以下位置並在Windows中註冊(安裝LAPS AdmPwd GPO Extension / CSE會自動完成此操作)：C:\\Program Files\\LAPS\\CSE\\AdmPwd.dll。"
    compliance:
      - cis: ["18.3.1"]
      - cis_csc_v8: ["5.2", "5.4"]
      - cis_csc_v7: ["4.4", "16.2"]
      - cmmc_v2.0: ["AC.L2-3.1.5", "AC.L2-3.1.6", "AC.L2-3.1.7", "IA.L2-3.5.7", "SC.L2-3.13.3"]
      - iso_27001-2013: ["A.9.4.3"]
      - nist_sp_800-53: ["AC-6(2)", "AC-6(5)"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1", "CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA} -> DllName'

  # 18.3.2 (L1) Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled' (MS only). (Automated)
  - id: 16134
    title: "確保「不允許密碼過期時間長於政策要求的時間」設定為「啟用」（僅限 MS）。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：已啟用。注意：使用第三方商業軟體來管理網域成員的獨特且複雜的本地管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    impact: 'Planned password expiration longer than password age dictated by "Password Settings" policy is NOT allowed.'
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Do not allow password expiration time longer than required by policy 注意: 此群組原則路徑預設不存在。需要額外的群組原則模板 (AdmPwd.admx/adml) - 它包含在Microsoft本地管理員密碼解決方案（LAPS）中。"
    compliance:
      - cis: ["18.3.2"]
      - cis_csc_v7: ["16.10"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PwdExpirationProtectionEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PwdExpirationProtectionEnabled -> 1'

  # 18.3.3 (L1) Ensure 'Enable Local Admin Password Management' is set to 'Enabled' (MS only). (Automated)
  - id: 16135
    title: "確保「啟用本機管理員密碼管理」設定為「已啟用」（僅限 MS）。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：已啟用。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    impact: "The local administrator password is managed (provided that the LAPS AdmPwd GPO Extension / CSE is installed on the target computer (see recommendation Ensure LAPS AdmPwd GPO Extension / CSE is installed), the Active Directory domain schema and account permissions have been properly configured on the domain). In a disaster recovery scenario where Active Directory is not available, the local Administrator password will not be retrievable and a local password reset using a tool (such as Microsoft's Disaster and Recovery Toolset (DaRT) Recovery Image) may be necessary."
    remediation: "要透過 GP 建立推薦配置，將以下 UI 路徑設為已啟用: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Enable Local Admin Password Management 注意: 此群組原則路徑預設不存在。需要額外的群組原則範本 (AdmPwd.admx/adml) - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.3.3"]
      - cis_csc_v8: ["5.2", "5.4"]
      - cis_csc_v7: ["4.4", "16.2"]
      - cmmc_v2.0: ["AC.L2-3.1.5", "AC.L2-3.1.6", "AC.L2-3.1.7", "IA.L2-3.5.7", "SC.L2-3.13.3"]
      - iso_27001-2013: ["A.9.4.3"]
      - nist_sp_800-53: ["AC-6(2)", "AC-6(5)"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1", "CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> AdmPwdEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> AdmPwdEnabled -> 1'

  # 18.3.4 (L1) Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters' (MS only). (Automated)
  - id: 16136
    title: "確保「密碼設定：密碼複雜度」設定為「啟用：大字母 + 小字母 + 數字 + 特殊字元」（僅限 MS）。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為：啟用：大字母+小字母+數字+特殊字元。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    impact: "LAPS-generated passwords will be required to contain large letters + small letters + numbers + special characters."
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為Enabled，並將Password Complexity選項配置為Large letters + small letters + numbers + special characters: Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings 注意：此群組原則路徑預設不存在。需要額外的群組原則模板(AdmPwd.admx/adml) - 它已包含在Microsoft Local Administrator Password Solution (LAPS)中。"
    compliance:
      - cis: ["18.3.4"]
      - cis_csc_v8: ["5.2"]
      - cis_csc_v7: ["4.4"]
      - cmmc_v2.0: ["IA.L2-3.5.7"]
      - iso_27001-2013: ["A.9.4.3"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordComplexity'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordComplexity -> 4'

  # 18.3.5 (L1) Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more' (MS only). (Automated)
  - id: 16137
    title: "確保“密碼設定：密碼長度”設定為“啟用：15 或更多”（僅限 MS）。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為： 啟用：15 或更多。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    impact: "LAPS-generated passwords will be required to have a length of 15 characters (or more, if selected)."
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為「已啟用」，並將「密碼長度」選項配置為 15 或更多：Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings 注意：此群組政策路徑預設情況下不存在。需要添加額外的群組政策模板（AdmPwd.admx/adml） - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.3.5"]
      - cis_csc_v8: ["5.2"]
      - cis_csc_v7: ["4.4"]
      - cmmc_v2.0: ["IA.L2-3.5.7"]
      - iso_27001-2013: ["A.9.4.3"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordLength'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordLength -> n:^(\d+) compare >= 15'

  # 18.3.6 (L1) Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer' (MS only). (Automated)
  - id: 16138
    title: "確保「密碼設定：密碼期限（天）」設定為「啟用：30 或更少」（僅限 MS）。"
    description: "2015 年5 月，Microsoft 發布了本地管理員密碼解決方案(LAPS) 工具，該工具是免費且受支援的軟體，允許組織在網域連接的工作站和成員伺服器上自動設定隨機且唯一的本機管理員帳戶密碼。密碼儲存在網域電腦帳戶的機密屬性中，並且可以在需要時由核准的系統管理員從 Active Directory 中檢索。 LAPS 工具需要進行小型 Active Directory 架構更新才能實施，並在目標電腦上安裝群組原則用戶端擴充 (CSE)。有關詳細資訊，請參閱 LAPS 檔案。 LAPS 支援 Windows Vista 或更高版本的工作站作業系統以及 Server 2003 或更高版本的伺服器作業系統。 LAPS 不支援獨立電腦 - 它們必須加入網域。此設定的建議狀態為： 啟用：30 或更少。注意：使用第 3 方商業軟體來管理網域成員的獨特且複雜的本機管理員密碼的組織可能會選擇忽略這些 LAPS 建議。注意#2：LAPS 僅設計用於管理本機管理員密碼，因此不建議（或支援）直接在沒有傳統本機管理員帳戶的網域控制站上使用。我們強烈建議您僅將 LAPS CSE 和 LAPS GPO 設定部署到成員伺服器和工作站。"
    rationale: "由於管理本機管理員密碼的困難，許多組織在部署時選擇在所有工作站和/或成員伺服器上使用相同的密碼。這會造成嚴重的攻擊面安全風險，因為如果攻擊者設法破壞一個系統並了解其本機管理員帳戶的密碼，那麼他們可以利用該帳戶立即存取也使用該本機管理員密碼的所有其他電腦帳戶。"
    impact: "LAPS-generated passwords will be required to have a maximum age of 30 days (or fewer, if selected)."
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為啟用，並將密碼年齡（天）選項配置為 30 天或更少：Computer Configuration\\Policies\\Administrative Templates\\LAPS\\Password Settings 注意：預設情況下，這條群組政策路徑不存在。需要額外的群組政策模板 (AdmPwd.admx/adml) - 它包含在 Microsoft Local Administrator Password Solution (LAPS) 中。"
    compliance:
      - cis: ["18.3.6"]
      - cis_csc_v8: ["5.2"]
      - cis_csc_v7: ["16.10"]
      - cmmc_v2.0: ["IA.L2-3.5.7"]
      - pci_dss_v4.0: ["2.2.2", "8.3.5", "8.3.6", "8.6.3"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordAgeDays'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft Services\AdmPwd -> PasswordAgeDays -> n:^(\d+) compare <= 30'

  # 18.4.1 (L1) Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled' (MS only). (Automated)
  - id: 16139
    title: "確保「在網路登入時對本機帳戶套用 UAC 限制」設定為「啟用」（僅限 MS）。"
    description: '此設定控製本機帳戶是否可用於透過網路登入進行遠端管理（例如，NET USE、連線至 C$ 等）。當在多個系統上配置相同的帳戶和密碼時，本機帳戶面臨憑證被盜的高風險。啟用此策略可顯著降低該風險。啟用：將 UAC 令牌過濾套用至網路登入的本機帳戶。停用管理員等強大群組中的成員資格，並從產生的存取權杖中刪除強大的權限。這會將 LocalAccountTokenFilterPolicy 註冊表值配置為 0。停用：透過將LocalAccountTokenFilterPolicy 註冊表值配置為1，允許本機帳戶在透過網路登入進行身份驗證時擁有完全管理權限。其他攻擊”憑證盜竊技術”檔案。有關 LocalAccountTokenFilterPolicy 的詳細資訊，請參閱 Microsoft 知識庫文章 951016：Windows Vista 中使用者帳戶控制和遠端限制的說明。此設定的建議狀態為：已啟用。'
    rationale: "當在多個系統上配置相同的帳戶和密碼時，本機帳戶面臨憑證被盜的高風險。確保啟用此策略可以顯著降低該風險。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 設定建議的配置，將以下 UI 路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Apply UAC restrictions to local accounts on network logons 注意: 預設情況下，這個群組原則路徑是不存在的。需要額外的群組原則範本 (SecGuide.admx/adml) —— 可以從微軟在此連結獲得。"
    compliance:
      - cis: ["18.4.1"]
      - cis_csc_v8: ["5.4"]
      - cis_csc_v7: ["4.3"]
      - cmmc_v2.0: ["AC.L2-3.1.5", "AC.L2-3.1.6", "AC.L2-3.1.7", "SC.L2-3.13.3"]
      - iso_27001-2013: ["A.9.2.3"]
      - nist_sp_800-53: ["AC-6(2)", "AC-6(5)"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
      - soc_2: ["CC6.1", "CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> LocalAccountTokenFilterPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> LocalAccountTokenFilterPolicy -> 0'

  # 18.4.2 (L1) Ensure 'Configure RPC packet level privacy setting for incoming connections' is set to 'Enabled'. (Automated)
  - id: 16140
    title: "確保「為傳入連線配置 RPC 封包等級隱私設定」設定為「啟用」。"
    description: "此原則設定控制遠端程序呼叫 (RPC) 傳入連線的封包層級隱私。此設定的建議狀態為：已啟用。"
    rationale: "印表機 RPC 綁定處理遠端 Winspool 介面驗證的方式中存在安全繞過漏洞（CVE-2021-1678 | Windows 列印後台處理程序欺騙漏洞）。為傳入連線啟用 RPC 封包級別隱私設定會強制伺服器端提高身份驗證級別，以最大限度地減少此漏洞。"
    impact: "None - this is default behavior."
    remediation: "要透過GP建立推薦的設定，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure RPC packet level privacy setting for incoming connections 注意: 此群組原則路徑預設情況下不存在。需要額外的群組原則範本 (SecGuide.admx/adml) - 可從Microsoft的這個連結獲取。"
    references:
      - "https://support.microsoft.com/en-us/topic/managing-deployment-of-printer-rpc-binding-changes-for-cve-2021-1678-kb4599464-12a69652-30b9-3d61-d9f7-7201623a8b25"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1678"
    compliance:
      - cis: ["18.4.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print -> RpcAuthnLevelPrivacyEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print -> RpcAuthnLevelPrivacyEnabled -> 1'

  # 18.4.3 (L1) Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver (recommended)'. (Automated)
  - id: 16141
    title: "確保「配置 SMB v1 用戶端驅動程式」設定為「啟用：停用驅動程式（建議）」。"
    description: "此設定配置伺服器訊息區塊版本 1 (SMBv1) 用戶端驅動程式服務 (MRxSmb10) 的啟動類型，建議停用該啟動類型。此設定的建議狀態為： 啟用：停用驅動程式（建議）。注意：在任何情況下，都不要將此整體設定配置為“停用”，因為這樣做會完全刪除基礎註冊表項，從而導致嚴重問題。"
    rationale: '自 2016 年 9 月以來，Microsoft 強烈鼓勵禁用 SMBv1，並不再在現代網路中使用，因為它是一個已有 30 年歷史的設計，比 SMBv2 和 SMBv3 等較新的設計更容易受到攻擊。有關此問題的更多資訊，請存取以下連結：停止使用 SMB1 | Microsoft 的儲存使用群組原則在託管環境中停用 SMB v1 -「保持安全」網路安全部落格透過群組原則停用 SMBv1 - Microsoft 安全指南部落格。'
    impact: "Some legacy OSes (e.g. Windows XP, Server 2003 or older), applications and appliances may no longer be able to communicate with the system once SMBv1 is disabled. We recommend careful testing be performed to determine the impact prior to configuring this as a widespread control, and where possible, remediate any incompatibilities found with the vendor of the incompatible system. Microsoft is also maintaining a thorough (although not comprehensive) list of known SMBv1 incompatibilities at this link: SMB1 Product Clearinghouse | Storage at Microsoft."
    remediation: "若要通過GP確立建議的配置，將以下UI路徑設置為啟用: Disable driver (recommended): Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 client driver 注意: 此組策略路徑預設情況下不存在。需要額外的組策略模板 (SecGuide.admx/adml) - 可以從Microsoft通過此鏈接獲得。"
    compliance:
      - cis: ["18.4.3"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2", "14.3"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1", "A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10 -> Start'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10 -> Start -> 4'

  # 18.4.4 (L1) Ensure 'Configure SMB v1 server' is set to 'Disabled'. (Automated)
  - id: 16142
    title: "確保「配置 SMB v1 伺服器」設定為「停用」。"
    description: "此設定配置伺服器訊息區塊版本 1 (SMBv1) 協定的伺服器端處理。此設定的建議狀態是：停用。"
    rationale: '自 2016 年 9 月以來，Microsoft 強烈鼓勵禁用 SMBv1，並不再在現代網路中使用，因為它是一個已有 30 年歷史的設計，比 SMBv2 和 SMBv3 等較新的設計更容易受到攻擊。有關此問題的更多資訊，請存取以下連結：停止使用 SMB1 | Microsoft 的儲存使用群組原則在託管環境中停用 SMB v1 -「保持安全」網路安全部落格透過群組原則停用 SMBv1 - Microsoft 安全指南部落格。'
    impact: "Some legacy OSes (e.g. Windows XP, Server 2003 or older), applications and appliances may no longer be able to communicate with the system once SMBv1 is disabled. We recommend careful testing be performed to determine the impact prior to configuring this as a widespread control, and where possible, remediate any incompatibilities found with the vendor of the incompatible system. Microsoft is also maintaining a thorough (although not comprehensive) list of known SMBv1 incompatibilities at this link: SMB1 Product Clearinghouse | Storage at Microsoft."
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設置為已停用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Configure SMB v1 server 注意：此群組原則路徑預設不存在。需要額外的群組原則模板 (SecGuide.admx/adml) - 可從微軟的此鏈接獲取。"
    compliance:
      - cis: ["18.4.4"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2", "14.3"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1", "A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters -> SMB1'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters -> SMB1 -> 0'

  # 18.4.5 (L1) Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'. (Automated)
  - id: 16143
    title: "確保「啟用結構化異常處理覆蓋保護 (SEHOP)」設定為「啟用」。"
    description: "Windows 包括對結構化異常處理覆蓋保護 (SEHOP) 的支援。我們建議啟用此功能以提高電腦的安全性設定檔。此設定的建議狀態為：已啟用。"
    rationale: "此功能旨在阻止使用結構化異常處理程序 (SEH) 覆蓋技術的漏洞利用。這種保護機制是在運作時提供的。因此，它有助於保護應用程序，無論它們是否使用最新的改進（例如 /SAFESEH 選項）進行編譯。"
    impact: "After you enable SEHOP, existing versions of Cygwin, Skype, and Armadillo-protected applications may not work correctly."
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\Enable Structured Exception Handling Overwrite Protection (SEHOP) 注意: 預設情況下此組策略路徑不存在。需要額外的組策略模板 (SecGuide.admx/adml) - 可從Microsoft在此鏈接獲取。更多資訊可參閱 MSKB 956607: 如何在Windows操作系統中啟用結構化異常處理覆寫保護 (SEHOP)。"
    compliance:
      - cis: ["18.4.5"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel -> DisableExceptionChainValidation'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel -> DisableExceptionChainValidation -> 0'

  # 18.4.6 (L1) Ensure 'LSA Protection' is set to 'Enabled'. (Automated)
  - id: 16144
    title: "確保“LSA 保護”設定為“啟用”。"
    description: "此原則設定控製本機安全機構伺服器服務 (LSASS) 程序是否運作受保護。本地安全機構 (LSA) 包括本地安全機構伺服器服務 (LSASS) 程序，用於驗證使用者的本地和遠端登入並強制執行本地安全性原則。此設定的建議狀態為：已啟用。注意：此設定僅適用於 Windows Server 2012 R2（及更高版本），Windows Server 2022（及更高版本）除外。請參閱策略設定 將 LSASS 配置為作為受保護程序執行。"
    rationale: "Windows Server 2012 R2（及更高版本）為 LSA 提供額外的保護，以防止非受保護程序讀取記憶體和程式碼注入。啟用此設定可為 LSA 儲存和管理的憑證提供更高的安全性。"
    impact: "If additional LSA protection is enabled, Administrators will not be able to debug a custom LSA plugin. A debugger cannot be attached to LSASS when it's a protected process. In general, there's no supported way to debug a running protected process."
    remediation: "要透過 GP 建立建議的配置，請設定以下 UI 路徑為啟用: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\LSA Protection 注意: 此群組原則路徑預設不會存在。需要一個額外的群組原則模板 (SecGuide.admx/adml) - 可以從 Microsoft 的這個連結獲得。"
    references:
      - "https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection"
    compliance:
      - cis: ["18.4.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RunAsPPL'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa -> RunAsPPL -> 1'

  # 18.4.7 (L1) Ensure 'NetBT NodeType configuration' is set to 'Enabled: P-node (recommended)'. (Automated)
  - id: 16145
    title: "確保“NetBT NodeType 配置”設定為“啟用：P 節點（建議）”。"
    description: "此設定決定 NetBIOS over TCP/IP (NetBT) 使用哪種方法來註冊和解析名稱。可用的方法有： - B 節點（廣播）方法僅使用廣播。 - P 節點（點對點）方法僅使用對名稱伺服器 (WINS) 的名稱查詢。 - M節點（混合）方法先廣播，如果廣播失敗則查詢名稱伺服器（WINS）。 - H 節點（混合）方法首先查詢名稱伺服器 (WINS)，如果查詢失敗則進行廣播。此設定的建議狀態為： 啟用：P 節點（建議）（點對點）。注意：透過 LMHOSTS 或 DNS 解析遵循這些方法。如果 NodeType 登錄值存在，它將覆寫任何 DhcpNodeType 登錄值。如果 NodeType 和 DhcpNodeType 都不存在，則如果沒有為網路配置 WINS 伺服器，則電腦使用 B 節點（廣播）；如果至少配置了一台 WINS 伺服器，則電腦使用 H 節點（混合）。"
    rationale: "為了幫助降低 NetBIOS 名稱服務 (NBT-NS) 中毒攻擊的風險，將節點類型設定為 P 節點（點對點）將阻止系統傳送 NetBIOS 廣播。"
    impact: "NetBIOS name resolution queries will require a defined and available WINS server for external NetBIOS name resolution. If a WINS server is not defined or not reachable, and the desired hostname is not defined in the local cache, local LMHOSTS or HOSTS files, NetBIOS name resolution will fail."
    remediation: "若要透過GP建立推薦的配置，將以下UI路徑設定為已啟用： P-node（推薦）：Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\NetBT NodeType configuration 注意：此變更在計算機重新啟動後才會生效。注意#2：此群組原則路徑預設不存在。需要額外的群組原則模板（SecGuide.admx/adml）——可以從Microsoft的這個鏈接獲取。請注意，此設定僅在Windows 10 v1903和Windows Server v1903（或更新版本）的SecGuide.admx/adml的安全性基線（最終版本）中提供，因此如果您之前下載了此模板，您可能需要從較新的Microsoft基線更新它以獲取這個新的NetBT NodeType配置設置。"
    compliance:
      - cis: ["18.4.7"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NodeType'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NodeType -> 2'

  # 18.4.8 (L1) Ensure 'WDigest Authentication' is set to 'Disabled'. (Automated)
  - id: 16146
    title: "確保“WDigest 身份驗證”設定為“停用”。"
    description: 'When WDigest authentication is enabled, Lsass.exe retains a copy of the user''s plaintext password in memory, where it can be at risk of theft. If this setting is not configured, WDigest authentication is disabled in Windows 8.1 and in Windows Server 2012 R2; it is enabled by default in earlier versions of Windows and Windows Server. For more information about local accounts and credential theft, review the "Mitigating Pass-the-Hash (PtH) Attacks and Other Credential Theft Techniques" documents. For more information about UseLogonCredential, see Microsoft Knowledge Base article 2871997: Microsoft Security Advisory Update to improve credentials protection and management May 13, 2014. The recommended state for this setting is: Disabled.'
    rationale: "防止憑證以明文形式儲存在記憶體中可以減少憑證被盜的機會。"
    impact: "None - this is also the default configuration for Server 2012 R2 or newer."
    remediation: "若要透過GP建立建議的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\MS Security Guide\\WDigest Authentication (disabling may require KB2871997) 註:此群組原則路徑預設不存在。需要額外的群組原則模板(SecGuide.admx/adml) - 可從微軟獲取此連結。"
    compliance:
      - cis: ["18.4.8"]
      - cis_csc_v8: ["3.11"]
      - cis_csc_v7: ["16.4"]
      - cmmc_v2.0: ["AC.L2-3.1.19", "IA.L2-3.5.10", "MP.L2-3.8.1", "SC.L2-3.13.11", "SC.L2-3.13.16"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["SC-28", "SC-28(1)"]
      - pci_dss_v3.2.1: ["3.4", "3.4.1", "8.2.1"]
      - pci_dss_v4.0: ["3.1.1", "3.3.2", "3.3.3", "3.5.1", "3.5.1.2", "3.5.1.3", "8.3.2"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -> UseLogonCredential'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -> UseLogonCredential -> 0'

  # 18.5.1 (L1) Ensure 'MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)' is set to 'Disabled'. (Automated)
  - id: 16147
    title: "確保「MSS：(AutoAdminLogon) 啟用自動登入（不建議）」設定為「停用」。"
    description: "此設定獨立於 Windows XP 和 Windows Vista 中的歡迎畫面功能；如果停用該功能，則不會停用此設定。如果將電腦設定為自動登入，則任何能夠實際存取該電腦的人也可以存取該電腦上的所有內容，包括該電腦所連接的任何一個或多個網路。此外，如果啟用自動登入，密碼將以明文形式儲存在註冊表中，並且儲存此值的特定註冊表項可由經過驗證的使用者群組遠端讀取。有關其他資訊，請參閱 Microsoft 知識庫文章 324737：如何在 Windows 中開啟自動登入。此設定的建議狀態是：停用。"
    rationale: "如果將電腦設定為自動登入，則任何能夠實際存取該電腦的人也可以存取該電腦上的所有內容，包括該電腦連接到的一個或多個網路。此外，如果啟用自動登入，密碼將以明文儲存在註冊表中。儲存此設定的特定註冊表項可由經過驗證的使用者群組遠端讀取。因此，只有當電腦受到實體保護並且確保不受信任的使用者無法遠端查看註冊表時，此條目才適用。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立建議的配置, 將以下使用者界面路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended) 注意: 這個組策略路徑預設情況下並不存在。需要額外的組策略模板(MSS-legacy.admx/adml) - 可以從這篇TechNet博客文章中獲得: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.1"]
      - cis_csc_v8: ["3.11"]
      - cis_csc_v7: ["16.4"]
      - cmmc_v2.0: ["AC.L2-3.1.19", "IA.L2-3.5.10", "MP.L2-3.8.1", "SC.L2-3.13.11", "SC.L2-3.13.16"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1"]
      - nist_sp_800-53: ["SC-28", "SC-28(1)"]
      - pci_dss_v3.2.1: ["3.4", "3.4.1", "8.2.1"]
      - pci_dss_v4.0: ["3.1.1", "3.3.2", "3.3.3", "3.5.1", "3.5.1.2", "3.5.1.3", "8.3.2"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> AutoAdminLogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> AutoAdminLogon -> 0'

  # 18.5.2 (L1) Ensure 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled' (Automated)
  - id: 16148
    title: "確保「MSS：（DisableIPSourceRouting IPv6）IP 來源路由保護等級（防止封包欺騙）」設定為「啟用：最高保護，來源路由完全停用」。"
    description: "IP 來源路由是一種允許發送方確定資料封包在網路中應遵循的 IP 路由的機制。此設定的建議狀態為： 啟用：最高保護，來源路由完全停用。"
    rationale: "攻擊者可以使用來源路由資料包來掩蓋其身分和位置。來源路由允許發送資料包的電腦指定資料包所採用的路由。"
    impact: "All incoming source routed packets will be dropped."
    remediation: "要通過GP建立推薦配置，請將以下UI路徑設置為啟用: 最高保護，完全禁用源路由功能: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing) 注意: 此組策略路徑預設情況下不存在。需要額外的組策略模板 (MSS-legacy.admx/adml) - 可從此TechNet博客文章獲得: The MSS settings - Microsoft Security Guidance blog."
    reference:
      - "https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/"
    compliance:
      - cis: ["18.5.2"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -> DisableIPSourceRouting'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -> DisableIPSourceRouting -> 2'

  # 18.5.3 (L1) Ensure 'MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled' (Automated)
  - id: 16149
    title: "確保「MSS：（DisableIPSourceRouting）IP 來源路由保護等級（防止封包欺騙）」設定為「啟用：最高保護，來源路由完全停用」。"
    description: "IP 來源路由是一種允許發送方確定資料封包通過網路應採用的 IP 路由的機制。對於企業環境，建議將此設定配置為“未定義”；對於高安全性環境，建議將此設定配置為“最高保護”，以完全停用來源路由。此設定的建議狀態為： 啟用：最高保護，來源路由完全停用。"
    rationale: "攻擊者可以使用來源路由資料包來掩蓋其身分和位置。來源路由允許發送資料包的電腦指定資料包所採用的路由。"
    impact: "All incoming source routed packets will be dropped."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為啟用：最高保護，完全禁用源路由：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing) 注意：此組策略路徑預設不存在。需要一個額外的組策略模板（MSS-legacy.admx/adml） - 可從此 TechNet 博客文章中獲取：The MSS settings - Microsoft Security Guidance blog."
    reference:
      - "https://blogs.technet.microsoft.com/secguide/2016/10/02/the-mss-settings/"
    compliance:
      - cis: ["18.5.3"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> DisableIPSourceRouting'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> DisableIPSourceRouting -> 2'

  # 18.5.4 (L1) Ensure 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'. (Automated)
  - id: 16150
    title: "確保「MSS：（啟用ICMPRedirect）允許 ICMP 重新導向覆蓋 OSPF 產生的路由」設定為「停用」。"
    description: "Internet 控制訊息協定 (ICMP) 重新導向會導致 IPv4 堆疊偵測主機路由。這些路由會覆寫開放最短路徑優先 (OSPF) 產生的路由。此設定的建議狀態是：停用。"
    rationale: "此行為是預期的。問題在於，ICMP 重新導向偵測路由的 10 分鐘逾時期限會暫時造成一種網路狀況，即流量將不再正確路由到受影響的主機。忽略此類 ICMP 重新導向將限制系統遭受攻擊的機會，從而影響其參與網路的能力。"
    impact: "When Routing and Remote Access Service (RRAS) is configured as an autonomous system boundary router (ASBR), it does not correctly import connected interface subnet routes. Instead, this router injects host routes into the OSPF routes. However, the OSPF router cannot be used as an ASBR router, and when connected interface subnet routes are imported into OSPF the result is confusing routing tables with strange routing paths."
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設為禁用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes 注意: 此組策略路徑預設情況下不存在，需要額外的組策略模板 (MSS-legacy.admx/adml) - 可從此 TechNet 博客文章獲取: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.4"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> EnableICMPRedirect'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> EnableICMPRedirect -> 0'

  # 18.5.5 (L2) Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'. (Automated)
  - id: 16151
    title: "確保「MSS：（KeepAliveTime）以毫秒為單位發送保持活動資料包的頻率」設定為「啟用：300,000 或 5 分鐘（建議）」。"
    description: "該值控制 TCP 嘗試透過發送保持活動資料包來驗證空閒連線是否仍然完好的頻率。如果遠端電腦仍然可以存取，它就會確認保持活動資料包。此設定的建議狀態為： 啟用：300,000 或 5 分鐘（建議）。"
    rationale: "能夠連接到網路應用程式的攻擊者可以建立大量連接以導致 DoS 情況。"
    impact: "Keep-alive packets are not sent by default by Windows. However, some applications may configure the TCP stack flag that requests keep-alive packets. For such configurations, you can lower this value from the default setting of two hours to five minutes to disconnect inactive sessions more quickly."
    remediation: "要透過GP建立建議的設定，請將以下UI路徑設定為啟用：300,000或5分鐘（建議）：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds 注意：此群組原則路徑預設不存在。需要額外的群組原則模板（MSS-legacy.admx/adml）——可以從這篇TechNet部落格文章取得：The MSS settings - Microsoft Security Guidance blog。"
    compliance:
      - cis: ["18.5.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> KeepAliveTime'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> KeepAliveTime -> 300000'

  # 18.5.6 (L1) Ensure 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled'. (Automated)
  - id: 16152
    title: "確保「MSS：(NoNameReleaseOnDemand) 允許電腦忽略來自 WINS 伺服器以外的 NetBIOS 名稱釋放請求」設定為「啟用」。"
    description: "TCP/IP 上的 NetBIOS 是一種網路協定，它提供了一種輕鬆地將在基於 Windows 的系統上註冊的 NetBIOS 名稱解析為在這些系統上配置的 IP 位址的方法。此設定會決定電腦在收到名稱釋放請求時是否釋放其 NetBIOS 名稱。此設定的建議狀態為：已啟用。"
    rationale: "NetBT 協定設計為不使用身份驗證，因此容易受到欺騙。欺騙使傳輸看起來像是來自執行該操作的用戶以外的用戶。惡意使用者可以利用該協定未經身份驗證的性質向目標電腦發送名稱衝突資料報，這將導致電腦放棄其名稱並且不回應查詢。攻擊者可以透過網路傳送請求並查詢電腦以釋放其 NetBIOS 名稱。與可能影響應用程式的任何變更一樣，建議您在更改生產環境之前在非生產環境中測試此變更。此類攻擊的結果可能是導致目標電腦出現間歇性連線問題，甚至阻止使用網路芳鄰、網域登入、NET SEND 指令或其他 NetBIOS 名稱解析。"
    impact: "None - this is the default behavior."
    remediation: "要以GP建立建議的設定，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (NoNameReleaseOnDemand) 允許電腦忽略來自WINS伺服器以外的NetBIOS名稱釋放請求 注意：此群組原則路徑預設情況下不存在。需要一個額外的群組原則模板（MSS-legacy.admx/adml） - 可從這篇TechNet博客文章獲取: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.6"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NoNameReleaseOnDemand'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters -> NoNameReleaseOnDemand -> 1'

  # 18.5.7 (L2) Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'. (Automated)
  - id: 16153
    title: "確保「MSS：（PerformRouterDiscovery）允許 IRDP 偵測和設定預設閘道位址（可能導致 DoS）」設定為「停用」。"
    description: "此設定用於啟用或停用 Internet 路由器發現協定 (IRDP)，該協定允許系統按照 RFC 1256 中的描述基於每個介面自動偵測和設定預設閘道位址。此設定的建議狀態是：停用。"
    rationale: "控制同一網段上的電腦的攻擊者可以設定網路上的電腦來冒充路由器。然後，其他啟用了 IRDP 的電腦將嘗試透過已受感染的電腦路由其流量。"
    impact: "Windows will not automatically detect and configure default gateway addresses on the computer."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS) 注意：此組策略路徑在預設情況下不存在。需要額外的組策略模板 (MSS-legacy.admx/adml) - 可從這篇 TechNet 博客文章獲得：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.7"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> PerformRouterDiscovery'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> PerformRouterDiscovery -> 0'

  # 18.5.8 (L1) Ensure 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' is set to 'Enabled'. (Automated)
  - id: 16154
    title: "確保「MSS：（SafeDllSearchMode）啟用安全 DLL 搜尋模式（建議）」設定為「啟用」。"
    description: "DLL 搜尋順序可以設定為透過以下兩種方式之一搜尋正在執行的程序請求的 DLL： - 首先搜尋系統路徑中指定的資料夾，然後搜尋目前工作資料夾。 - 首先搜尋目前工作資料夾，然後搜尋系統路徑中指定的資料夾。啟用後，登錄值設定為 1。停用後，登錄值設定為 0，系統會先搜尋目前工作資料夾，然後搜尋系統路徑中指定的資料夾。應用程式將被迫先在系統路徑中搜尋 DLL。對於需要應用程式中包含的這些 DLL 的唯一版本的應用程序，此條目可能會導致效能或穩定性問題。此設定的建議狀態為：已啟用。注意：有關安全 DLL 搜尋模式如何運作的更多資訊，請存取以下連結：動態連結庫搜尋順序 - Windows 應用程式 |微軟檔案。"
    rationale: "如果使用者在不知情的情況下執行與包含系統 DLL 修改版本的其他檔案封裝在一起的惡意程式碼，則惡意程式碼可能會載入這些 DLL 的自己版本，並可能增加程式碼可能造成的損害類型和程度。"
    impact: "None - this is the default behavior."
    remediation: "為了通過 GP 建立推薦的配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended) 注意：此群組原則路徑預設情況下不存在。需要額外的群組原則模板 (MSS-legacy.admx/adml) - 可在這篇 TechNet 博客文章中找到：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.8"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager -> SafeDllSearchMode'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager -> SafeDllSearchMode -> 1'

  # 18.5.9 Ensure 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' is set to 'Enabled: 5 or fewer seconds' (Automated)
  - id: 16155
    title: "確保「MSS：(ScreenSaverGracePeriod) 螢幕保護程式寬限期到期之前的時間（以秒為單位，建議為 0）」設定為「啟用：5 秒或更少」。"
    description: "當啟用螢幕保護程式鎖定時，Windows 在啟動螢幕保護程式和控制台實際自動鎖定之間有一個寬限期。此設定的建議狀態為： 啟用：5 秒或更少。"
    rationale: "螢幕保護程式鎖定生效之前允許使用者移動的預設寬限期為五秒。如果您保留預設的寬限期配置，您的電腦很容易受到其他人的潛在攻擊，這些人可能會在鎖定生效之前接近控制台並嘗試登入電腦。可以在註冊表中輸入條目來調整寬限期的長度。"
    impact: "Users will have to enter their passwords to resume their console sessions as soon as the grace period ends after screen saver activation."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設定為啟用: 5 秒或更少: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (ScreenSaverGracePeriod) 螢幕保護程式寬限期到期前的時間（以秒為單位）（建議為 0）注意: 此組策略路徑預設不存在。需要額外的組策略模板（MSS-legacy.admx/adml）- 可從此 TechNet 部落格文章獲得: MSS 設定 - Microsoft Security Guidance blog。"
    compliance:
      - cis: ["18.5.9"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScreenSaverGracePeriod'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -> ScreenSaverGracePeriod -> n:^(\d+) compare <= 5'

  # 18.5.10 (L2) Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'. (Automated)
  - id: 16156
    title: "確保「MSS：（TcpMaxDataRetransmissions IPv6）未確認資料重傳次數」設定為「啟用：3」。"
    description: "此設定控制在連線中止之前 TCP 重新傳輸單一資料段（非連線段）的次數。連接上每次連續重傳，重傳逾時都會加倍。當響應恢復時它會重置。基本逾時值由測量的連線往返時間動態決定。此設定的建議狀態為：啟用：3。"
    rationale: "如果惡意使用者從未針對目標電腦傳輸的資料發送任何確認訊息，則可能會耗盡目標電腦的資源。"
    impact: "TCP starts a retransmission timer when each outbound segment is passed to the IP. If no acknowledgment is received for the data in a given segment before the timer expires, then the segment is retransmitted up to three times."
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為已啟用: 3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions IPv6) 備註：資料未確認傳輸多少次 注意: 此群組原則路徑預設情況下不存在。需要額外的群組原則範本（MSS-legacy.admx/adml） - 可以從這篇 TechNet 部落格文章中獲得: The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.10"]
      - cis_csc_v8: ["4.2"]
      - cis_csc_v7: ["11.1"]
      - cmmc_v2.0: ["CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.3", "CM.L2-3.4.6", "CM.L2-3.4.7", "SC.L2-3.13.6"]
      - nist_sp_800-53: ["AC-18(1)", "AC-18(3)", "CM-2", "CM-6", "CM-7", "CM-7(1)", "CM-9"]
      - pci_dss_v3.2.1: ["1.1.1", "1.2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.4.2", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> TcpMaxDataRetransmissions'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> TcpMaxDataRetransmissions -> 3'

  # 18.5.11 (L2) Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'. (Automated)
  - id: 16157
    title: "確保「MSS：(TcpMaxDataRetransmissions)未確認資料重傳次數」設定為「啟用：3」。"
    description: "此設定控制在連線中止之前 TCP 重新傳輸單一資料段（非連線段）的次數。連接上每次連續重傳，重傳逾時都會加倍。當響應恢復時它會重置。基本逾時值由測量的連線往返時間動態決定。此設定的建議狀態為：啟用：3。"
    rationale: "如果惡意使用者從未針對目標電腦傳輸的資料發送任何確認訊息，則可能會耗盡目標電腦的資源。"
    impact: "TCP starts a retransmission timer when each outbound segment is passed to the IP. If no acknowledgment is received for the data in a given segment before the timer expires, then the segment is retransmitted up to three times."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為Enabled：3: Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS:(TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted 注意：預設情況下，此組策略路徑不存在。需要額外的組策略模板（MSS-legacy.admx/adml）——可以從這篇TechNet博客文章中獲得：The MSS settings - Microsoft Security Guidance blog。"
    compliance:
      - cis: ["18.5.11"]
      - cis_csc_v7: ["9.2"]
      - iso_27001-2013: ["A.13.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> TcpMaxDataRetransmissions'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters -> TcpMaxDataRetransmissions -> 3'

  # 18.5.12 (L1) Ensure 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set to 'Enabled: 90% or less' (Automated)
  - id: 16158
    title: "確保「MSS：（警告等級）系統將產生警告的安全事件日誌的百分比閾值」設定為「啟用：90% 或更低」。"
    description: "當日誌達到使用者定義的閾值時，此設定可以在安全事件日誌中產生安全審核。此設定的建議狀態為： 啟用：90% 或更低。注意：如果日誌設定配置為根據需要覆蓋事件或覆蓋 x 天之前的事件，則不會產生此事件。"
    rationale: "如果安全日誌達到其容量的 90%，且電腦尚未配置為根據需要覆蓋事件，則較新的事件將不會寫入日誌。如果日誌已達到其容量，且電腦已設定為在無法再將事件記錄到安全日誌時關閉，則電腦將關閉並且無法再提供網路服務。"
    impact: "An audit event will be generated when the Security log reaches the 90% percent full threshold (or whatever lower value may be set) unless the log is configured to overwrite events as needed."
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為啟用：90%或以下：Computer Configuration\\Policies\\Administrative Templates\\MSS (Legacy)\\MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning 注意：此群組原則路徑預設情況下不存在。需要添加一個額外的群組原則模板 (MSS-legacy.admx/adml) - 可以從這篇 TechNet 部落格文章獲取：The MSS settings - Microsoft Security Guidance blog."
    compliance:
      - cis: ["18.5.12"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.3", "6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security -> WarningLevel'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security -> WarningLevel -> n:^(\d+) compare <= 90'

  # 18.6.4.1 (L1) Ensure 'Configure NetBIOS settings' is set to 'Enabled: Disable NetBIOS name resolution on public networks'. (Automated)
  - id: 16159
    title: "確保「設定 NetBIOS 設定」設定為「啟用：停用公用網路上的 NetBIOS 名稱解析」。"
    description: "此策略設定指定網域名稱系統 (DNS) 用戶端是否將透過網路基本輸入/輸出系統 (NetBIOS) 執行名稱解析。 NetBIOS 是一種用於 Microsoft 內部網路的傳統名稱解析方法，早於使用 DNS 實現此目的（Active Directory 之前）。一些遺留應用程式仍然需要使用 NetBIOS 才能實現全部功能。此設定的建議狀態為： 啟用：停用公用網路上的 NetBIOS 名稱解析。將此設定配置為「啟用：停用 NetBIOS 名稱解析」也符合基準測試。"
    rationale: 'NetBIOS 不執行身份驗證，並且可能允許遠端攻擊者透過發送欺騙性的名稱衝突或名稱釋放資料封包來造成拒絕服務。這也稱為「NetBIOS 名稱伺服器協定欺騙」。防止在公共網路上使用 NetBIOS 可減少攻擊面。'
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 設定建議配置，將以下 UI 路徑設為啟用：Disable NetBIOS name resolution on public networks: Computer Configuration\\Policies\\Administrative Templates\\Network\\DNS Client\\Configure NetBIOS settings."
    compliance:
      - cis: ["18.6.4.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableNetbios'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableNetbios -> 1'

  # 18.6.4.2 (L1) Ensure 'Turn off multicast name resolution' is set to 'Enabled'. (Automated)
  - id: 16160
    title: "確保“關閉多播名稱解析”設定為“啟用”。"
    description: "LLMNR 是輔助名稱解析協定。使用 LLMNR，可以透過單一子網路上的本機網路連結使用多重播放將查詢從用戶端電腦傳送到相同子網路上也啟用了 LLMNR 的另一台用戶端電腦。 LLMNR 不需要 DNS 伺服器或 DNS 用戶端配置，並在無法進行常規 DNS 名稱解析的情況下提供名稱解析。此設定的建議狀態為：已啟用。"
    rationale: "攻擊者可以在網路上偵聽這些 LLMNR (UDP/5355) 或 NBT-NS (UDP/137) 廣播並對其做出回應，欺騙主機認為它知道所請求系統的位置。注意：要完全緩解本機名稱解析中毒，除了此設定之外，還應將每個已安裝 NIC 的屬性設為「停用 TCP/IP 上的 NetBIOS」（在 NIC 屬性的 WINS 標籤上）。不幸的是，沒有全域設定可以自動套用於所有 NIC 來實現此目的 - 它是針對每個 NIC 的設置，隨不同的 NIC 硬體安裝而變化。"
    impact: "In the event DNS is unavailable a system will be unable to request it from other systems on the same subnet."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\DNS Client\\Turn off multicast name resolution 注意：此群組原則路徑可能預設不存在。它是由群組原則範本 DnsClient.admx/adml 提供的，該範本包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理範本（或更新版本）的範圍內。"
    compliance:
      - cis: ["18.6.4.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableMulticast'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient -> EnableMulticast -> 1'

  # 18.6.5.1 (L2) Ensure 'Enable Font Providers' is set to 'Disabled'. (Automated)
  - id: 16161
    title: "確保“啟用字型提供者”設定為“停用”。"
    description: "此策略設定是否允許 Windows 從線上字型提供者下載字型和字型目錄資料。此設定的建議狀態是：停用。"
    rationale: "在企業管理的環境中，IT 部門應該管理系統配置的更改，以確保所有變更都經過測試和批准。"
    impact: "Windows will not connect to an online font provider and will only enumerate locally-installed fonts."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為已停用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Fonts\\Enable Font Providers 注意：此群組原則路徑預設可能不存在。它是由群組原則模板 GroupPolicy.admx/adml 提供，該模板包含在 Microsoft Windows 10 1607 版及 Server 2016 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.6.5.1"]
      - cis_csc_v8: ["16.5"]
      - cis_csc_v7: ["18.4"]
      - pci_dss_v3.2.1: ["6.2"]
      - pci_dss_v4.0: ["12.3.4", "6.3.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableFontProviders'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableFontProviders -> 0'

  # 18.6.8.1 (L1) Ensure 'Enable insecure guest logons' is set to 'Disabled'. (Automated)
  - id: 16162
    title: "確保「啟用不安全的來賓登入」設定為「停用」。"
    description: "此政策設定確定 SMB 用戶端是否允許不安全的來賓登入 SMB 伺服器。此設定的建議狀態是：停用。"
    rationale: "檔案伺服器使用不安全的來賓登入來允許對共用資料夾進行未經身份驗證的存取。"
    impact: "The SMB client will reject insecure guest logons. This was not originally the default behavior in older versions of Windows, but Microsoft changed the default behavior starting with Windows Server 2016 R1709: Guest access in SMB2 disabled by default in Windows 10 and Windows Server 2016."
    remediation: "若要通過GP建立建議的配置，請將以下UI路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Lanman Workstation\\Enable insecure guest logons 注意：此群組策略路徑可能在預設情況下不存在。它由群組策略模板LanmanWorkstation.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1511的管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.6.8.1"]
      - cis_csc_v7: ["9.2"]
      - iso_27001-2013: ["A.13.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation -> AllowInsecureGuestAuth'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation -> AllowInsecureGuestAuth -> 0'

  # 18.6.9.1 (L2) Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'. (Automated)
  - id: 16163
    title: "確保「開啟映射器 I/O (LLTDIO) 驅動程式」設定為「停用」。"
    description: "此策略設定更改映射器 I/O 網路協定驅動程式的操作行為。 LLTDIO 允許電腦發現其所連接的網路的拓撲。它還允許電腦發起服務品質請求，例如頻寬估計和網路健康分析。此設定的建議狀態是：停用。"
    rationale: "為了幫助防止可能發現和連接到未經授權的設備，應停用此設定以防止響應網路拓撲發現的網路流量。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Mapper I/O (LLTDIO) driver 注意：此組策略路徑由LinkLayerTopologyDiscovery.admx/adml組策略範本提供，該範本包含在所有版本的Microsoft Windows系統管理範本中。"
    compliance:
      - cis: ["18.6.9.1"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowLLTDIOOnDomain -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowLLTDIOOnPublicNet -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableLLTDIO -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> ProhibitLLTDIOOnPrivateNet -> 0'

  # 18.6.9.2 (L2) Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'. (Automated)
  - id: 16164
    title: "確保「開啟響應器 (RSPNDR) 驅動程式」設定為「停用」。"
    description: "此策略設定更改響應程式網路協定驅動程式的操作行為。響應程序允許電腦參與鏈路層拓撲發現請求，以便可以在網路上發現並定位它。它還允許電腦參與服務品質活動，例如頻寬估計和網路健康分析。此設定的建議狀態是：停用。"
    rationale: "為了幫助防止可能發現和連接到未經授權的設備，應停用此設定以防止響應網路拓撲發現的網路流量。"
    impact: "None - this is the default behavior."
    remediation: "若要透過GP建立推薦的配置, 將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Link-Layer Topology Discovery\\Turn on Responder (RSPNDR) driver 注意: 此群組政策路徑由隨所有版本的Microsoft Windows行政模板一起提供的Group Policy模板LinkLayerTopologyDiscovery.admx/adml提供。"
    compliance:
      - cis: ["18.6.9.2"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowRspndrOnDomain -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> AllowRspndrOnPublicNet -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> EnableRspndr -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LLTD -> ProhibitRspndrOnPrivateNet -> 0'

  # 18.6.10.2 (L2) Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'. (Automated)
  - id: 16165
    title: "確保「關閉 Microsoft 對等網路服務」設定為「啟用」。"
    description: "對等名稱解析協定 (PNRP) 允許將名稱分散式解析為 IPv6 位址和連接埠號碼。該協定在雲端環境中運行。雲端是一組可以使用相同 IPv6 範圍相互通訊的對等電腦。點對點協定允許 RTC、協作、內容分發和分散式處理領域的應用程式。此設定的建議狀態為：已啟用。"
    rationale: "此設定增強了環境的安全性並降低了與對等網路相關的整體風險暴露。"
    impact: "Microsoft Peer-to-Peer Networking Services are turned off in their entirety, and all applications dependent on them will stop working."
    remediation: "若要通過GP建立推薦的配置，請將以下用戶界面路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Microsoft Peer-to-Peer Networking Services\\Turn off Microsoft Peer-to-Peer Networking Services 注意：此群組原則路徑由群組原則模板P2P - pnrp.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.6.10.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet -> Disabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Peernet -> Disabled -> 1'

  # 18.6.11.2 (L1) Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'. (Automated)
  - id: 16166
    title: "確保「禁止在 DNS 網域網路上安裝和設定橋接器」設定為「已啟用」。"
    description: "您可以使用此程序來控制使用者安裝和設定網橋的能力。此設定的建議狀態為：已啟用。"
    rationale: "網路橋接設定（如果啟用）允許使用者建立第 2 層媒體存取控制 (MAC) 橋接，使他們能夠將兩個或多個實體網段連接在一起。因此，網橋允許連接到兩個不同網路的電腦在這些網路之間共用資料。在企業管理的環境中，需要將網路流量控制為僅經過授權的路徑，讓使用者建立網橋會增加橋接網路的風險和攻擊面。"
    impact: "Users cannot create or configure a Network Bridge."
    remediation: "要通過GP建立建議配置，將以下UI路徑設置為 “Enabled”: Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Prohibit installation and configuration of Network Bridge on your DNS domain network 注意：此群組原則路徑由群組原則模板NetworkConnections.admx/adml提供，該模板包含在所有版本的Microsoft Windows 系統管理模板中。"
    compliance:
      - cis: ["18.6.11.2"]
      - cis_csc_v8: ["4.8", "12.2"]
      - cis_csc_v7: ["11.3"]
      - cmmc_v2.0: ["AC.L1-3.1.2", "AC.L1-3.1.20", "AC.L1-3.1.22", "AC.L2-3.1.14", "AC.L2-3.1.16", "AC.L2-3.1.17", "AC.L2-3.1.3", "CM.L2-3.4.1", "CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L1-3.13.5", "SC.L2-3.13.2", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.12.1.2"]
      - nist_sp_800-53: ["CP-6", "CP-7", "PL-8"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "1.2.3", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "1.3.1", "1.3.2", "1.3.3", "1.4.4", "11.4.5", "2.2.4", "6.4.1", "7.1", "7.2.5.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_AllowNetBridge_NLA'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_AllowNetBridge_NLA -> 0'

  # 18.6.11.3 (L1) Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'. (Automated)
  - id: 16167
    title: "確保「禁止在 DNS 網域網路上使用 Internet 連線共用」設定為「已啟用」。"
    description: '雖然此「舊」設定傳統上應用於 Windows 2000、Windows XP 和 Server 2003 中的 Internet 連線共用 (ICS)，但此設定現在會新套用於 Windows 10 和 Server 2016 中的行動熱點功能。設定為：啟用。'
    rationale: "非管理員不應開啟行動熱點功能並開啟其與附近行動裝置的網路連線。"
    impact: "Mobile Hotspot cannot be enabled or configured by Administrators and non-Administrators alike."
    remediation: "要透過群組原則設定建議的配置，將以下介面路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Prohibit use of Internet Connection Sharing on your DNS domain network 注意：此群組原則路徑由群組原則範本NetworkConnections.admx/adml提供，該範本包含在所有版本的微軟Windows管理範本中。"
    compliance:
      - cis: ["18.6.11.3"]
      - cis_csc_v8: ["4.8", "12.2"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["AC.L1-3.1.2", "AC.L1-3.1.20", "AC.L1-3.1.22", "AC.L2-3.1.14", "AC.L2-3.1.16", "AC.L2-3.1.17", "AC.L2-3.1.3", "CM.L2-3.4.1", "CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L1-3.13.5", "SC.L2-3.13.2", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - nist_sp_800-53: ["CP-6", "CP-7", "PL-8"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "1.2.3", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "1.3.1", "1.3.2", "1.3.3", "1.4.4", "11.4.5", "2.2.4", "6.4.1", "7.1", "7.2.5.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_ShowSharedAccessUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_ShowSharedAccessUI -> 1'

  # 18.6.11.4 (L1) Ensure 'Require domain users to elevate when setting a network's location' is set to 'Enabled'. (Automated)
  - id: 16168
    title: "確保「設定網路位置時要求網域使用者提升權限」設定為「已啟用」。"
    description: "此策略設定決定在設定網路位置時是否要求網域使用者提升權限。此設定的建議狀態為：已啟用。"
    rationale: "允許一般使用者設定網路位置會增加風險和攻擊面。"
    impact: "Domain users must elevate when setting a network's location."
    remediation: "要透過 GP 建立建議的配置，請設置以下 UI 路徑為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Connections\\Require domain users to elevate when setting a network's location 注意：此群組原則路徑預設可能不存在。它由群組原則範本 NetworkConnections.admx/adml 提供，該範本包含在 Microsoft Windows 7 & Server 2008 R2 管理範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.6.11.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_StdDomainUserSetLocation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections -> NC_StdDomainUserSetLocation -> 1'

  # 18.6.14.1 (L1) Ensure 'Hardened UNC Paths' is set to 'Enabled, with "Require Mutual Authentication" and "Require Integrity" set for all NETLOGON and SYSVOL shares' (Automated)
  - id: 16169
    title: 'Ensure ''Hardened UNC Paths'' is set to ''Enabled, with "Require Mutual Authentication" and "Require Integrity" set for all NETLOGON and SYSVOL shares''.'
    description: '此策略設定配置對 UNC 路徑的安全存取。此設定的建議狀態為：啟用，並為所有 NETLOGON 和 SYSVOL 共用設定「需要相互驗證」和「需要完整性」。注意：如果環境僅包含 Windows 8.0 / Server 2012（非 R2）或更高版本的系統，則也可以（選用）將「隱私權」設定設為啟用 SMB 加密。但是，使用 SMB 加密將使舊作業系統完全無法存取目標共用路徑，因此請謹慎使用此附加選項並進行徹底測試。'
    rationale: "2015 年 2 月，作為 MS15-011 / MSKB 3000483 安全性更新的一部分，Microsoft 發布了一種新的控制機制來減輕群組原則中的安全風險。此機制需要安裝新的安全性更新，還需要將特定的群組原則設定部署到 Windows Vista / Server 2008（非 R2）或更高版本的網域中的所有電腦（未啟用啟用此功能的相關安全性修補程式）針對Server 2003 發布）。安全性更新也提供了新的群組原則範本 (NetworkProvider.admx/adml)。新 GPO 範本就位後，以下是修復群組原則安全風險的最低要求： \\*\\NETLOGON RequireMutualAuthentication=1, RequireIntegrity=1 \\*\\SYSVOL RequireMutualAuthentication=1, RequireIntegrity=1 注意：將設定套用到客戶端電腦後，可能需要重新啟動才能存取上述路徑。有關部署此安全性設定的其他指南可從此處的 Microsoft Premier Field Engineering (PFE) 平台 TechNet 部落格取得：MS15-011 和 MS15-014 部署指南。"
    impact: "Windows only allows access to the specified UNC paths after fulfilling additional security requirements."
    remediation: "要通過GP建立建議的配置，設置以下UI路徑為啟用並至少配置以下路徑: \\*\\NETLOGON RequireMutualAuthentication=1, RequireIntegrity=1 \\*\\SYSVOL RequireMutualAuthentication=1, RequireIntegrity=1 Computer Configuration\\Policies\\Administrative Templates\\Network\\Network Provider\\Hardened UNC Paths 注意：此群組原則路徑預設不存在。需要額外的群組原則模板(NetworkProvider.admx/adml) - 它包含在MS15-011 / MSKB 3000483安全更新或Microsoft Windows 10 RTM (版本1507)管理模板(或更新版本)中。"
    compliance:
      - cis: ["18.6.14.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\NETLOGON -> r:RequireMutualAuthentication=1 && r:RequireIntegrity=1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths -> \\*\SYSVOL -> r:RequireMutualAuthentication=1 && r:RequireIntegrity=1'

  # 18.6.19.2.1 (L2) Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)'). (Automated)
  - id: 16170
    title: "停用 IPv6（確保 TCPIP6 參數「DisabledComponents」設定為「0xff (255)」）。"
    description: "Internet 協定版本 6 (IPv6) 是電腦用來透過 Internet 以及家庭和企業網路交換資訊的一組協定。與 IPv4 相比，IPv6 允許分配更多的 IP 位址。較舊的網路、主機和作業系統可能本身不支援 IPv6。此設定的建議狀態為：DisabledComponents - 0xff (255)。"
    rationale: "由於絕大多數私人企業管理的網路不需要使用 IPv6（因為它們可以存取私有 IPv4 位址），因此停用 IPv6 元件可以消除可能的攻擊面，而該攻擊面也更難監控流量。因此，我們建議在不需要時將 IPv6 設定為停用狀態。"
    impact: "Connectivity to other systems using IPv6 will no longer operate, and software that depends on IPv6 will cease to function. Examples of Microsoft applications that may use IPv6 include: Remote Assistance, HomeGroup, DirectAccess, Windows Mail. This registry change is documented in Microsoft Knowledge Base article 929852: How to disable IPv6 or its components in Windows. Note: This registry change does not take effect until the next reboot."
    remediation: "若要建立建議的配置，將以下註冊表值設置為0xff（255）（DWORD）：HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters:DisabledComponents 注意：此更改在重新啟動計算機之前不會生效。注意#2：儘管微軟沒有提供用於配置此註冊表值的ADMX模板，但在CIS基準緩解工具包中提供了自訂.ADM模板（Disable-IPv6-Components-KB929852.adm）以促進其配置。不過請注意，僅僅關閉.ADM模板中的群組策略設置不會 撤銷 一旦應用的更改。相反，必須應用相反的設置以將註冊表值更改為相反的狀態。"
    compliance:
      - cis: ["18.6.19.2.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> DisabledComponents'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters -> DisabledComponents -> 255'

  # 18.6.20.1 (L2) Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'. (Automated)
  - id: 16171
    title: "確保「使用 Windows Connect Now 設定無線設定」設定為「停用」。"
    description: "此策略設定允許使用 Windows Connect Now (WCN) 設定無線設定。 WCN Registrar 支援透過 Windows 可攜式裝置 API (WPD) 和 USB 隨身碟透過內建 802.11 Wi-Fi 發現和設定乙太網路 (UPnP) 裝置。還可以使用其他選項來允許透過特定媒體進行發現和配置。此設定的建議狀態是：停用。"
    rationale: "此設定增強了環境的安全性，並降低了與使用者配置無線設定相關的整體風險。"
    impact: "WCN operations are disabled over all media."
    remediation: "要通過GP建立推薦的配置，請將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Configuration of wireless settings using Windows Connect Now 注意: 此群組政策路徑由Group Policy模板WindowsConnectNow.admx/adml提供，該模板包含在所有版本的Microsoft Windows Administrative Templates中。"
    compliance:
      - cis: ["18.6.20.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["15.4", "15.5"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.8.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> EnableRegistrars -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableUPnPRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableInBand802DOT11Registrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableFlashConfigRegistrar -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\Registrars -> DisableWPDRegistrar -> 0'

  # 18.6.20.2 (L2) Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'. (Automated)
  - id: 16172
    title: "確保「禁止存取 Windows Connect Now 精靈」設定為「啟用」。"
    description: "此策略設定禁止存取 Windows Connect Now (WCN) 精靈。此設定的建議狀態為：已啟用。"
    rationale: "允許標準使用者存取 Windows Connect Now 精靈會增加風險和攻擊面。"
    impact: 'The WCN wizards are turned off and users have no access to any of the wizard tasks. All the configuration related tasks including "Set up a wireless router or access point" and "Add a wireless device" are disabled.'
    remediation: "若要透過GP建立建議的配置，請設置以下UI路徑為“已啟用”：Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connect Now\\Prohibit access of the Windows Connect Now wizards 注意：此群組策略路徑預設可能不存在。它由群組策略範本WindowsConnectNow.admx/adml提供，這個範本包含在Microsoft Windows 8.0 & Server 2012（非R2）管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.6.20.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI -> DisableWcnUi'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WCN\UI -> DisableWcnUi -> 1'

  # 18.6.21.1 (L1) Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled: 1 = Minimize simultaneous connections' (Automated)
  - id: 16173
    title: "確保「最小化同時連接到 Internet 或 Windows 網域的數量」設定為「啟用：1 = 最小化同時連線」。"
    description: "此政策設定可阻止電腦同時建立多個與 Internet 或 Windows 網域的連線。此設定的建議狀態為： 啟用：1 = 最小化同時連線。"
    rationale: "防止橋接網路連接有助於防止使用者在不知情的情況下允許流量在內部和外部網路之間路由，從而導致敏感內部資料暴露的風險。"
    impact: "None - this is the default behavior."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設定為Enabled: 1 = Minimize simultaneous connections: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connection Manager\\Minimize the number of simultaneous connections to the Internet or a Windows Domain 注意：此群組原則路徑可能預設不存在。它由WCM.admx/adml群組原則模板提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板中。從Windows 10 Release 1903管理模板開始，它已更新了一個新的Minimize Policy Options子設置。"
    compliance:
      - cis: ["18.6.21.1"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["15.5"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.2"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fMinimizeConnections'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fMinimizeConnections -> 1'

  # 18.6.21.2 (L2) Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled' (MS only). (Automated)
  - id: 16174
    title: "確保「連接到經過網域驗證的網路時禁止連線到非網域網路」設定為「已啟用」（僅限 MS）。"
    description: "此策略設定可防止電腦同時連接到基於網域的網路和非基於網域的網路。此設定的建議狀態為：已啟用。"
    rationale: "潛在的擔憂是用戶會在不知情的情況下允許網路流量在不安全的公共網路和企業管理的網路之間流動。"
    impact: "The computer responds to automatic and manual network connection attempts based on the following circumstances: Automatic connection attempts - When the computer is already connected to a domain based network, all automatic connection attempts to non-domain networks are blocked. - When the computer is already connected to a non-domain based network, automatic connection attempts to domain based networks are blocked. Manual connection attempts - When the computer is already connected to either a non-domain based network or a domain based network over media other than Ethernet, and a user attempts to create a manual connection to an additional network in violation of this policy setting, the existing network connection is disconnected and the manual connection is allowed. - When the computer is already connected to either a non-domain based network or a domain based network over Ethernet, and a user attempts to create a manual connection to an additional network in violation of this policy setting, the existing Ethernet connection is maintained and the manual connection attempt is blocked."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\Network\\Windows Connection Manager\\Prohibit connection to non-domain networks when connected to domain authenticated network 注意：此群組原則路徑預設可能不存在。它是由包含在 Microsoft Windows 8.0 & Server 2012 (non-R2) 行政模板（或更新版本）中的群組原則模板 WCM.admx/adml 提供的。"
    compliance:
      - cis: ["18.6.21.2"]
      - cis_csc_v7: ["12.4"]
      - iso_27001-2013: ["A.13.1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fBlockNonDomain'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy -> fBlockNonDomain -> 1'

  # 18.7.1 (L1) Ensure 'Allow Print Spooler to accept client connections' is set to 'Disabled'. (Automated)
  - id: 16175
    title: "確保「允許列印後台處理程序接受客戶端連線」設定為「停用」。"
    description: "此策略設定控制列印後台處理程序服務是否接受客戶端連線。此設定的建議狀態是：停用。注意：必須重新啟動背景列印程式服務才能使此原則的變更生效。警告：列印伺服器必須對此建議進行例外處理，才能使其正常運作。當客戶端連線被停用時，使用者將無法列印到伺服器。"
    rationale: "停用 Print Spooler 服務接受用戶端連線的功能可以減輕針對 PrintNightmare 漏洞 (CVE-2021-34527) 的遠端攻擊和其他遠端 Print Spooler 攻擊。但是，此建議並不能減輕對 Print Spooler 服務的本地攻擊。"
    impact: "Provided that the Print Spooler service is not disabled, applications on and users logged in to servers will continue to be able to print from the server. However, the Print Spooler service will not accept client connections or allow users to share printers. Note that all printers that were already shared will continue to be shared. Warning: An exception to this recommendation must be made for print servers in order for them to function properly. Users will not be able to print to the server when client connections are disabled."
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為已停用: Computer Configuration\\Policies\\Administrative Templates\\Printers:Allow Print Spooler to accept client connections 注意: 此群組原則路徑由群組原則範本 Printing2.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    references:
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527"
    compliance:
      - cis: ["18.7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers -> RegisterSpoolerRemoteRpcEndPoint'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers -> RegisterSpoolerRemoteRpcEndPoint -> 0'

  # 18.7.2 (L1) Ensure 'Configure Redirection Guard' is set to 'Enabled: Redirection Guard Enabled'. (Automated)
  - id: 16176
    title: "確保「配置重新導向防護」設定為「已啟用：重新導向防護已啟用」。"
    description: "此策略設定決定是否為列印背景處理程序啟用重新導向防護。重新導向防護可以防止在背景列印程式中使用檔案重新導向。此設定的建議狀態為： 已啟用：重新導向防護已啟用。"
    rationale: "此設定可防止非管理員在列印後台處理程序程序中重新導向檔案。"
    impact: "None - this is default behavior."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為啟用：Redirection Guard 啟用：Computer Configuration\\Policies\\Administrative Templates\\Printers\\Configure Redirection Guard 注意：此群組策略路徑由群組策略範本 Printing.admx/adml 提供，該範本包含在 Microsoft Windows 11 發行版 22H2 管理模板 (及更新版本) 中。"
    references:
      - "https://techcommunity.microsoft.com/t5/microsoft-security-baselines/windows-11-version-22h2-security-baseline/ba-p/3632520"
    compliance:
      - cis: ["18.7.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers -> RedirectionguardPolicy'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers -> RedirectionguardPolicy -> 1'

  # 18.7.3 (L1) Ensure 'Configure RPC connection settings: Protocol to use for outgoing RPC connections' is set to 'Enabled: RPC over TCP'. (Automated)
  - id: 16177
    title: "確保「配置 RPC 連線設定：用於傳出 RPC 連線的協定」設定為「啟用：透過 TCP 的 RPC」。"
    description: "此策略設定控制用於遠端列印後台處理程序的傳出遠端程序呼叫 (RPC) 連線的協定和協定設定。此設定的建議狀態為： 啟用：基於 TCP 的 RPC。"
    rationale: "此設定防止使用命名管道進行與列印後台處理程序的 RPC 連接，並強制使用 TCP（一種更安全的通訊方法）。"
    impact: "Warning: Many existing print configurations may be using the older named pipes protocol and therefore will cease to function."
    remediation: "若要通過 GP 建立建議配置，請將以下 UI 路徑設置為已啟用：RPC over TCP: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Configure RPC connection settings: Protocol to use for outgoing RPC connections 注意：此群組原則路徑由群組原則模板 Printing.admx/adml 提供，該模板包含在 Microsoft Windows 11 Release 22H2 管理模板（及更新版本）中。"
    references:
      - "https://learn.microsoft.com/en-us/troubleshoot/windows-client/printing/windows-11-rpc-connection-updates-for-print#allow-rpc-over-tcp-communication"
    compliance:
      - cis: ["18.7.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcUseNamedPipeProtocol'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcUseNamedPipeProtocol -> 1'

  # 18.7.4 (L1) Ensure 'Configure RPC connection settings: Use authentication for outgoing RPC connections' is set to 'Enabled: Default'. (Automated)
  - id: 16178
    title: "確保「配置 RPC 連線設定：對傳出 RPC 連線使用身份驗證」設定為「啟用：預設」。"
    description: "此策略設定控制用於遠端列印後台處理程序的傳出遠端程序呼叫 (RPC) 連線的協定和協定設定。此設定的建議狀態為： 啟用：預設。"
    rationale: "此設定可防止使用命名管道進行與列印後台處理程序的 RPC 連接，並強制使用 TCP（一種更安全的通訊方法）。"
    impact: "Warning: Many existing print configurations may be using the older named pipes protocol and therefore will cease to function."
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為啟用：預設值：Computer Configuration\\Policies\\Administrative Templates\\Printers\\Configure RPC connection settings: Use authentication for outgoing RPC connections 注意：此群組原則路徑由群組原則模板Printing.admx/adml提供，該模板包含在Microsoft Windows 11 Release 22H2行政模板（及更新版本）中。"
    references:
      - "https://learn.microsoft.com/en-us/troubleshoot/windows-client/printing/windows-11-rpc-connection-updates-for-print#allow-rpc-over-tcp-communication"
    compliance:
      - cis: ["18.7.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcAuthentication'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcAuthentication -> 1'

  # 18.7.5 (L1) Ensure 'Configure RPC listener settings: Protocols to allow for incoming RPC connections' is set to 'Enabled: RPC over TCP'. (Automated)
  - id: 16179
    title: "確保「配置 RPC 偵聽器設定：允許傳入 RPC 連線的協定」設定為「啟用：透過 TCP 的 RPC」。"
    description: "此策略設定控制允許使用哪些協定傳入到列印後台處理程序的遠端程序呼叫 (RPC) 連線。此設定的建議狀態為： 啟用：基於 TCP 的 RPC。"
    rationale: "此設定可防止使用命名管道進行與列印後台處理程序的 RPC 連接，並強制使用 TCP（一種更安全的通訊方法）。"
    impact: "Warning: Many existing print configurations may be using the older named pipes protocol and therefore will cease to function."
    remediation: "要通過群組原則建立推薦的配置，請將以下使用者介面路徑設定為已啟用：RCP over TCP: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Configure RPC listener settings: Configure protocol options for incoming RPC connections 注意：此群組原則路徑由群組原則模板Printing.admx/adml提供，該模板包含在Microsoft Windows 11版本22H2管理模板（及更新版本）中。"
    compliance:
      - cis: ["18.7.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcProtocols'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcProtocols -> 1'

  # 18.7.6 (L1) Ensure 'Configure RPC listener settings: Authentication protocol to use for incoming RPC connections:' is set to 'Enabled: Negotiate' or higher (Automated)
  - id: 16180
    title: "確保「配置 RPC 偵聽器設定：用於傳入 RPC 連線的身份驗證協定：」設定為「啟用：協商」或更高。"
    description: "此策略設定控制允許使用哪些協定傳入到列印後台處理程序的遠端程序呼叫 (RPC) 連線。此設定的建議狀態為： 啟用：協商或更高。"
    rationale: "此設定可防止使用命名管道進行與列印後台處理程序的 RPC 連接，並強制使用 TCP（一種更安全的通訊方法）。"
    impact: "Warning: Many existing print configurations may be using the older named pipes protocol and therefore will cease to function."
    remediation: "要透過 GP 建立建議的設定，將以下 UI 路徑設為啟用: 協商或更高級別: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Configure RPC listener settings: Configure protocol options for incoming RPC connections 注意: 此群組原則路徑由群組原則範本 Printing.admx/adml 提供，該範本包含在 Microsoft Windows 11 Release 22H2 Administrive Templates (及更新版本) 中。"
    compliance:
      - cis: ["18.7.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> ForceKerberosForRpc'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> ForceKerberosForRpc -> 1'

  # 18.7.7 (L1) Ensure 'Configure RPC over TCP port' is set to 'Enabled: 0'. (Automated)
  - id: 16181
    title: "確保“配置 RPC over TCP 連接埠”設定為“啟用：0”。"
    description: "此策略設定控制用於 RPC over TCP 的連接埠用於列印後台處理程序的傳入連線和遠端列印後台處理程序的傳出連線。此設定的建議狀態為：啟用：0。"
    rationale: "使用動態端口進行列印使攻擊者更難知道正在使用哪個端口，從而更難知道要攻擊哪個端口。"
    impact: "If your current print environment is configured for a specific TCP port, this setting may require a firewall change (if applicable) for continued printing."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為已啟用：0: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Configure RPC over TCP port 注意：此群組原則路徑是由群組原則範本Printing.admx/adml提供，該範本包含在Microsoft Windows 11 Release 22H2 Administrative Templates（及更新版本）中。"
    compliance:
      - cis: ["18.7.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcTcpPort'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\RPC -> RpcTcpPort -> 0'

  # 18.7.8 (L1) Ensure 'Limits print driver installation to Administrators' is set to 'Enabled'. (Automated)
  - id: 16182
    title: "確保「限制管理員安裝列印驅動程式」設定為「啟用」。"
    description: "此策略設定控制非管理員使用者是否可以在系統上安裝列印驅動程式。此設定的建議狀態為：已啟用。注意：2021 年 8 月 10 日，Microsoft 宣布了“指向和列印預設行為變更”，該變更修改了預設指向和列印驅動程式安裝和更新行為，以需要管理員權限。這記錄在 KB5005652 - 管理新的指向和列印預設驅動程式安裝行為 (CVE-2021-34481) 中。"
    rationale: "限制管理員安裝列印磁碟機有助於緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和其他列印背景處理程序攻擊。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為啟用。Computer Configuration\\Policies\\Administrative Templates\\Printers\\Limits print driver installation to Administrators 注意：此組策略路徑是由組策略模板 Printing.admx/adml 提供的，該模板包含在 Microsoft Windows 10 Release 21H2 管理模板（及更新版本）中。"
    references:
      - "https://support.microsoft.com/en-us/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-a7ea-183b129578a7"
      - "https://support.microsoft.com/en-gb/topic/kb5005652-manage-new-point-and-print-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-a23b-6d8e9a302872"
    compliance:
      - cis: ["18.7.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint -> RestrictDriverInstallationToAdministrators'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint -> RestrictDriverInstallationToAdministrators -> 1'

  # 18.7.9 (L1) Ensure 'Manage processing of Queue-specific files' is set to 'Enabled: Limit Queue-specific files to Color profiles'. (Automated)
  - id: 16183
    title: "確保「管理佇列特定檔案的處理」設定為「啟用：將佇列特定檔案限制為色彩設定檔」。"
    description: "此策略設定管理印表機安裝期間如何處理特定於佇列的檔案。在印表機安裝時，供應商提供的安裝應用程式可以指定與特定列印佇列關聯的一組任何類型的檔案。檔案被下載到連接到列印伺服器的每個客戶端。此設定的建議狀態為： 啟用：將佇列特定檔案限制為色彩設定檔。"
    rationale: "當 Windows 列印後台處理程序服務不正確地執行特權檔案操作時，存在 Windows 列印後台處理程序遠端程式碼執行漏洞 (CVE-2021-36958)。成功利用此漏洞的攻擊者可以以SYSTEM權限執行任意程式碼，然後安裝程式；查看、更改或刪除資料；或建立具有完全使用者權限的新帳戶。"
    impact: "None - this is default behavior."
    remediation: "要通過 GP 設定建議配置，將以下 UI 路徑設為 Enabled: Limit Queue-specific files to Color profiles: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Manage processing of Queue-specific files 說明：此群組原則路徑由群組原則範本 Printing.admx/adml 提供，該範本隨 Microsoft Windows 11 22H2 版管理範本（及更新版本）一起提供。"
    references:
      - "https://learn.microsoft.com/en-us/windows-hardware/drivers/print/installing-queue-specific-files"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958"
    compliance:
      - cis: ["18.7.9"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers -> CopyFilesPolicy'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers -> CopyFilesPolicy -> 1'

  # 18.7.10 (L1) Ensure 'Point and Print Restrictions: When installing drivers for a new connection' is set to 'Enabled: Show warning and elevation prompt'. (Automated)
  - id: 16184
    title: "確保「指向和列印限制：為新連線安裝驅動程式時」設定為「啟用：顯示警告和提升提示」。"
    description: "此政策設定控制當使用者使用指向和列印建立新的印表機連線時電腦是否顯示警告和安全性提升提示。此設定的建議狀態為： 啟用：顯示警告和提升提示。注意：2021 年 8 月 10 日，Microsoft 宣布了“指向和列印預設行為變更”，該變更修改了預設指向和列印驅動程式安裝和更新行為，以需要管理員權限。這記錄在 KB5005652 - 管理新的指向和列印預設驅動程式安裝行為 (CVE-2021-34481) 中。此變更會覆寫所有「指向和列印」群組原則設置，並確保只有管理員才能使用「指向和列印」從列印伺服器安裝印表機驅動程式。"
    rationale: "啟用 Windows 使用者帳戶控制 (UAC) 來安裝新的列印驅動程式可以協助緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和其他列印背景處理程序攻擊。儘管指向和列印預設驅動程式安裝行為會覆蓋此設置，但將其配置為在行為相反時作為後備措施非常重要。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立建議的配置，請將以下用戶界面路徑設置為已啟用：顯示警告和提升提示：Computer Configuration\\Policies\\Administrative Templates\\Printers\\Point and Print Restrictions：當為新連接安裝驅動程式時注意：此組策略路徑由包含在所有版本 Microsoft Windows 管理模板中的組策略模板 Printing.admx/adml 提供。"
    references:
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958"
      - "https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-change/"
      - "https://support.microsoft.com/en-us/topic/kb5005652-manage-new-point-and-print-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-a23b-6d8e9a302872"
    compliance:
      - cis: ["18.7.10"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint -> NoWarningNoElevationOnInstall'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint -> NoWarningNoElevationOnInstall -> 1'

  # 18.7.11 (L1) Ensure 'Point and Print Restrictions: When updating drivers for an existing connection' is set to 'Enabled: Show warning and elevation prompt'. (Automated)
  - id: 16185
    title: "確保「指向和列印限制：更新現有連線的驅動程式時」設定為「啟用：顯示警告和提升提示」。"
    description: "此政策設定控制當使用者使用「指向和列印」為現有連線更新驅動程式時，電腦是否顯示警告和安全性提升提示。此設定的建議狀態為： 啟用：顯示警告和提升提示。注意：2021 年 8 月 10 日，Microsoft 宣布了“指向和列印預設行為變更”，該變更修改了預設指向和列印驅動程式安裝和更新行為，以需要管理員權限。這記錄在 KB5005652 - 管理新的指向和列印預設驅動程式安裝行為 (CVE-2021-34481) 中。此變更會覆寫所有「指向和列印」群組原則設置，並確保只有管理員才能使用「指向和列印」從列印伺服器安裝印表機驅動程式。"
    rationale: "啟用 Windows 使用者帳戶控制 (UAC) 來更新現有列印驅動程式有助於緩解 PrintNightmare 漏洞 (CVE-2021-34527) 和其他列印背景處理程序攻擊。儘管指向和列印預設驅動程式安裝行為會覆蓋此設置，但將其配置為在行為相反時作為後備措施非常重要。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立推薦配置，將以下 UI 路徑設為已啟用: Show warning and elevation prompt: Computer Configuration\\Policies\\Administrative Templates\\Printers\\Point and Print Restrictions: When updating drivers for an existing connection 注意: 此組策略路徑由組策略模板 Printing.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    references:
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527"
      - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958"
      - "https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-change"
      - "https://support.microsoft.com/en-us/topic/kb5005652-manage-new-point-and-print-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-a23b-6d8e9a302872"
    compliance:
      - cis: ["18.7.11"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint -> UpdatePromptSettings'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint -> UpdatePromptSettings -> 1'

  # 18.8.1.1 (L2) Ensure 'Turn off notifications network usage' is set to 'Enabled'. (Automated)
  - id: 16186
    title: "確保「關閉網路使用通知」設定為「啟用」。"
    description: "此策略設定可阻止應用程式使用網路傳送更新磁貼、磁貼徽章、Toast 或原始通知的通知。此政策設定關閉 Windows 和 Windows 推播通知服務 (WNS) 之間的連線。此策略設定也會阻止應用程式輪詢應用程式服務來更新磁貼。此設定的建議狀態為：已啟用。"
    rationale: "Windows 推播通知服務 (WNS) 是一種從雲端/Internet 接收第三方通知和更新的機制。在高安全性環境中，應防止外部系統（尤其是組織外部託管的系統）對安全工作站產生影響。"
    impact: "Applications and system features will not be able receive notifications from the network from WNS or via notification polling APIs."
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Start Menu and Taskbar\\Turn off notifications network usage 注意：預設情況下，這個群組原則路徑可能不存在。它由群組原則範本 WPN.admx/adml 提供，且包含在 Microsoft Windows 10 Release 1607 和 Server 2016 之後的管理範本中。"
    compliance:
      - cis: ["18.8.1.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications -> NoCloudApplicationNotification'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications -> NoCloudApplicationNotification -> 1'

  # 18.9.3.1 (L1) Ensure 'Include command line in process creation events' is set to 'Enabled'. (Automated)
  - id: 16187
    title: "確保「在程序建立事件中包含指令列」設定為「啟用」。"
    description: "此政策設定控制在建立新程序時是否將程序建立指令列文字記錄在安全性審核事件中。此設定的建議狀態為：已啟用。注意：早於 Windows Server 2012 R2 的伺服器作業系統最初不支援此設定控制的此功能。但是，2015 年 2 月，Microsoft 透過更新 KB3004375 在 Windows Server 2008 R2 和 Windows Server 2012（非 R2）中新增了對此功能的支援。因此，在那些較舊的作業系統上設定此設定也很重要。"
    rationale: "在對攻擊事件進行取證調查時，捕獲事件日誌中的程序指令列資訊非常有價值。"
    impact: 'Process command line information will be included in the event logs, which can contain sensitive or private information such as passwords or user data. Warning: There are potential risks of capturing credentials and sensitive information which could be exposed to users who have read-access to event logs. Microsoft provides a feature called "Protected Event Logging" to better secure event log data. For assistance with protecting event logging, visit: About Logging Windows - PowerShell | Microsoft Docs.'
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Audit Process Creation\\Include command line in process creation events 注意: 此群組原則路徑預設可能不存在。這是群組原則模板 AuditSettings.admx/adml 提供的，該模板包含在 Microsoft Windows 8.1 & Server 2012 R2 行政模板中 (或更新版本)。"
    references:
      - "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7.2#protected-event-logging"
    compliance:
      - cis: ["18.9.3.1"]
      - cis_csc_v8: ["8.8"]
      - cis_csc_v7: ["8.8"]
      - iso_27001-2013: ["A.12.14.1"]
      - soc_2: ["CC5.2", "CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit -> ProcessCreationIncludeCmdLine_Enabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit -> ProcessCreationIncludeCmdLine_Enabled -> 1'

  # 18.9.4.1 (L1) Ensure 'Encryption Oracle Remediation' is set to 'Enabled: Force Updated Clients'. (Automated)
  - id: 16188
    title: "確保「加密 Oracle 修復」設定為「啟用：強制更新用戶端」。"
    description: "某些應用程式（例如遠端桌面連線）所使用的某些版本的 CredSSP 協定容易受到針對用戶端的加密預言機攻擊。此策略控制與易受攻擊的用戶端和伺服器的相容性，並允許您設定加密預言機漏洞所需的保護等級。此設定的建議狀態為： 啟用：強制更新客戶端。"
    rationale: "此設定對於緩解 CredSSP 加密 Oracle 漏洞非常重要，Microsoft 於 2018 年 3 月 13 日在 CVE-2018-0886 中發布了該漏洞的資訊 | CredSSP 遠端程式碼執行漏洞。從 Server 2008（非 R2）開始的所有 Windows Server 版本都會受到此漏洞的影響，並且只要在 2018 年 5 月（或之後）之前進行了修補，都將與此建議相容。"
    impact: "Client applications which use CredSSP will not be able to fall back to the insecure versions and services using CredSSP will not accept unpatched clients. This setting should not be deployed until all remote hosts support the newest version, which is achieved by ensuring that all Microsoft security updates at least through May 2018 are installed."
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設定為啟用: Force Updated Clients: Computer Configuration\\Policies\\Administrative Templates\\System\\Credentials Delegation\\Encryption Oracle Remediation 注意: 此群組原則路徑預設可能不存在。它由群組原則範本CredSsp.admx/adml提供，該範本包含在Microsoft Windows 10 Release 1803行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.4.1"]
      - cis_csc_v8: ["7.3"]
      - cis_csc_v7: ["3.4"]
      - cmmc_v2.0: ["SI.L1-3.14.1"]
      - nist_sp_800-53: ["SI-2(2)"]
      - pci_dss_v3.2.1: ["6.2"]
      - soc_2: ["CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters -> AllowEncryptionOracle'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters -> AllowEncryptionOracle -> 1'

  # 18.9.4.2 (L1) Ensure 'Remote host allows delegation of non- exportable credentials' is set to 'Enabled'. (Automated)
  - id: 16189
    title: "確保「遠端主機允許委派不可匯出的憑證」設定為「啟用」。"
    description: "遠端主機允許委派不可匯出的憑證。使用憑證委派時，裝置會提供遠端主機可匯出版本的憑證。這使用戶面臨遠端主機上的攻擊者竊取憑證的風險。受限管理模式和 Windows Defender Remote Credential Guard 功能是幫助防範此風險的兩個選項。此設定的建議狀態為：已啟用。注意：有關 Windows Defender Remote Credential Guard 及其與受限管理模式的比較的更多詳細資訊，請存取此連結：使用 Windows Defender Remote Credential Guard 保護遠端桌面憑證 (Windows 10) |微軟檔案。"
    rationale: "受限管理模式旨在透過確保可重複使用的憑證不會儲存在可能受到損害的遠端裝置的記憶體中來幫助保護管理員帳戶。 Windows Defender Remote Credential Guard 透過將 Kerberos 請求重新導向回請求連接的設備，幫助你透過遠端桌面連線保護你的憑證。應該啟用並支援這兩個功能，因為它們可以減少憑證被盜的機會。"
    impact: "The host will support the Restricted Admin Mode and Windows Defender Remote Credential Guard features."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Credentials Delegation\\Remote host allows delegation of non-exportable credentials 注意: 此組策略路徑可能預設不存在。它由組策略模板CredSsp.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1703管理模板(或更新版本)中。"
    references:
      - "https://docs.microsoft.com/en-us/windows/security/identity-protection/remote-credential-guard"
    compliance:
      - cis: ["18.9.4.2"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["16.5"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation -> AllowProtectedCreds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation -> AllowProtectedCreds -> 1'

  # 18.9.5.1 (NG) Ensure 'Turn On Virtualization Based Security' is set to 'Enabled'. (Automated)
  - id: 16190
    title: "確保「開啟基於虛擬化的安全性」設定為「已啟用」。"
    description: "此策略設定指定是否啟用基於虛擬化的安全性。基於虛擬化的安全性使用 Windows Hypervisor 來提供安全服務的支援。此設定的建議狀態為：已啟用 注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這又要求使用 UEFI BIOS 設定（而非舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "Kerberos、NTLM 和憑證管理員透過使用基於虛擬化的安全性來隔離機密。先前版本的 Windows 將機密儲存在本機安全機構 (LSA) 中。在 Windows 10 之前，LSA 將作業系統使用的機密儲存在其程序記憶體中。啟用 Windows Defender Credential Guard 後，作業系統中的 LSA 程序會與一個稱為隔離 LSA 程序的新元件進行通訊，該元件儲存和保護這些機密。隔離 LSA 程序儲存的資料受到基於虛擬化的安全性的保護，且作業系統的其餘部分無法存取。"
    impact: "Warning: All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible. Warning #2: Enabling Windows Defender Credential Guard on Domain Controllers is not supported. The domain controller hosts authentication services which integrate with processes isolated when Windows Defender Credential Guard is enabled, causing crashes."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security 注意：此群組原則路徑可能預設不存在。它由包含在 Microsoft Windows 10 RTM (Release 1507) 行政模板 (或更新版本) 的 Group Policy 模板 DeviceGuard.admx/adml 提供。"
    compliance:
      - cis: ["18.9.5.1"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> EnableVirtualizationBasedSecurity'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> EnableVirtualizationBasedSecurity -> 1'

  # 18.9.5.2 (NG) Ensure 'Turn On Virtualization Based Security: Select Platform Security Level' is set to 'Secure Boot' or higher. (Automated)
  - id: 16191
    title: "確保「開啟基於虛擬化的安全性：選擇平台安全等級」設定為「安全啟動」或更高。"
    description: "此原則設定指定是否啟用基於虛擬化的安全性 (VBS)。 VBS使用Windows Hypervisor來提供安全服務的支援。此設定的建議狀態是：安全啟動或安全啟動和 DMA 保護。注意：VBS 需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "安全啟動有助於降低引導程式攻擊的風險，並與 DMA 保護結合使用，有助於保護資料免於從記憶體中刮取。"
    impact: "Choosing the Secure Boot option provides the system with as much protection as is supported by the computer's hardware. A system with input/output memory management units (IOMMUs) will have Secure Boot with DMA protection. A system without IOMMUs will simply have Secure Boot enabled without DMA protection. Choosing the Secure Boot with DMA protection option requires the system to have IOMMUs in order to enable VBS. Without IOMMU hardware support, VBS will be disabled. Warning: All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible."
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為Secure Boot或Secure Boot and DMA Protection: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Select Platform Security Level 注意：此組策略路徑可能預設情況下不存在。它由Group Policy模板DeviceGuard.admx/adml提供，該模板包含在Microsoft Windows 10 RTM (Release 1507) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.5.2"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: any
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> RequirePlatformSecurityFeatures -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> RequirePlatformSecurityFeatures -> 3'

  # 18.9.5.3 (NG) Ensure 'Turn On Virtualization Based Security: Virtualization Based Protection of Code Integrity' is set to 'Enabled with UEFI lock'. (Automated)
  - id: 16192
    title: "確保「開啟基於虛擬化的安全性：基於虛擬化的程式碼完整性保護」設定為「透過 UEFI 鎖定啟用」。"
    description: "此設定啟用基於虛擬化的核心模式程式碼完整性保護。啟用此功能後，將強制執行核心模式記憶體保護，並且程式碼完整性驗證路徑將受到基於虛擬化的安全功能的保護。此設定的建議狀態是：啟用並啟用 UEFI 鎖定 注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "「使用 UEFI 鎖定啟用」選項可確保無法遠端停用基於虛擬化的程式碼完整性保護。"
    impact: "Warning: All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible. Warning #2: Once this setting is turned on and active, Virtualization Based Security cannot be disabled solely via GPO or any other remote method. After removing the setting from GPO, the features must also be manually disabled locally at the machine using the steps provided at this link: Manage Windows Defender Credential Guard (Windows 10) | Microsoft Docs."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設為啟用並使用 UEFI 鎖定: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Virtualization Based Protection of Code Integrity 注意：預設情況下，該群組原則路徑可能不存在。 它由 Group Policy 模板 DeviceGuard.admx/adml 提供，該模板包含在 Microsoft Windows 10 RTM (版本 1507) 管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.9.5.3"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HypervisorEnforcedCodeIntegrity'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HypervisorEnforcedCodeIntegrity -> 1'

  # 18.9.5.4 (NG) Ensure 'Turn On Virtualization Based Security: Require UEFI Memory Attributes Table' is set to 'True (checked)'. (Automated)
  - id: 16193
    title: "確保「開啟基於虛擬化的安全性：需要 UEFI 記憶體屬性表」設定為「True（選取）」。"
    description: "此選項僅在具有 UEFI 韌體支援記憶體屬性表的裝置上啟用基於虛擬化的程式碼完整性保護。沒有 UEFI 記憶體屬性表的裝置可能具有與基於虛擬化的程式碼完整性保護不相容的韌體，這在某些情況下可能會導致當機或資料遺失或與某些插件卡不相容。如果未設定此選項，則應測試目標裝置以確保相容性。此設定的建議狀態為：True（選取） 注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這又要求使用 UEFI BIOS 設定（而非舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "此設定將有助於防止在不相容的系統上啟用此控件，從而導致當機或資料遺失。"
    impact: "Warning: All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible."
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 TRUE: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Require UEFI Memory Attributes Table 注意: 此群組原則路徑預設可能不存在。它由群組原則模板 DeviceGuard.admx/adml 提供，該模板包含在 Microsoft Windows 10 1703 版本 (或更新版本) 的管理模板中。"
    compliance:
      - cis: ["18.9.5.4"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HVCIMATRequired'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> HVCIMATRequired -> 1'

  # 18.9.5.5 (NG) Ensure 'Turn On Virtualization Based Security: Credential Guard Configuration' is set to 'Enabled with UEFI lock' (MS Only). (Automated)
  - id: 16194
    title: "確保「開啟基於虛擬化的安全性：Credential Guard 設定」設定為「透過 UEFI 鎖啟用」（僅限 MS）。"
    description: '此設定可讓使用者開啟具有基於虛擬化的安全性的 Credential Guard，以協助保護憑證。 「透過 UEFI 鎖定啟用」選項可確保無法遠端停用 Credential Guard。為了停用該功能，您必須將群組原則設為“停用”，並從每台電腦（具有實際存在的使用者）中刪除安全功能，以便清除 UEFI 中保留的配置。此設定的建議狀態是：啟用 UEFI 鎖定，但僅在成員伺服器（而非網域控制器）上。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。'
    rationale: "“啟用 UEFI 鎖定”選項可確保無法遠端停用 Credential Guard。"
    impact: "Warning: All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible. Warning #2: Enabling Windows Defender Credential Guard on Domain Controllers is not supported. The domain controller hosts authentication services which integrate with processes isolated when Windows Defender Credential Guard is enabled, causing crashes. Warning #3: Once this setting is turned on and active, Credential Guard cannot be disabled solely via GPO or any other remote method. After removing the setting from GPO, the features must also be manually disabled locally at the machine using the steps provided at this link: Manage Windows Defender Credential Guard (Windows 10) | Microsoft Docs."
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為啟用並使用UEFI鎖（僅在成員伺服器上）：Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Credential Guard Configuration 注意：此群組原則路徑預設情況下可能不存在。它由群組原則模板DeviceGuard.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1511 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.9.5.5"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> LsaCfgFlags'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> LsaCfgFlags -> 3'

  # 18.9.5.6 (NG) Ensure 'Turn On Virtualization Based Security: Credential Guard Configuration' is set to 'Disabled' (DC Only). (Automated)
  - id: 16195
    title: "確保「開啟基於虛擬化的安全性：Credential Guard 設定」設定為「停用」（僅限 DC）。"
    description: "此設定可讓使用者開啟具有基於虛擬化的安全性的 Credential Guard，以協助保護憑證。此設定的建議狀態是：在網域控制器上停用。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "Credential Guard 在網域控制器上沒有用，可能會導致網域控制器當機。"
    impact: "None - this is the default behavior. Warning: Enabling Windows Defender Credential Guard on Domain Controllers is not supported. The domain controller hosts authentication services which integrate with processes isolated when Windows Defender Credential Guard is enabled, causing crashes. Manage Windows Defender Credential Guard (Windows 10) | Microsoft Docs."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Credential Guard Configuration 注意: 此群組原則路徑預設可能不存在。它由隨附於 Microsoft Windows 10 Release 1511 的管理模板 (或更新版本) 中的群組原則模板 DeviceGuard.admx/adml 提供。"
    compliance:
      - cis: ["18.9.5.6"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> LsaCfgFlags'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> LsaCfgFlags -> 0'

  # 18.9.5.7 (NG) Ensure 'Turn On Virtualization Based Security: Secure Launch Configuration' is set to 'Enabled'. (Automated)
  - id: 16196
    title: "確保「開啟基於虛擬化的安全性：安全啟動配置」設定為「已啟用」。"
    description: "安全啟動可保護基於虛擬化的安全環境免受裝置韌體中漏洞的利用。此設定的建議狀態為：已啟用。注意：基於虛擬化的安全性需要啟用安全啟動的 64 位元版本的 Windows，這反過來又要求使用 UEFI BIOS 設定（而不是舊版 BIOS 設定）安裝 Windows。此外，如果在虛擬機器上執行 Windows，則主機必須向來賓 VM 公開硬體輔助 CPU 虛擬化功能（Intel VT-x 或 AMD-V）。有關此功能的系統要求的更多資訊，請參閱 Windows Defender Credential Guard 要求 (Windows 10) | Microsoft 檔案註解 #2：使用 Azure IaaS VM 時目前不支援 Credential Guard 和 Device Guard。"
    rationale: "安全啟動改變了 Windows 啟動方式，以使用英特爾可信任執行技術 (TXT) 和執行階段 BIOS 彈性功能，以防止韌體漏洞影響基於 Windows 虛擬化的安全環境的安全性。"
    impact: "Warning: All drivers on the system must be compatible with this feature or the system may crash. Ensure that this policy setting is only deployed to computers which are known to be compatible."
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Device Guard\\Turn On Virtualization Based Security: Secure Launch Configuration 注意：此群組原則路徑可能預設不存在。它由群組原則範本 DeviceGuard.admx/adml 提供，該範本包含在 Microsoft Windows 10 發佈 1809 & Server 2019 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.5.7"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> ConfigureSystemGuardLaunch'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard -> ConfigureSystemGuardLaunch -> 1'

  # 18.9.7.2 (L1) Ensure 'Prevent device metadata retrieval from the Internet' is set to 'Enabled'. (Automated)
  - id: 16197
    title: "確保「阻止從 Internet 檢索裝置元資料」設定為「啟用」。"
    description: "此策略設定可讓您阻止 Windows 從 Internet 擷取裝置元資料。此設定的建議狀態為：已啟用。注意：這不會阻止基本硬體驅動程式的安裝，但會阻止關聯的第三方實用軟體在 SYSTEM 帳戶的上下文中自動安裝。"
    rationale: "軟體安裝應由授權系統管理員而非標準使用者進行。允許在 SYSTEM 帳戶上下文中自動安裝第三方軟體可能會導致透過後門或安裝軟體錯誤進行未經授權的存取。"
    impact: "Standard users without administrator privileges will not be able to install associated third-party utility software for peripheral devices. This may limit the use of advanced features of those devices unless/until an administrator installs the associated utility software for the device."
    remediation: "若要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Enabled：Computer Configuration\\Policies\\Administrative Templates\\System\\Device Installation\\Prevent device metadata retrieval from the Internet 注意：此組策略路徑由組策略模板 DeviceInstallation.admx/adml 提供，該模板包含在 Microsoft Windows 7 & Server 2008 R2 管理模板中，或組策略模板 DeviceSetup.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理模板中(或更新版本)。"
    compliance:
      - cis: ["18.9.7.2"]
      - cis_csc_v7: ["18.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Device Metadata'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Device Metadata -> PreventDeviceMetadataFromNetwork'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Device Metadata -> PreventDeviceMetadataFromNetwork -> 1'

  # 18.9.13.1 (L1) Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'. (Automated)
  - id: 16198
    title: "確保「引導啟動驅動程式初始化策略」設定為「啟用：良好、未知和不良但關鍵」。"
    description: "此策略設定可讓您指定根據早期啟動反惡意軟體啟動驅動程式確定的分類來初始化哪些啟動啟動驅動程式。早期啟動反惡意軟體引導啟動驅動程式可以為每個引導啟動驅動程式傳回以下分類： - 良好：驅動程式已簽署且未被竄改。 - 壞：驅動程式已被識別為惡意軟體。建議您不要允許初始化已知的不良驅動程式。 - 不良，但啟動所需：驅動程式已被識別為惡意軟體，但如果不載入此驅動程式，電腦將無法成功啟動。 - 未知：此驅動程式尚未經過您的惡意軟體偵測應用程式的證明，並且尚未由 Early Launch Antimalware 啟動驅動程式分類。如果啟用此策略設置，您將能夠選擇下次啟動電腦時要初始化的引導啟動驅動程式。如果您的惡意軟體偵測應用程式不包含早期啟動反惡意軟體啟動驅動程式，或者您的早期啟動反惡意軟體啟動驅動程式已停用，則此設定無效，並且所有啟動驅動程式都會被初始化。此設定的建議狀態為： 啟用：良好、未知和不良但關鍵。"
    rationale: "此策略設定有助於減少已感染系統的惡意軟體的影響。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 Enabled: Good, unknown and bad but critical: Computer Configuration\\Policies\\Administrative Templates\\System\\Early Launch Antimalware\\Boot-Start Driver Initialization Policy 注意: 此群組策略路徑可能在預設情況下不存在。該路徑由群組策略模板 EarlyLaunchAM.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理模板中 (或更新版本)。"
    compliance:
      - cis: ["18.9.13.1"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch -> DriverLoadPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch -> DriverLoadPolicy -> 3'

  # 18.9.19.2 (L1) Ensure 'Configure registry policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'. (Automated)
  - id: 16199
    title: "確保「配置註冊表策略處理：不在定期後台處理期間套用」設定為「啟用：FALSE」。"
    description: '「定期後台處理期間不套用」選項可防止系統在電腦使用時在背景更新受影響的策略。停用背景更新後，政策變更將在下次使用者登入或系統重新啟動後生效。此設定的建議狀態為： 已啟用：FALSE（未選取）。'
    rationale: "與等到下一次使用者登入或系統重新啟動相比，將此選項設為 false（未選取）將確保網域原則變更更快生效。"
    impact: "Group Policies will be reapplied every time they are refreshed, which could have a slight impact on performance."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為啟用，然後將「在定期背景處理期間不應用」選項設置為FALSE（未選中）：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Configure registry policy processing 注意：此組策略路徑預設可能不存在。它由組策略模板GroupPolicy.admx/adml提供，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.19.2"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.4"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.2"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> 0'

  # 18.9.19.3 (L1) Ensure 'Configure registry policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'. (Automated)
  - id: 16200
    title: "確保「配置註冊表策略處理：即使群組原則物件未變更也進行處理」設定為「啟用：TRUE」。"
    description: '「即使群組原則物件未變更也進行處理」選項會更新並重新套用策略，即使策略未變更也是如此。此設定的建議狀態為： 啟用：TRUE（選取）。'
    rationale: "將此選項設為 true（選取）將確保可能已在本機配置的未經授權的變更強制再次符合基於網域的群組原則設定。"
    impact: "Group Policies will be reapplied even if they have not been changed, which could have a slight impact on performance."
    remediation: "要通過 GP 建立推薦配置，請將以下 UI 路徑設置為啟用，然後將「即使組策略對象未更改也要處理」選項設置為 TRUE（選中）：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Configure registry policy processing 注意：此組策略路徑預設可能不存在。它由組策略模板 GroupPolicy.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.19.3"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.4"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.2"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> 0'

  # 18.9.19.4 (L1) Ensure 'Continue experiences on this device' is set to 'Disabled'. (Automated)
  - id: 16201
    title: "確保“在此裝置上繼續體驗”設定為“已停用”。"
    description: "此策略設定是否允許 Windows 裝置參與跨裝置體驗（繼續體驗）。此設定的建議狀態是：停用。"
    rationale: "跨裝置體驗是指系統可以存取應用程式並向其他裝置發送訊息。在企業管理的環境中，只有受信任的系統才應該在網路內進行通訊。應禁止存取任何其他系統。"
    impact: "The Windows device will not be discoverable by other devices, and cannot participate in cross-device experiences."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為已停用: Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Continue experiences on this device 注意: 此群組原則路徑預設可能不存在。它由群組原則範本 GroupPolicy.admx/adml 提供，該範本包含在 Microsoft Windows 10 1607 版和 Server 2016 行政範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.19.4"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableCdp'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableCdp -> 0'

  # 18.9.19.5 (L1) Ensure 'Turn off background refresh of Group Policy' is set to 'Disabled'. (Automated)
  - id: 16202
    title: "確保「關閉群組原則後台刷新」設定為「停用」。"
    description: "此策略設定可防止在電腦使用時更新群組原則。此策略設定適用於電腦、使用者和網域控制站的群組原則。此設定的建議狀態是：停用。"
    rationale: "與等到下次使用者登入或系統重新啟動相比，此設定可確保群組原則變更更快生效。"
    impact: "None - this is the default behavior."
    remediation: "若要透過GP設定建議的配置，請將以下UI路徑設置為已停用：Computer Configuration\\Policies\\Administrative Templates\\System\\Group Policy\\Turn off background refresh of Group Policy 注意：此群組原則路徑由GroupPolicy.admx/adml群組原則範本提供，該範本包含在所有版本的Microsoft Windows管理範本中。"
    compliance:
      - cis: ["18.9.19.5"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.4"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.2"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableBkGndGroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableBkGndGroupPolicy -> 0'

  # 18.9.20.1.1 (L1) Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'. (Automated)
  - id: 16203
    title: "請確保「關閉透過 HTTP 下載列印驅動程式」設定為「啟用」。"
    description: "此原則設定控制電腦是否可以透過 HTTP 下載列印驅動程式套件。若要設定 HTTP 列印，可能需要透過 HTTP 下載標準作業系統安裝中不可用的印表機驅動程式。此設定的建議狀態為：已啟用。"
    rationale: "使用者可能會下載包含惡意程式碼的驅動程式。"
    impact: "Print drivers cannot be downloaded over HTTP. Note: This policy setting does not prevent the client computer from printing to printers on the intranet or the Internet over HTTP. It only prohibits downloading drivers that are not already installed locally."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為 已啟用 : Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off downloading of print drivers over HTTP 注意: 此組策略路徑由組策略模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.20.1.1"]
      - cis_csc_v8: ["2.5"]
      - cis_csc_v7: ["2.7"]
      - cmmc_v2.0: ["CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "CM.L2-3.4.9"]
      - iso_27001-2013: ["A.12.1.2", "A.12.5.1", "A.12.6.2"]
      - nist_sp_800-53: ["CM-7(5)"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableWebPnPDownload'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableWebPnPDownload -> 1'

  # 18.9.20.1.2 (L2) Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'. (Automated)
  - id: 16204
    title: "確保「關閉手寫個人化資料共享」設定為「啟用」。"
    description: "此設定會關閉手寫辨識個人化工具的資料共用。手寫辨識個人化工具使平板電腦使用者能夠透過提供書寫範例來使手寫辨識適應自己的書寫風格。該工具可以選擇與 Microsoft 共用使用者書寫範例，以改善未來版本的 Windows 中的手寫識別。該工具會產生報表並透過安全連線將其傳輸給 Microsoft。此設定的建議狀態為：已啟用。"
    rationale: "一個人的筆跡是個人識別資訊 (PII)，尤其是當涉及到您的簽名時。因此，在許多環境中，未經使用者明確批准而自動將 PII 上傳到網站是不可接受的。"
    impact: "Tablet PC users cannot choose to share writing samples from the handwriting recognition personalization tool with Microsoft."
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設定為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting personalization data sharing 注意：此群組原則路徑可能預設不存在。它由 Group Policy 模板 ShapeCollector.admx/adml 提供，該模板包含在 Microsoft Windows 7 和 Server 2008 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.20.1.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC -> PreventHandwritingDataSharing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\TabletPC -> PreventHandwritingDataSharing -> 1'

  # 18.9.20.1.3 (L2) Ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled'. (Automated)
  - id: 16205
    title: "確保「關閉手寫辨識錯誤報告」設定為「啟用」。"
    description: "關閉手寫辨識錯誤報告工具。手寫識別錯誤報告工具使用戶能夠報告在 Tablet PC 輸入面板中遇到的錯誤。該工具會產生錯誤報告並透過安全連線將其傳輸給 Microsoft。 Microsoft 使用這些錯誤報告來改進未來版本的 Windows 中的手寫辨識。此設定的建議狀態為：已啟用。"
    rationale: "一個人的筆跡是個人識別資訊 (PII)，尤其是當涉及到您的簽名時。因此，在許多環境中，未經使用者明確批准而自動將 PII 上傳到網站是不可接受的。"
    impact: "Users cannot start the handwriting recognition error reporting tool or send error reports to Microsoft."
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off handwriting recognition error reporting 注意: 此組策略路徑是由Group Policy模板InkWatson.admx/adml提供的，所有版本的Microsoft Windows Administrative Templates都包含此模板。"
    compliance:
      - cis: ["18.9.20.1.3"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports -> PreventHandwritingErrorReports'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports -> PreventHandwritingErrorReports -> 1'

  # 18.9.20.1.4 (L2) Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'. (Automated)
  - id: 16206
    title: "確保「如果 URL 連線引用 Microsoft.com，則關閉 Internet 連線精靈」設定為「啟用」。"
    description: "此政策設定指定 Internet 連線精靈是否可以連線至 Microsoft 以下載 Internet 服務提供者 (ISP) 的清單。此設定的建議狀態為：已啟用。"
    rationale: "在企業管理的環境中，我們希望降低使用者在不知情的情況下暴露敏感資料的風險。"
    impact: 'The "Choose a list of Internet Service Providers" path in the Internet Connection Wizard causes the wizard to exit. This prevents users from retrieving the list of ISPs, which resides on Microsoft servers.'
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設定為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com 注意：此群組原則路徑由所有版本的 Microsoft Windows 系統管理模板中隨附的群組原則模板 ICM.admx/adml 提供。"
    compliance:
      - cis: ["18.9.20.1.4"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard -> ExitOnMSICW'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard -> ExitOnMSICW -> 1'

  # 18.9.20.1.5 (L1) Ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'. (Automated)
  - id: 16207
    title: "確保「關閉 Web 發佈和線上訂購精靈的 Internet 下載」設定為「啟用」。"
    description: "此策略設定控制 Windows 是否下載 Web 發佈和線上訂購精靈的提供者清單。此設定的建議狀態為：已啟用。"
    rationale: "儘管風險很小，但啟用此設定將降低用戶在不知情的情況下透過此功能下載惡意內容的可能性。"
    impact: "Windows is prevented from downloading providers; only the service providers cached in the local registry are displayed."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Internet download for Web publishing and online ordering wizards 注意: 此群組原則路徑由群組原則範本 ICM.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 行政範本中。"
    compliance:
      - cis: ["18.9.20.1.5"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoWebServices'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoWebServices -> 1'

  # 18.9.20.1.6 (L2) Ensure 'Turn off printing over HTTP' is set to 'Enabled'. (Automated)
  - id: 16208
    title: "確保「關閉透過 HTTP 的列印」設定為「啟用」。"
    description: "此原則設定可讓您停用用戶端電腦透過 HTTP 列印的功能，從而允許電腦列印到 Intranet 和 Internet 上的印表機。此設定的建議狀態為：已啟用。注意：此控制會影響透過 HTTP 和 HTTPS 進行的列印。"
    rationale: "透過此功能透過 HTTP 傳輸的資訊不受保護，並且可能被惡意使用者攔截。因此，它不經常在企業託管環境中使用。"
    impact: "The client computer will not be able to print to Internet printers over HTTP or HTTPS. Note: This policy setting affects the client side of Internet printing only. Regardless of how it is configured, a computer could act as an Internet Printing server and make its shared printers available through HTTP."
    remediation: "若要透過 GP 建立建議的配置，將以下 UI 路徑設為已啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off printing over HTTP 注意: 此群組原則路徑由群組原則範本 ICM.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.20.1.6"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["13.3"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableHTTPPrinting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers -> DisableHTTPPrinting -> 1'

  # 18.9.20.1.7 (L2) Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'. (Automated)
  - id: 16209
    title: "確保「如果 URL 連線引用 Microsoft.com，則關閉註冊」設定為「啟用」。"
    description: "此政策設定指定 Windows 註冊精靈是否連接到 Microsoft.com 進行線上註冊。此設定的建議狀態為：已啟用。"
    rationale: "企業管理環境中的使用者不應註冊自己的 Windows 副本，並在此過程中提供自己的 PII。"
    impact: "Users are blocked from connecting to Microsoft.com for online registration and they cannot register their copy of Windows online."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Registration if URL connection is referring to Microsoft.com 注意: 此群組原則路徑由群組原則範本 ICM.admx/adml 提供，該範本包含於所有版本的 Microsoft Windows 行政模板中。"
    compliance:
      - cis: ["18.9.20.1.7"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control -> NoRegistration'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Registration Wizard Control -> NoRegistration -> 1'

  # 18.9.20.1.8 (L2) Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'. (Automated)
  - id: 16210
    title: "確保「關閉搜尋伴侶內容檔案更新」設定為「啟用」。"
    description: "此策略設定指定Search Companion 是否應在本機和 Internet 搜尋期間自動下載內容更新。此設定的建議狀態為：已啟用。"
    rationale: "用戶可能會因為搜尋的主題而在不知不覺中洩露敏感訊息，這種風險很小。這種風險非常低，因為即使啟用此設置，用戶仍然必須向所需的搜尋引擎提交搜尋查詢才能執行搜尋。"
    impact: "Search Companion does not download content updates during searches. Note: Internet searches will still send the search text and information about the search to Microsoft and the chosen search provider. If you select Classic Search, the Search Companion feature will be unavailable. You can select Classic Search by clicking Start, Search, Change Preferences, and then Change Internet Search Behavior."
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設為 Enabled：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Search Companion content file updates 注意：此群組原則路徑由群組原則範本 ICM.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.20.1.8"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion -> DisableContentFileUpdates'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SearchCompanion -> DisableContentFileUpdates -> 1'

  # 18.9.20.1.9 (L2) Ensure 'Turn off the "Order Prints" picture task' is set to 'Enabled'. (Automated)
  - id: 16211
    title: 'Ensure ''Turn off the "Order Prints" picture task'' is set to ''Enabled''.'
    description: '此策略設定指定「線上訂購列印」任務是否可從 Windows 資料夾中的圖片任務中取得。線上訂購印刷品嚮導用於下載提供者清單並允許用戶線上訂購印刷品。此設定的建議狀態為：已啟用。'
    rationale: "在企業管理的環境中，我們希望降低使用者在不知情的情況下暴露敏感資料的風險。"
    impact: 'The task "Order Prints Online" is removed from Picture Tasks in File Explorer folders.'
    remediation: "要通過 GP 設置推薦配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Order Prints\" picture task 注意：此群組策略路徑由 Group Policy 模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 群組策略管理模板中。"
    compliance:
      - cis: ["18.9.20.1.9"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoOnlinePrintsWizard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoOnlinePrintsWizard -> 1'

  # 18.9.20.1.10 (L2) Ensure 'Turn off the "Publish to Web" task for files and folders' is set to 'Enabled'. (Automated)
  - id: 16212
    title: 'Ensure ''Turn off the "Publish to Web" task for files and folders'' is set to ''Enabled''.'
    description: "此政策設定指定「將此檔案發佈到Web」、「將此資料夾發佈到Web」和「將所選項目發佈到Web」任務是否可從Windows 資料夾中的「資料和資料夾任務」中取得。此設定的建議狀態為：已啟用。"
    rationale: "使用者可以向組織控制以外的公共服務發布機密或敏感資訊。"
    impact: 'The "Publish to Web" task is removed from File and Folder tasks in Windows folders.'
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the \"Publish to Web\" task for files and folders 注意：此組策略路徑是由組策略模板ICM.admx/adml提供的，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.20.1.10"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoPublishingWizard'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoPublishingWizard -> 1'

  # 18.9.20.1.11 (L2) Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'. (Automated)
  - id: 16213
    title: "確保「關閉 Windows Messenger 客戶體驗改善計畫」設定為「啟用」。"
    description: "此策略設定指定 Windows Messenger 是否可以收集有關如何使用 Windows Messenger 軟體和服務的匿名資訊。 Microsoft 使用透過客戶體驗改善計畫收集的資訊來偵測軟體缺陷，以便可以更快地修正這些缺陷，啟用此設定將減少 Microsoft 為此目的收集的資料量。此設定的建議狀態為：已啟用。"
    rationale: "大型企業託管環境可能不希望 Microsoft 從託管客戶端電腦收集資訊。"
    impact: "Windows Messenger will not collect usage information, and the user settings to enable the collection of usage information will not be shown."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off the Windows Messenger Customer Experience Improvement Program 注意：此組策略路徑由組策略模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.9.20.1.11"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client -> CEIP'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Messenger\Client -> CEIP -> 2'

  # 18.9.20.1.12 (L2) Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'. (Automated)
  - id: 16214
    title: "確保「關閉 Windows 客戶體驗改善計畫」設定為「啟用」。"
    description: "此策略設定指定 Windows 客戶體驗改善計畫是否可以收集有關 Windows 使用方式的匿名資訊。 Microsoft 使用透過 Windows 客戶體驗改進計劃收集的資訊來改進最常用的功能並偵測缺陷，以便更快地修正它們。啟用此設定將減少 Microsoft 為此目的收集的資料量。此設定的建議狀態為：已啟用。"
    rationale: "大型企業託管環境可能不希望 Microsoft 從託管客戶端電腦收集資訊。"
    impact: "All users are opted out of the Windows Customer Experience Improvement Program."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Customer Experience Improvement Program 注意：此組策略路徑由組策略模板ICM.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.9.20.1.12"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows -> CEIPEnable'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SQMClient\Windows -> CEIPEnable -> 0'

  # 18.9.20.1.13 (L2) Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'. (Automated)
  - id: 16215
    title: "確保「關閉 Windows 錯誤報告」設定為「啟用」。"
    description: "此策略設定控制是否向 Microsoft 報告錯誤。錯誤報告用於報告有關發生故障或停止回應的系統或應用程式的資訊，並用於提高產品品質。此設定的建議狀態為：已啟用。"
    rationale: "如果 Windows 錯誤發生在安全的企業管理環境中，則應將錯誤直接回報給 IT 人員以進行故障排除和修復。直接向 Microsoft 報告這些錯誤對公司沒有任何好處，並且存在在不知情的情況下暴露敏感資料作為錯誤的一部分的風險。"
    impact: "Users are not given the option to report errors to Microsoft."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Internet Communication Management\\Internet Communication settings\\Turn off Windows Error Reporting 注意: 此群組原則路徑由群組原則模板 ICM.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.9.20.1.13"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> Disabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting -> Disabled -> 1'

  # 18.9.23.1 (L2) Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'. (Automated)
  - id: 16216
    title: "確保「支援使用憑證進行裝置驗證」設定為「啟用：自動」。"
    description: "此策略設定可讓您設定對 Kerberos 的支持，以嘗試使用裝置的憑證對網域進行驗證。支援使用憑證進行裝置驗證將需要連接到裝置帳戶網域中支援電腦帳戶憑證驗證的 DC。此設定的建議狀態為：啟用：自動。"
    rationale: "強烈建議使用憑證進行更強大的裝置身份驗證，而不是標準的使用者名稱和密碼身份驗證。將此設定為「自動」將允許盡可能使用基於憑證的身份驗證。"
    impact: "None - this is the default behavior."
    remediation: "要透過 GP 建立推薦的設定，請將以下 UI 路徑設置為「已啟用」：Automatic: Computer Configuration\\Policies\\Administrative Templates\\System\\Kerberos\\Support device authentication using certificate 注意：此群組原則路徑可能預設不存在。它由群組原則模板 Kerberos.admx/adml 提供，該模板包含在 Microsoft Windows 10 RTM （版本 1507）管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.9.23.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitBehavior'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitBehavior -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\kerberos\parameters -> DevicePKInitEnabled -> 1'

  # 18.9.26.1 (L2) Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'. (Automated)
  - id: 16217
    title: "確保「禁止將使用者輸入方法複製到系統帳戶進行登入」設定為「已啟用」。"
    description: "此策略可防止將使用者輸入法自動複製到系統帳戶以在登入畫面上使用。使用者只能使用系統帳戶中啟用的一組輸入法。此設定的建議狀態為：已啟用。"
    rationale: "這是增加系統帳戶安全性的一種方法。"
    impact: "Users will have input methods enabled for the system account on the sign-in page."
    remediation: "若要通過GP建立建議的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Locale Services\\Disallow copying of user input methods to the system account for sign-in 注意：此群組原則路徑可能預設不存在。它由包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中的Globalization.admx/adml群組原則模板提供。"
    compliance:
      - cis: ["18.9.26.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International -> BlockUserInputMethodsForSignIn'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Control Panel\International -> BlockUserInputMethodsForSignIn -> 1'

  # 18.9.27.1 (L1) Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'. (Automated)
  - id: 16218
    title: "確保「阻止使用者在登入時顯示帳戶詳細資料」設定為「已啟用」。"
    description: "此策略可阻止使用者在登入畫面上顯示帳戶詳細資訊（電子郵件地址或使用者名稱）。此設定的建議狀態為：已啟用。"
    rationale: "有權存取控制台的攻擊者（例如，具有實體存取權限的人或能夠透過遠端桌面服務連接到伺服器的人）可以查看最後登入伺服器的使用者的名稱。然後，攻擊者可以嘗試猜測密碼、使用字典或使用暴力攻擊來嘗試登入。"
    impact: "The user cannot choose to show account details on the sign-in screen."
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為“已啟用”: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Block user from showing account details on sign-in 注意：此群組原則路徑可能預設不存在。它由群組原則範本 Logon.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1607 和 Server 2016 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.27.1"]
      - cis_csc_v8: ["4.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "CM.L2-3.4.1", "CM.L2-3.4.2", "CM.L2-3.4.6", "CM.L2-3.4.7"]
      - iso_27001-2013: ["A.14.2.5", "A.8.1.3"]
      - nist_sp_800-53: ["CM-7(1)", "CM-9", "SA-10"]
      - pci_dss_v3.2.1: ["11.5", "2.2"]
      - pci_dss_v4.0: ["1.1.1", "1.2.1", "1.2.6", "1.2.7", "1.5.1", "2.1.1", "2.2.1"]
      - soc_2: ["CC7.1", "CC8.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockUserFromShowingAccountDetailsOnSignin'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockUserFromShowingAccountDetailsOnSignin -> 1'

  # 18.9.27.2 (L1) Ensure 'Do not display network selection UI' is set to 'Enabled'. (Automated)
  - id: 16219
    title: "確保“不顯示網路選擇 UI”設定為“啟用”。"
    description: "此策略設定可讓你控制是否任何人都可以與登入畫面上的可用網頁 UI 互動。此設定的建議狀態為：已啟用。"
    rationale: "未經授權的使用者可以將電腦與網路斷開連接，或者可以在不登入 Windows 的情況下將電腦連接到其他可用網路。"
    impact: "The PC's network connectivity state cannot be changed without signing into Windows."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Do not display network selection UI 注意：此群組原則路徑預設可能不存在。它由包含在 Microsoft Windows 8.1 & Server 2012 R2 管理範本 (或更新版本) 中的群組原則範本 Logon.admx/adml 提供。"
    compliance:
      - cis: ["18.9.27.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontDisplayNetworkSelectionUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontDisplayNetworkSelectionUI -> 1'

  # 18.9.27.3 (L1) Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'. (Automated)
  - id: 16220
    title: "確保「不列舉已加入網域的電腦上的已連線使用者」設定為「已啟用」。"
    description: "此政策設定可防止在加入網域的電腦上列舉已連線的使用者。此設定的建議狀態為：已啟用。"
    rationale: "惡意使用者可以使用此功能來收集其他使用者的帳戶名，然後該資訊可以與其他類型的攻擊結合使用，例如猜測密碼或社交工程。此對策的價值很小，因為具有網域憑證的使用者可以使用其他方法收集相同的帳戶資訊。"
    impact: "The Logon UI will not enumerate any connected users on domain-joined computers."
    remediation: "要透過GP建立建議的組態，將以下UI路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Do not enumerate connected users on domain-joined computers 注意: 此群組原則路徑預設可能不存在。它由群組原則模板Logon.admx/adml提供，該模板包含在Microsoft Windows 8.0和Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.27.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontEnumerateConnectedUsers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DontEnumerateConnectedUsers -> 1'

  # 18.9.27.4 (L1) Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled' (MS only). (Automated)
  - id: 16221
    title: "確保「列舉加入網域的電腦上的本機使用者」設定為「已停用」（僅限 MS）。"
    description: "此策略設定允許在加入網域的電腦上列舉本機使用者。此設定的建議狀態是：停用。"
    rationale: "惡意使用者可以使用此功能來收集其他使用者的帳戶名，然後該資訊可以與其他類型的攻擊結合使用，例如猜測密碼或社交工程。此對策的價值很小，因為具有網域憑證的使用者可以使用其他方法收集相同的帳戶資訊。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為已禁用: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Enumerate local users on domain-joined computers 注意：此組策略路徑可能預設不存在。它由包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理模板（或更新版本）中的組策略模板 Logon.admx/adml 提供。"
    compliance:
      - cis: ["18.9.27.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnumerateLocalUsers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnumerateLocalUsers -> 0'

  # 18.9.27.5 (L1) Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'. (Automated)
  - id: 16222
    title: "確保「關閉鎖定畫面上的應用程式通知」設定為「啟用」。"
    description: "此策略設定可讓您阻止應用程式通知出現在鎖定畫面上。此設定的建議狀態為：已啟用。"
    rationale: "應用程式通知可能會顯示敏感的業務或個人資料。"
    impact: "No app notifications are displayed on the lock screen."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn off app notifications on the lock screen 注意：此群組原則路徑預設情況下可能不存在。它是由群組原則模板 Logon.admx/adml 提供的，該模板包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.27.5"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DisableLockScreenAppNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> DisableLockScreenAppNotifications -> 1'

  # 18.9.27.6 (L1) Ensure 'Turn off picture password sign-in' is set to 'Enabled'. (Automated)
  - id: 16223
    title: "確保「關閉圖片密碼登入」設定為「啟用」。"
    description: "此政策設定可讓您控制網域使用者是否可以使用圖片密碼登入。此設定的建議狀態為：已啟用。注意：如果允許圖片密碼功能，則使用時使用者的網域密碼會快取在系統保管庫中。"
    rationale: "圖片密碼無需輸入複雜密碼。在共享工作環境中，只要有人觀察螢幕上的手勢，進行簡單的肩衝浪，就可以讓該人無需知道複雜的密碼即可存取系統。帶有影像的垂直監視器螢幕在遠處比水平擊鍵更清晰，從而增加了成功觀察滑鼠手勢的可能性。"
    impact: "Users will not be able to set up or sign in with a picture password."
    remediation: "要通過 GP 建立建議的配置，將以下 UI 路徑設置為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn off picture password sign-in 注意：此組策略路徑可能預設不存在。它由組策略模板 CredentialProviders.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.27.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockDomainPicturePassword'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> BlockDomainPicturePassword -> 1'

  # 18.9.27.7 (L1) Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'. (Automated)
  - id: 16224
    title: "確保「開啟便捷 PIN 登入」設定為「停用」。"
    description: "此政策設定可讓您控制網域使用者是否可以使用便利 PIN 登入。在 Windows 10 中，便利 PIN 被具有更強安全性的 Passport 取代。若要為網域使用者設定 Passport，請使用電腦設定\\管理範本\\Windows 元件\\Microsoft Passport for Work 下的原則。注意：使用此功能時，使用者的網域密碼將快取在系統保管庫中。此設定的建議狀態是：停用。"
    rationale: "PIN 碼是由比密碼少得多的字元創建的，因此在大多數情況下，PIN 碼的穩健性遠不如密碼。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\System\\Logon\\Turn on convenience PIN sign-in 註：此群組原則路徑可能預設不存在。它由群組原則模板CredentialProviders.admx/adml提供，該模板包含在Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）中。 註#2：在較舊的Microsoft Windows管理模板中，此設定最初命名為Turn on PIN sign-in，但從Windows 10 Release 1511管理模板開始重新命名。"
    compliance:
      - cis: ["18.9.27.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowDomainPINLogon'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> AllowDomainPINLogon -> 0'

  # 18.9.32.6.1 (L2) Ensure 'Allow network connectivity during connected-standby (on battery)' is set to 'Disabled'. (Automated)
  - id: 16225
    title: "確保「在連接待機期間允許網路連線（使用電池）」設定為「停用」。"
    description: "此策略設定可讓您控制現代具有待機功能的系統上待機時的網路連線狀態。此設定的建議狀態是：停用。"
    rationale: "停用此設定可確保電腦在無人看管、使用電池且處於睡眠狀態時無法透過 WLAN 網路存取。"
    impact: "Network connectivity in standby (while on battery) is not guaranteed. This connectivity restriction currently only applies to WLAN networks only, but is subject to change (according to Microsoft)."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Allow network connectivity during connected-standby (on battery) 注意: 此群組策略路徑可能預設不存在。它由群組策略範本Power.admx/adml提供，該範本包含在Microsoft Windows 10 Release 1607及Server 2016管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.32.6.1"]
      - cis_csc_v7: ["9.2"]
      - iso_27001-2013: ["A.13.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex -> 0'

  # 18.9.32.6.2 (L2) Ensure 'Allow network connectivity during connected-standby (plugged in)' is set to 'Disabled'. (Automated)
  - id: 16226
    title: "確保「在連接待機（插入）期間允許網路連線」設定為「停用」。"
    description: "此策略設定可讓您控制現代具有待機功能的系統上待機時的網路連線狀態。此設定的建議狀態是：停用。"
    rationale: "停用此設定可確保攻擊者在無人看管、接通電源並處於睡眠狀態時無法透過 WLAN 網路存取電腦。"
    impact: "Network connectivity in standby (while plugged in) is not guaranteed. This connectivity restriction currently only applies to WLAN networks only, but is subject to change (according to Microsoft)."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為禁用：Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Allow network connectivity during connected-standby (plugged in) 注：此組策略路徑可能預設不存在。它由包含在Microsoft Windows 10 Release 1607 & Server 2016管理模板（或更新版本）中的組策略模板Power.admx/adml提供。"
    compliance:
      - cis: ["18.9.32.6.2"]
      - cis_csc_v7: ["9.2"]
      - iso_27001-2013: ["A.13.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex -> 0'

  # 18.9.32.6.3 (L1) Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'. (Automated)
  - id: 16227
    title: "確保「電腦喚醒時需要密碼（使用電池）」設定為「啟用」。"
    description: "指定當系統從睡眠狀態恢復時是否提示使用者輸入密碼。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可確保將無人值守的電腦從睡眠狀態喚醒的任何人都必須提供登入憑證才能存取系統。"
    impact: "None - this is the default behavior."
    remediation: "若要透過GP建立推薦的配置，將以下UI路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Require a password when a computer wakes (on battery) 注意：此群組原則路徑預設情況下可能不存在。它由群組原則模板Power.admx/adml提供，該模板隨附於Microsoft Windows 8.0 & Server 2012（非R2）管理模板（或更新版本）。"
    compliance:
      - cis: ["18.9.32.6.3"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> 1'

  # 18.9.32.6.4 (L1) Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'. (Automated)
  - id: 16228
    title: "確保“電腦喚醒（插入電源）時需要密碼”設定為“啟用”。"
    description: "指定當系統從睡眠狀態恢復時是否提示使用者輸入密碼。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可確保將無人值守的電腦從睡眠狀態喚醒的任何人都必須提供登入憑證才能存取系統。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為「已啟用」: Computer Configuration\\Policies\\Administrative Templates\\System\\Power Management\\Sleep Settings\\Require a password when a computer wakes (plugged in) 注意: 此群組政策路徑預設情況下可能不存在。 它由群組政策模板 Power.admx/adml 提供，該模板包含在 Microsoft Windows 8.0 & Server 2012 (非R2) 管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.9.32.6.4"]
      - cis_csc_v8: ["4.3"]
      - cis_csc_v7: ["16.11"]
      - cmmc_v2.0: ["AC.L2-3.1.10", "AC.L2-3.1.11"]
      - hipaa: ["164.312(a)(2)(iii)"]
      - iso_27001-2013: ["A.8.1.3"]
      - nist_sp_800-53: ["AC-11", "AC-11(1)", "AC-12", "AC-2(5)"]
      - pci_dss_v3.2.1: ["8.1.8"]
      - pci_dss_v4.0: ["8.2.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> 1'

  # 18.9.34.1 (L1) Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'. (Automated)
  - id: 16229
    title: "確保「配置提供遠端協助」設定為「停用」。"
    description: "此策略設定可讓您開啟或關閉此電腦上的提供（未經請求的）遠端協助。服務台和支援人員將無法主動提供協助，但他們仍可回應使用者的協助要求。此設定的建議狀態是：停用。"
    rationale: "用戶可能會被欺騙並接受惡意用戶主動提供的遠端協助。"
    impact: "None - this is the default behavior."
    remediation: "若要透過 GP 確立建議配置，將以下 UI 路徑設為禁用: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Assistance\\Configure Offer Remote Assistance 注意: 此群組原則路徑預設可能不存在。它由群組原則模板 RemoteAssistance.admx/adml 提供，此模板包含在 Microsoft Windows 8.0 和 Server 2012 (非 R2) 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.34.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowUnsolicited'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowUnsolicited -> 0'

  # 18.9.34.2 (L1) Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'. (Automated)
  - id: 16230
    title: "確保「配置請求的遠端協助」設定為「停用」。"
    description: "此策略設定可讓您開啟或關閉此電腦上的請求（請求）遠端協助。此設定的建議狀態是：停用。"
    rationale: "流氓管理員可能會獲得對其他使用者桌面會話的存取權限，但他們無法在未經使用者許可的情況下連接到使用者的電腦或控制該電腦。當專家嘗試連線時，使用者仍然可以選擇拒絕連線或授予專家僅查看權限。使用者必須明確點擊「是」按鈕才能允許專家遠端控制工作站。"
    impact: "Users on this computer cannot use e-mail or file transfer to ask someone for help. Also, users cannot use instant messaging programs to allow connections to this computer."
    remediation: "若要通過 GP 建立推薦的配置，請將以下路徑設置為停用: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Assistance\\Configure Solicited Remote Assistance 注意: 此群組策略路徑可能預設不存在，它由包含在 Microsoft Windows 8.0 和 Server 2012 (非 R2) 管理模板 (或更新版本) 中的群組策略模板 RemoteAssistance.admx/adml 提供。"
    compliance:
      - cis: ["18.9.34.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowToGetHelp'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fAllowToGetHelp -> 0'

  # 18.9.35.1 (L1) Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled' (MS only). (Automated)
  - id: 16231
    title: "確保「啟用 RPC 端點映射器用戶端身份驗證」設定為「已啟用」（僅限 MS）。"
    description: "此策略設定控制 RPC 用戶端在進行的呼叫包含身份驗證資訊時是否使用端點映射器服務進行身份驗證。執行 Windows NT4（所有 Service Pack）的電腦上的端點映射器服務無法處理以此方式提供的驗證資訊。如果將此原則設定套用至信任網域 DC，則可能會導致單向林信任出現特定問題（請參閱 Microsoft KB3073942），因此我們不建議將其套用至網域控制站。注意：此策略只有在系統重新啟動後才會生效。此設定的建議狀態為：已啟用。"
    rationale: "對 RPC 服務的匿名存取可能會導致資訊意外洩露給未經身份驗證的使用者。"
    impact: "RPC clients will authenticate to the Endpoint Mapper Service for calls that contain authentication information. Clients making such calls will not be able to communicate with the Windows NT4 Server Endpoint Mapper Service."
    remediation: "若要透過 GP 建立推薦的設定，請將以下 UI 路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Enable RPC Endpoint Mapper Client Authentication 注意: 此群組原則路徑可能預設不存在。它由 Microsoft Windows 8.0 & Server 2012 (非 R2) 管理範本（或更新版本）中包含的群組原則範本 RPC.admx/adml 提供。"
    compliance:
      - cis: ["18.9.35.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> EnableAuthEpResolution'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> EnableAuthEpResolution -> 1'

  # 18.9.35.2 (L2) Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated' (MS only). (Automated)
  - id: 16232
    title: "確保「限制未經驗證的 RPC 用戶端」設定為「啟用：已驗證」（僅限 MS）。"
    description: '此策略設定控制 RPC 伺服器在運作時如何處理連接到 RPC 伺服器的未經驗證的 RPC 用戶端。此策略設定影響所有 RPC 應用程式。在域環境中，應謹慎使用此策略設置，因為它會影響廣泛的功能，包括群組策略處理本身。恢復對此策略設定的變更可能需要在每台受影響的電腦上進行手動幹預。此策略設定永遠不應應用於網域控制器。如果用戶端使用命名管道與伺服器通訊或使用 RPC 安全性，則用戶端將被視為經過驗證的用戶端。特別請求由未經身份驗證的用戶端存取的 RPC 介面可能不受此限制，具體取決於此策略設定的選定值。 --「無」允許所有 RPC 用戶端連接到應用程式原則設定的電腦上執行的 RPC 伺服器。 --「經過驗證」僅允許經過驗證的 RPC 用戶端（根據上面的定義）連線到在應用程式原則設定的電腦上執行的 RPC 伺服器。向提出請求的介面授予豁免。 --「無例外地經過驗證」僅允許經過驗證的 RPC 用戶端（根據上面的定義）連線到在應用程式原則設定的電腦上執行的 RPC 伺服器。不允許有任何例外。該值有可能導致嚴重問題，因此不建議使用。注意：系統重新啟動後才會套用此策略設定。此設定的建議狀態為： 已啟用：已通過身份驗證。'
    rationale: "未經身份驗證的 RPC 通訊可能會造成安全漏洞。"
    impact: "Only authenticated RPC Clients will be allowed to connect to RPC servers running on the machine on which the policy setting is applied. Exemptions are granted to interfaces that have requested them."
    remediation: "為了透過 GP 建立建議設定，將以下 UI 路徑設為啟用：Authenticated: Computer Configuration\\Policies\\Administrative Templates\\System\\Remote Procedure Call\\Restrict Unauthenticated RPC clients 注意：此群組原則路徑可能預設不存在。它由群組原則範本 RPC.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 和 Server 2012 (非 R2) 的管理範本 (或更新版本) 中。"
    compliance:
      - cis: ["18.9.35.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> RestrictRemoteClients'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Rpc -> RestrictRemoteClients -> 1'

  # 18.9.38.1 (L1) Ensure 'Configure validation of ROCA-vulnerable WHfB keys during authentication' is set to 'Enabled: Audit' or higher (DC only). (Automated)
  - id: 16233
    title: "確保「在驗證期間配置 ROCA 易受攻擊的 WHfB 金鑰的驗證」設定為「啟用：審核」或更高（僅限 DC）。"
    description: 'This policy setting allows you to configure how Domain Controllers handle Windows Hello for Business (WHfB) keys that are vulnerable to the "Return of Coppersmith''s attack" (ROCA) vulnerability. If this policy setting is enabled the following options are supported: Ignore: During authentication the Domain Controller will not probe any WHfB keys for the ROCA vulnerability. Audit: During authentication the Domain Controller will emit audit events for WHfB keys that are subject to the ROCA vulnerability (authentications will still succeed). Block: During authentication the Domain Controller will block the use of WHfB keys that are subject to the ROCA vulnerability (vulnerable authentications will fail). The recommended state for this setting is: Enabled: Audit. Configuring this setting to Enabled: Block also conforms to the benchmark. Note: This setting only takes effect on Domain Controllers. Note #2: A reboot is not required for changes to this setting to take effect.'
    rationale: 'The "Return of Coppersmith''s attack" or ROCA vulnerability is a cryptographic weakness in a widely used cryptographic library. An attacker can reveal secret keys (offline with no physical access to the affected device) on certified devices using this library. For more information on this vulnerability, visit ADV170012 - Security Update Guide - Microsoft - Vulnerability in TPM could allow Security Feature Bypass.'
    impact: "This setting may affect vulnerable Trusted Platform Module (TPMs). To avoid issues, this setting should not be set to Block until appropriate mitigations have been performed, for example patching of vulnerable TPMs."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為啟用: Audit (將其配置為 Enabled: Block 也符合基準): Computer Configuration\\Policies\\Administrative Templates\\System\\Security Account Manager\\Configure validation of ROCA-vulnerable WHfB keys during authentication 注意: 預設情況下，這個群組政策路徑可能不存在。它由群組政策模板 Sam.admx/adml 提供，該模板包含在 Microsoft Windows 11 Release 21H2 管理模板（或更新版本）中。"
    references:
      - "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361"
      - "https://nvd.nist.gov/vuln/detail/CVE-2017-15361"
    compliance:
      - cis: ["18.9.38.1"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\SAM'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\SAM -> SamNGCKeyROCAValidation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\SAM -> SamNGCKeyROCAValidation -> n:(\d+) compare >= 1'

  # 18.9.46.5.1 (L2) Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'. (Automated)
  - id: 16234
    title: "確保「Microsoft 支援診斷工具：開啟與支援提供者的 MSDT 互動通訊」設定為「停用」。"
    description: "此策略設定配置 Microsoft 支援診斷工具 (MSDT) 與支援提供者的互動式通訊。 MSDT 收集診斷資料以供支援專業人員進行分析。此設定的建議狀態是：停用。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    impact: "MSDT cannot run in support mode, and no data can be collected or sent to the support provider."
    remediation: "若要透過GP建立建議配置，請將以下UI路徑設定為禁用：Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Microsoft Support Diagnostic Tool\\Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider 注意：此群組原則路徑預設可能不存在。它由MSDT.admx/adml的群組原則模板提供，該模板包含在Microsoft Windows 8.0及Server 2012（非R2）管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.9.46.5.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy -> DisableQueryRemoteServer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy -> DisableQueryRemoteServer -> 0'

  # 18.9.46.11.1 (L2) Ensure 'Enable/Disable PerfTrack' is set to 'Disabled'. (Automated)
  - id: 16235
    title: "確保“啟用/停用 PerfTrack”設定為“停用”。"
    description: "此策略設定指定是啟用還是停用回應事件追蹤。此設定的建議狀態是：停用。"
    rationale: "啟用後，給定事件的聚合資料將傳輸給 Microsoft。此選項可以限制特定使用者的此功能、設定同意等級以及指定可以傳送錯誤報告的特定程式。但是，強烈建議集中限制執行 PerfTrack 的能力，以限制未經授權或不必要的使用、資料外洩或無意通訊的可能性。"
    impact: "Responsiveness events are not processed."
    remediation: "若要通過 GP 設定推薦配置，請將以下 UI 路徑設置為「已禁用」：Computer Configuration\\Policies\\Administrative Templates\\System\\Troubleshooting and Diagnostics\\Windows Performance PerfTrack\\Enable/Disable PerfTrack 注意：此組策略路徑可能預設不存在。它由組策略模板 PerformancePerftrack.admx/adml 提供，該模板隨附於 Microsoft Windows 7 & Server 2008 R2 管理模板（或更新版本）。"
    compliance:
      - cis: ["18.9.46.11.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> 0'

  # 18.9.48.1 (L2) Ensure 'Turn off the advertising ID' is set to 'Enabled'. (Automated)
  - id: 16236
    title: "確保“關閉廣告 ID”設定為“啟用”。"
    description: "此策略設定會關閉廣告 ID，防止應用程式使用該 ID 來實現跨應用程式的體驗。此設定的建議狀態為：已啟用。"
    rationale: "出於廣告目的追蹤用戶活動，即使是匿名的，也可能涉及隱私問題。在企業管理的環境中，應用程式不應需要或要求追蹤目標廣告。"
    impact: "The advertising ID is turned off. Apps can't use the ID for experiences across apps."
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設定為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\System\\User Profiles\\Turn off the advertising ID 注意：該群組原則路徑可能預設不存在。它由群組原則範本 UserProfiles.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.9.48.1"]
      - cis_csc_v7: ["9.2"]
      - iso_27001-2013: ["A.13.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo -> DisabledByGroupPolicy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo -> DisabledByGroupPolicy -> 1'

  # 18.9.50.1.1 (L2) Ensure 'Enable Windows NTP Client' is set to 'Enabled'. (Automated)
  - id: 16237
    title: "確保「啟用 Windows NTP 用戶端」設定為「已啟用」。"
    description: "此原則設定指定是否啟用 Windows NTP 用戶端。啟用 Windows NTP 用戶端可讓您的電腦將其電腦時鐘與其他 NTP 伺服器同步。如果您決定使用第三方時間提供者，您可能需要停用此服務。此設定的建議狀態為：已啟用。"
    rationale: "可靠且準確的時間記錄對於許多服務和安全要求非常重要，包括但不限於分散式應用程式、身份驗證服務、多用戶資料庫和日誌記錄服務。使用 NTP 用戶端（具有安全操作）可確保功能準確性，並且是審查安全相關事件時的焦點。"
    impact: "You can set the local computer clock to synchronize time with NTP servers."
    remediation: "要透過 GP 建立建議的設定，將以下 UI 路徑設為啟用: Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Client 注意: 此群組原則路徑由群組原則範本 W32Time.admx/adml 提供，此範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.50.1.1"]
      - cis_csc_v8: ["8.4"]
      - cis_csc_v7: ["6.1"]
      - cmmc_v2.0: ["AU.L2-3.3.7"]
      - iso_27001-2013: ["A.12.4.4"]
      - nist_sp_800-53: ["AU-7"]
      - pci_dss_v3.2.1: ["10.4"]
      - pci_dss_v4.0: ["10.6", "10.6.1", "10.6.2", "10.6.3"]
      - soc_2: ["CC4.1", "CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient -> Enabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpClient -> Enabled -> 1'

  # 18.9.50.1.2 (L2) Ensure 'Enable Windows NTP Server' is set to 'Disabled' (MS only). (Automated)
  - id: 16238
    title: "確保「啟用 Windows NTP 伺服器」設定為「停用」（僅限 MS）。"
    description: "此原則設定可讓您指定是否啟用 Windows NTP 伺服器。此設定的建議狀態是：停用。注意：在大多數企業管理環境中，不應停用網域控制站上的 Windows NTP 伺服器，因為它對於 NT5DS（基於網域層次結構）時間同步的操作非常重要。"
    rationale: "由於 Kerberos 驗證時間戳記的敏感度以及確保準確的安全性日誌記錄，正確的時間同步配置在企業託管環境中至關重要。"
    impact: "None - this is the default behavior."
    remediation: "若要通過群組原則建立建議的設定，請將以下用戶介面路徑設置為停用：Computer Configuration\\Policies\\Administrative Templates\\System\\Windows Time Service\\Time Providers\\Enable Windows NTP Server 注：此群組原則路徑由群組原則範本 W32Time.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.9.50.1.2"]
      - cis_csc_v8: ["8.4"]
      - cis_csc_v7: ["6.1"]
      - cmmc_v2.0: ["AU.L2-3.3.7"]
      - iso_27001-2013: ["A.12.4.4"]
      - nist_sp_800-53: ["AU-7"]
      - pci_dss_v3.2.1: ["10.4"]
      - pci_dss_v4.0: ["10.6", "10.6.1", "10.6.2", "10.6.3"]
      - soc_2: ["CC4.1", "CC5.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer -> Enabled'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer -> Enabled -> 0'

  # 18.10.3.1 (L2) Ensure 'Allow a Windows app to share application data between users' is set to 'Disabled'. (Automated)
  - id: 16239
    title: "確保「允許 Windows 應用程式在使用者之間共用應用程式資料」設定為「停用」。"
    description: "管理 Windows 應用程式在已安裝應用程式的使用者之間共用資料的能力。資料透過 SharedLocal 資料夾共享。此資料夾可透過 Windows.Storage API 存取。此設定的建議狀態是：停用。"
    rationale: "系統的使用者可能會意外地與同一系統上的其他使用者共享敏感資料。"
    impact: "None - this is the default behavior."
    remediation: "若要透過 GP 建立推薦的配置，將以下 UI 路徑設為「已停用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App Package Deployment\\Allow a Windows app to share application data between users 注意：此群組原則路徑預設可能不存在。它由群組原則範本 AppxPackageManager.admx/adml 提供，該範本包含在 Microsoft Windows 10 RTM (版本 1507) 管理範本中 (或更新版本)。"
    compliance:
      - cis: ["18.10.3.1"]
      - cis_csc_v8: ["3.3"]
      - cis_csc_v7: ["14.6"]
      - cmmc_v2.0: ["AC.L1-3.1.1", "AC.L1-3.1.2", "AC.L2-3.1.3", "AC.L2-3.1.5", "MP.L2-3.8.2"]
      - hipaa: ["164.308(a)(3)(i)", "164.308(a)(3)(ii)(A)", "164.312(a)(1)"]
      - iso_27001-2013: ["A.9.1.1"]
      - nist_sp_800-53: ["AC-5", "AC-6"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
      - pci_dss_v4.0: ["1.3.1", "7.1"]
      - soc_2: ["CC5.2", "CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager -> AllowSharedLocalAppData'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\AppModel\StateManager -> AllowSharedLocalAppData -> 0'

  # 18.10.5.1 (L1) Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'. (Automated)
  - id: 16240
    title: "確保「允許 Microsoft 帳戶可選」設定為「已啟用」。"
    description: "透過此策略設置，您可以控制 Microsoft 帳戶對於需要帳戶登入的 Windows 應用程式商店應用程式是否是可選的。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可讓組織在存取 Windows 應用程式商店應用程式時使用其企業使用者帳戶，而不是使用其 Microsoft 帳戶。這使組織可以更好地控制相關憑證。 Microsoft 帳戶無法集中管理，因此無法對其應用程式企業憑證安全性策略，這可能會使使用 Microsoft 帳戶存取的任何資訊面臨風險。"
    impact: "Windows Store apps that typically require a Microsoft account to sign in will allow users to sign in with an enterprise account instead."
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\App runtime\\Allow Microsoft accounts to be optional 注意：此群組原則路徑可能預設不存在。它由群組原則範本 AppXRuntime.admx/adml 提供，該範本隨 Microsoft Windows 8.1 和 Server 2012 R2 管理範本（或更新版本）一起提供。"
    compliance:
      - cis: ["18.10.5.1"]
      - cis_csc_v8: ["5.6"]
      - cis_csc_v7: ["16.2"]
      - nist_sp_800-53: ["AC-2(1)"]
      - soc_2: ["CC6.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> MSAOptional'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> MSAOptional -> 1'

  # 18.10.7.1 (L1) Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'. (Automated)
  - id: 16241
    title: "確保“禁止非磁碟區設備自動播放”設定為“啟用”。"
    description: "此政策設定不允許 MTP 裝置（例如相機或手機）自動播放。此設定的建議狀態為：已啟用。"
    rationale: "攻擊者可以利用此功能啟動程式來損壞客戶端電腦或電腦上的資料。"
    impact: "AutoPlay will not be allowed for MTP devices like cameras or phones."
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設定為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Disallow Autoplay for non-volume devices 注意：此群組原則路徑預設可能不存在。它由包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理模板（或更新版本）中的群組原則模板 AutoPlay.admx/adml 提供。"
    compliance:
      - cis: ["18.10.7.1"]
      - cis_csc_v8: ["10.3"]
      - cis_csc_v7: ["8.5"]
      - cmmc_v2.0: ["MP.L2-3.8.7"]
      - hipaa: ["164.310(d)(1)"]
      - iso_27001-2013: ["A.12.2.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoAutoplayfornonVolume'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoAutoplayfornonVolume -> 1'

  # 18.10.7.2 (L1) Ensure 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands'. (Automated)
  - id: 16242
    title: "確保「設定自動運行的預設行為」設定為「啟用：不執行任何自動運行指令」。"
    description: "此策略設定設定自動運行指令的預設行為。自動運行指令通常儲存在 autorun.inf 檔案中。他們經常啟動安裝程式或其他例程。此設定的建議狀態為： 啟用：不執行任何自動執行指令。"
    rationale: "在 Windows Vista 之前，當插入包含自動執行指令的媒體時，系統將自動執行該程序，無需使用者乾預。這會產生主要的安全性問題，因為程式碼可能會在使用者不知情的情況下執行。從 Windows Vista 開始，預設行為是提示使用者是否要執行自動執行指令。自動執行指令在「自動播放」對話方塊中表示為處理程序。"
    impact: "AutoRun commands will be completely disabled."
    remediation: "若要透過 GP 建立推薦的配置，請將以下 UI 路徑設為啟用：Do not execute any autorun commands: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Set the default behavior for AutoRun 注意：此群組原則路徑預設情況下可能不存在。它由包含在 Microsoft Windows 8.0 & Server 2012（非 R2）管理模板（或更新版本）中的群組原則模板 AutoPlay.admx/adml 提供。"
    compliance:
      - cis: ["18.10.7.2"]
      - cis_csc_v8: ["10.3"]
      - cis_csc_v7: ["8.5"]
      - cmmc_v2.0: ["MP.L2-3.8.7"]
      - hipaa: ["164.310(d)(1)"]
      - iso_27001-2013: ["A.12.2.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoAutorun'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoAutorun -> 1'

  # 18.10.7.3 (L1) Ensure 'Turn off Autoplay' is set to 'Enabled: All drives'. (Automated)
  - id: 16243
    title: "確保「關閉自動播放」設定為「啟用：所有磁碟機」。"
    description: "一旦您將媒體插入驅動器，自動播放就會開始從驅動器讀取內容，這會導致程式或音訊媒體的安裝檔案立即啟動。攻擊者可以利用此功能啟動程式來損壞電腦或電腦上的資料。預設情況下，某些可移動磁碟機類型（例如磁碟機和網路磁碟機）上的自動播放功能處於停用狀態，但 CD-ROM 磁碟機上則不會。注意：您無法使用此策略設定在預設情況下停用自動播放的電腦磁碟機（例如磁碟機和網路磁碟機）上啟用自動播放。此設定的建議狀態為： 啟用：所有磁碟機。"
    rationale: "攻擊者可以利用此功能啟動程式來損壞客戶端電腦或電腦上的資料。"
    impact: "Autoplay will be disabled - users will have to manually launch setup or installation programs that are provided on removable media."
    remediation: "若要透過 GP 建立建議的配置，請將以下使用者介面路徑設置為“已啟用”： All drives: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\AutoPlay Policies\\Turn off Autoplay 注意：此群組原則路徑由群組原則範本 AutoPlay.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.10.7.3"]
      - cis_csc_v8: ["10.3"]
      - cis_csc_v7: ["8.5"]
      - cmmc_v2.0: ["MP.L2-3.8.7"]
      - hipaa: ["164.310(d)(1)"]
      - iso_27001-2013: ["A.12.2.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoDriveTypeAutoRun'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> NoDriveTypeAutoRun -> 255'

  # 18.10.8.1.1 (L1) Ensure 'Configure enhanced anti-spoofing' is set to 'Enabled'. (Automated)
  - id: 16244
    title: "確保「配置增強型反欺騙」設定為「啟用」。"
    description: "此策略設定是否為支援增強型反欺騙的裝置配置增強型反欺騙。此設定的建議狀態為：已啟用。"
    rationale: "企業託管環境現在支援更廣泛的行動設備，提高這些設備的安全性將有助於防止網路上未經授權的存取。"
    impact: "Windows will require all users on the device to use anti-spoofing for facial features, on devices which support it."
    remediation: "要通過GP建立建議配置，將以下UI路徑設置為Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Biometrics\\Facial Features\\Configure enhanced anti-spoofing 注意：此群組原則路徑預設可能不存在。它是由群組原則模板Biometrics.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1511 Administrative Templates（或更新版本）中。注意#2：在Windows 10 Release 1511和Windows 10 Release 1607 & Server 2016 Administrative Templates中，此設置最初名為Use enhanced anti-spoofing when available。在Windows 10 Release 1703 Administrative Templates中，該設置更名為Configure enhanced anti-spoofing。"
    compliance:
      - cis: ["18.10.8.1.1"]
      - cis_csc_v8: ["10.5"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures -> EnhancedAntiSpoofing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures -> EnhancedAntiSpoofing -> 1'

  # 18.10.10.1 (L2) Ensure 'Allow Use of Camera' is set to 'Disabled'. (Automated)
  - id: 16245
    title: "確保“允許使用相機”設定為“停用”。"
    description: "此策略設定控制是否允許在電腦上使用相機設備。此設定的建議狀態是：停用。"
    rationale: "高安全環境中的攝影機可能會帶來嚴重的隱私和資料外洩風險 - 應停用它們以幫助減輕該風險。"
    impact: "Users will not be able to utilize the camera on a system."
    remediation: "要通過 GP 建立建議的配置，將以下使用者介面路徑設定為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Camera\\Allow Use of Camera 注意: 此群組原則路徑預設可能不存在。它是由群組原則範本 Camera.admx/adml 提供，該範本包含在 Microsoft Windows 10 版本 1607 和 Server 2016 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.10.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera -> AllowCamera'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Camera -> AllowCamera -> 0'

  # 18.10.12.1 (L1) Ensure 'Turn off cloud consumer account state content' is set to 'Enabled'. (Automated)
  - id: 16246
    title: "確保「關閉雲端消費者帳戶狀態內容」設定為「已啟用」。"
    description: "此策略設定決定是否在所有 Windows 體驗中允許雲端消費者帳戶狀態內容。此設定的建議狀態為：已啟用。"
    rationale: "在企業管理環境中使用消費者帳戶並不是良好的安全實踐，因為它可能導致資料外洩。"
    impact: "Users will not be able to use Microsoft consumer accounts on the system, and associated Windows experiences will instead present default fallback content."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Cloud Content\\Turn off cloud consumer account state content 注意：此群組原則路徑可能預設情況下不存在。它由群組原則模板 CloudContent.admx/adml 提供，該模板包含在 Microsoft Windows 11 Release 21H2 Administrative Templates（或更高版本）中。"
    compliance:
      - cis: ["18.10.12.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableConsumerAccountStateContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableConsumerAccountStateContent -> 1'

  # 18.10.12.2 (L1) Ensure 'Turn off Microsoft consumer experiences' is set to 'Enabled'. (Automated)
  - id: 16247
    title: "確保「關閉 Microsoft 消費者體驗」設定為「啟用」。"
    description: "此策略設定會關閉可協助消費者充分利用其裝置和 Microsoft 帳戶的體驗。此設定的建議狀態為：已啟用。注意：根據 Microsoft TechNet，此政策設定僅適用於 Windows 10 企業版和 Windows 10 教育版。"
    rationale: "在企業託管環境中靜默安裝應用程式並不是良好的安全實踐 - 特別是當應用程式將資料發送回第三方時。"
    impact: "Users will no longer see personalized recommendations from Microsoft and notifications about their Microsoft account."
    remediation: "要通過GP建立推薦的配置，請設置以下UI路徑為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Cloud Content\\Turn off Microsoft consumer experiences 注意：此組策略路徑可能預設不存在。它由組策略模板CloudContent.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1511管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.12.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableWindowsConsumerFeatures'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent -> DisableWindowsConsumerFeatures -> 1'

  # 18.10.13.1 (L1) Ensure 'Require pin for pairing' is set to 'Enabled: First Time' OR 'Enabled: Always'. (Automated)
  - id: 16248
    title: "確保“需要配對引腳”設定為“啟用：首次”或“啟用：始終”。"
    description: "此策略設定控制與無線顯示設備配對是否需要 PIN。此設定的建議狀態為：啟用：首次或啟用：始終。"
    rationale: "如果未配置或停用此設置，則將無線顯示裝置與系統配對時不需要 PIN，從而增加未經授權使用的風險。"
    impact: "The pairing ceremony for connecting to new wireless display devices will always require a PIN."
    remediation: "要通過GP建立建議的配置，將以下UI路徑設置為Enabled: First Time或Enabled: Always: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Connect\\Require pin for pairing 注意：此群組策略路徑預設可能不存在。它由包含在Microsoft Windows 10 Release 1607和Server 2016管理範本（或更新版本）中的群組策略範本WirelessDisplay.admx/adml提供。新的Choose one of the following actions子選項後來在Windows 10 Release 1809管理範本中新增。在較舊的範本中選擇Enabled相當於在較新範本中選擇Enabled: First Time。"
    compliance:
      - cis: ["18.10.13.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Connect'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Connect -> RequirePinForPairing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Connect -> RequirePinForPairing -> r:^1$|^2$'

  # 18.10.14.1 (L1) Ensure 'Do not display the password reveal button' is set to 'Enabled'. (Automated)
  - id: 16249
    title: "確保“不顯示密碼顯示按鈕”設定為“啟用”。"
    description: "此策略設定允許你配置密碼顯示按鈕在密碼輸入使用者體驗中的顯示。此設定的建議狀態為：已啟用。"
    rationale: "當輸入長而複雜的密碼時，尤其是使用觸控螢幕時，這是一個有用的功能。潛在的風險是其他人可能會在偷偷觀察您的螢幕時看到您的密碼。"
    impact: "The password reveal button will not be displayed after a user types a password in the password entry text box."
    remediation: "若要透過 GP 設定建議的配置，請將以下 UI 路徑設為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Do not display the password reveal button 注意：此群組原則路徑預設可能不存在。它由群組原則範本 CredUI.admx/adml 提供，該範本包含在 Microsoft Windows 8.0 和 Server 2012（非 R2）管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.14.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI -> DisablePasswordReveal'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredUI -> DisablePasswordReveal -> 1'

  # 18.10.14.2 (L1) Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'. (Automated)
  - id: 16250
    title: "確保「列舉提升時的管理員帳號」設定為「停用」。"
    description: "此策略設定控制當使用者嘗試提升正在執行的應用程式時是否顯示管理員帳戶。此設定的建議狀態是：停用。"
    rationale: "用戶可以看到管理員帳戶列表，這使得登入控制台會話的惡意用戶更容易嘗試破解這些帳戶的密碼。"
    impact: "None - this is the default behavior."
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Credential User Interface\\Enumerate administrator accounts on elevation 注意：此組策略路徑是由組策略模板CredUI.admx/adml提供的，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.10.14.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI -> EnumerateAdministrators'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI -> EnumerateAdministrators -> 0'

  # 18.10.15.1 (L1) Ensure 'Allow Diagnostic Data' is set to 'Enabled: Diagnostic data off (not recommended)' or 'Enabled: Send required diagnostic data'. (Automated)
  - id: 16251
    title: "確保「允許診斷資料」設定為「啟用：診斷資料關閉（不建議）」或「啟用：傳送所需的診斷資料」。"
    description: "此策略設定決定向 Microsoft 報告的診斷和使用資料量： - 值為 (0) 診斷資料關閉（不建議）。使用該值，設備不會發送任何診斷資料。僅企業版、教育版和伺服器版支援此值。如果您選擇此設置，您組織中的設備仍然是安全的。 - 值 (1) 發送所需的診斷資料。這是保持 Windows 安全性、最新並按預期運行所需的最少診斷資料。使用此值會停用「設定」應用程式中的可選診斷資料控制項。 - 值 (3)發送可選診斷資料。收集額外的診斷資料可幫助我們檢測、診斷和修復問題，以及改善產品。當您選擇傳送可選診斷資料時，將始終包含所需的診斷資料。可選的診斷資料還可以包括診斷日誌檔案和故障轉儲。使用限制轉儲收集和限制診斷日誌收集策略可以更精細地控制發送的可選診斷資料。 Windows 遙測設定適用於 Windows 作業系統和一些第一方應用程式。此設定不適用於在 Windows 10/11 上執行的第三方應用程式。此設定的建議狀態為： 啟用：診斷資料關閉（不建議）或啟用：傳送所需的診斷資料。注意：如果您的組織依賴 Windows 更新，建議的最低設定是「必需的診斷資料」。由於診斷資料關閉時不會收集 Windows 更新資訊，因此不會發送有關更新失敗的重要資訊。 Microsoft 使用此資訊來修復這些故障的原因並提高更新的品質。注意#2：配置診斷資料選擇加入設定使用者介面群組原則可用於防止最終使用者變更其資料收集設定。注意 #3：增強型診斷資料設定在 Windows 11 和 Windows Server 2022 上不可用，已被替換為可以控制發送的可選診斷資料量的政策。有關這些設定的更多資訊，請存取使用群組策略和 MDM 管理診斷資料。"
    rationale: "將任何資料發送給第三方供應商都是出於安全考慮，並且只能根據需要進行。"
    impact: "Note that setting values of 0 or 1 will degrade certain experiences on the device."
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設定為啟用: Diagnostic data off (not recommended) 或啟用: Send required diagnostic data: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Allow Diagnostic Data 注意：預設情況下，可能沒有此群組原則路徑。它由群組原則範本 DataCollection.admx/adml 提供，該範本包含在 Microsoft Windows 10 RTM（發行版 1507）管理範本（或更新版本）中。 注意 #2：在舊版 Microsoft Windows 管理範本中，此設置最初名為 Allow Telemetry，但從 Windows 11 發行 21H2 管理範本開始，該設置已重命名為 Allow Diagnostic Data。"
    references:
      - "https://docs.microsoft.com/en-us/windows/privacy/configure-windows-diagnostic-data-in-your-organization"
    compliance:
      - cis: ["18.10.15.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: any
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> AllowTelemetry -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> AllowTelemetry -> 1'

  # 18.10.15.2 (L2) Ensure 'Configure Authenticated Proxy usage for the Connected User Experience and Telemetry service' is set to 'Enabled: Disable Authenticated Proxy usage' (Automated)
  - id: 16252
    title: "確保「為連線的使用者體驗和遙測服務配置經過驗證的代理程式使用」設定為「啟用：停用經過驗證的代理程式使用」。"
    description: "此策略設定控制連接使用者體驗和遙測服務是否可以自動使用經過驗證的代理程式將資料傳回 Microsoft。此設定的建議狀態為： 啟用：停用經過驗證的代理程式使用。"
    rationale: "將任何資料發送給第三方供應商都是出於安全考慮，並且只能根據需要進行。"
    impact: "The Connected User Experience and Telemetry service will be blocked from automatically using an authenticated proxy."
    remediation: "要透過 GP 建立推薦的配置，將以下 UI 路徑設置為啟用：Disable Authenticated Proxy usage: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Configure Authenticated Proxy usage for the Connected User Experience and Telemetry service 注意：此群組策略路徑預設可能不存在。它是由群組策略範本 DataCollection.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1703 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.15.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableEnterpriseAuthProxy'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableEnterpriseAuthProxy -> 1'

  # 18.10.15.3 (L1) Ensure 'Disable OneSettings Downloads' is set to 'Enabled'. (Automated)
  - id: 16253
    title: "確保「停用 OneSettings 下載」設定為「啟用」。"
    description: "此策略設定控制 Windows 是否嘗試連接 OneSettings 服務以下載設定設定。此設定的建議狀態為：已啟用。"
    rationale: "將資料傳送給第三方供應商是一個安全問題，只能根據需要進行。"
    impact: "Windows will not connect to the OneSettings service to download configuration settings."
    remediation: "若要透過 GP 設定建議的配置，請將以下使用者介面路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Disable OneSettings Downloads 注意：此群組原則路徑可能預設不存在。它由群組原則範本 DataCollection.admx/adml 提供，該範本包含在 Microsoft Windows 11 Release 21H2 行政模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.15.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableOneSettingsDownloads'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DisableOneSettingsDownloads -> 1'

  # 18.10.15.4 (L1) Ensure 'Do not show feedback notifications' is set to 'Enabled'. (Automated)
  - id: 16254
    title: "確保「不顯示回饋通知」設定為「啟用」。"
    description: "此策略設定允許組織阻止其裝置顯示來自 Microsoft 的回饋問題。此設定的建議狀態為：已啟用。"
    rationale: "使用者不應在企業管理的環境中向第三方供應商發送任何回饋。"
    impact: "Users will no longer see feedback notifications through the Windows Feedback app."
    remediation: "要透過 GP 建立推薦的配置，將以下介面路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Do not show feedback notifications 注意：此群組原則路徑預設可能不存在。它是由群組原則範本 FeedbackNotifications.admx/adml 提供，該範本包含在 Microsoft Windows 10 釋出 1511 行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.15.4"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DoNotShowFeedbackNotifications'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> DoNotShowFeedbackNotifications -> 1'

  # 18.10.15.5 (L1) Ensure 'Enable OneSettings Auditing' is set to 'Enabled'. (Automated)
  - id: 16255
    title: "確保「啟用 OneSettings 審核」設定為「已啟用」。"
    description: "此策略設定控制 Windows 是否將嘗試與 OneSettings 服務連線至事件日誌。此設定的建議狀態為：已啟用。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "Windows will record attempts to connect with the OneSettings service to the Applications and Services Logs\\Microsoft\\Windows\\Privacy-Auditing\\Operational Event Log channel."
    remediation: "若要透過 GP 建立建議的設定，請將以下 UI 路徑設為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Enable OneSettings Auditing 注意：此群組原則路徑預設可能不存在。它由群組原則範本 DataCollection.admx/adml 提供，該範本包含在 Microsoft Windows 11 Release 21H2 行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.15.5"]
      - cis_csc_v8: ["6.3"]
      - cis_csc_v7: ["8.5"]
      - iso_27001-2013: ["A.12.2.1"]
      - pci_dss_v3.2.1: ["8.3"]
      - soc_2: ["CC6.1", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> EnableOneSettingsAuditing'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> EnableOneSettingsAuditing -> 1'

  # 18.10.15.6 (L1) Ensure 'Limit Diagnostic Log Collection' is set to 'Enabled'. (Automated)
  - id: 16256
    title: "確保“限制診斷日誌收集”設定為“啟用”。"
    description: "此策略設定控制當需要更多資訊來解決設備上的問題時是否收集其他診斷日誌。此設定的建議狀態為：已啟用。注意：僅當設備配置為傳送可選診斷資料時，才會傳送診斷日誌。當建議「允許診斷資料」設定為「啟用」時，診斷資料受到限制：診斷資料關閉（不建議）或「啟用」：發送所需的診斷資料以僅發送基本資訊。"
    rationale: "將資料傳送給第三方供應商是一個安全問題，只能根據需要進行。"
    impact: "Diagnostic logs and information such as crash dumps will not be collected for transmission to Microsoft."
    remediation: "要通過 GP 建立推薦配置，將以下 UI 路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Limit Diagnostic Log Collection 注意：此群組原則路徑預設可能不存在。 它由群組原則範本 DataCollection.admx/adml 提供，而該範本包含在 Microsoft Windows 11 版本 21H2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.15.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDiagnosticLogCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDiagnosticLogCollection -> 1'

  # 18.10.15.7 (L1) Ensure 'Limit Dump Collection' is set to 'Enabled'. (Automated)
  - id: 16257
    title: "確保“限制轉儲收集”設定為“啟用”。"
    description: "當需要更多資訊來解決問題時，此策略設定限制可以收集的記憶體轉儲類型。此設定的建議狀態為：已啟用。注意：僅當裝置配置為傳送可選診斷資料時才會傳送記憶體轉儲。當建議「允許診斷資料」設定為「啟用」時，診斷資料受到限制：診斷資料關閉（不建議）或「啟用」：發送所需的診斷資料以僅發送基本資訊。"
    rationale: "記憶體轉儲可能包含敏感資訊 - 將此類資料傳送給第三方供應商是一個安全問題，只能根據需要進行。"
    impact: "Windows Error Reporting will not send full and/or heap memory dumps to Microsoft - they will be limited to kernel mini and/or user mode triage memory dumps (if sending optional diagnostic data is permitted)."
    remediation: "要通過 GP 建立建議配置，將以下 UI 路徑設置為已啟用。Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Limit Dump Collection 注意：此群組策略路徑可能預設不存在。它由群組策略模板 DataCollection.admx/adml 提供，該模板包含在 Microsoft Windows 11 Release 21H2 Administrative Templates（或更新版本）中。"
    compliance:
      - cis: ["18.10.15.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDumpCollection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection -> LimitDumpCollection -> 1'

  # 18.10.15.8 (L1) Ensure 'Toggle user control over Insider builds' is set to 'Disabled'. (Automated)
  - id: 16258
    title: "確保「切換使用者對 Insider 版本的控制」設定為「停用」。"
    description: 'This policy setting determines whether users can access the Insider build controls in the Advanced Options for Windows Update. These controls are located under "Get Insider builds," and enable users to make their devices available for downloading and installing Windows preview software. The recommended state for this setting is: Disabled. Note: This policy setting applies only to devices running Windows Server 2016, up until Release 1703. For Release 1709 or newer, Microsoft encourages using the Manage preview builds setting (recommendation title ''Manage preview builds''). We have kept this setting in the benchmark to ensure that any older builds of Windows Server 2016 in the environment are still enforced.'
    rationale: "在企業管理的環境中允許實驗性功能可能存在風險，因為這可能會為系統帶來錯誤和安全漏洞，使攻擊者更容易獲得存取權限。通常最好只使用生產就緒的版本。"
    impact: 'The item "Get Insider builds" will be unavailable.'
    remediation: "若要通過GP設置建議的配置，請將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Data Collection and Preview Builds\\Toggle user control over Insider builds 注意: 此組策略路徑可能預設不存在。它由隨Microsoft Windows 10 RTM (Release 1507) 管理模板（或更新版本）包含的組策略模板AllowBuildPreview.admx/adml提供。"
    compliance:
      - cis: ["18.10.15.8"]
      - cis_csc_v8: ["2.5"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "CM.L2-3.4.9"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - nist_sp_800-53: ["CM-7(5)"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds -> AllowBuildPreview'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds -> AllowBuildPreview -> 0'

  # 18.10.26.1.1 (L1) Ensure 'Application: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'. (Automated)
  - id: 16259
    title: "確保“應用程式：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立推薦的配置，將以下UI路徑設為已停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Application\\Control Event Log behavior when the log file reaches its maximum size 注意：此群組策略路徑由群組策略範本EventLog.admx/adml提供，該範本包含在所有版本的Microsoft Windows Administrative Templates中。 注意#2：在舊版的Microsoft Windows Administrative Templates中，這個設定最初名為Retain old events，但在Windows 8.0和Server 2012（非R2）行政範本中開始更名。"
    compliance:
      - cis: ["18.10.26.1.1"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> Retention -> 0'

  # 18.10.26.1.2 (L1) Ensure 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'. (Automated)
  - id: 16260
    title: "確保「應用程式：指定最大日誌檔案大小 (KB)」設定為「啟用：32,768 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "When event logs fill to capacity, they will stop recording information unless the retention method for each is set so that the computer will overwrite the oldest entries with the most recent ones. To mitigate the risk of loss of recent data, you can configure the retention method so that older events are overwritten as needed. The consequence of this configuration is that older events will be removed from the logs. Attackers can take advantage of such a configuration, because they can generate a large number of extraneous events to overwrite any evidence of their attack. These risks can be somewhat reduced if you automate the archival and backup of event log data. Ideally, all specifically monitored events should be sent to a server that uses Microsoft System Center Operations Manager (SCOM) or some other automated monitoring tool. Such a configuration is particularly important because an attacker who successfully compromises a server could clear the Security log. If all events are sent to a monitoring server, then you will be able to gather forensic information about the attacker's activities."
    remediation: "要透過 GP 確立建議的配置，將以下 UI 路徑設置為 Enabled: 32,768 or greater: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Application\\Specify the maximum log file size (KB) 注意: 此群組原則路徑由所有版本的 Microsoft Windows Administrative Templates 中包含的群組原則模板 EventLog.admx/adml 提供。注意 #2: 在較舊的 Microsoft Windows Administrative Templates 中，此設置最初命名為 Maximum Log Size (KB)，但從 Windows 8.0 & Server 2012 (non-R2) Administrative Templates 開始已被重新命名。"
    compliance:
      - cis: ["18.10.26.1.2"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application -> MaxSize -> n:^(\d+) compare >= 32768'

  # 18.10.26.2.1 (L1) Ensure 'Security: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'. (Automated)
  - id: 16261
    title: "確保“安全性：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "None - this is the default behavior."
    remediation: "要透過 GP 建立推薦配置，請將以下 UI 路徑設置為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Security\\Control Event Log behavior when the log file reaches its maximum size 注意: 此群組原則路徑由 Group Policy 模板 EventLog.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。注意#2: 在舊版 Microsoft Windows Administrative Templates 中，此設置最初名為 Retain old events，但在 Windows 8.0 和 Server 2012 (非 R2) Administrative Templates 開始被重新命名。"
    compliance:
      - cis: ["18.10.26.2.1"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> Retention -> 0'

  # 18.10.26.2.2 (L1) Ensure 'Security: Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater'. (Automated)
  - id: 16262
    title: "確保「安全性：指定最大日誌檔案大小 (KB)」設定為「啟用：196,608 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：196,608 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "When event logs fill to capacity, they will stop recording information unless the retention method for each is set so that the computer will overwrite the oldest entries with the most recent ones. To mitigate the risk of loss of recent data, you can configure the retention method so that older events are overwritten as needed. The consequence of this configuration is that older events will be removed from the logs. Attackers can take advantage of such a configuration, because they can generate a large number of extraneous events to overwrite any evidence of their attack. These risks can be somewhat reduced if you automate the archival and backup of event log data. Ideally, all specifically monitored events should be sent to a server that uses Microsoft System Center Operations Manager (SCOM) or some other automated monitoring tool. Such a configuration is particularly important because an attacker who successfully compromises a server could clear the Security log. If all events are sent to a monitoring server, then you will be able to gather forensic information about the attacker's activities."
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為已啟用：196,608 或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Security\\Specify the maximum log file size (KB) 注意：此組策略路徑由組策略模板 EventLog.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。注意 #2：在舊版 Microsoft Windows 管理模板中，此設置最初被命名為 Maximum Log Size (KB)，但從 Windows 8.0 和 Server 2012（非 R2）管理模板開始重命名。"
    compliance:
      - cis: ["18.10.26.2.2"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security -> MaxSize -> n:^(\d+) compare >= 196608'

  # 18.10.26.3.1 (L1) Ensure 'Setup: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'. (Automated)
  - id: 16263
    title: "確保“設定：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP建立推薦的配置，請將以下UI路徑設置為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Setup\\Control Event Log behavior when the log file reaches its maximum size 注意：此組策略路徑是由組策略模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。注意#2：在較早的Microsoft Windows管理模板中，此設置最初名為Retain old events，但從Windows 8.0 & Server 2012 (non-R2)管理模板開始更名。"
    compliance:
      - cis: ["18.10.26.3.1"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> Retention -> 0'

  # 18.10.26.3.2 (L1) Ensure 'Setup: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'. (Automated)
  - id: 16264
    title: "確保「設定：指定最大日誌檔案大小 (KB)」設定為「啟用：32,768 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "When event logs fill to capacity, they will stop recording information unless the retention method for each is set so that the computer will overwrite the oldest entries with the most recent ones. To mitigate the risk of loss of recent data, you can configure the retention method so that older events are overwritten as needed. The consequence of this configuration is that older events will be removed from the logs. Attackers can take advantage of such a configuration, because they can generate a large number of extraneous events to overwrite any evidence of their attack. These risks can be somewhat reduced if you automate the archival and backup of event log data. Ideally, all specifically monitored events should be sent to a server that uses Microsoft System Center Operations Manager (SCOM) or some other automated monitoring tool. Such a configuration is particularly important because an attacker who successfully compromises a server could clear the Security log. If all events are sent to a monitoring server, then you will be able to gather forensic information about the attacker's activities."
    remediation: "若要透過 GP 建立建議的配置，請將以下使用者介面路徑設置為已啟用：32,768 或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\Setup\\Specify the maximum log file size (KB) 注意：此群組原則路徑由群組原則範本 EventLog.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。注意 #2：在較舊的 Microsoft Windows 管理範本中，這一設置最初被命名為 Maximum Log Size (KB)，但從 Windows 8.0 和 Server 2012（非 R2）管理範本開始被重新命名。"
    compliance:
      - cis: ["18.10.26.3.2"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup -> MaxSize -> n:^(\d+) compare >= 32768'

  # 18.10.26.4.1 (L1) Ensure 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'. (Automated)
  - id: 16265
    title: "確保“系統：日誌檔案達到最大大小時控制事件日誌行為”設定為“停用”。"
    description: "此策略設定控制日誌檔案達到最大大小時的事件日誌行為。此設定的建議狀態是：停用。注意：當完整策略設定時，舊事件可能會或可能不會根據備份日誌自動保留。"
    rationale: "如果不記錄新事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "None - this is the default behavior."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\System\\Control Event Log behavior when the log file reaches its maximum size 注意：此群組原則路徑由 EventLog.admx/adml 群組原則範本提供，該範本包含在所有版本的 Microsoft Windows Administrative Templates 中。注意 #2：在較舊的 Microsoft Windows Administrative Templates 中，該設定最初名為 Retain old events，但從 Windows 8.0 和 Server 2012 (非 R2) Administrative Templates 開始重新命名。"
    compliance:
      - cis: ["18.10.26.4.1"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> Retention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> Retention -> 0'

  # 18.10.26.4.2 (L1) Ensure 'System: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'. (Automated)
  - id: 16266
    title: "確保「系統：指定最大日誌檔案大小 (KB)」設定為「啟用：32,768 或更大」。"
    description: "此策略設定指定日誌檔案的最大大小（以千位元組為單位）。最大日誌檔案大小可以配置為 1 MB (1,024 KB) 到 4 TB (4,194,240 KB)，以千位元組為增量。此設定的建議狀態為： 啟用：32,768 或更大。"
    rationale: "如果未記錄事件，則可能很難或不可能確定系統問題或惡意使用者未經授權的活動的根本原因。"
    impact: "When event logs fill to capacity, they will stop recording information unless the retention method for each is set so that the computer will overwrite the oldest entries with the most recent ones. To mitigate the risk of loss of recent data, you can configure the retention method so that older events are overwritten as needed. The consequence of this configuration is that older events will be removed from the logs. Attackers can take advantage of such a configuration, because they can generate a large number of extraneous events to overwrite any evidence of their attack. These risks can be somewhat reduced if you automate the archival and backup of event log data. Ideally, all specifically monitored events should be sent to a server that uses Microsoft System Center Operations Manager (SCOM) or some other automated monitoring tool. Such a configuration is particularly important because an attacker who successfully compromises a server could clear the Security log. If all events are sent to a monitoring server, then you will be able to gather forensic information about the attacker's activities."
    remediation: "為了通過GP建立推薦配置，將以下UI路徑設置為啟用：32,768或更大：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Event Log Service\\System\\Specify the maximum log file size (KB) 注意：此組策略路徑由組策略模板EventLog.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。 注意#2：在舊版Microsoft Windows管理模板中，此設置最初命名為Maximum Log Size (KB)，但從Windows 8.0 & Server 2012（非R2）管理模板開始更名。"
    compliance:
      - cis: ["18.10.26.4.2"]
      - cis_csc_v8: ["8.3"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - pci_dss_v3.2.1: ["10.7"]
      - soc_2: ["A1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> MaxSize'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System -> MaxSize -> n:^(\d+) compare >= 32768'

  # 18.10.29.2 (L1) Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'. (Automated)
  - id: 16267
    title: "確保「關閉資源管理器的資料執行保護」設定為「停用」。"
    description: "停用資料執行保護可以允許某些舊插件應用程式在不終止資源管理器的情況下運作。此設定的建議狀態是：停用。注意：某些舊版插件應用程式和其他軟體可能無法與資料執行保護一起運行，並且需要為該特定插件/軟體定義例外。"
    rationale: "資料執行保護是 Explorer 支援的重要安全功能，有助於限制某些類型惡意軟體的影響。"
    impact: "None - this is the default behavior."
    remediation: "要通過GP設定推薦的配置, 將以下UI路徑設置為已禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off Data Execution Prevention for Explorer 注意: 此組策略路徑預設可能不存在。它由組策略模板Explorer.admx/adml提供, 該模板包含在Microsoft Windows 7 & Server 2008 R2管理模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.10.29.2"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoDataExecutionPrevention'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoDataExecutionPrevention -> 0'

  # 18.10.29.3 (L1) Ensure 'Turn off heap termination on corruption' is set to 'Disabled'. (Automated)
  - id: 16268
    title: "確保「關閉損壞時的堆終止」設定為「停用」。"
    description: "如果損壞時沒有堆終止，舊插件應用程式可能會在檔案總管會話損壞時繼續執行。確保腐敗堆終止處於活動狀態可以防止這種情況發生。此設定的建議狀態是：停用。"
    rationale: "允許應用程式在其會話損壞後繼續運行會增加系統的風險狀況。"
    impact: "None - this is the default behavior."
    remediation: "若要透過 GP 建立建議的配置，請將以下 UI 路徑設為已停用： Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off heap termination on corruption 注意：此群組原則路徑由所有版本的 Microsoft Windows 管理模板中包含的群組原則模板 Explorer.admx/adml 提供。"
    compliance:
      - cis: ["18.10.29.3"]
      - cis_csc_v7: ["8.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoHeapTerminationOnCorruption'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer -> NoHeapTerminationOnCorruption -> 0'

  # 18.10.29.4 (L1) Ensure 'Turn off shell protocol protected mode' is set to 'Disabled'. (Automated)
  - id: 16269
    title: "確保“關閉 shell 協定保護模式”設定為“停用”。"
    description: "此策略設定可讓您配置 shell 協定可以具有的功能量。當使用該協定的全部功能時，應用程式可以開啟資料夾並啟動檔案。保護模式減少了該協定的功能，允許應用程式僅開啟一組有限的資料夾。當處於保護模式時，應用程式無法使用此協定開啟檔案。建議將此協定保留在保護模式下，以提高 Windows 的安全性。此設定的建議狀態是：停用。"
    rationale: "將檔案和資料夾的開啟限制在有限的範圍內可以減少系統的攻擊面。"
    impact: "None - this is the default behavior."
    remediation: "要透過 GP 設定推薦的配置，將以下 UI 路徑設置為「已停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\File Explorer\\Turn off shell protocol protected mode 注意：此群組原則路徑由群組原則範本 WindowsExplorer.admx/adml 提供，並包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.10.29.4"]
      - cis_csc_v7: ["8.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> PreXPSP2ShellProtocolBehavior'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer -> PreXPSP2ShellProtocolBehavior -> 0'

  # 18.10.37.1 (L2) Ensure 'Turn off location' is set to 'Enabled'. (Automated)
  - id: 16270
    title: "確保“關閉位置”設定為“啟用”。"
    description: "此策略設定關閉電腦的位置功能。此設定的建議狀態為：已啟用。"
    rationale: "此設定會影響位置功能（例如 GPS 或其他位置追蹤）。從安全角度來看，在大多數情況下向軟體透露您的位置並不是一個好主意，但也有合法用途，例如地圖軟體。但是，它們不應該在高安全性環境中使用。"
    impact: "The location feature is turned off, and all programs on the computer are prevented from using location information from the location feature."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Location and Sensors\\Turn off location 注意：此群組原則路徑可能預設不存在。它由群組原則範本 Sensors.admx/adml 提供，此範本包含於 Microsoft Windows 7 & Server 2008 R2 Administrative Templates（或更新版本）。"
    compliance:
      - cis: ["18.10.37.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableLocation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors -> DisableLocation -> 1'

  # 18.10.41.1 (L2) Ensure 'Allow Message Service Cloud Sync' is set to 'Disabled'. (Automated)
  - id: 16271
    title: "確保「允許訊息服務雲端同步」設定為「停用」。"
    description: "此策略設定允許將蜂窩短信備份和還原到 Microsoft 的雲端服務。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，資料不應發送給任何第三方，因為該資料可能包含敏感資訊。"
    impact: "Cellular text messages will not be backed up to (or restored from) Microsoft's cloud services."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設定為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Messaging\\Allow Message Service Cloud Sync 注意：此群組原則路徑預設可能不存在。它是由 Microsoft Windows 10 版本 1709 管理模板（或更新版本）隨附的群組原則模板 Messaging.admx/adml 提供的。"
    compliance:
      - cis: ["18.10.41.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging -> AllowMessageSync'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Messaging -> AllowMessageSync -> 0'

  # 18.10.42.1 (L1) Ensure 'Block all consumer Microsoft account user authentication' is set to 'Enabled'. (Automated)
  - id: 16272
    title: "確保「封鎖所有消費者 Microsoft 帳戶使用者驗證」設定為「已啟用」。"
    description: "此設定會決定裝置上的應用程式和服務是否可以透過 Windows OnlineID 和 WebAccountManager API 使用新的消費者 Microsoft 帳戶驗證。此設定的建議狀態為：已啟用。"
    rationale: "想要有效實施身分識別管理策略並對其電腦上使用的帳戶保持嚴格控制的組織可能會希望阻止 Microsoft 帳戶。組織可能還需要封鎖 Microsoft 帳戶，以滿足適用於其資訊系統的合規性標準的要求。"
    impact: "All applications and services on the device will be prevented from new authentications using consumer Microsoft accounts via the Windows OnlineID and WebAccountManager APIs. Authentications performed directly by the user in web browsers or in apps that use OAuth will remain unaffected."
    remediation: "要透過GP設置建議的配置，請將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft accounts\\Block all consumer Microsoft account user authentication 注意：此群組原則路徑預設可能不存在。它是由包含在Microsoft Windows 10 Release 1703管理模板（或更新版本）中的群組原則模板MSAPolicy.admx/adml提供的。"
    compliance:
      - cis: ["18.10.42.1"]
      - cis_csc_v8: ["5.3"]
      - cis_csc_v7: ["16.8"]
      - cmmc_v2.0: ["IA.L2-3.5.6"]
      - iso_27001-2013: ["A.9.2.1"]
      - nist_sp_800-53: ["AC-2(3)"]
      - pci_dss_v3.2.1: ["8.1.4"]
      - pci_dss_v4.0: ["8.3.7"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftAccount'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftAccount -> DisableUserAuth'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MicrosoftAccount -> DisableUserAuth -> 1'

  # 18.10.43.5.1 (L1) Ensure 'Configure local setting override for reporting to Microsoft MAPS' is set to 'Disabled'. (Automated)
  - id: 16273
    title: "確保「配置本機設定覆蓋以向 Microsoft MAPS 報告」設定為「停用」。"
    description: '此原則設定為加入 Microsoft Active Protection Service (MAPS) 的配置配置本機覆蓋，Microsoft 現在已將其重新命名為「Microsft Defender Antivirus Cloud Protection Service」。此設定只能透過群組原則進行設定。此設定的建議狀態是：停用。'
    rationale: "應在企業託管環境中集中決定是否參與 Microsoft MAPS / Microsoft Defender 防毒雲保護服務以進行惡意軟體報告，以便其中的所有電腦在這方面表現一致。將此設定配置為「停用」可確保決策保持集中管理。"
    impact: "None - this is the default behavior."
    remediation: "若要透過 GP 建立建議設定，請將以下 UI 路徑設定為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\MAPS\\Configure local setting override for reporting to Microsoft MAPS 注意: 此群組原則路徑預設可能不存在。它由 WindowsDefender.admx/adml 群組原則範本提供，此範本包含在 Microsoft Windows 8.1 和 Server 2012 R2 行政範本（或更新）中。"
    compliance:
      - cis: ["18.10.43.5.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> LocalSettingOverrideSpynetReporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> LocalSettingOverrideSpynetReporting -> 0'

  # 18.10.43.5.2 (L2) Ensure 'Join Microsoft MAPS' is set to 'Disabled'. (Automated)
  - id: 16274
    title: "確保“加入 Microsoft MAPS”設定為“停用”。"
    description: "此政策設定可讓你加入 Microsoft Active Protection Service (MAPS)，Microsoft 現在已將其重新命名為 Windows Defender 防毒雲端保護服務，然後再命名為 Microsoft Defender 防毒雲端保護服務。 Microsoft MAPS / Microsoft Defender 防毒雲端保護服務是一個線上社群，可協助您選擇如何應對潛在威脅。該社群還幫助阻止新的惡意軟體感染的傳播。您可以選擇發送有關檢測到的軟體的基本或附加資訊。其他資訊可協助 Microsoft 建立新定義並協助其保護您的電腦。可能的選項有： - - - (0x0) 停用（預設） (0x1) 基本會員資格(0x2) 高級會員資格基本會員資格將向Microsoft 發送有關已檢測到的軟體的基本訊息，包括該軟體來自您應用或執行的操作的位置。除了基本資訊之外，高級會員資格還會向 Microsoft 發送有關惡意軟體、間諜軟體和潛在有害軟體的更多資訊，包括軟體檔案的位置、軟體的運作方式以及它如何影響您的電腦。此設定的建議狀態是：停用。"
    rationale: "如果刪除了有害軟體，將傳送的訊息可能包括電腦上偵測到的項目的位置等資訊。資訊將自動收集和發送。在某些情況下，個人資訊可能會無意中傳送給 Microsoft。但是，Microsoft 聲明不會使用此資訊來識別您的身分或與您聯絡。出於高安全環境中的隱私原因，最好完全阻止這些資料提交。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\MAPS\\Join Microsoft MAPS 注意：此群組策略路徑預設可能不存在。它由群組策略模板 WindowsDefender.admx/adml 提供，包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.43.5.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> SpynetReporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet -> SpynetReporting -> 0'

  # 18.10.43.6.1.1 (L1) Ensure 'Configure Attack Surface Reduction rules' is set to 'Enabled'. (Automated)
  - id: 16275
    title: "確保“配置攻擊面減少規則”設定為“啟用”。"
    description: "此策略設定控制攻擊面減少 (ASR) 規則的狀態。此設定的建議狀態為：已啟用。"
    rationale: "減少攻擊面有助於防止尋求漏洞的惡意軟體通常使用的操作和應用程式來感染電腦。"
    impact: "When a rule is triggered, a notification will be displayed from the Action Center."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Microsoft Defender Exploit Guard\\Attack Surface Reduction\\Configure Attack Surface Reduction rules 注意：此群組原則路徑預設可能不存在。它是由群組原則範本 WindowsDefender.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1709 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.43.6.1.1"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR -> ExploitGuard_ASR_Rules'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR -> ExploitGuard_ASR_Rules -> 1'

  # 18.10.43.6.1.2 (L1) Ensure 'Configure Attack Surface Reduction rules: Set the state for each ASR rule' is configured. (Automated)
  - id: 16276
    title: "確保配置「配置攻擊面減少規則：設定每個 ASR 規則的狀態」。"
    description: "此策略設定設定攻擊面減少規則。此設定的建議狀態為： 26190899-1602-49e8-8b27-eb1d0a1ce869 - 1（阻止 Office 通訊應用程式建立子程序） 3b576869-a4ec-4529-8536-b80a7769e89-a4ec-4529-8536-b80a7769e89-a4ec-4529-8536-b80a7769e899-a4389896a - -875e-4185-98a7-b882c64b5ce5 - 1（阻止濫用被利用的易受攻擊的簽章驅動程式） 5beb7efe-fd9a-4556-801d-275e5ffc04cc - 1（阻止執行可能被混淆的腳本） 175668417563b bb93-3ecf5cb7cc84 - 1 （阻止Office 應用程式將程式碼注入其他程序） 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c - 1（阻止Adob​​e Reader 建立子程序） 9-6463196. （阻止從Windows 本機安全性竊取憑證權限子系統(lsass.exe)) b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 - 1（阻止從USB 執行的不受信任和未簽署的程序） be9ba2d9-53ea-4dc-1844dc -9b1eeee46550 - 1（阻止來自電子郵件用戶端和Webmail 的可執行內容) d4f940ab-401b-4efc-aadc-ad5f3c50688a - 1（阻止Office 應用程式建立子程序） 注意：有關ASR 規則的更多資訊可以在以下連結中找到：使用攻擊面減少規則來防止惡意軟體感染 |微軟檔案。"
    rationale: "減少攻擊面有助於防止尋求漏洞的惡意軟體通常使用的操作和應用程式來感染電腦。"
    impact: "When a rule is triggered, a notification will be displayed from the Action Center. Note: The following rules apply to Windows Server 2019 and 2022, but do not apply to Windows Server 2012 R2 and 2016: 92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b (Block Win32 API calls from Office macro), d3e037e1-3eb8-44c8-a917-57927947596d (Block JavaScript or VBScript from launching downloaded executable content), and e6db77e5-3df2-4cf1-b95a-636979351e5b (Block persistence through WMI event subscription)."
    remediation: "為了透過 GP 建立推薦的配置，請設置以下 UI 路徑，使 26190899-1602-49e8-8b27-eb1d0a1ce869、3b576869-a4ec-4529-8536-b80a7769e899、56a863a9-875e-4185-98a7-b882c64b5ce5、5beb7efe-fd9a-4556-801d-275e5ffc04cc、75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84、7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c、9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2、b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4、be9ba2d9-53ea-4cdc-84e5-9b1eeee46550 和 d4f940ab-401b-4efc-aadc-ad5f3c50688a 各自設定為值 1: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Microsoft Defender Exploit Guard\\Attack Surface Reduction\\Configure Attack Surface Reduction rules: Set the state for each ASR rule 註：此群組原則路徑可能預設不存在。它由群組原則範本 WindowsDefender.admx/adml 提供，該範本包含在 Microsoft Windows 10 Release 1709 行政範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.43.6.1.2"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D4F940AB-401B-4EFC-AADC-AD5F3C50688A'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 3B576869-A4EC-4529-8536-B80A7769E899'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D3E037E1-3EB8-44C8-A917-57927947596D'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 26190899-1602-49E8-8B27-eB1D0A1CE869'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 9E6C4E1F-7D60-472F-bA1A-A39EF669E4B2'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D4F940AB-401B-4EFC-AADC-AD5F3C50688A -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 3B576869-A4EC-4529-8536-B80A7769E899 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> D3E037E1-3EB8-44C8-A917-57927947596D -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 26190899-1602-49E8-8B27-eB1D0A1CE869 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> 9E6C4E1F-7D60-472F-bA1A-A39EF669E4B2 -> 1'
      - 'r:HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules -> B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4 -> 1'

  # 18.10.43.6.3.1 (L1) Ensure 'Prevent users and apps from accessing dangerous websites' is set to 'Enabled: Block'. (Automated)
  - id: 16277
    title: "確保「防止使用者和應用程式存取危險網站」設定為「啟用：封鎖」。"
    description: "此策略設定控制 Microsoft Defender Exploit Guard 網路保護。此設定的建議狀態為：啟用：阻止。"
    rationale: "此設定可以幫助防止員工使用任何應用程式存取可能託管網路釣魚詐騙、漏洞託管網站和 Internet 上其他惡意內容的危險網域。"
    impact: "Users and applications will not be able to access dangerous domains."
    remediation: "要通過 GP 設定推薦配置，將以下 UI 路徑設置為已啟用：Block: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Microsoft Defender Exploit Guard\\Network Protection\\Prevent users and apps from accessing dangerous websites 注意：此群組政策路徑預設情況下可能不存在。它由包含在 Microsoft Windows 10 版本 1709 的管理模板 (或更新版本) 中的 Group Policy 模板 WindowsDefender.admx/adml 提供。"
    compliance:
      - cis: ["18.10.43.6.3.1"]
      - cis_csc_v8: ["9.3", "10.5"]
      - cis_csc_v7: ["7.4", "8.3"]
      - cmmc_v2.0: ["SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.1"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.1.6", "1.4", "11.4"]
      - pci_dss_v4.0: ["1.2.6", "1.4.2"]
      - soc_2: ["CC5.2", "CC6.6", "CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection -> EnableNetworkProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection -> EnableNetworkProtection -> 1'

  # 18.10.43.7.1 (L2) Ensure 'Enable file hash computation feature' is set to 'Enabled'. (Automated)
  - id: 16278
    title: "確保“啟用檔案雜湊計算功能”設定為“已啟用”。"
    description: "此設定決定是否為 Microsoft Defender 掃描的檔案計算雜湊值。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為監視可疑和已知的惡意活動。檔案雜湊是檢測檔案更改的可靠方法，並且可以通過跳過自上次掃描並確定為安全以來未更改的檔案來加快掃描過程。更改的檔案雜湊也可能導致額外的審查。"
    impact: "This setting could cause performance degradation during initial deployment and for users where new executable content is frequently being created (such as software developers), or where applications are frequently installed or updated. For more information on this setting, please visit Security baseline (FINAL): Windows 10 and Windows Server, version 2004 - Microsoft Tech Community - 1543631. Note: The impact of this setting should be monitored closely during deployment to ensure user and system performance impact is within acceptable limits."
    remediation: "要透過 GP 設定建議的配置，請將以下使用者介面路徑設為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\MpEngine\\Enable file hash computation feature 注意: 此群組原則路徑可能預設不存在。它由群組原則模板 WindowsDefender.admx/adml 提供，該模板包含在 Microsoft Windows 10 Release 2004 管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.43.7.1"]
      - cis_csc_v8: ["10.1"]
      - cis_csc_v7: ["8.1"]
      - cmmc_v2.0: ["SI.L1-3.14.2"]
      - hipaa: ["164.308(a)(5)(ii)(B)"]
      - iso_27001-2013: ["A.12.2.1"]
      - pci_dss_v3.2.1: ["5.1"]
      - pci_dss_v4.0: ["5.1.1", "5.2.1", "5.2.2", "5.3.2"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine -> EnableFileHashComputation'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine -> EnableFileHashComputation -> 1'

  # 18.10.43.10.1 (L1) Ensure 'Scan all downloaded files and attachments' is set to 'Enabled'. (Automated)
  - id: 16279
    title: "確保「掃描所有下載的檔案和附件」設定為「啟用」。"
    description: "此策略設定配置掃描所有下載的檔案和附件。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP設定推薦的配置，請將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Scan all downloaded files and attachments 注意：此群組策略路徑預設可能不存在。它是由群組策略模板 WindowsDefender.admx/adml 提供的，該模板包含在Microsoft Windows 8.1 & Server 2012 R2 管理模板（或更新版本）中。"
    references:
      - "https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/configure-real-time-protection-microsoft-defender-antivirus"
    compliance:
      - cis: ["18.10.43.10.1"]
      - cis_csc_v7: ["8.1"]
      - iso_27001-2013: ["A.12.2.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableIOAVProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableIOAVProtection -> 0'

  # 18.10.43.10.2 (L1) Ensure 'Turn off real-time protection' is set to 'Disabled'. (Automated)
  - id: 16280
    title: "確保“關閉即時保護”設定為“停用”。"
    description: "此策略設定為已知惡意軟體偵測配置即時保護提示。當惡意軟體或可能不需要的軟體嘗試自行安裝或在您的電腦上執行時，Microsoft Defender 防毒軟體會向您發出警報。此設定的建議狀態是：停用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP設置建議的配置，將以下UI路徑設置為Disabled：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Turn off real - time protection 注意：此群組原則路徑可能預設情況下不存在。它由群組原則範本WindowsDefender.admx/adml提供，該範本包含在Microsoft Windows 8.1和Server 2012 R2的管理範本（或更新版本）中。"
    references:
      - "https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/configure-real-time-protection-microsoft-defender-antivirus"
    compliance:
      - cis: ["18.10.43.10.2"]
      - cis_csc_v7: ["8.1"]
      - iso_27001-2013: ["A.12.2.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableRealtimeMonitoring'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableRealtimeMonitoring -> 0'

  # 18.10.43.10.3 (L1) Ensure 'Turn on behavior monitoring' is set to 'Enabled'. (Automated)
  - id: 16281
    title: "確保「開啟行為監控」設定為「已啟用」。"
    description: "此策略設定允許你設定 Microsoft Defender 防毒的行為監視。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    impact: "None - this is the default configuration."
    remediation: "若要通過 GP 建立建議的配置，請將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Turn on behavior monitoring 注意: 此組策略路徑預設可能不存在。它由組策略範本 WindowsDefender.admx/adml 提供，該範本包含在 Microsoft Windows 8.1 & Server 2012 R2 管理範本（或更新版本）中。"
    compliance:
      - cis: ["18.10.43.10.3"]
      - cis_csc_v8: ["10.7"]
      - cis_csc_v7: ["8.1"]
      - iso_27001-2013: ["A.12.2.1"]
      - pci_dss_v4.0: ["5.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableBehaviorMonitoring'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableBehaviorMonitoring -> 0'

  # 18.10.43.10.4 (L1) Ensure 'Turn on script scanning' is set to 'Enabled'. (Automated)
  - id: 16282
    title: "確保“開啟腳本掃描”設定為“已啟用”。"
    description: "此策略設定允許開啟/關閉腳本掃描。腳本掃描會攔截腳本，然後在它們在系統上執行之前對其進行掃描。此設定的建議狀態為：已啟用。"
    rationale: "在執行 Microsoft Defender 防毒等防毒解決方案時，請務必確保將其配置為啟發式即時監控可疑和已知的惡意活動。"
    impact: "None - this is the default behavior."
    remediation: "若要通過 GP 建立建議的配置，將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Real-Time Protection\\Turn on script scanning 注意: 此組策略路徑可能預設不存在。它由包含在 Microsoft Windows 11 Release 21H2 管理模板（或更新版本）中的組策略模板 WindowsDefender.admx/adml 提供。"
    references:
      - "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-advanced-scan-types-microsoft-defender-antivirus?view=o365-worldwide"
    compliance:
      - cis: ["18.10.43.10.4"]
      - cis_csc_v8: ["10.7"]
      - cis_csc_v7: ["8.1"]
      - iso_27001-2013: ["A.12.2.1"]
      - pci_dss_v4.0: ["5.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableScriptScanning'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-TimeProtection -> DisableScriptScanning -> 0'

  # 18.10.43.12.1 (L2) Ensure 'Configure Watson events' is set to 'Disabled'. (Automated)
  - id: 16283
    title: "確保「配置 Watson 事件」設定為「停用」。"
    description: "此策略設定可讓您設定是否傳送 Watson 事件。此設定的建議狀態是：停用。"
    rationale: "Watson 事件是當程式或服務當機或失敗時發送給 Microsoft 的報告，包括自動提交的可能性。阻止發送此資訊有助於減少隱私問題。"
    impact: "Watson events will not be sent to Microsoft automatically when a program or service crashes or fails."
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Reporting\\Configure Watson events 注：此群組策略路徑預設可能不存在。它由Group Policy模板WindowsDefender.admx/adml提供，該模板包含在Microsoft Windows 8.1和Server 2012 R2管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.43.12.1"]
      - cis_csc_v7: ["13.3"]
      - iso_27001-2013: ["A.13.1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting -> DisableGenericRePorts'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting -> DisableGenericRePorts -> 1'

  # 18.10.43.13.1 (L1) Ensure 'Scan removable drives' is set to 'Enabled'. (Automated)
  - id: 16284
    title: "確保「掃描可移動磁碟機」設定為「已啟用」。"
    description: "此策略設定可讓您管理在執行完整掃描時是否掃描可移動磁碟機（例如 USB 隨身碟）內容中的惡意軟體和不需要的軟體。此設定的建議狀態為：已啟用。"
    rationale: "確保任何現有的可移動磁碟機始終包含在任何類型的掃描中非常重要，因為可移動磁碟機更有可能包含從外部非託管電腦引入企業託管環境的惡意軟體。"
    impact: "Removable drives will be scanned during any type of scan by Microsoft Defender Antivirus."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Scan\\Scan removable drives 注意：此群組政策路徑預設可能不存在。它由群組政策模板 WindowsDefender.admx/adml 提供，該模板隨 Microsoft Windows 8.1 & Server 2012 R2 行政模板（或更新版本）一起提供。"
    compliance:
      - cis: ["18.10.43.13.1"]
      - cis_csc_v8: ["10.4"]
      - cis_csc_v7: ["8.4"]
      - cmmc_v2.0: ["SC.L2-3.13.13", "SI.L1-3.14.5"]
      - hipaa: ["164.310(d)(1)"]
      - iso_27001-2013: ["A.12.2.1"]
      - pci_dss_v4.0: ["5.3.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableRemovableDriveScanning'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableRemovableDriveScanning -> 0'

  # 18.10.43.13.2 (L1) Ensure 'Turn on e-mail scanning' is set to 'Enabled'. (Automated)
  - id: 16285
    title: "確保「開啟電子郵件掃描」設定為「啟用」。"
    description: "此策略設定可讓您設定電子郵件掃描。啟用電子郵件掃描時，引擎將根據特定格式解析郵箱和郵件檔案，以分析郵件正文和附件。目前支援多種電子郵件格式，例如：pst (Outlook)、dbx、mbx、mime (Outlook Express)、binhex (Mac)。此設定的建議狀態為：已啟用。"
    rationale: "應使用 Microsoft Defender Antivirus 等防毒解決方案掃描傳入電子郵件，因為電子郵件附件是惡意軟體滲透電腦的常用攻擊媒介。"
    impact: "E-mail scanning by Microsoft Defender Antivirus will be enabled."
    remediation: "若要透過 GP 設定建議配置，請將以下 UI 路徑設定為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Scan\\Turn on e-mail scanning 注意：此群組原則路徑可能預設不存在。它由包含在 Microsoft Windows 8.1 和 Server 2012 R2 管理模板（或更新版本）中的群組原則模板 WindowsDefender.admx/adml 提供。"
    compliance:
      - cis: ["18.10.43.13.2"]
      - cis_csc_v7: ["8.1"]
      - iso_27001-2013: ["A.12.2.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableEmailScanning'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Scan -> DisableEmailScanning -> 0'

  # 18.10.43.16 (L1) Ensure 'Configure detection for potentially unwanted applications' is set to 'Enabled: Block'. (Automated)
  - id: 16286
    title: "確保「配置潛在有害應用程式偵測」設定為「啟用：阻止」。"
    description: "此策略設定控制對潛在有害應用程式 (PUA) 的檢測和操作，這些應用程式是偷偷摸摸的不需要的應用程式捆綁程式或其捆綁的應用程序，可以傳播廣告軟體或惡意軟體。此設定的建議狀態為：啟用：阻止。有關詳細資訊，請參閱此連結：使用 Microsoft Defender 防毒軟體阻止可能不需要的應用程式 |微軟檔案。"
    rationale: "潛在不必要的應用程式可能會增加網路被惡意軟體感染的風險，導致惡意軟體感染更難以識別，並且可能浪費 IT 資源來清理應用程式。應阻止它們安裝。"
    impact: "Applications that are identified by Microsoft as PUA will be blocked at download and install time."
    remediation: "若要通過 GP 建立建議的配置, 請將以下 UI 路徑設置為啟用: Block: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Configure detection for potentially unwanted applications 注意: 此群組策略路徑由群組策略模板 WindowsDefender.admx/adml 提供, 該模板包含在 Microsoft Windows 10 版本 1809 和 Server 2019 管理模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.10.43.16"]
      - cis_csc_v8: ["10.6"]
      - cis_csc_v7: ["2.7", "8.1"]
      - iso_27001-2013: ["A.12.1.2", "A.12.2.1", "A.12.5.1", "A.12.6.2"]
      - pci_dss_v3.2.1: ["11.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> PUAProtection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender -> PUAProtection -> 1'

  # 18.10.43.17 (L1) Ensure 'Turn off Microsoft Defender AntiVirus' is set to 'Disabled'. (Automated)
  - id: 16287
    title: "確保“關閉 Microsoft Defender 防毒”設定為“停用”。"
    description: "此策略設定會關閉 Microsoft Defender 防毒軟體。如果設定配置為“已停用”，Microsoft Defender 防毒軟體將運行並掃描電腦是否存在惡意軟體和其他可能不需要的軟體。此設定的建議狀態是：停用。"
    rationale: "確保最新的、更新的防毒產品掃描每台電腦是否有惡意檔案活動非常重要。 Microsoft 在 Microsoft Defender 防毒軟體中提供了開箱即用的有效解決方案。選擇購買信譽良好的第三方防毒解決方案的組織可以選擇免除此建議，而不是商業替代方案。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Microsoft Defender Antivirus\\Turn off Microsoft Defender AntiVirus 注意: 此群組原則路徑由Group Policy Template WindowsDefender.admx/adml提供, 並且包含於所有版本的Microsoft Windows Administrative Templates。 注意 #2: 在舊版Microsoft Windows Administrative Templates中，此設置最初命名為Turn off Windows Defender，但從Windows 10 Release 1703 Administrative Templates開始已重新命名。從Windows 10 Release 2004 Administrative Templates開始再次重新命名為Windows Defender Antivirus。"
    compliance:
      - cis: ["18.10.43.17"]
      - cis_csc_v8: ["10.6"]
      - cis_csc_v7: ["8.1"]
      - iso_27001-2013: ["A.12.2.1"]
      - pci_dss_v3.2.1: ["11.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsDefender'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsDefender -> DisableAntiSpyware'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsDefender -> DisableAntiSpyware -> 0'

  # 18.10.51.1 (L1) Ensure 'Prevent the usage of OneDrive for file storage' is set to 'Enabled'. (Automated)
  - id: 16288
    title: "確保「阻止使用 OneDrive 進行檔案儲存」設定為「已啟用」。"
    description: "此策略設定可讓你阻止應用程式和功能使用下一代同步客戶端處理 OneDrive 上的檔案。此設定的建議狀態為：已啟用。"
    rationale: "啟用此設定可防止使用者意外（或故意）使用新一代同步用戶端將機密或敏感的公司資訊上傳至 OneDrive 雲端服務。注意：此安全性問題適用於安裝在伺服器上的任何基於雲端的檔案儲存應用程序，而不僅僅是 Windows Server 隨附的應用程式。"
    impact: "Users can't access OneDrive from the OneDrive app and file picker. Windows Store apps can't access OneDrive using the WinRT API. OneDrive doesn't appear in the navigation pane in File Explorer. OneDrive files aren't kept in sync with the cloud. Users can't automatically upload photos and videos from the camera roll folder. Note: If your organization uses Office 365, be aware that this setting will prevent users from saving files to OneDrive/SkyDrive. Note #2: If your organization has decided to implement OneDrive for Business and therefore needs to except itself from this recommendation, we highly suggest that you also obtain and utilize the OneDrive.admx/adml template that is bundled with the latest OneDrive client, as noted at this link (this template is not included with the Windows Administrative Templates). Two alternative OneDrive settings in particular from that template are worth your consideration: - Allow syncing OneDrive accounts for only specific organizations - a computer - based setting that restricts OneDrive client connections to only approved tenant IDs. - Prevent users from synchronizing personal OneDrive accounts - a user-based setting that prevents use of consumer OneDrive (i.e. non-business)."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Enabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\OneDrive\\Prevent the usage of OneDrive for file storage 注意：此群組原則路徑預設可能不存在。它是由群組原則模板 SkyDrive.admx/adml 提供，該模板包含在 Microsoft Windows 8.1 & Server 2012 R2 Administrative Templates (或更新版本) 中。然而，我們強烈建議您僅使用包含於 Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates (或更新版本) 的版本。舊版本模板在 OneDrive & SkyDrive 的不同模板檔案中存在衝突設置，直到上述版本中才完全清理。 注意 #2：在舊版本的 Microsoft Windows Administrative Templates 中，此設置名為 Prevent the usage of SkyDrive for file storage，但從 Windows 10 RTM (Release 1507) 行政模板開始重新命名。"
    compliance:
      - cis: ["18.10.51.1"]
      - cis_csc_v7: ["13.4"]
      - iso_27001-2013: ["A.13.2.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive -> DisableFileSyncNGSC'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive -> DisableFileSyncNGSC -> 1'

  # 18.10.56.1 (L2) Ensure 'Turn off Push To Install service' is set to 'Enabled'. (Automated)
  - id: 16289
    title: "確保「關閉推播安裝服務」設定為「啟用」。"
    description: "此策略設定控制使用者是否可以從在其他裝置或 Web 上執行的 Microsoft Store 應用程式將應用程式推送到裝置。此設定的建議狀態為：已啟用。"
    rationale: "在高安全性的託管環境中，應用程式安裝應由 IT 人員而不是最終使用者集中管理。"
    impact: "Users will not be able to push Apps to this device from the Microsoft Store running on other devices or the web."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Push to Install\\Turn off Push To Install service 注意：此群組原則路徑可能預設不存在。它由群組原則模板PushToInstall.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1709管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.56.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PushToInstall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PushToInstall -> DisablePushToInstall'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PushToInstall -> DisablePushToInstall -> 1'

  # 18.10.57.2.2 (L1) Ensure 'Do not allow passwords to be saved' is set to 'Enabled'. (Automated)
  - id: 16290
    title: "確保“不允許儲存密碼”設定為“啟用”。"
    description: "此政策設定有助於防止遠端桌面用戶端在電腦上保存密碼。此設定的建議狀態為：已啟用。注意：如果此政策設定之前配置為“已停用”或“未配置”，則遠端桌面用戶端第一次與任何伺服器斷開連接時，先前儲存的任何密碼都將被刪除。"
    rationale: "能夠實際存取電腦的攻擊者可能能夠破壞保存密碼的保護。危害使用者帳戶並連接到其電腦的攻擊者可以使用已儲存的密碼來存取其他主機。"
    impact: "The password saving checkbox will be disabled for Remote Desktop clients and users will not be able to save passwords."
    remediation: "若要透過 GP 建立建議的設定，將以下 UI 路徑設為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Connection Client\\Do not allow passwords to be saved 注意：此群組原則路徑由所有版本的 Microsoft Windows 管理範本中包含的群組原則範本 TerminalServer.admx/adml 提供。"
    compliance:
      - cis: ["18.10.57.2.2"]
      - cis_csc_v7: ["16.11"]
      - iso_27001-2013: ["A.8.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DisablePasswordSaving'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DisablePasswordSaving -> 1'

  # 18.10.57.3.2.1 (L2) Ensure 'Restrict Remote Desktop Services users to a single Remote Desktop Services session' is set to 'Enabled'. (Automated)
  - id: 16291
    title: "確保「將遠端桌面服務使用者限制為單一遠端桌面服務會話」設定為「已啟用」。"
    description: "此策略設定可讓您將使用者限制為單一遠端桌面服務會話。此設定的建議狀態為：已啟用。"
    rationale: "此設定可確保透過遠端桌面連接到伺服器的使用者和管理員將繼續使用相同會話 - 如果他們斷開連接並重新連接，他們將返回到先前使用的相同會話，從而防止建立第二個同時會話。這既可以透過讓伺服器託管不必要的額外會話（這會為伺服器帶來額外的負載）來防止不必要的資源使用，也可以確保使用者體驗的一致性。"
    impact: "None - this is the default behavior."
    remediation: "若要透過GP建立建議的配置，請將以下UI路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Connections\\Restrict Remote Desktop Services users to a single Remote Desktop Services session 注意: 此群組政策路徑是由群組政策模板TerminalServer.admx/adml提供的，所有版本的Microsoft Windows行政模板都包括該模板。 注意#2: 在舊版的Microsoft Windows行政模板中，此設定名為限制終端服務使用者為單一遠端會話，但從Windows 7和Server 2008 R2行政模板開始已重新命名。"
    compliance:
      - cis: ["18.10.57.3.2.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fSingleSessionPerUser'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fSingleSessionPerUser -> 1'

  # 18.10.57.3.3.1 (L2) Ensure 'Do not allow COM port redirection' is set to 'Enabled'. (Automated)
  - id: 16292
    title: "確保「不允許 COM 連接埠重新導向」設定為「啟用」。"
    description: "此原則設定指定是否阻止在遠端桌面服務工作階段中將資料從遠端電腦重新導向至用戶端 COM 連接埠。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 COM 連接埠重新導向，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    impact: "Users in a Remote Desktop Services session will not be able to redirect server data to local (client) COM ports."
    remediation: "要通過 GP 建立建議的配置，將以下使用者介面路徑設置為「啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow COM port redirection 注意：此群組原則路徑由群組原則範本 TerminalServer.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.10.57.3.3.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCcm'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCcm -> 1'

  # 18.10.57.3.3.2 (L1) Ensure 'Do not allow drive redirection' is set to 'Enabled'. (Automated)
  - id: 16293
    title: "確保“不允許驅動器重新導向”設定為“已啟用”。"
    description: "此策略設定阻止使用者將其用戶端電腦上的本機磁碟機共用給他們存取的遠端桌面伺服器。對應的驅動器以以下格式顯示在Windows 資源管理器的會話資料夾樹中： \\\\TSClient\\<driveletter>$ 如果共用本機磁碟機，則它們很容易受到想要利用其上儲存的資料的入侵者的攻擊。此設定的建議狀態為：已啟用。"
    rationale: "資料可以從使用者的遠端桌面服務會話轉發到使用者的本機計算機，而無需任何直接的使用者互動。已存在於受感染伺服器上的惡意軟體將在遠端桌面會話期間對使用者的本機電腦進行直接且隱密的磁碟存取。"
    impact: "Drive redirection will not be possible. In most situations, traditional network drive mapping to file shares (including administrative shares) performed manually by the connected user will serve as a capable substitute to still allow file transfers when needed."
    remediation: "若要通過GP建立推薦的配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow drive redirection 注意: 此組策略路徑由與所有版本的Microsoft Windows管理模板一起包含的組策略模板TerminalServer.admx/adml提供。"
    compliance:
      - cis: ["18.10.57.3.3.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCdm'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableCdm -> 1'

  # 18.10.57.3.3.3 (L2) Ensure 'Do not allow LPT port redirection' is set to 'Enabled'. (Automated)
  - id: 16294
    title: "確保“不允許 LPT 連接埠重新導向”設定為“啟用”。"
    description: "此策略設定指定是否阻止在遠端桌面服務工作階段期間將資料重新導向至用戶端 LPT 連接埠。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中很少需要 LPT 連接埠重新導向，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    impact: "Users in a Remote Desktop Services session will not be able to redirect server data to local (client) LPT ports."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow LPT port redirection 注意: 這個組策略路徑是由組策略模板TerminalServer.admx/adml提供，並包含在所有版本的Microsoft Windows系統管理模板中。"
    compliance:
      - cis: ["18.10.57.3.3.3"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLPT'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisableLPT -> 1'

  # 18.10.57.3.3.4 (L2) Ensure 'Do not allow supported Plug and Play device redirection' is set to 'Enabled'. (Automated)
  - id: 16295
    title: "確保「不允許支援的即插即用裝置重新導向」設定為「已啟用」。"
    description: "此策略設定可讓您控制將受支援的即插即用裝置（例如 Windows 可攜式裝置）重新導向至遠端桌面服務工作階段中的遠端電腦。此設定的建議狀態為：已啟用。"
    rationale: "在安全更敏感的環境中，希望減少可能的攻擊面。遠端桌面會話中對即插即用裝置重新導向的需求非常少，因此減少資料外洩和/或惡意程式碼傳輸的意外途徑的數量是有意義的。"
    impact: "Users in a Remote Desktop Services session will not be able to redirect their supported (local client) Plug and Play devices to the remote computer."
    remediation: "要透過 GP 建立推薦的配置，請將以下 UI 路徑設定為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Device and Resource Redirection\\Do not allow supported Plug and Play device redirection 注意：此群組原則路徑由群組原則範本 TerminalServer.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.10.57.3.3.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisablePNPRedir'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fDisablePNPRedir -> 1'

  # 18.10.57.3.9.1 (L1) Ensure 'Always prompt for password upon connection' is set to 'Enabled'. (Automated)
  - id: 16296
    title: "確保「連線時始終提示輸入密碼」設定為「啟用」。"
    description: "此原則設定指定遠端桌面服務是否始終在連線時提示用戶端電腦輸入密碼。您可以使用此原則設定強制要求登入遠端桌面服務的使用者輸入密碼，即使他們已經在遠端桌面連線用戶端中提供了密碼。此設定的建議狀態為：已啟用。"
    rationale: "使用者在建立新的遠端桌面連線捷徑時可以選擇儲存其使用者名稱和密碼。如果執行遠端桌面服務的伺服器允許使用此功能的使用者登入伺服器但不輸入密碼，則獲得使用者電腦實體存取權限的攻擊者可能會連接到遠端桌面伺服器透過遠端桌面連線捷徑，即使他們可能不知道用戶的密碼。"
    impact: "Users cannot automatically log on to Remote Desktop Services by supplying their passwords in the Remote Desktop Connection client. They will be prompted for a password to log on."
    remediation: "要通過GP建立建議的配置，將以下UI路徑設定為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Always prompt for password upon connection 注意: 此群組策略路徑由群組策略模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。 注意 #2: 在Microsoft Windows Vista管理模板中，這個設置名為 Always prompt client for password upon connection ，但從Windows Server 2008 (非R2)管理模板開始，它被重新命名。"
    compliance:
      - cis: ["18.10.57.3.9.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fPromptForPassword'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fPromptForPassword -> 1'

  # 18.10.57.3.9.2 (L1) Ensure 'Require secure RPC communication' is set to 'Enabled'. (Automated)
  - id: 16297
    title: "確保“需要安全 RPC 通訊”設定為“啟用”。"
    description: "此策略設定可讓您指定遠端桌面服務是需要與所有用戶端進行安全遠端程序呼叫 (RPC) 通訊還是允許不安全的通訊。您可以使用此策略設定僅允許經過驗證和加密的請求來增強與用戶端的 RPC 通訊的安全性。此設定的建議狀態為：已啟用。"
    rationale: "允許不安全的 RPC 通訊可能會使伺服器遭受中間人攻擊和資料外洩攻擊。"
    impact: "Remote Desktop Services accepts requests from RPC clients that support secure requests, and does not allow unsecured communication with untrusted clients."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require secure RPC communication 注意: 此群組原則路徑由所有版本 Microsoft Windows Administrative Templates 附帶的群組原則模板 TerminalServer.admx/adml 提供。"
    compliance:
      - cis: ["18.10.57.3.9.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fEncryptRPCTraffic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> fEncryptRPCTraffic -> 1'

  # 18.10.57.3.9.3 (L1) Ensure 'Require use of specific security layer for remote (RDP) connections' is set to 'Enabled: SSL'. (Automated)
  - id: 16298
    title: "確保「需要對遠端 (RDP) 連線使用特定安全層」設定為「啟用：SSL」。"
    description: "此原則設定指定是否需要使用特定安全層來保護遠端桌面協定 (RDP) 連線期間用戶端和 RD 會話主機伺服器之間的通訊。此設定的建議狀態為：啟用：SSL。注意：儘管此設定被標記為 SSL，但它實際上強制執行傳輸層安全性 (TLS) 版本 1.0，而不是較舊的（安全性較低）SSL 協定。"
    rationale: "本機遠端桌面協定 (RDP) 加密現在被視為弱協定，因此首選對用戶端和 RD 會話主機伺服器之間的所有 RDP 通訊強制使用更強的傳輸層安全性 (TLS) 加密。"
    impact: "TLS 1.0 will be required to authenticate to the RD Session Host server. If TLS is not supported, the connection fails. Note: By default, this setting will use a self-signed certificate for RDP connections. If your organization has established the use of a Public Key Infrastructure (PKI) for SSL/TLS encryption, then we recommend that you also configure the Server authentication certificate template setting to instruct RDP to use a certificate from your PKI instead of a self-signed one. Note that the certificate template used for this purpose must have “Client Authentication” configured as an Intended Purpose. Note also that a valid, non-expired certificate using the specified template must already be installed on the server for it to work. Note #2: Some third party two-factor authentication solutions (e.g. RSA Authentication Agent) can be negatively affected by this setting, as the SSL/TLS security layer will expect the user's Windows password upon initial connection attempt (before the RDP logon screen), and once successfully authenticated, pass the credential along to that Windows session on the RDP host (to complete the login). If a two-factor agent is present and expecting a different credential at the RDP logon screen, this initial connection may result in a failed logon attempt, and also effectively cause a “double logon” requirement for each and every new RDP session."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為啟用：SSL: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require use of specific security layer for remote (RDP) connections 提示：此組策略路徑由組策略模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.10.57.3.9.3"]
      - cis_csc_v8: ["3.10"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> SecurityLayer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> SecurityLayer -> 2'

  # 18.10.57.3.9.4 (L1) Ensure 'Require user authentication for remote connections by using Network Level Authentication' is set to 'Enabled'. (Automated)
  - id: 16299
    title: "確保「要求使用網路層級身份驗證對遠端連線進行使用者身份驗證」設定為「已啟用」。"
    description: "透過此策略設置，您可以指定是否需要使用網路層級身份驗證對 RD 會話主機伺服器的遠端連線進行使用者驗證。此設定的建議狀態為：已啟用。"
    rationale: "要求在遠端連線過程中儘早進行使用者身份驗證可增強安全性。"
    impact: "Only client computers that support Network Level Authentication can connect to the RD Session Host server. Note: Some third party two-factor authentication solutions (e.g. RSA Authentication Agent) can be negatively affected by this setting, as Network Level Authentication will expect the user's Windows password upon initial connection attempt (before the RDP logon screen), and once successfully authenticated, pass the credential along to that Windows session on the RDP host (to complete the login). If a two-factor agent is present and expecting a different credential at the RDP logon screen, this initial connection may result in a failed logon attempt, and also effectively cause a “double logon” requirement for each and every new RDP session."
    remediation: "要透過群組原則設定建議的配置，將以下 UI 路徑設置為「已啟用」：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Require user authentication for remote connections by using Network Level Authentication 注意：此群組原則路徑由群組原則範本 TerminalServer.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。注意 #2：在微軟 Windows Vista 管理範本中，此設定最初命名為 Require user authentication using RDP 6.0 for remote connections，但從 Windows Server 2008（非 R2）管理範本開始進行了重新命名。"
    compliance:
      - cis: ["18.10.57.3.9.4"]
      - cis_csc_v8: ["3.10"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> UserAuthentication'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> UserAuthentication -> 1'

  # 18.10.57.3.9.5 (L1) Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'. (Automated)
  - id: 16300
    title: "確保「設定用戶端連線加密等級」設定為「啟用：高等級」。"
    description: "此策略設定指定是否需要使用特定的加密等級來保護遠端桌面協定 (RDP) 連線期間用戶端電腦和 RD 會話主機伺服器之間的通訊。此策略僅在您使用本機 RDP 加密時適用。但是，不建議使用本機 RDP 加密（而不是 SSL 加密）。此策略不適用於 SSL 加密。此設定的建議狀態為： 啟用：高等級。"
    rationale: "如果允許使用低階加密的遠端桌面用戶端連接，則攻擊者更有可能解密任何捕獲的遠端桌面服務網路流量。"
    impact: "None - this is the default behavior."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為啟用： 高級：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Security\\Set client connection encryption level 注意：此群組原則路徑由群組原則範本 TerminalServer.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理範本中。"
    compliance:
      - cis: ["18.10.57.3.9.5"]
      - cis_csc_v8: ["3.10"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MinEncryptionLevel'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MinEncryptionLevel -> 3'

  # 18.10.57.3.10.1 (L2) Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less, but not Never (0)'. (Automated)
  - id: 16301
    title: "確保「為活動但空閒的遠端桌面服務會話設定時間限制」設定為「啟用：15 分鐘或更短，但不是從不 (0)」。"
    description: "此策略設定可讓您指定活動遠端桌面服務工作階段在自動中斷連線之前可以空閒（無需使用者輸入）的最長時間。此設定的建議狀態為： 已啟用：15 分鐘或更短，但非從不 (0)。"
    rationale: "此設定有助於防止活動的遠端桌面會話在不使用時長時間佔用計算機，從而防止大量不活動的會話消耗計算資源。此外，如果使用者的密碼已更改但舊會話仍在運行，則舊的、被遺忘的遠端桌面會話仍然處於活動狀態，可能會導緻密碼鎖定。對於限制連接使用者數量的系統（例如，預設管理模式下的伺服器 - 僅 2 個會話），其他使用者的舊但仍處於活動狀態的會話可能會阻止其他使用者連接，從而導致有效的拒絕服務。此外，配置錯誤或設定時間過長的會話逾時可能會使系統容易被攻擊者劫持會話。"
    impact: "Remote Desktop Services will automatically disconnect active but idle sessions after 15 minutes (or the specified amount of time). The user receives a warning two minutes before the session disconnects, which allows the user to press a key or move the mouse to keep the session active. Note that idle session time limits do not apply to console sessions."
    remediation: "要通過GP建立建議的配置，請將以下UI路徑設置為“已啟用”：15分鐘或更少，但不要設為“從不(0)”： Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for active but idle Remote Desktop Services sessions 注意：此群組原則路徑由群組原則模板TerminalServer.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。注意 #2：在較舊的Microsoft Windows管理模板中，此設置名為“Set time limit for active but idle Terminal Services sessions”，但從Windows 7 & Server 2008 R2管理模板開始已更名。"
    compliance:
      - cis: ["18.10.57.3.10.1"]
      - cis_csc_v7: ["16.11"]
      - iso_27001-2013: ["A.8.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime -> n:^(\d+) compare <= 900000'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxIdleTime -> n:^(\d+) compare != 0'

  # 18.10.57.3.10.2 (L2) Ensure 'Set time limit for disconnected sessions' is set to 'Enabled: 1 minute'. (Automated)
  - id: 16302
    title: "確保「設定斷開連線的會話的時間限制」設定為「啟用：1 分鐘」。"
    description: "此策略設定可讓您設定斷開連線的遠端桌面服務工作階段的時間限制。此設定的建議狀態為： 啟用：1 分鐘。"
    rationale: "此設定有助於防止活動的遠端桌面會話在不使用時長時間佔用計算機，從而防止大量已斷開連接但仍處於活動狀態的會話消耗計算資源。此外，如果使用者的密碼已更改但舊會話仍在運行，則舊的、被遺忘的遠端桌面會話仍然處於活動狀態，可能會導緻密碼鎖定。對於限制連接使用者數量的系統（例如，預設管理模式下的伺服器 - 僅 2 個會話），其他使用者的舊但仍處於活動狀態的會話可能會阻止其他使用者連接，從而導致有效的拒絕服務。此設定對於確保正確終止斷開連線的會話非常重要。此外，配置錯誤或設定時間過長的會話逾時可能會使系統容易被攻擊者劫持會話。"
    impact: "Disconnected Remote Desktop sessions are deleted from the server after 1 minute. Note that disconnected session time limits do not apply to console sessions."
    remediation: "若要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為「已啟用」：1 分鐘：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Session Time Limits\\Set time limit for disconnected sessions 注意：此群組原則路徑由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.10.57.3.10.2"]
      - cis_csc_v7: ["16.11"]
      - iso_27001-2013: ["A.8.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxDisconnectionTime'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> MaxDisconnectionTime -> 60000'

  # 18.10.57.3.11.1 (L1) Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'. (Automated)
  - id: 16303
    title: "確保「退出時不刪除臨時資料夾」設定為「停用」。"
    description: "此策略設定指定遠端桌面服務是否在登出時保留使用者的每個會話暫存資料夾。此設定的建議狀態是：停用。"
    rationale: "敏感資訊可能包含在臨時資料夾內，並且對登入系統的其他管理員可見。"
    impact: "None - this is the default behavior."
    remediation: "若要透過 GP 建立建議的設定，將以下使用者介面路徑設為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Temporary Folders\\Do not delete temp folders upon exit 注意：此群組原則路徑是由所有版本的 Microsoft Windows 行政模板包含的 Group Policy template TerminalServer.admx/adml 提供的。 注意#2：在較舊的 Microsoft Windows 行政模板中，這個設定被命名為 Do not delete temp folder upon exit，但從 Windows 8.0 和 Server 2012（非 R2）行政模板開始被重新命名。"
    compliance:
      - cis: ["18.10.57.3.11.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DeleteTempDirsOnExit'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> DeleteTempDirsOnExit -> 1'

  # 18.10.57.3.11.2 (L1) Ensure 'Do not use temporary folders per session' is set to 'Disabled'. (Automated)
  - id: 16304
    title: "確保“不要在每個會話中使用臨時資料夾”設定為“停用”。"
    description: "預設情況下，遠端桌面服務會在 RD 會話主機伺服器上為使用者在 RD 會話主機伺服器上維護的每個活動會話建立一個單獨的臨時資料夾。臨時資料夾是在 RD 會話主機伺服器上使用者設定檔資料夾下的 Temp 資料夾中建立的，並以 sessionid 命名。此臨時資料夾用於儲存各個臨時檔案。為了回收磁碟空間，當使用者從會話註銷時，臨時資料夾將被刪除。此設定的建議狀態是：停用。"
    rationale: "停用此設定可使快取資料獨立於每個會話，既減少了會話之間共享快取資料出現問題的可能性，也使可能的敏感資料與每個使用者會話分開。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Remote Desktop Services\\Remote Desktop Session Host\\Temporary Folders\\Do not use temporary folders per session 注意: 這個群組原則路徑由群組原則模板 TerminalServer.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.10.57.3.11.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> PerSessionTempDir'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -> PerSessionTempDir -> 1'

  # 18.10.58.1 (L1) Ensure 'Prevent downloading of enclosures' is set to 'Enabled'. (Automated)
  - id: 16305
    title: "確保“阻止下載附件”設定為“啟用”。"
    description: "此策略設定可阻止使用者將附件（檔案附件）從 RSS 來源下載到使用者的電腦。此設定的建議狀態為：已啟用。"
    rationale: "允許透過 RSS 來源下載附件可能會引入可能具有惡意目的的檔案。"
    impact: "Users cannot set the Feed Sync Engine to download an enclosure through the Feed property page. Developers cannot change the download setting through feed APIs."
    remediation: "若要透過GP建立推薦的配置，將以下UI路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\RSS Feeds\\Prevent downloading of enclosures 注意：此群組原則路徑由包含在所有版本的Microsoft Windows管理模板中的群組原則模板InetRes.admx/adml提供。注意#2：在較舊的Microsoft Windows管理模板中，這個設置被命名為「Turn off downloading of enclosures」，但從Windows 8.0 & Server 2012（非R2）管理模板開始，這個設置名稱被更改。"
    compliance:
      - cis: ["18.10.58.1"]
      - cis_csc_v8: ["9.4"]
      - cis_csc_v7: ["7.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8"]
      - iso_27001-2013: ["A.12.6.2"]
      - nist_sp_800-53: ["CM-10", "CM-11", "SC-18"]
      - pci_dss_v4.0: ["2.2.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds -> DisableEnclosureDownload'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds -> DisableEnclosureDownload -> 1'

  # 18.10.59.2 (L2) Ensure 'Allow Cloud Search' is set to 'Enabled: Disable Cloud Search'. (Automated)
  - id: 16306
    title: "確保「允許雲端搜尋」設定為「啟用：停用雲端搜尋」。"
    description: "此策略設定允許搜尋和 Cortana 搜尋 OneDrive 和 SharePoint 等雲端來源。此設定的建議狀態為： 已啟用：停用 Cloud Search。"
    rationale: "出於隱私考慮，切勿將資料發送給任何第三方，因為該資料可能包含敏感資訊。"
    impact: "Search and Cortana will not be permitted to search cloud sources like OneDrive and SharePoint."
    remediation: "要透過 GP 設定建議的配置，將以下 UI 路徑設置為啟用：禁用雲端搜索：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow Cloud Search 注意：此群組原則路徑預設可能不存在。它是由 Windows 10 版本 1709 群組原則範本 Search.admx/adml（或更新版本）提供。"
    compliance:
      - cis: ["18.10.59.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCloudSearch'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowCloudSearch -> 0'

  # 18.10.59.3 (L1) Ensure 'Allow indexing of encrypted files' is set to 'Disabled'. (Automated)
  - id: 16307
    title: "確保“允許加密檔案索引”設定為“停用”。"
    description: "此策略設定控制是否允許對加密項目建立索引。更改此設定後，索引將完全重建。索引位置必須使用全磁碟區加密（例如 BitLocker 磁碟機加密或非 Microsoft 解決方案），以維護加密檔案的安全性。此設定的建議狀態是：停用。"
    rationale: "建立索引並允許用戶搜尋加密檔案可能會洩露加密檔案中儲存的機密資料。"
    impact: "None - this is the default behavior."
    remediation: "若要通過GP建立推薦配置，將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow indexing of encrypted files 注意: 此群組策略路徑由群組策略模板Search.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.10.59.3"]
      - cis_csc_v7: ["14.8"]
      - iso_27001-2013: ["A.10.1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowIndexingEncryptedStoresOrItems'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> AllowIndexingEncryptedStoresOrItems -> 0'

  # 18.10.59.4 (L2) Ensure 'Allow search highlights' is set to 'Disabled'. (Automated)
  - id: 16308
    title: "確保“允許搜尋突出顯示”設定為“停用”。"
    description: "此策略設定控制開始功能表搜尋框和搜尋主頁中的搜尋反白顯示。此設定的建議狀態是：停用。"
    rationale: "在高安全性環境中，資料不應發送給任何第三方或由任何第三方接收，因為該資料可能包含敏感資訊。"
    impact: 'Interesting, "informative", and "noteworthy" information about the current date will not be displayed (by Microsoft) to the user.'
    remediation: "要透過 GP 建立推薦的配置，請將以下使用者介面路徑設定為已停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Search\\Allow search highlights 注意：此群組原則路徑可能預設不存在。它由包含在 Microsoft Windows 10 Release 21H2 Administrative Templates (或更新版本) 中的群組原則模板 Search.admx/adml 提供。"
    compliance:
      - cis: ["18.10.59.4"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> EnableDynamicContentInWSB'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search -> EnableDynamicContentInWSB -> 0'

  # 18.10.63.1 (L2) Ensure 'Turn off KMS Client Online AVS Validation' is set to 'Enabled'. (Automated)
  - id: 16309
    title: "確保「關閉 KMS 用戶端線上 AVS 驗證」設定為「啟用」。"
    description: "金鑰管理服務 (KMS) 是一種 Microsoft 授權啟動方法，需要設定本機伺服器來儲存軟體授權。 KMS 伺服器本身需要連接到 Microsoft 來啟動 KMS 服務，但後續的網路用戶端可以透過 KMS 伺服器啟動 Microsoft Windows 作業系統和/或其 Microsoft Office，而不是直接連接到 Microsoft。此政策設定可讓您選擇不自動向 Microsoft 傳送 KMS 用戶端啟動資料。此設定的建議狀態為：已啟用。"
    rationale: "儘管 KMS 授權方法不需要 KMS 用戶端連線到 Microsoft，但它們仍然會自動向 Microsoft 發送 KMS 用戶端啟動狀態資料。阻止發送此資訊有助於減少高安全環境中的隱私問題。"
    impact: "The computer is prevented from sending data to Microsoft regarding its KMS client activation state."
    remediation: "要通過GP建立推薦配置，將以下UI路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Software Protection Platform\\Turn off KMS Client Online AVS Validation 注：此組策略路徑預設可能不存在。它由包含在Microsoft Windows 10 RTM（版本1507）管理模板（或更新版本）中的組策略模板AVSValidationGP.admx/adml提供。"
    compliance:
      - cis: ["18.10.63.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform -> NoGenTicket'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform -> NoGenTicket -> 1'

  # 18.10.76.2.1 (L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'. (Automated)
  - id: 16310
    title: "確保「設定 Windows Defender SmartScreen」設定為「啟用：警告並防止繞過」。"
    description: "此策略設定可讓您管理 Windows SmartScreen 的行為。 Windows SmartScreen 透過在執行從 Internet 下載的無法識別的程式之前向使用者發出警告，幫助保持電腦更安全。一些有關啟用此功能的 PC 上運行的檔案和程式的資訊將發送給 Microsoft。此設定的建議狀態為： 啟用：警告並防止繞過。"
    rationale: "Windows SmartScreen 透過在執行從 Internet 下載的無法識別的程式之前向使用者發出警告，幫助保持電腦更安全。但是，由於一些有關 PC 上運行的檔案和程式的資訊會發送給 Microsoft，因此一些組織可能更願意停用它。"
    impact: "Users will be warned before they are allowed to run unrecognized programs downloaded from the Internet."
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 啟用: Warn and prevent bypass: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Defender SmartScreen\\Explorer\\Configure Windows Defender SmartScreen 注意: 此組策略路徑可能預設不存在。它由提供的組策略範本 WindowsExplorer.admx/adml 包含於 Microsoft Windows 8.0 和 Server 2012 (非R2) 管理範本 (或更新版本)。 注意 #2: 在較舊的 Microsoft Windows 管理範本中，此設定最初名為 Configure Windows SmartScreen，但從 Windows 10 Release 1703 管理範本開始已重命名。"
    compliance:
      - cis: ["18.10.76.2.1"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableSmartScreen'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> ShellSmartScreenLevel'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> EnableSmartScreen -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System -> ShellSmartScreenLevel -> Block'

  # 18.10.80.1 (L2) Ensure 'Allow suggested apps in Windows Ink Workspace' is set to 'Disabled'. (Automated)
  - id: 16311
    title: "確保「允許 Windows Ink 工作區中建議的應用程式」設定為「停用」。"
    description: "此原則設定決定是否允許 Windows Ink Workspace 中建議的應用程式。此設定的建議狀態是：停用。"
    rationale: "此 Microsoft 功能旨在收集資料並根據收集的資料建議應用程式。停用此設定將有助於確保您的資料不會與任何第三方共用。"
    impact: "The suggested apps in Windows Ink Workspace will not be allowed."
    remediation: "若要透過GP建立推薦的配置，請將以下UI路徑設定為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Ink Workspace\\Allow suggested apps in Windows Ink Workspace 注意：此群組策略路徑預設可能不存在。它由WindowsInkWorkspace.admx/adml群組策略模板提供，該模板包含在Microsoft Windows 10 Release 1607和Server 2016管理模板（或更新版本）中。"
    compliance:
      - cis: ["18.10.80.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace -> 0'

  # 18.10.80.2 (L1) Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: On, but disallow access above lock' OR 'Enabled: Disabled'. (Automated)
  - id: 16312
    title: "確保「允許 Windows Ink 工作區」設定為「啟用：打開，但不允許存取上述鎖定」或「啟用：停用」。"
    description: "此策略設定決定是否允許在鎖定畫面上方顯示 Windows Ink 項目。此設定的建議狀態為： 啟用：打開，但不允許存取以上鎖定或啟用：停用。"
    rationale: "不建議在系統鎖定時允許存取任何應用程式。如果允許此功能，則只有在使用者使用正確的憑證進行身份驗證後才可以存取它。"
    impact: "Windows Ink Workspace will not be permitted above the lock screen."
    remediation: "要通過 GP 建立推薦的配置, 將以下 UI 路徑設置為啟用: 設置加鎖但禁止存取 或 啟用: 禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Ink Workspace\\Allow Windows Ink Workspace 注意: 此組策略路徑可能預設情況下不存在。它由組策略模板 WindowsInkWorkspace.admx/adml 提供, 該模板包含在 Microsoft Windows 10 Release 1607 和 Server 2016 管理模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.10.80.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: any
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowWindowsInkWorkspace -> 0'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace -> AllowWindowsInkWorkspace -> 1'

  # 18.10.81.1 (L1) Ensure 'Allow user control over installs' is set to 'Disabled'. (Automated)
  - id: 16313
    title: "確保「允許使用者控制安裝」設定為「停用」。"
    description: "此設定控制是否允許使用者更改通常僅系統管理員可用的安裝選項。 Windows Installer 的安全功能通常會阻止使用者變更通常為系統管理員保留的安裝選項，例如指定檔案的安裝目錄。如果 Windows Installer 偵測到安裝套件允許使用者變更受保護的選項，它將停止安裝並顯示一則訊息。只有當安裝程式在特權安全上下文中執行時，這些安全功能才會起作用，在特權安全性上下文中，安裝程式有權存取使用者拒絕的目錄。此設定的建議狀態是：停用。"
    rationale: "在企業管理的環境中，只有具有管理權限的 IT 人員才能在系統上安裝或變更軟體。允許使用者對安裝進行任何控制可能會帶來未經批准的軟體被安裝或從系統中刪除的風險，這可能會導致系統容易受到損害。"
    impact: "None - this is the default behavior."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Allow user control over installs 注意: 此群組策略路徑由所有版本的微軟Windows管理模板中包含的群組策略模板MSI.admx/adml提供 注意 #2: 在較舊的微軟Windows管理模板中，此設置名為允許用戶控制安裝，但從Windows 8.0及Server 2012（非R2）管理模板開始，它被重命名了。"
    compliance:
      - cis: ["18.10.81.1"]
      - cis_csc_v8: ["2.5"]
      - cmmc_v2.0: ["CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "CM.L2-3.4.9"]
      - nist_sp_800-53: ["CM-7(5)"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> EnableUserControl'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> EnableUserControl -> 0'

  # 18.10.81.2 (L1) Ensure 'Always install with elevated privileges' is set to 'Disabled'. (Automated)
  - id: 16314
    title: "確保「始終使用提升的權限安裝」設定為「停用」。"
    description: "此設定控制 Windows Installer 在系統上安裝任何程式時是否應使用系統權限。注意：此設定同時出現在「電腦設定」和「使用者設定」資料夾中。若要使此設定生效，您必須在兩個資料夾中啟用該設定。注意：如果啟用，熟練用戶可以利用此設定授予的權限來更改其權限並獲得對受限檔案和資料夾的永久存取權限。請注意，不保證此設定的使用者配置版本的安全性。此設定的建議狀態是：停用。"
    rationale: "權限有限的使用者可以透過建立 Windows Installer 安裝套件來利用此功能，該安裝套件會建立屬於本機內建管理員群組的新本機帳戶、將其目前帳戶新增至本機內建管理員群組、安裝惡意軟體，或進行其他未經授權的活動。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP設置建議的配置，請將以下UI路徑設置為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Always install with elevated privileges 注意: 此群組原則路徑由群組原則模板MSI.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.10.81.2"]
      - cis_csc_v8: ["5.4"]
      - cis_csc_v7: ["4.3"]
      - cmmc_v2.0: ["AC.L2-3.1.5", "AC.L2-3.1.6", "AC.L2-3.1.7", "SC.L2-3.13.3"]
      - iso_27001-2013: ["A.9.2.3"]
      - nist_sp_800-53: ["AC-6(2)", "AC-6(5)"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
      - soc_2: ["CC6.1", "CC6.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> AlwaysInstallElevated'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> AlwaysInstallElevated -> 0'

  # 18.10.81.3 (L2) Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'. (Automated)
  - id: 16315
    title: "確保「封鎖 Windows Installer 腳本的 Internet Explorer 安全性提示」設定為「停用」。"
    description: "此策略設定控制是否允許基於 Web 的程式在電腦上安裝軟體而不通知使用者。此設定的建議狀態是：停用。"
    rationale: "抑制系統警告可能會帶來安全風險並增加系統的攻擊面。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 設定建議的配置，請將以下路徑設置為「已停用」: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Installer\\Prevent Internet Explorer security prompt for Windows Installer scripts 注意: 此群組原則路徑由包含於所有版本 Microsoft Windows 管理模板的 MSI.admx/adml 群組原則模板提供。注意 #2: 在早期的 Microsoft Windows 管理模板中，此設置最初名為 Disable IE security prompt for Windows Installer scripts，但從 Windows 8.0 和 Server 2012 (非 R2) 管理模板開始重命名。"
    compliance:
      - cis: ["18.10.81.3"]
      - cis_csc_v8: ["2.5"]
      - cmmc_v2.0: ["CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "CM.L2-3.4.9"]
      - nist_sp_800-53: ["CM-7(5)"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> SafeForScripting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer -> SafeForScripting -> 0'

  # 18.10.82.1 (L1) Ensure 'Sign-in and lock last interactive user automatically after a restart' is set to 'Disabled'. (Automated)
  - id: 16316
    title: "確保「重新啟動後自動登入並鎖定最後一個互動式使用者」設定為「停用」。"
    description: "此策略設定控制 Windows 更新重新啟動系統後裝置是否自動登入最後一個互動式使用者。此設定的建議狀態是：停用。"
    rationale: "停用此功能將防止快取使用者憑證和未經授權使用設備，並確保使用者知道重新啟動。"
    impact: "The device does not store the user's credentials for automatic sign-in after a Windows Update restart. The users' lock screen apps are not restarted after the system restarts. The user is required to present the logon credentials in order to proceed after restart."
    remediation: "要透過 GP 建立建議的配置，請將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Logon Options\\Sign-in and lock last interactive user automatically after a restart 注意：此群組原則路徑預設情況下可能不存在。它由群組原則範本 WinLogon.admx/adml 提供，該範本與 Microsoft Windows 8.1 和 Server 2012 R2 管理範本（或更新版本）一起提供。注意 #2：在舊版 Microsoft Windows 管理範本中，此設置最初命名為 Sign-in last interactive user automatically after a system-initiated restart，但從 Windows 10 Release 1903 管理範本開始，它被重新命名。"
    compliance:
      - cis: ["18.10.82.1"]
      - cis_csc_v7: ["16.11"]
      - iso_27001-2013: ["A.8.1.3"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableAutomaticRestartSignOn'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -> DisableAutomaticRestartSignOn -> 1'

  # 18.10.87.1 (L1) Ensure 'Turn on PowerShell Script Block Logging' is set to 'Enabled'. (Automated)
  - id: 16317
    title: "確保「開啟 PowerShell 腳本區塊日誌記錄」設定為「已啟用」。"
    description: "此原則設定允許將所有 PowerShell 腳本輸入記錄到應用程式和服務日誌\\Microsoft\\Windows\\PowerShell\\操作事件日誌通道。此設定的建議狀態為：已啟用。注意：如果啟用了腳本區塊呼叫啟動/停止事件的日誌記錄（選取選項方塊），PowerShell 將在呼叫指令、腳本區塊、函數或腳本啟動或停止時記錄其他事件。啟用此選項會產生大量事件日誌。 CIS 有意選擇不推薦此選項，因為它會產生大量事件。如果組織選擇啟用可選設定（選取），這也符合基準。"
    rationale: "在對 PowerShell 攻擊事件進行取證調查以確定發生的情況時，PowerShell 腳本輸入的日誌非常有價值。"
    impact: "PowerShell script input will be logged to the Applications and Services Logs\\Microsoft\\Windows\\PowerShell\\Operational Event Log channel, which can contain credentials and sensitive information. Warning: There are potential risks of capturing credentials and sensitive information in the PowerShell logs, which could be exposed to users who have read-access to those logs. Microsoft provides a feature called \"Protected Event Logging\" to better secure event log data. For assistance with protecting event logging, visit: About Logging Windows - PowerShell | Microsoft Docs."
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Script Block Logging 注意：此組策略路徑可能預設不存在。它由組策略模板PowerShellExecutionPolicy.admx/adml提供，該模板包含在 Microsoft Windows 10 RTM (Release 1507) 的管理模板中（或更新版本）。"
    references:
      - "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7.2#protected-event-logging"
    compliance:
      - cis: ["18.10.87.1"]
      - cis_csc_v8: ["8.8"]
      - cis_csc_v7: ["8.8"]
      - iso_27001-2013: ["A.12.14.1"]
      - soc_2: ["CC5.2", "CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging -> EnableScriptBlockLogging'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging -> EnableScriptBlockLogging -> 1'

  # 18.10.87.2 (L1) Ensure 'Turn on PowerShell Transcription' is set to 'Enabled'. (Automated)
  - id: 16318
    title: "確保「開啟 PowerShell 轉錄」設定為「已啟用」。"
    description: "此策略設定可讓您將 Windows PowerShell 指令的輸入和輸出擷取到基於文字的記錄中。此設定的建議狀態為：已啟用。"
    rationale: "在對 PowerShell 攻擊事件進行取證調查以確定發生的情況時，PowerShell 腳本輸入非常有價值。"
    impact: "PowerShell transcript input will be logged to the PowerShell_transcript output file, which is saved to the My Documents folder of each users' profile by default. Warning: There are potential risks of capturing credentials and sensitive information in the PowerShell_transcript output file, which could be exposed to users who have read-access to the file."
    remediation: "要根據GP建立推薦的配置，將以下UI路徑設定為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Transcription 注意: 此群組原則路徑預設可能不存在。它由Group Policy範本PowerShellExecutionPolicy.admx/adml提供，此範本包含在Microsoft Windows 10 RTM（發行1507）管理範本（或更新版本）中。"
    references:
      - "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_group_policy_settings?view=powershell-7.2#turn-on-powershell-transcription"
    compliance:
      - cis: ["18.10.87.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription -> EnableTranscripting'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription -> EnableTranscripting -> 1'

  # 18.10.89.1.1 (L1) Ensure 'Allow Basic authentication' is set to 'Disabled'. (Automated)
  - id: 16319
    title: "確保“允許基本身份驗證”設定為“禁用”。"
    description: "此原則設定可讓您管理 Windows 遠端管理 (WinRM) 用戶端是否使用基本驗證。此設定的建議狀態是：停用。"
    rationale: "基本身份驗證不如 WinRM 中提供的其他身份驗證方法可靠，因為包括密碼在內的憑證以純文字形式傳輸。能夠捕獲執行 WinRM 的網路上的資料包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Allow Basic authentication 注意：此組策略路徑由所有版本的 Microsoft Windows 行政模板中包含的組策略模板 WindowsRemoteManagement.admx/adml 提供。"
    compliance:
      - cis: ["18.10.89.1.1"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["16.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowBasic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowBasic -> 0'

  # 18.10.89.1.2 (L1) Ensure 'Allow unencrypted traffic' is set to 'Disabled'. (Automated)
  - id: 16320
    title: "確保「允許未加密的流量」設定為「停用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 用戶端是否透過網路傳送和接收未加密的訊息。此設定的建議狀態是：停用。"
    rationale: "對 WinRM 網路流量進行加密可降低攻擊者在 WinRM 訊息透過網路傳輸時查看或修改 WinRM 訊息的風險。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Allow unencrypted traffic 注意: 此群組策略路徑由 Group Policy 模板 WindowsRemoteManagement.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.10.89.1.2"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["14.4"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowUnencryptedTraffic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowUnencryptedTraffic -> 0'

  # 18.10.89.1.3 (L1) Ensure 'Disallow Digest authentication' is set to 'Enabled'. (Automated)
  - id: 16321
    title: "確保「禁止摘要式身份驗證」設定為「啟用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 用戶端是否不使用摘要式驗證。此設定的建議狀態為：已啟用。"
    rationale: "摘要式驗證的穩健性不如 WinRM 中可用的其他驗證方法，能夠擷取執行 WinRM 的網路上的封包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    impact: "The WinRM client will not use Digest authentication."
    remediation: "若要透過 GP 設定建議的配置，將以下 UI 路徑設為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Client\\Disallow Digest authentication 注意: 此群組原則路徑由群組原則範本 WindowsRemoteManagement.admx/adml 提供，此範本隨所有版本的 Microsoft Windows 管理範本一同提供。"
    compliance:
      - cis: ["18.10.89.1.3"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["16.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowDigest'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client -> AllowDigest -> 0'

  # 18.10.89.2.1 (L1) Ensure 'Allow Basic authentication' is set to 'Disabled'. (Automated)
  - id: 16322
    title: "確保“允許基本身份驗證”設定為“禁用”。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否接受來自遠端用戶端的基本驗證。此設定的建議狀態是：停用。"
    rationale: "基本身份驗證不如 WinRM 中提供的其他身份驗證方法可靠，因為包括密碼在內的憑證以純文字形式傳輸。能夠捕獲執行 WinRM 的網路上的資料包的攻擊者可能能夠確定用於透過 WinRM 存取遠端主機的憑證。"
    impact: "None - this is the default behavior."
    remediation: "要透過群組原則(GP)設定建議的配置，將以下 UI 路徑設為禁用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow Basic authentication 注意: 這個群組原則路徑由 Group Policy template WindowsRemoteManagement.admx/adml 提供，並包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.10.89.2.1"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["16.5"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowBasic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowBasic -> 0'

  # 18.10.89.2.2 (L2) Ensure 'Allow remote server management through WinRM' is set to 'Disabled'. (Automated)
  - id: 16323
    title: "確保「允許透過 WinRM 進行遠端伺服器管理」設定為「停用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否會自動在網路上偵聽預設 HTTP 連接埠上的 HTTP 傳輸要求。此設定的建議狀態是：停用。"
    rationale: "任何功能都是潛在的攻擊途徑，那些啟用入站網路連線的功能尤其危險。僅在受信任的網路上啟用 Windows 遠端管理 (WinRM) 服務，並在可行時採用 IPsec 等其他控制措施。"
    impact: "None - this is the default behavior."
    remediation: "要透過 GP 建立推薦的配置，將以下使用者介面路徑設為停用: Computer Configuration\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow remote server management through WinRM 注意: 此群組原則路徑由所有版本的 Microsoft Windows 管理模板包含的 Group Policy 模板 WindowsRemoteManagement.admx/adml 提供。 注意 #2: 在舊版的 Microsoft Windows 管理模板中，這個設定最初名為 Allow automatic configuration of listeners，但從 Windows 8.0 和 Server 2012（非 R2）管理模板開始，這個名稱已被重新命名。"
    compliance:
      - cis: ["18.10.89.2.2"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowAutoConfig'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowAutoConfig -> 0'

  # 18.10.89.2.3 (L1) Ensure 'Allow unencrypted traffic' is set to 'Disabled'. (Automated)
  - id: 16324
    title: "確保「允許未加密的流量」設定為「停用」。"
    description: "此策略設定可讓你管理 Windows 遠端管理 (WinRM) 服務是否透過網路傳送和接收未加密的訊息。此設定的建議狀態是：停用。"
    rationale: "對 WinRM 網路流量進行加密可降低攻擊者在 WinRM 訊息透過網路傳輸時查看或修改 WinRM 訊息的風險。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦的配置，請將以下 UI 路徑設置為 Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Allow unencrypted traffic 注意：此組策略路徑由 Group Policy 模板 WindowsRemoteManagement.admx/adml 提供，該模板包含在所有版本的 Microsoft Windows Administrative Templates 中。"
    compliance:
      - cis: ["18.10.89.2.3"]
      - cis_csc_v8: ["3.10"]
      - cis_csc_v7: ["14.4"]
      - cmmc_v2.0: ["AC.L2-3.1.13", "AC.L2-3.1.17", "IA.L2-3.5.10", "SC.L2-3.13.11", "SC.L2-3.13.15", "SC.L2-3.13.8"]
      - hipaa: ["164.312(a)(2)(iv)", "164.312(e)(1)", "164.312(e)(2)(i)", "164.312(e)(2)(ii)"]
      - iso_27001-2013: ["A.10.1.1", "A.13.1.1"]
      - nist_sp_800-53: ["AC-17(2)", "SC-8", "SC-8(1)"]
      - pci_dss_v3.2.1: ["2.1.1", "4.1", "4.1.1", "8.2.1"]
      - pci_dss_v4.0: ["2.2.7", "4.1.1", "4.2.1", "4.2.1.2", "4.2.2", "8.3.2"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowUnencryptedTraffic'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> AllowUnencryptedTraffic -> 0'

  # 18.10.89.2.4 (L1) Ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled'. (Automated)
  - id: 16325
    title: "確保「禁止 WinRM 儲存 RunAs 憑證」設定為「啟用」。"
    description: "透過此策略設置，您可以管理 Windows 遠端管理 (WinRM) 服務是否允許儲存任何外掛程式的運行身分憑證。此設定的建議狀態為：已啟用。注意：如果啟用然後停用此策略設置，則先前為 RunAsPassword 配置的任何值都需要重置。"
    rationale: "儘管儲存 RunAs 憑證的功能是一項方便的功能，但它會稍微增加帳戶外洩的風險。例如，如果您在無人看管幾分鐘之前忘記鎖定桌面，其他人不僅可以存取您電腦的桌面，還可以存取您透過 WinRM 使用快取的 RunAs 憑證管理的任何主機。"
    impact: "The WinRM service will not allow the RunAsUser or RunAsPassword configuration values to be set for any plug-ins. If a plug-in has already set the RunAsUser and RunAsPassword configuration values, the RunAsPassword configuration value will be erased from the credential store on the computer. If this setting is later Disabled again, any values that were previously configured for RunAsPassword will need to be reset."
    remediation: "要通過 GP 設置推薦配置，將以下 UI 路徑設置為已啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Management (WinRM)\\WinRM Service\\Disallow WinRM from storing RunAs credentials 注意: 默认情况下可能不存在此组策略路径。 它由包含在 Microsoft Windows 8.0 及 Server 2012 (非 R2) 管理模板（或更新版本）中的组策略模板 WindowsRemoteManagement.admx/adml 提供。"
    compliance:
      - cis: ["18.10.89.2.4"]
      - cis_csc_v7: ["14.3"]
      - iso_27001-2013: ["A.13.1.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> DisableRunAs'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service -> DisableRunAs -> 1'

  # 18.10.90.1 (L2) Ensure 'Allow Remote Shell Access' is set to 'Disabled'. (Automated)
  - id: 16326
    title: "確保「允許遠端 Shell 存取」設定為「停用」。"
    description: "此策略設定可讓您管理對所有支援的 shell 的遠端存取配置以執行腳本和指令。此設定的建議狀態是：停用。注意：此設定的 GPME 幫助文字措辭不正確，這意味著將其配置為「啟用」將拒絕新的遠端 Shell 連接，將其設為「停用」將允許遠端 Shell 連接。事實恰恰相反（並且與設定的標題一致）。這是 Microsoft 在管理範本中的措詞錯誤。"
    rationale: "任何功能都是潛在的攻擊途徑，那些啟用入站網路連線的功能尤其危險。僅在受信任的網路上啟用 Windows Remote Shell，並在可行時採用 IPsec 等其他控制措施。"
    impact: "New Remote Shell connections are not allowed and are rejected by the server. Note: On Server 2012 (non-R2) and newer, due to design changes in the OS after Server 2008 R2, configuring this setting as prescribed will prevent the ability to add or remove Roles and Features (even locally) via the GUI. We therefore recommend that the necessary Roles and Features be installed prior to configuring this setting on a Level 2 server. Alternatively, Roles and Features can still be added or removed using the PowerShell commands Add-WindowsFeature or Remove-WindowsFeature in the Server Manager module, even with this setting configured."
    remediation: "要通過GP建立推薦的配置，請將以下UI路徑設定為已停用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Remote Shell\\Allow Remote Shell Access 注意：此群組政策路徑由群組政策模板WindowsRemoteShell.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.10.90.1"]
      - cis_csc_v8: ["4.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.L2-3.4.7", "CM.L2-3.4.8", "SC.L2-3.13.6"]
      - iso_27001-2013: ["A.13.1.3"]
      - pci_dss_v3.2.1: ["1.1.6", "1.2.1", "2.2.2", "2.2.5"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4", "6.4.1"]
      - soc_2: ["CC6.3", "CC6.6"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS -> AllowRemoteShellAccess'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS -> AllowRemoteShellAccess -> 0'

  # 18.10.92.2.1 (L1) Ensure 'Prevent users from modifying settings' is set to 'Enabled'. (Automated)
  - id: 16327
    title: "確保「阻止使用者修改設定」設定為「啟用」。"
    description: "此策略設定可阻止使用者變更 Windows 安全性設定中的漏洞保護設定區域。此設定的建議狀態為：已啟用。"
    rationale: "只有經過授權的 IT 人員才能夠更改漏洞保護設置，以確保組織的特定配置不會被修改。"
    impact: "Local users cannot make changes in the Exploit protection settings area."
    remediation: "要通過GP建立推薦的配置，將以下UI路徑設置為已啟用：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Security\\App and browser protection\\Prevent users from modifying settings 注意：此組策略路徑可能預設不存在。它由組策略模板WindowsDefenderSecurityCenter.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1709管理模板中（或更新版本）。"
    compliance:
      - cis: ["18.10.92.2.1"]
      - cis_csc_v8: ["10.5"]
      - cis_csc_v7: ["8.3"]
      - nist_sp_800-53: ["SI-16"]
      - pci_dss_v3.2.1: ["1.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection -> DisallowExploitProtectionOverride'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection -> DisallowExploitProtectionOverride -> 1'

  # 18.10.93.1.1 (L1) Ensure 'No auto-restart with logged on users for scheduled automatic updates installations' is set to 'Disabled'. (Automated)
  - id: 16328
    title: "確保「對於已排程的自動更新安裝，登入使用者不會自動重新啟動」設定為「停用」。"
    description: "此政策設定指定自動更新將等待登入電腦的使用者重新啟動電腦以完成計劃的安裝。此設定的建議狀態是：停用。注意：此設定僅在您設定自動更新以執行計劃的更新安裝時適用。如果將“配置自動更新”設定配置為“已停用”，則此設定無效。"
    rationale: "某些安全性更新需要重新啟動電腦才能完成安裝。如果電腦無法自動重新啟動，則最新更新將無法完全安裝，並且在重新啟動之前不會將新更新下載到電腦。如果沒有自動重新啟動功能，沒有安全意識的使用者可能會選擇無限期延遲重啟，從而使電腦處於不太安全的狀態。"
    impact: "None - this is the default behavior."
    remediation: "要透過GP建立建議的配置，將以下UI路徑設定為Disabled: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Legacy Policies\\No auto-restart with logged on users for scheduled automatic updates installations 注意：此群組原則路徑由隨所有版本的Microsoft Windows管理範本包括的Group Policy範本WindowsUpdate.admx/adml提供。注意#2：在較早的Microsoft Windows管理範本中，此設置最初名為No auto-restart for scheduled Automatic Updates installations，但自Windows 7及Server 2008 R2管理範本開始便被重新命名。"
    compliance:
      - cis: ["18.10.93.1.1"]
      - cis_csc_v8: ["7.3"]
      - cis_csc_v7: ["3.4"]
      - cmmc_v2.0: ["SI.L1-3.14.1"]
      - nist_sp_800-53: ["SI-2(2)"]
      - pci_dss_v3.2.1: ["6.2"]
      - soc_2: ["CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoRebootWithLoggedOnUsers'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoRebootWithLoggedOnUsers -> 0'

  # 18.10.93.2.1 (L1) Ensure 'Configure Automatic Updates' is set to 'Enabled'. (Automated)
  - id: 16329
    title: "確保“配置自動更新”設定為“啟用”。"
    description: '此政策設定指定您環境中的電腦是否將從 Windows Update 或 WSUS 接收安全更新。如果將此原則設定配置為“啟用”，作業系統將識別網路連線何時可用，然後使用網路連線搜尋 Windows 更新或指定的 Intranet 網站以取得適用於它們的更新。將此策略設定配置為「啟用」後，在「配置自動更新屬性」對話方塊中選擇以下三個選項之一以指定服務的工作方式： - 2 - 通知下載和自動安裝（下載任何更新之前通知） - 3 - 自動下載並通知安裝（自動下載更新並在準備安裝時通知。）（預設） - 4 - 自動下載並安排安裝（自動下載更新並按照下面指定的時間表安裝。） ) - 5 - 允許本機管理員選擇設定（將上述選擇的決定權留給本機管理員（不建議）） 此設定的建議狀態為：啟用。注意：子設定「配置自動更新：」有 4 個可能的值 - 所有這些值都有效，具體取決於特定的組織需求，但如果可行，我們建議使用值 4 - 自動下載並安排安裝。此建議不是評分要求。注意#2：使用第三方解決方案進行修補的組織可以選擇免除此建議，而是將其配置為“停用”，以便本機 Windows 更新機制不會幹擾第三方修補過程。'
    rationale: "儘管每個版本的Windows在發布前都經過了徹底的測試，但在產品發貨後仍有可能發現問題。配置自動更新設定可以幫助您確保環境中的電腦始終安裝最新的關鍵作業系統更新和服務包。"
    impact: "Critical operating system updates and service packs will be installed as necessary."
    remediation: "要通過 GP 建立建議的配置，請將以下 UI 路徑設置為啟用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage end user experience\\Configure Automatic Updates 注意: 此群組原則路徑由群組原則範本 WindowsUpdate.admx/adml 提供，該範本包含在所有版本的 Microsoft Windows 管理模板中。"
    compliance:
      - cis: ["18.10.93.2.1"]
      - cis_csc_v8: ["7.3"]
      - cis_csc_v7: ["3.4"]
      - cmmc_v2.0: ["SI.L1-3.14.1"]
      - nist_sp_800-53: ["SI-2(2)"]
      - pci_dss_v3.2.1: ["6.2"]
      - soc_2: ["CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoUpdate'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> NoAutoUpdate -> 0'

  # 18.10.93.2.2 (L1) Ensure 'Configure Automatic Updates: Scheduled install day' is set to '0 - Every day'. (Automated)
  - id: 16330
    title: "確保“配置自動更新：計劃安裝日”設定為“0 - 每天”。"
    description: "此政策設定指定環境中的電腦何時從 Windows Update 或 WSUS 接收安全性更新。此設定的建議狀態是：0 - 每天。注意：只有在建議「設定自動更新」中選擇 4 - 自動下載並排程安裝時，此設定才適用。如果選擇任何其他選項，則不會產生任何影響。"
    rationale: "儘管每個版本的Windows在發布前都經過了徹底的測試，但在產品發貨後仍有可能發現問題。配置自動更新設定可以幫助您確保環境中的電腦始終安裝最新的關鍵作業系統更新和服務包。"
    impact: "If 4 - Auto download and schedule the install is selected in recommendation 'Configure Automatic Updates', critical operating system updates and service packs will automatically download every day (at 3:00 A.M., by default)."
    remediation: "要通過GP建立推薦配置，將以下路徑設置為0 - 每天: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage end user experience\\Configure Automatic Updates: Scheduled install day 注意: 此組策略路徑由組策略模板WindowsUpdate.admx/adml提供，該模板包含在所有版本的Microsoft Windows管理模板中。"
    compliance:
      - cis: ["18.10.93.2.2"]
      - cis_csc_v8: ["7.3"]
      - cis_csc_v7: ["3.4"]
      - cmmc_v2.0: ["SI.L1-3.14.1"]
      - nist_sp_800-53: ["SI-2(2)"]
      - pci_dss_v3.2.1: ["6.2"]
      - soc_2: ["CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> ScheduledInstallDay'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU -> ScheduledInstallDay -> 0'

  # 18.10.93.4.1 (L1) Ensure 'Manage preview builds' is set to 'Disabled'. (Automated)
  - id: 16331
    title: "確保「管理預覽版本」設定為「停用」。"
    description: "此策略設定管理在發布更新之前接收哪些更新。開發頻道：非常適合高技術用戶。開發管道中的內部人員將從我們活躍的開發分支接收開發週期中最早的版本。這些版本與特定的 Windows 10 版本不符。 Beta 頻道：非常適合想要了解即將推出的 Windows 10 功能的功能探索者。您的回饋在這裡尤其重要，因為它將幫助我們的工程師確保在主要版本發布之前解決關鍵問題。發布預覽頻道（預設）：發布預覽頻道中的內部人員可以在即將發布的 Windows 10 發佈到全世界之前存取該版本。這些版本由 Microsoft 支援。我們建議公司在組織內廣泛部署之前，透過發布預覽頻道預覽和驗證即將發布的 Windows 10 版本。此設定的建議狀態是：停用。注意：預覽版本註冊需要遙測等級設定為 2 或更高，並且您的網域在 insider.windows.com 上註冊。有關預覽版本的更多資訊，請參閱：https://aka.ms/wipforbiz。"
    rationale: "在企業管理的環境中允許實驗性功能可能存在風險，因為這可能會為系統帶來錯誤和安全漏洞，使攻擊者更容易獲得存取權限。通常最好只使用生產就緒的版本。"
    impact: "Preview builds are prevented from installing on the device."
    remediation: "要透過 GP 建立建議的配置，將以下 UI 路徑設置為停用: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage updates offered from Windows Update\\Manage preview builds 注意: 此群組原則路徑預設可能不存在。它由 Group Policy 範本 WindowsUpdate.admx/adml 提供，包含在 Microsoft Windows 10 1709 版的行政範本 (或更新版本) 中。"
    references:
      - "https://docs.microsoft.com/en-us/windows-insider/business/manage-builds"
    compliance:
      - cis: ["18.10.93.4.1"]
      - cis_csc_v8: ["2.5"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "CM.L2-3.4.9"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - nist_sp_800-53: ["CM-7(5)"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4"]
      - soc_2: ["CC6.8"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> ManagePreviewBuildsPolicyValue'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> ManagePreviewBuildsPolicyValue -> 0'

  # 18.10.93.4.2 (L1) Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled: 180 or more days'. (Automated)
  - id: 16332
    title: "確保「收到預覽版本和功能更新時選擇」設定為「啟用：180 天或更多天」。"
    description: '此策略設定決定何時接收預覽版本或功能更新。延遲更新 這使裝置能夠將您的頻道可用的下一個功能更新推遲最多 14 天（對於所有預發布頻道）和最多 365 天（對於半年頻道）。或者，如果裝置正在從半年頻道進行更新，則可以指定裝置要移至和/或保留的版本，直到政策更新或裝置達到服務終止為止。注意：如果您設定了這兩個策略，則指定的版本將優先，並且延遲將不會生效。請參閱 Windows 版本資訊頁面以了解作業系統版本資訊。暫停更新 若要防止按計劃時間收到功能更新，您可以暫時暫停功能更新。暫停將在指定開始日期後 35 天內有效，或直到清除該欄位為止（仍將提供品質更新）。注意：如果「允許診斷資料」（以前稱為「允許遙測」）策略設定為 0，則此策略將無效。注意#2：從 Windows 10 R1607 開始，Microsoft 引入了一種名為「雙重掃描」的新 Windows 更新 (WU) 用戶端行為，著眼於基於雲端的更新管理。在某些情況下，此雙重掃描功能可能會幹擾來自 Windows Server 更新服務 (WSUS) 的 Windows 更新和/或手動 WU 更新。如果您在環境中使用 WSUS，則可能需要將上述設定設為「未設定」或設定「不允許更新延遲策略導致對 Windows 更新進行掃描」（在 Windows 10 版本 1709 管理範本中新增），以便防止雙重掃描功能幹擾。有關雙重掃描的更多資訊，請存取以下鏈接： - 揭秘“雙重掃描” - WSUS 產品團隊博客- 改進1607 上的雙重掃描- WSUS 產品團隊博客注意#3：在Windows 10 R1703 之前，無法識別超過180天的值由作業系統。從 Windows 10 R1703 開始，您可以延遲的最大天數為 365 天。'
    rationale: "在生產環境中，最好只使用經過嚴格測試的公開可用的軟體和功能。"
    impact: "Feature Updates will be delayed until they are publicly released to general public by Microsoft."
    remediation: "要透過群組原則（GP）建立建議的配置，請將以下UI路徑設為已啟用：180天或更長時間：Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage updates offered from Windows Update\\Select when Preview Builds and Feature Updates are received 注意：此群組原則路徑預設可能不存在。它由群組原則模板WindowsUpdate.admx/adml提供，該模板包含在Microsoft Windows 10 Release 1607 & Server 2016 Administrative Templates中（或更新版本）。 注意#2：在較舊的Microsoft Windows Administrative Templates中，此設置最初名為Select when Feature Updates are received，但從Windows 10 Release 1709 Administrative Templates開始，此設置已重新命名為Select when Preview Builds and Feature Updates are received。"
    compliance:
      - cis: ["18.10.93.4.2"]
      - cis_csc_v8: ["2.5", "7.3"]
      - cis_csc_v7: ["2.4"]
      - cmmc_v2.0: ["CM.L2-3.4.6", "CM.L2-3.4.7", "CM.L2-3.4.8", "CM.L2-3.4.9", "SI.L1-3.14.1"]
      - iso_27001-2013: ["A.8.1.1"]
      - nist_sp_800-53: ["CM-7(5)", "SI-2(2)"]
      - pci_dss_v3.2.1: ["6.2"]
      - pci_dss_v4.0: ["1.2.5", "2.2.4"]
      - soc_2: ["CC6.8", "CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferFeatureUpdates -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> n:^(\d+) compare >= 180'

  # 18.10.93.4.3 (L1) Ensure 'Select when Quality Updates are received' is set to 'Enabled: 0 days'. (Automated)
  - id: 16333
    title: "確保「選擇何時收到品質更新」設定為「啟用：0 天」。"
    description: '此設定控制何時接收品質更新。此設定的建議狀態為：啟用：0 天。注意：如果「允許診斷資料」（以前稱為「允許遙測」）策略設定為 0，則此策略將無效。注意#2：從 Windows Server 2016 RTM（版本 1607）開始，Microsoft 引進了一種稱為雙掃描的新 Windows Update (WU) 用戶端行為，著眼於基於雲端的更新管理。在某些情況下，此雙重掃描功能可能會幹擾來自 Windows Server 更新服務 (WSUS) 的 Windows 更新和/或手動 WU 更新。如果您在環境中使用 WSUS，則可能需要將上述設定設為「未設定」或設定「不允許更新延遲策略導致對 Windows 更新進行掃描」（在 Windows 10 版本 1709 管理範本中新增），以便防止雙重掃描功能幹擾。有關雙重掃描的更多資訊，請存取以下鏈接： - 揭秘“雙重掃描” - WSUS 產品團隊博客 - 改進 1607 上的雙重掃描 - WSUS 產品團隊博客。'
    rationale: "品質更新可能包含重要的錯誤修復和/或安全更新檔，應盡快安裝。"
    impact: "None - this is the default behavior."
    remediation: "要通過 GP 建立推薦的配置，將以下 UI 路徑設置為啟用：0 天: Computer Configuration\\Policies\\Administrative Templates\\Windows Components\\Windows Update\\Manage updates offered from Windows Update\\Select when Quality Updates are received 注意：此群組原則路徑預設不存在。需要更新的群組原則模板 (WindowsUpdate.admx/adml) - 它包含在 Microsoft Windows 10 版本 1607 及 Server 2016 的管理模板 (或更新版本) 中。"
    compliance:
      - cis: ["18.10.93.4.3"]
      - cis_csc_v8: ["7.3"]
      - cis_csc_v7: ["3.4", "3.5"]
      - cmmc_v2.0: ["SI.L1-3.14.1"]
      - nist_sp_800-53: ["SI-2(2)"]
      - pci_dss_v3.2.1: ["6.2"]
      - soc_2: ["CC7.1"]
    condition: all
    rules:
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferQualityUpdates -> 1'
      - 'r:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate -> DeferQualityUpdatesPeriodInDays -> 0'

  # 19.1.3.1 (L1) Ensure 'Enable screen saver' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.1.3.2 (L1) Ensure 'Password protect the screen saver' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.1.3.3 (L1) Ensure 'Screen saver timeout' is set to 'Enabled: 900 seconds or fewer, but not 0'. (Automated) - Not Implemented
  # 19.5.1.1 (L1) Ensure 'Turn off toast notifications on the lock screen' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.6.6.1.1 (L2) Ensure 'Turn off Help Experience Improvement Program' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.4.1 (L1) Ensure 'Do not preserve zone information in file attachments' is set to 'Disabled'. (Automated) - Not Implemented
  # 19.7.4.2 (L1) Ensure 'Notify antivirus programs when opening attachments' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.7.1 (L1) Ensure 'Configure Windows spotlight on lock screen' is set to Disabled'. (Automated) - Not Implemented
  # 19.7.7.2 (L1) Ensure 'Do not suggest third-party content in Windows spotlight' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.7.3 (L2) Ensure 'Do not use diagnostic data for tailored experiences' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.7.4 (L2) Ensure 'Turn off all Windows spotlight features' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.7.5 (L1) Ensure 'Turn off Spotlight collection on Desktop' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.25.1 (L1) Ensure 'Prevent users from sharing files within their profile.' is set to 'Enabled'. (Automated) - Not Implemented
  # 19.7.40.1 (L1) Ensure 'Always install with elevated privileges' is set to 'Disabled'. (Automated) - Not Implemented
  # 19.7.42.2.1 (L2) Ensure 'Prevent Codec Download' is set to 'Enabled'. (Automated) - Not Implemented
